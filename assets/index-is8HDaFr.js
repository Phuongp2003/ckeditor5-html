var qR=Object.defineProperty;var jR=(n,t,e)=>t in n?qR(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var GR=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var h=(n,t,e)=>jR(n,typeof t!="symbol"?t+"":t,e);var yle=GR((Rn,Ln)=>{function KR(n,t){for(var e=0;e<t.length;e++){const i=t[e];if(typeof i!="string"&&!Array.isArray(i)){for(const s in i)if(s!=="default"&&!(s in n)){const o=Object.getOwnPropertyDescriptor(i,s);o&&Object.defineProperty(n,s,o.get?o:{enumerable:!0,get:()=>i[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function e(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=e(s);fetch(s.href,o)}})();/**
* @vue/shared v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Sd(n,t){const e=new Set(n.split(","));return i=>e.has(i)}const Le={},Cr=[],dn=()=>{},ZR=()=>!1,Fl=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Tg=n=>n.startsWith("onUpdate:"),ot=Object.assign,Eg=(n,t)=>{const e=n.indexOf(t);e>-1&&n.splice(e,1)},JR=Object.prototype.hasOwnProperty,Se=(n,t)=>JR.call(n,t),Y=Array.isArray,kr=n=>Zr(n)==="[object Map]",Vo=n=>Zr(n)==="[object Set]",yw=n=>Zr(n)==="[object Date]",YR=n=>Zr(n)==="[object RegExp]",ce=n=>typeof n=="function",st=n=>typeof n=="string",xi=n=>typeof n=="symbol",Ue=n=>n!==null&&typeof n=="object",Ag=n=>(Ue(n)||ce(n))&&ce(n.then)&&ce(n.catch),jy=Object.prototype.toString,Zr=n=>jy.call(n),XR=n=>Zr(n).slice(8,-1),Gy=n=>Zr(n)==="[object Object]",xg=n=>st(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Tr=Sd(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Id=n=>{const t=Object.create(null);return e=>t[e]||(t[e]=n(e))},QR=/-(\w)/g,Wt=Id(n=>n.replace(QR,(t,e)=>e?e.toUpperCase():"")),e3=/\B([A-Z])/g,un=Id(n=>n.replace(e3,"-$1").toLowerCase()),Dl=Id(n=>n.charAt(0).toUpperCase()+n.slice(1)),Oa=Id(n=>n?`on${Dl(n)}`:""),Jt=(n,t)=>!Object.is(n,t),Er=(n,...t)=>{for(let e=0;e<n.length;e++)n[e](...t)},Ky=(n,t,e,i=!1)=>{Object.defineProperty(n,t,{configurable:!0,enumerable:!1,writable:i,value:e})},Tu=n=>{const t=parseFloat(n);return isNaN(t)?n:t},Eu=n=>{const t=st(n)?Number(n):NaN;return isNaN(t)?n:t};let Cw;const Zy=()=>Cw||(Cw=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),t3="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error",n3=Sd(t3);function $l(n){if(Y(n)){const t={};for(let e=0;e<n.length;e++){const i=n[e],s=st(i)?r3(i):$l(i);if(s)for(const o in s)t[o]=s[o]}return t}else if(st(n)||Ue(n))return n}const i3=/;(?![^(]*\))/g,s3=/:([^]+)/,o3=/\/\*[^]*?\*\//g;function r3(n){const t={};return n.replace(o3,"").split(i3).forEach(e=>{if(e){const i=e.split(s3);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Hl(n){let t="";if(st(n))t=n;else if(Y(n))for(let e=0;e<n.length;e++){const i=Hl(n[e]);i&&(t+=i+" ")}else if(Ue(n))for(const e in n)n[e]&&(t+=e+" ");return t.trim()}function a3(n){if(!n)return null;let{class:t,style:e}=n;return t&&!st(t)&&(n.class=Hl(t)),e&&(n.style=$l(e)),n}const l3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",c3=Sd(l3);function Jy(n){return!!n||n===""}function u3(n,t){if(n.length!==t.length)return!1;let e=!0;for(let i=0;e&&i<n.length;i++)e=Ps(n[i],t[i]);return e}function Ps(n,t){if(n===t)return!0;let e=yw(n),i=yw(t);if(e||i)return e&&i?n.getTime()===t.getTime():!1;if(e=xi(n),i=xi(t),e||i)return n===t;if(e=Y(n),i=Y(t),e||i)return e&&i?u3(n,t):!1;if(e=Ue(n),i=Ue(t),e||i){if(!e||!i)return!1;const s=Object.keys(n).length,o=Object.keys(t).length;if(s!==o)return!1;for(const r in n){const a=n.hasOwnProperty(r),l=t.hasOwnProperty(r);if(a&&!l||!a&&l||!Ps(n[r],t[r]))return!1}}return String(n)===String(t)}function Pd(n,t){return n.findIndex(e=>Ps(e,t))}const Yy=n=>!!(n&&n.__v_isRef===!0),Sg=n=>st(n)?n:n==null?"":Y(n)||Ue(n)&&(n.toString===jy||!ce(n.toString))?Yy(n)?Sg(n.value):JSON.stringify(n,Xy,2):String(n),Xy=(n,t)=>Yy(t)?Xy(n,t.value):kr(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[i,s],o)=>(e[jh(i,o)+" =>"]=s,e),{})}:Vo(t)?{[`Set(${t.size})`]:[...t.values()].map(e=>jh(e))}:xi(t)?jh(t):Ue(t)&&!Y(t)&&!Gy(t)?String(t):t,jh=(n,t="")=>{var e;return xi(n)?`Symbol(${(e=n.description)!=null?e:t})`:n};/**
* @vue/reactivity v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let An;class Ig{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this.parent=An,!t&&An&&(this.index=(An.scopes||(An.scopes=[])).push(this)-1)}get active(){return this._active}run(t){if(this._active){const e=An;try{return An=this,t()}finally{An=e}}}on(){An=this}off(){An=this.parent}stop(t){if(this._active){let e,i;for(e=0,i=this.effects.length;e<i;e++)this.effects[e].stop();for(e=0,i=this.cleanups.length;e<i;e++)this.cleanups[e]();if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].stop(!0);if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function d3(n){return new Ig(n)}function Qy(n,t=An){t&&t.active&&t.effects.push(n)}function eC(){return An}function h3(n){An&&An.cleanups.push(n)}let fo;class Vr{constructor(t,e,i,s){this.fn=t,this.trigger=e,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Qy(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,Ws();for(let t=0;t<this._depsLength;t++){const e=this.deps[t];if(e.computed&&(f3(e.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),qs()}return this._dirtyLevel>=4}set dirty(t){this._dirtyLevel=t?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let t=xs,e=fo;try{return xs=!0,fo=this,this._runnings++,kw(this),this.fn()}finally{Tw(this),this._runnings--,fo=e,xs=t}}stop(){this.active&&(kw(this),Tw(this),this.onStop&&this.onStop(),this.active=!1)}}function f3(n){return n.value}function kw(n){n._trackId++,n._depsLength=0}function Tw(n){if(n.deps.length>n._depsLength){for(let t=n._depsLength;t<n.deps.length;t++)tC(n.deps[t],n);n.deps.length=n._depsLength}}function tC(n,t){const e=n.get(t);e!==void 0&&t._trackId!==e&&(n.delete(t),n.size===0&&n.cleanup())}function m3(n,t){n.effect instanceof Vr&&(n=n.effect.fn);const e=new Vr(n,dn,()=>{e.dirty&&e.run()});t&&(ot(e,t),t.scope&&Qy(e,t.scope)),(!t||!t.lazy)&&e.run();const i=e.run.bind(e);return i.effect=e,i}function g3(n){n.effect.stop()}let xs=!0,Kf=0;const nC=[];function Ws(){nC.push(xs),xs=!1}function qs(){const n=nC.pop();xs=n===void 0?!0:n}function Pg(){Kf++}function Rg(){for(Kf--;!Kf&&Zf.length;)Zf.shift()()}function iC(n,t,e){if(t.get(n)!==n._trackId){t.set(n,n._trackId);const i=n.deps[n._depsLength];i!==t?(i&&tC(i,n),n.deps[n._depsLength++]=t):n._depsLength++}}const Zf=[];function sC(n,t,e){Pg();for(const i of n.keys()){let s;i._dirtyLevel<t&&(s??(s=n.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=t),i._shouldSchedule&&(s??(s=n.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&Zf.push(i.scheduler)))}Rg()}const oC=(n,t)=>{const e=new Map;return e.cleanup=n,e.computed=t,e},Au=new WeakMap,mo=Symbol(""),Jf=Symbol("");function wn(n,t,e){if(xs&&fo){let i=Au.get(n);i||Au.set(n,i=new Map);let s=i.get(e);s||i.set(e,s=oC(()=>i.delete(e))),iC(fo,s)}}function Gi(n,t,e,i,s,o){const r=Au.get(n);if(!r)return;let a=[];if(t==="clear")a=[...r.values()];else if(e==="length"&&Y(n)){const l=Number(i);r.forEach((c,u)=>{(u==="length"||!xi(u)&&u>=l)&&a.push(c)})}else switch(e!==void 0&&a.push(r.get(e)),t){case"add":Y(n)?xg(e)&&a.push(r.get("length")):(a.push(r.get(mo)),kr(n)&&a.push(r.get(Jf)));break;case"delete":Y(n)||(a.push(r.get(mo)),kr(n)&&a.push(r.get(Jf)));break;case"set":kr(n)&&a.push(r.get(mo));break}Pg();for(const l of a)l&&sC(l,4);Rg()}function p3(n,t){const e=Au.get(n);return e&&e.get(t)}const b3=Sd("__proto__,__v_isRef,__isVue"),rC=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(xi)),Ew=w3();function w3(){const n={};return["includes","indexOf","lastIndexOf"].forEach(t=>{n[t]=function(...e){const i=Ae(this);for(let o=0,r=this.length;o<r;o++)wn(i,"get",o+"");const s=i[t](...e);return s===-1||s===!1?i[t](...e.map(Ae)):s}}),["push","pop","shift","unshift","splice"].forEach(t=>{n[t]=function(...e){Ws(),Pg();const i=Ae(this)[t].apply(this,e);return Rg(),qs(),i}}),n}function _3(n){xi(n)||(n=String(n));const t=Ae(this);return wn(t,"has",n),t.hasOwnProperty(n)}class aC{constructor(t=!1,e=!1){this._isReadonly=t,this._isShallow=e}get(t,e,i){const s=this._isReadonly,o=this._isShallow;if(e==="__v_isReactive")return!s;if(e==="__v_isReadonly")return s;if(e==="__v_isShallow")return o;if(e==="__v_raw")return i===(s?o?fC:hC:o?dC:uC).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(i)?t:void 0;const r=Y(t);if(!s){if(r&&Se(Ew,e))return Reflect.get(Ew,e,i);if(e==="hasOwnProperty")return _3}const a=Reflect.get(t,e,i);return(xi(e)?rC.has(e):b3(e))||(s||wn(t,"get",e),o)?a:Nt(a)?r&&xg(e)?a:a.value:Ue(a)?s?Vg(a):Vd(a):a}}class lC extends aC{constructor(t=!1){super(!1,t)}set(t,e,i,s){let o=t[e];if(!this._isShallow){const l=Rs(o);if(!ko(i)&&!Rs(i)&&(o=Ae(o),i=Ae(i)),!Y(t)&&Nt(o)&&!Nt(i))return l?!1:(o.value=i,!0)}const r=Y(t)&&xg(e)?Number(e)<t.length:Se(t,e),a=Reflect.set(t,e,i,s);return t===Ae(s)&&(r?Jt(i,o)&&Gi(t,"set",e,i):Gi(t,"add",e,i)),a}deleteProperty(t,e){const i=Se(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&i&&Gi(t,"delete",e,void 0),s}has(t,e){const i=Reflect.has(t,e);return(!xi(e)||!rC.has(e))&&wn(t,"has",e),i}ownKeys(t){return wn(t,"iterate",Y(t)?"length":mo),Reflect.ownKeys(t)}}class cC extends aC{constructor(t=!1){super(!0,t)}set(t,e){return!0}deleteProperty(t,e){return!0}}const v3=new lC,y3=new cC,C3=new lC(!0),k3=new cC(!0),Lg=n=>n,Rd=n=>Reflect.getPrototypeOf(n);function _c(n,t,e=!1,i=!1){n=n.__v_raw;const s=Ae(n),o=Ae(t);e||(Jt(t,o)&&wn(s,"get",t),wn(s,"get",o));const{has:r}=Rd(s),a=i?Lg:e?Mg:al;if(r.call(s,t))return a(n.get(t));if(r.call(s,o))return a(n.get(o));n!==s&&n.get(t)}function vc(n,t=!1){const e=this.__v_raw,i=Ae(e),s=Ae(n);return t||(Jt(n,s)&&wn(i,"has",n),wn(i,"has",s)),n===s?e.has(n):e.has(n)||e.has(s)}function yc(n,t=!1){return n=n.__v_raw,!t&&wn(Ae(n),"iterate",mo),Reflect.get(n,"size",n)}function Aw(n,t=!1){!t&&!ko(n)&&!Rs(n)&&(n=Ae(n));const e=Ae(this);return Rd(e).has.call(e,n)||(e.add(n),Gi(e,"add",n,n)),this}function xw(n,t,e=!1){!e&&!ko(t)&&!Rs(t)&&(t=Ae(t));const i=Ae(this),{has:s,get:o}=Rd(i);let r=s.call(i,n);r||(n=Ae(n),r=s.call(i,n));const a=o.call(i,n);return i.set(n,t),r?Jt(t,a)&&Gi(i,"set",n,t):Gi(i,"add",n,t),this}function Sw(n){const t=Ae(this),{has:e,get:i}=Rd(t);let s=e.call(t,n);s||(n=Ae(n),s=e.call(t,n)),i&&i.call(t,n);const o=t.delete(n);return s&&Gi(t,"delete",n,void 0),o}function Iw(){const n=Ae(this),t=n.size!==0,e=n.clear();return t&&Gi(n,"clear",void 0,void 0),e}function Cc(n,t){return function(i,s){const o=this,r=o.__v_raw,a=Ae(r),l=t?Lg:n?Mg:al;return!n&&wn(a,"iterate",mo),r.forEach((c,u)=>i.call(s,l(c),l(u),o))}}function kc(n,t,e){return function(...i){const s=this.__v_raw,o=Ae(s),r=kr(o),a=n==="entries"||n===Symbol.iterator&&r,l=n==="keys"&&r,c=s[n](...i),u=e?Lg:t?Mg:al;return!t&&wn(o,"iterate",l?Jf:mo),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:a?[u(d[0]),u(d[1])]:u(d),done:f}},[Symbol.iterator](){return this}}}}function ps(n){return function(...t){return n==="delete"?!1:n==="clear"?void 0:this}}function T3(){const n={get(o){return _c(this,o)},get size(){return yc(this)},has:vc,add:Aw,set:xw,delete:Sw,clear:Iw,forEach:Cc(!1,!1)},t={get(o){return _c(this,o,!1,!0)},get size(){return yc(this)},has:vc,add(o){return Aw.call(this,o,!0)},set(o,r){return xw.call(this,o,r,!0)},delete:Sw,clear:Iw,forEach:Cc(!1,!0)},e={get(o){return _c(this,o,!0)},get size(){return yc(this,!0)},has(o){return vc.call(this,o,!0)},add:ps("add"),set:ps("set"),delete:ps("delete"),clear:ps("clear"),forEach:Cc(!0,!1)},i={get(o){return _c(this,o,!0,!0)},get size(){return yc(this,!0)},has(o){return vc.call(this,o,!0)},add:ps("add"),set:ps("set"),delete:ps("delete"),clear:ps("clear"),forEach:Cc(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(o=>{n[o]=kc(o,!1,!1),e[o]=kc(o,!0,!1),t[o]=kc(o,!1,!0),i[o]=kc(o,!0,!0)}),[n,e,t,i]}const[E3,A3,x3,S3]=T3();function Ld(n,t){const e=t?n?S3:x3:n?A3:E3;return(i,s,o)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?i:Reflect.get(Se(e,s)&&s in i?e:i,s,o)}const I3={get:Ld(!1,!1)},P3={get:Ld(!1,!0)},R3={get:Ld(!0,!1)},L3={get:Ld(!0,!0)},uC=new WeakMap,dC=new WeakMap,hC=new WeakMap,fC=new WeakMap;function V3(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function B3(n){return n.__v_skip||!Object.isExtensible(n)?0:V3(XR(n))}function Vd(n){return Rs(n)?n:Bd(n,!1,v3,I3,uC)}function mC(n){return Bd(n,!1,C3,P3,dC)}function Vg(n){return Bd(n,!0,y3,R3,hC)}function M3(n){return Bd(n,!0,k3,L3,fC)}function Bd(n,t,e,i,s){if(!Ue(n)||n.__v_raw&&!(t&&n.__v_isReactive))return n;const o=s.get(n);if(o)return o;const r=B3(n);if(r===0)return n;const a=new Proxy(n,r===2?i:e);return s.set(n,a),a}function go(n){return Rs(n)?go(n.__v_raw):!!(n&&n.__v_isReactive)}function Rs(n){return!!(n&&n.__v_isReadonly)}function ko(n){return!!(n&&n.__v_isShallow)}function Bg(n){return n?!!n.__v_raw:!1}function Ae(n){const t=n&&n.__v_raw;return t?Ae(t):n}function gC(n){return Object.isExtensible(n)&&Ky(n,"__v_skip",!0),n}const al=n=>Ue(n)?Vd(n):n,Mg=n=>Ue(n)?Vg(n):n;class pC{constructor(t,e,i,s){this.getter=t,this._setter=e,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new Vr(()=>t(this._value),()=>Ar(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=i}get value(){const t=Ae(this);return(!t._cacheable||t.effect.dirty)&&Jt(t._value,t._value=t.effect.run())&&Ar(t,4),Og(t),t.effect._dirtyLevel>=2&&Ar(t,2),t._value}set value(t){this._setter(t)}get _dirty(){return this.effect.dirty}set _dirty(t){this.effect.dirty=t}}function O3(n,t,e=!1){let i,s;const o=ce(n);return o?(i=n,s=dn):(i=n.get,s=n.set),new pC(i,s,o||!s,e)}function Og(n){var t;xs&&fo&&(n=Ae(n),iC(fo,(t=n.dep)!=null?t:n.dep=oC(()=>n.dep=void 0,n instanceof pC?n:void 0)))}function Ar(n,t=4,e,i){n=Ae(n);const s=n.dep;s&&sC(s,t)}function Nt(n){return!!(n&&n.__v_isRef===!0)}function Na(n){return bC(n,!1)}function N3(n){return bC(n,!0)}function bC(n,t){return Nt(n)?n:new F3(n,t)}class F3{constructor(t,e){this.__v_isShallow=e,this.dep=void 0,this.__v_isRef=!0,this._rawValue=e?t:Ae(t),this._value=e?t:al(t)}get value(){return Og(this),this._value}set value(t){const e=this.__v_isShallow||ko(t)||Rs(t);t=e?t:Ae(t),Jt(t,this._rawValue)&&(this._rawValue,this._rawValue=t,this._value=e?t:al(t),Ar(this,4))}}function D3(n){Ar(n,4)}function Ng(n){return Nt(n)?n.value:n}function $3(n){return ce(n)?n():Ng(n)}const H3={get:(n,t,e)=>Ng(Reflect.get(n,t,e)),set:(n,t,e,i)=>{const s=n[t];return Nt(s)&&!Nt(e)?(s.value=e,!0):Reflect.set(n,t,e,i)}};function Fg(n){return go(n)?n:new Proxy(n,H3)}class z3{constructor(t){this.dep=void 0,this.__v_isRef=!0;const{get:e,set:i}=t(()=>Og(this),()=>Ar(this));this._get=e,this._set=i}get value(){return this._get()}set value(t){this._set(t)}}function wC(n){return new z3(n)}function U3(n){const t=Y(n)?new Array(n.length):{};for(const e in n)t[e]=_C(n,e);return t}class W3{constructor(t,e,i){this._object=t,this._key=e,this._defaultValue=i,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return p3(Ae(this._object),this._key)}}class q3{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function j3(n,t,e){return Nt(n)?n:ce(n)?new q3(n):Ue(n)&&arguments.length>1?_C(n,t,e):Na(n)}function _C(n,t,e){const i=n[t];return Nt(i)?i:new W3(n,t,e)}const G3={GET:"get",HAS:"has",ITERATE:"iterate"},K3={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"};/**
* @vue/runtime-core v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Z3(n,t){}const J3={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",WATCH_GETTER:2,2:"WATCH_GETTER",WATCH_CALLBACK:3,3:"WATCH_CALLBACK",WATCH_CLEANUP:4,4:"WATCH_CLEANUP",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE"},Y3={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update"};function Ki(n,t,e,i){try{return i?n(...i):n()}catch(s){Bo(s,t,e)}}function Vn(n,t,e,i){if(ce(n)){const s=Ki(n,t,e,i);return s&&Ag(s)&&s.catch(o=>{Bo(o,t,e)}),s}if(Y(n)){const s=[];for(let o=0;o<n.length;o++)s.push(Vn(n[o],t,e,i));return s}}function Bo(n,t,e,i=!0){const s=t?t.vnode:null;if(t){let o=t.parent;const r=t.proxy,a=`https://vuejs.org/error-reference/#runtime-${e}`;for(;o;){const c=o.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](n,r,a)===!1)return}o=o.parent}const l=t.appContext.config.errorHandler;if(l){Ws(),Ki(l,null,10,[n,r,a]),qs();return}}X3(n,e,s,i)}function X3(n,t,e,i=!0){console.error(n)}let ll=!1,Yf=!1;const zt=[];let ki=0;const xr=[];let Cs=null,co=0;const vC=Promise.resolve();let Dg=null;function Md(n){const t=Dg||vC;return n?t.then(this?n.bind(this):n):t}function Q3(n){let t=ki+1,e=zt.length;for(;t<e;){const i=t+e>>>1,s=zt[i],o=cl(s);o<n||o===n&&s.pre?t=i+1:e=i}return t}function Od(n){(!zt.length||!zt.includes(n,ll&&n.allowRecurse?ki+1:ki))&&(n.id==null?zt.push(n):zt.splice(Q3(n.id),0,n),yC())}function yC(){!ll&&!Yf&&(Yf=!0,Dg=vC.then(CC))}function eL(n){const t=zt.indexOf(n);t>ki&&zt.splice(t,1)}function xu(n){Y(n)?xr.push(...n):(!Cs||!Cs.includes(n,n.allowRecurse?co+1:co))&&xr.push(n),yC()}function Pw(n,t,e=ll?ki+1:0){for(;e<zt.length;e++){const i=zt[e];if(i&&i.pre){if(n&&i.id!==n.uid)continue;zt.splice(e,1),e--,i()}}}function Su(n){if(xr.length){const t=[...new Set(xr)].sort((e,i)=>cl(e)-cl(i));if(xr.length=0,Cs){Cs.push(...t);return}for(Cs=t,co=0;co<Cs.length;co++){const e=Cs[co];e.active!==!1&&e()}Cs=null,co=0}}const cl=n=>n.id==null?1/0:n.id,tL=(n,t)=>{const e=cl(n)-cl(t);if(e===0){if(n.pre&&!t.pre)return-1;if(t.pre&&!n.pre)return 1}return e};function CC(n){Yf=!1,ll=!0,zt.sort(tL);try{for(ki=0;ki<zt.length;ki++){const t=zt[ki];t&&t.active!==!1&&Ki(t,t.i,t.i?15:14)}}finally{ki=0,zt.length=0,Su(),ll=!1,Dg=null,(zt.length||xr.length)&&CC()}}let cr,Tc=[];function kC(n,t){var e,i;cr=n,cr?(cr.enabled=!0,Tc.forEach(({event:s,args:o})=>cr.emit(s,...o)),Tc=[]):typeof window<"u"&&window.HTMLElement&&!((i=(e=window.navigator)==null?void 0:e.userAgent)!=null&&i.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(o=>{kC(o,t)}),setTimeout(()=>{cr||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,Tc=[])},3e3)):Tc=[]}let yt=null,Nd=null;function ul(n){const t=yt;return yt=n,Nd=n&&n.type.__scopeId||null,t}function nL(n){Nd=n}function iL(){Nd=null}const sL=n=>$g;function $g(n,t=yt,e){if(!t||n._n)return n;const i=(...s)=>{i._d&&rm(-1);const o=ul(t);let r;try{r=n(...s)}finally{ul(o),i._d&&rm(1)}return r};return i._n=!0,i._c=!0,i._d=!0,i}function oL(n,t){if(yt===null)return n;const e=jl(yt),i=n.dirs||(n.dirs=[]);for(let s=0;s<t.length;s++){let[o,r,a,l=Le]=t[s];o&&(ce(o)&&(o={mounted:o,updated:o}),o.deep&&Es(r),i.push({dir:o,instance:e,value:r,oldValue:void 0,arg:a,modifiers:l}))}return n}function yi(n,t,e,i){const s=n.dirs,o=t&&t.dirs;for(let r=0;r<s.length;r++){const a=s[r];o&&(a.oldValue=o[r].value);let l=a.dir[i];l&&(Ws(),Vn(l,e,8,[n.el,a,n,t]),qs())}}const ks=Symbol("_leaveCb"),Ec=Symbol("_enterCb");function Hg(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Ul(()=>{n.isMounted=!0}),Hd(()=>{n.isUnmounting=!0}),n}const Un=[Function,Array],zg={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Un,onEnter:Un,onAfterEnter:Un,onEnterCancelled:Un,onBeforeLeave:Un,onLeave:Un,onAfterLeave:Un,onLeaveCancelled:Un,onBeforeAppear:Un,onAppear:Un,onAfterAppear:Un,onAppearCancelled:Un},TC=n=>{const t=n.subTree;return t.component?TC(t.component):t},rL={name:"BaseTransition",props:zg,setup(n,{slots:t}){const e=rs(),i=Hg();return()=>{const s=t.default&&Fd(t.default(),!0);if(!s||!s.length)return;let o=s[0];if(s.length>1){for(const f of s)if(f.type!==Pt){o=f;break}}const r=Ae(n),{mode:a}=r;if(i.isLeaving)return Gh(o);const l=Rw(o);if(!l)return Gh(o);let c=Br(l,r,i,e,f=>c=f);Ls(l,c);const u=e.subTree,d=u&&Rw(u);if(d&&d.type!==Pt&&!ri(l,d)&&TC(e).type!==Pt){const f=Br(d,r,i,e);if(Ls(d,f),a==="out-in"&&l.type!==Pt)return i.isLeaving=!0,f.afterLeave=()=>{i.isLeaving=!1,e.update.active!==!1&&(e.effect.dirty=!0,e.update())},Gh(o);a==="in-out"&&l.type!==Pt&&(f.delayLeave=(m,g,p)=>{const w=AC(i,d);w[String(d.key)]=d,m[ks]=()=>{g(),m[ks]=void 0,delete c.delayedLeave},c.delayedLeave=p})}return o}}},EC=rL;function AC(n,t){const{leavingVNodes:e}=n;let i=e.get(t.type);return i||(i=Object.create(null),e.set(t.type,i)),i}function Br(n,t,e,i,s){const{appear:o,mode:r,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:d,onBeforeLeave:f,onLeave:m,onAfterLeave:g,onLeaveCancelled:p,onBeforeAppear:w,onAppear:v,onAfterAppear:_,onAppearCancelled:y}=t,E=String(n.key),x=AC(e,n),S=(P,B)=>{P&&Vn(P,i,9,B)},R=(P,B)=>{const J=B[1];S(P,B),Y(P)?P.every(H=>H.length<=1)&&J():P.length<=1&&J()},V={mode:r,persisted:a,beforeEnter(P){let B=l;if(!e.isMounted)if(o)B=w||l;else return;P[ks]&&P[ks](!0);const J=x[E];J&&ri(n,J)&&J.el[ks]&&J.el[ks](),S(B,[P])},enter(P){let B=c,J=u,H=d;if(!e.isMounted)if(o)B=v||c,J=_||u,H=y||d;else return;let le=!1;const Re=P[Ec]=$e=>{le||(le=!0,$e?S(H,[P]):S(J,[P]),V.delayedLeave&&V.delayedLeave(),P[Ec]=void 0)};B?R(B,[P,Re]):Re()},leave(P,B){const J=String(n.key);if(P[Ec]&&P[Ec](!0),e.isUnmounting)return B();S(f,[P]);let H=!1;const le=P[ks]=Re=>{H||(H=!0,B(),Re?S(p,[P]):S(g,[P]),P[ks]=void 0,x[J]===n&&delete x[J])};x[J]=n,m?R(m,[P,le]):le()},clone(P){const B=Br(P,t,e,i,s);return s&&s(B),B}};return V}function Gh(n){if(zl(n))return n=Si(n),n.children=null,n}function Rw(n){if(!zl(n))return n;const{shapeFlag:t,children:e}=n;if(e){if(t&16)return e[0];if(t&32&&ce(e.default))return e.default()}}function Ls(n,t){n.shapeFlag&6&&n.component?Ls(n.component.subTree,t):n.shapeFlag&128?(n.ssContent.transition=t.clone(n.ssContent),n.ssFallback.transition=t.clone(n.ssFallback)):n.transition=t}function Fd(n,t=!1,e){let i=[],s=0;for(let o=0;o<n.length;o++){let r=n[o];const a=e==null?r.key:String(e)+String(r.key!=null?r.key:o);r.type===It?(r.patchFlag&128&&s++,i=i.concat(Fd(r.children,t,a))):(t||r.type!==Pt)&&i.push(a!=null?Si(r,{key:a}):r)}if(s>1)for(let o=0;o<i.length;o++)i[o].patchFlag=-2;return i}/*! #__NO_SIDE_EFFECTS__ */function Ug(n,t){return ce(n)?ot({name:n.name},t,{setup:n}):n}const po=n=>!!n.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function aL(n){ce(n)&&(n={loader:n});const{loader:t,loadingComponent:e,errorComponent:i,delay:s=200,timeout:o,suspensible:r=!0,onError:a}=n;let l=null,c,u=0;const d=()=>(u++,l=null,f()),f=()=>{let m;return l||(m=l=t().catch(g=>{if(g=g instanceof Error?g:new Error(String(g)),a)return new Promise((p,w)=>{a(g,()=>p(d()),()=>w(g),u+1)});throw g}).then(g=>m!==l&&l?l:(g&&(g.__esModule||g[Symbol.toStringTag]==="Module")&&(g=g.default),c=g,g)))};return Ug({name:"AsyncComponentWrapper",__asyncLoader:f,get __asyncResolved(){return c},setup(){const m=vt;if(c)return()=>Kh(c,m);const g=_=>{l=null,Bo(_,m,13,!i)};if(r&&m.suspense||ql)return f().then(_=>()=>Kh(_,m)).catch(_=>(g(_),()=>i?qe(i,{error:_}):null));const p=Na(!1),w=Na(),v=Na(!!s);return s&&setTimeout(()=>{v.value=!1},s),o!=null&&setTimeout(()=>{if(!p.value&&!w.value){const _=new Error(`Async component timed out after ${o}ms.`);g(_),w.value=_}},o),f().then(()=>{p.value=!0,m.parent&&zl(m.parent.vnode)&&(m.parent.effect.dirty=!0,Od(m.parent.update))}).catch(_=>{g(_),w.value=_}),()=>{if(p.value&&c)return Kh(c,m);if(w.value&&i)return qe(i,{error:w.value});if(e&&!v.value)return qe(e)}}})}function Kh(n,t){const{ref:e,props:i,children:s,ce:o}=t.vnode,r=qe(n,i,s);return r.ref=e,r.ce=o,delete t.vnode.ce,r}const zl=n=>n.type.__isKeepAlive,lL={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(n,{slots:t}){const e=rs(),i=e.ctx;if(!i.renderer)return()=>{const _=t.default&&t.default();return _&&_.length===1?_[0]:_};const s=new Map,o=new Set;let r=null;const a=e.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:d}}}=i,f=d("div");i.activate=(_,y,E,x,S)=>{const R=_.component;c(_,y,E,0,a),l(R.vnode,_,y,E,R,a,x,_.slotScopeIds,S),Et(()=>{R.isDeactivated=!1,R.a&&Er(R.a);const V=_.props&&_.props.onVnodeMounted;V&&an(V,R.parent,_)},a)},i.deactivate=_=>{const y=_.component;Lu(y.m),Lu(y.a),c(_,f,null,1,a),Et(()=>{y.da&&Er(y.da);const E=_.props&&_.props.onVnodeUnmounted;E&&an(E,y.parent,_),y.isDeactivated=!0},a)};function m(_){Zh(_),u(_,e,a,!0)}function g(_){s.forEach((y,E)=>{const x=dm(y.type);x&&(!_||!_(x))&&p(E)})}function p(_){const y=s.get(_);!r||!ri(y,r)?m(y):r&&Zh(r),s.delete(_),o.delete(_)}Ha(()=>[n.include,n.exclude],([_,y])=>{_&&g(E=>Ia(_,E)),y&&g(E=>!Ia(y,E))},{flush:"post",deep:!0});let w=null;const v=()=>{w!=null&&(sm(e.subTree.type)?Et(()=>{s.set(w,Ac(e.subTree))},e.subTree.suspense):s.set(w,Ac(e.subTree)))};return Ul(v),$d(v),Hd(()=>{s.forEach(_=>{const{subTree:y,suspense:E}=e,x=Ac(y);if(_.type===x.type&&_.key===x.key){Zh(x);const S=x.component.da;S&&Et(S,E);return}m(_)})}),()=>{if(w=null,!t.default)return null;const _=t.default(),y=_[0];if(_.length>1)return r=null,_;if(!Bs(y)||!(y.shapeFlag&4)&&!(y.shapeFlag&128))return r=null,y;let E=Ac(y);const x=E.type,S=dm(po(E)?E.type.__asyncResolved||{}:x),{include:R,exclude:V,max:P}=n;if(R&&(!S||!Ia(R,S))||V&&S&&Ia(V,S))return r=E,y;const B=E.key==null?x:E.key,J=s.get(B);return E.el&&(E=Si(E),y.shapeFlag&128&&(y.ssContent=E)),w=B,J?(E.el=J.el,E.component=J.component,E.transition&&Ls(E,E.transition),E.shapeFlag|=512,o.delete(B),o.add(B)):(o.add(B),P&&o.size>parseInt(P,10)&&p(o.values().next().value)),E.shapeFlag|=256,r=E,sm(y.type)?y:E}}},cL=lL;function Ia(n,t){return Y(n)?n.some(e=>Ia(e,t)):st(n)?n.split(",").includes(t):YR(n)?n.test(t):!1}function xC(n,t){IC(n,"a",t)}function SC(n,t){IC(n,"da",t)}function IC(n,t,e=vt){const i=n.__wdc||(n.__wdc=()=>{let s=e;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(Dd(t,i,e),e){let s=e.parent;for(;s&&s.parent;)zl(s.parent.vnode)&&uL(i,t,e,s),s=s.parent}}function uL(n,t,e,i){const s=Dd(t,n,i,!0);zd(()=>{Eg(i[t],s)},e)}function Zh(n){n.shapeFlag&=-257,n.shapeFlag&=-513}function Ac(n){return n.shapeFlag&128?n.ssContent:n}function Dd(n,t,e=vt,i=!1){if(e){const s=e[n]||(e[n]=[]),o=t.__weh||(t.__weh=(...r)=>{Ws();const a=Eo(e),l=Vn(t,e,n,r);return a(),qs(),l});return i?s.unshift(o):s.push(o),o}}const os=n=>(t,e=vt)=>{(!ql||n==="sp")&&Dd(n,(...i)=>t(...i),e)},PC=os("bm"),Ul=os("m"),RC=os("bu"),$d=os("u"),Hd=os("bum"),zd=os("um"),LC=os("sp"),VC=os("rtg"),BC=os("rtc");function MC(n,t=vt){Dd("ec",n,t)}const Wg="components",dL="directives";function Iu(n,t){return qg(Wg,n,!0,t)||n}const OC=Symbol.for("v-ndc");function hL(n){return st(n)?qg(Wg,n,!1)||n:n||OC}function fL(n){return qg(dL,n)}function qg(n,t,e=!0,i=!1){const s=yt||vt;if(s){const o=s.type;if(n===Wg){const a=dm(o,!1);if(a&&(a===t||a===Wt(t)||a===Dl(Wt(t))))return o}const r=Lw(s[n]||o[n],t)||Lw(s.appContext[n],t);return!r&&i?o:r}}function Lw(n,t){return n&&(n[t]||n[Wt(t)]||n[Dl(Wt(t))])}function mL(n,t,e,i){let s;const o=e&&e[i];if(Y(n)||st(n)){s=new Array(n.length);for(let r=0,a=n.length;r<a;r++)s[r]=t(n[r],r,void 0,o&&o[r])}else if(typeof n=="number"){s=new Array(n);for(let r=0;r<n;r++)s[r]=t(r+1,r,void 0,o&&o[r])}else if(Ue(n))if(n[Symbol.iterator])s=Array.from(n,(r,a)=>t(r,a,void 0,o&&o[a]));else{const r=Object.keys(n);s=new Array(r.length);for(let a=0,l=r.length;a<l;a++){const c=r[a];s[a]=t(n[c],c,a,o&&o[a])}}else s=[];return e&&(e[i]=s),s}function gL(n,t){for(let e=0;e<t.length;e++){const i=t[e];if(Y(i))for(let s=0;s<i.length;s++)n[i[s].name]=i[s].fn;else i&&(n[i.name]=i.key?(...s)=>{const o=i.fn(...s);return o&&(o.key=i.key),o}:i.fn)}return n}function pL(n,t,e={},i,s){if(yt.isCE||yt.parent&&po(yt.parent)&&yt.parent.isCE)return t!=="default"&&(e.name=t),qe("slot",e,i&&i());let o=n[t];o&&o._c&&(o._d=!1),Vs();const r=o&&NC(o(e)),a=qd(It,{key:(e.key||r&&r.key||`_${t}`)+(!r&&i?"_fb":"")},r||(i?i():[]),r&&n._===1?64:-2);return!s&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),o&&o._c&&(o._d=!0),a}function NC(n){return n.some(t=>Bs(t)?!(t.type===Pt||t.type===It&&!NC(t.children)):!0)?n:null}function bL(n,t){const e={};for(const i in n)e[t&&/[A-Z]/.test(i)?`on:${i}`:Oa(i)]=n[i];return e}const Xf=n=>n?yk(n)?jl(n):Xf(n.parent):null,Fa=ot(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>Xf(n.parent),$root:n=>Xf(n.root),$emit:n=>n.emit,$options:n=>jg(n),$forceUpdate:n=>n.f||(n.f=()=>{n.effect.dirty=!0,Od(n.update)}),$nextTick:n=>n.n||(n.n=Md.bind(n.proxy)),$watch:n=>t4.bind(n)}),Jh=(n,t)=>n!==Le&&!n.__isScriptSetup&&Se(n,t),Qf={get({_:n},t){if(t==="__v_skip")return!0;const{ctx:e,setupState:i,data:s,props:o,accessCache:r,type:a,appContext:l}=n;let c;if(t[0]!=="$"){const m=r[t];if(m!==void 0)switch(m){case 1:return i[t];case 2:return s[t];case 4:return e[t];case 3:return o[t]}else{if(Jh(i,t))return r[t]=1,i[t];if(s!==Le&&Se(s,t))return r[t]=2,s[t];if((c=n.propsOptions[0])&&Se(c,t))return r[t]=3,o[t];if(e!==Le&&Se(e,t))return r[t]=4,e[t];em&&(r[t]=0)}}const u=Fa[t];let d,f;if(u)return t==="$attrs"&&wn(n.attrs,"get",""),u(n);if((d=a.__cssModules)&&(d=d[t]))return d;if(e!==Le&&Se(e,t))return r[t]=4,e[t];if(f=l.config.globalProperties,Se(f,t))return f[t]},set({_:n},t,e){const{data:i,setupState:s,ctx:o}=n;return Jh(s,t)?(s[t]=e,!0):i!==Le&&Se(i,t)?(i[t]=e,!0):Se(n.props,t)||t[0]==="$"&&t.slice(1)in n?!1:(o[t]=e,!0)},has({_:{data:n,setupState:t,accessCache:e,ctx:i,appContext:s,propsOptions:o}},r){let a;return!!e[r]||n!==Le&&Se(n,r)||Jh(t,r)||(a=o[0])&&Se(a,r)||Se(i,r)||Se(Fa,r)||Se(s.config.globalProperties,r)},defineProperty(n,t,e){return e.get!=null?n._.accessCache[t]=0:Se(e,"value")&&this.set(n,t,e.value,null),Reflect.defineProperty(n,t,e)}},wL=ot({},Qf,{get(n,t){if(t!==Symbol.unscopables)return Qf.get(n,t,n)},has(n,t){return t[0]!=="_"&&!n3(t)}});function _L(){return null}function vL(){return null}function yL(n){}function CL(n){}function kL(){return null}function TL(){}function EL(n,t){return null}function AL(){return FC().slots}function xL(){return FC().attrs}function FC(){const n=rs();return n.setupContext||(n.setupContext=Tk(n))}function dl(n){return Y(n)?n.reduce((t,e)=>(t[e]=null,t),{}):n}function SL(n,t){const e=dl(n);for(const i in t){if(i.startsWith("__skip"))continue;let s=e[i];s?Y(s)||ce(s)?s=e[i]={type:s,default:t[i]}:s.default=t[i]:s===null&&(s=e[i]={default:t[i]}),s&&t[`__skip_${i}`]&&(s.skipFactory=!0)}return e}function IL(n,t){return!n||!t?n||t:Y(n)&&Y(t)?n.concat(t):ot({},dl(n),dl(t))}function PL(n,t){const e={};for(const i in n)t.includes(i)||Object.defineProperty(e,i,{enumerable:!0,get:()=>n[i]});return e}function RL(n){const t=rs();let e=n();return lm(),Ag(e)&&(e=e.catch(i=>{throw Eo(t),i})),[e,()=>Eo(t)]}let em=!0;function LL(n){const t=jg(n),e=n.proxy,i=n.ctx;em=!1,t.beforeCreate&&Vw(t.beforeCreate,n,"bc");const{data:s,computed:o,methods:r,watch:a,provide:l,inject:c,created:u,beforeMount:d,mounted:f,beforeUpdate:m,updated:g,activated:p,deactivated:w,beforeDestroy:v,beforeUnmount:_,destroyed:y,unmounted:E,render:x,renderTracked:S,renderTriggered:R,errorCaptured:V,serverPrefetch:P,expose:B,inheritAttrs:J,components:H,directives:le,filters:Re}=t;if(c&&VL(c,i,null),r)for(const ye in r){const se=r[ye];ce(se)&&(i[ye]=se.bind(e))}if(s){const ye=s.call(e,e);Ue(ye)&&(n.data=Vd(ye))}if(em=!0,o)for(const ye in o){const se=o[ye],Ni=ce(se)?se.bind(e,e):ce(se.get)?se.get.bind(e,e):dn,bc=!ce(se)&&ce(se.set)?se.set.bind(e):dn,Qs=Ek({get:Ni,set:bc});Object.defineProperty(i,ye,{enumerable:!0,configurable:!0,get:()=>Qs.value,set:pi=>Qs.value=pi})}if(a)for(const ye in a)DC(a[ye],i,e,ye);if(l){const ye=ce(l)?l.call(e):l;Reflect.ownKeys(ye).forEach(se=>{HC(se,ye[se])})}u&&Vw(u,n,"c");function ee(ye,se){Y(se)?se.forEach(Ni=>ye(Ni.bind(e))):se&&ye(se.bind(e))}if(ee(PC,d),ee(Ul,f),ee(RC,m),ee($d,g),ee(xC,p),ee(SC,w),ee(MC,V),ee(BC,S),ee(VC,R),ee(Hd,_),ee(zd,E),ee(LC,P),Y(B))if(B.length){const ye=n.exposed||(n.exposed={});B.forEach(se=>{Object.defineProperty(ye,se,{get:()=>e[se],set:Ni=>e[se]=Ni})})}else n.exposed||(n.exposed={});x&&n.render===dn&&(n.render=x),J!=null&&(n.inheritAttrs=J),H&&(n.components=H),le&&(n.directives=le)}function VL(n,t,e=dn){Y(n)&&(n=tm(n));for(const i in n){const s=n[i];let o;Ue(s)?"default"in s?o=Da(s.from||i,s.default,!0):o=Da(s.from||i):o=Da(s),Nt(o)?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:r=>o.value=r}):t[i]=o}}function Vw(n,t,e){Vn(Y(n)?n.map(i=>i.bind(t.proxy)):n.bind(t.proxy),t,e)}function DC(n,t,e,i){const s=i.includes(".")?ck(e,i):()=>e[i];if(st(n)){const o=t[n];ce(o)&&Ha(s,o)}else if(ce(n))Ha(s,n.bind(e));else if(Ue(n))if(Y(n))n.forEach(o=>DC(o,t,e,i));else{const o=ce(n.handler)?n.handler.bind(e):t[n.handler];ce(o)&&Ha(s,o,n)}}function jg(n){const t=n.type,{mixins:e,extends:i}=t,{mixins:s,optionsCache:o,config:{optionMergeStrategies:r}}=n.appContext,a=o.get(t);let l;return a?l=a:!s.length&&!e&&!i?l=t:(l={},s.length&&s.forEach(c=>Pu(l,c,r,!0)),Pu(l,t,r)),Ue(t)&&o.set(t,l),l}function Pu(n,t,e,i=!1){const{mixins:s,extends:o}=t;o&&Pu(n,o,e,!0),s&&s.forEach(r=>Pu(n,r,e,!0));for(const r in t)if(!(i&&r==="expose")){const a=BL[r]||e&&e[r];n[r]=a?a(n[r],t[r]):t[r]}return n}const BL={data:Bw,props:Mw,emits:Mw,methods:Pa,computed:Pa,beforeCreate:Zt,created:Zt,beforeMount:Zt,mounted:Zt,beforeUpdate:Zt,updated:Zt,beforeDestroy:Zt,beforeUnmount:Zt,destroyed:Zt,unmounted:Zt,activated:Zt,deactivated:Zt,errorCaptured:Zt,serverPrefetch:Zt,components:Pa,directives:Pa,watch:OL,provide:Bw,inject:ML};function Bw(n,t){return t?n?function(){return ot(ce(n)?n.call(this,this):n,ce(t)?t.call(this,this):t)}:t:n}function ML(n,t){return Pa(tm(n),tm(t))}function tm(n){if(Y(n)){const t={};for(let e=0;e<n.length;e++)t[n[e]]=n[e];return t}return n}function Zt(n,t){return n?[...new Set([].concat(n,t))]:t}function Pa(n,t){return n?ot(Object.create(null),n,t):t}function Mw(n,t){return n?Y(n)&&Y(t)?[...new Set([...n,...t])]:ot(Object.create(null),dl(n),dl(t??{})):t}function OL(n,t){if(!n)return t;if(!t)return n;const e=ot(Object.create(null),n);for(const i in t)e[i]=Zt(n[i],t[i]);return e}function $C(){return{app:null,config:{isNativeTag:ZR,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let NL=0;function FL(n,t){return function(i,s=null){ce(i)||(i=ot({},i)),s!=null&&!Ue(s)&&(s=null);const o=$C(),r=new WeakSet;let a=!1;const l=o.app={_uid:NL++,_component:i,_props:s,_container:null,_context:o,_instance:null,version:Sk,get config(){return o.config},set config(c){},use(c,...u){return r.has(c)||(c&&ce(c.install)?(r.add(c),c.install(l,...u)):ce(c)&&(r.add(c),c(l,...u))),l},mixin(c){return o.mixins.includes(c)||o.mixins.push(c),l},component(c,u){return u?(o.components[c]=u,l):o.components[c]},directive(c,u){return u?(o.directives[c]=u,l):o.directives[c]},mount(c,u,d){if(!a){const f=qe(i,s);return f.appContext=o,d===!0?d="svg":d===!1&&(d=void 0),u&&t?t(f,c):n(f,c,d),a=!0,l._container=c,c.__vue_app__=l,jl(f.component)}},unmount(){a&&(n(null,l._container),delete l._container.__vue_app__)},provide(c,u){return o.provides[c]=u,l},runWithContext(c){const u=Sr;Sr=l;try{return c()}finally{Sr=u}}};return l}}let Sr=null;function HC(n,t){if(vt){let e=vt.provides;const i=vt.parent&&vt.parent.provides;i===e&&(e=vt.provides=Object.create(i)),e[n]=t}}function Da(n,t,e=!1){const i=vt||yt;if(i||Sr){const s=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:Sr._context.provides;if(s&&n in s)return s[n];if(arguments.length>1)return e&&ce(t)?t.call(i&&i.proxy):t}}function DL(){return!!(vt||yt||Sr)}const zC={},UC=()=>Object.create(zC),WC=n=>Object.getPrototypeOf(n)===zC;function $L(n,t,e,i=!1){const s={},o=UC();n.propsDefaults=Object.create(null),qC(n,t,s,o);for(const r in n.propsOptions[0])r in s||(s[r]=void 0);e?n.props=i?s:mC(s):n.type.props?n.props=s:n.props=o,n.attrs=o}function HL(n,t,e,i){const{props:s,attrs:o,vnode:{patchFlag:r}}=n,a=Ae(s),[l]=n.propsOptions;let c=!1;if((i||r>0)&&!(r&16)){if(r&8){const u=n.vnode.dynamicProps;for(let d=0;d<u.length;d++){let f=u[d];if(Ud(n.emitsOptions,f))continue;const m=t[f];if(l)if(Se(o,f))m!==o[f]&&(o[f]=m,c=!0);else{const g=Wt(f);s[g]=nm(l,a,g,m,n,!1)}else m!==o[f]&&(o[f]=m,c=!0)}}}else{qC(n,t,s,o)&&(c=!0);let u;for(const d in a)(!t||!Se(t,d)&&((u=un(d))===d||!Se(t,u)))&&(l?e&&(e[d]!==void 0||e[u]!==void 0)&&(s[d]=nm(l,a,d,void 0,n,!0)):delete s[d]);if(o!==a)for(const d in o)(!t||!Se(t,d))&&(delete o[d],c=!0)}c&&Gi(n.attrs,"set","")}function qC(n,t,e,i){const[s,o]=n.propsOptions;let r=!1,a;if(t)for(let l in t){if(Tr(l))continue;const c=t[l];let u;s&&Se(s,u=Wt(l))?!o||!o.includes(u)?e[u]=c:(a||(a={}))[u]=c:Ud(n.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,r=!0)}if(o){const l=Ae(e),c=a||Le;for(let u=0;u<o.length;u++){const d=o[u];e[d]=nm(s,l,d,c[d],n,!Se(c,d))}}return r}function nm(n,t,e,i,s,o){const r=n[e];if(r!=null){const a=Se(r,"default");if(a&&i===void 0){const l=r.default;if(r.type!==Function&&!r.skipFactory&&ce(l)){const{propsDefaults:c}=s;if(e in c)i=c[e];else{const u=Eo(s);i=c[e]=l.call(null,t),u()}}else i=l}r[0]&&(o&&!a?i=!1:r[1]&&(i===""||i===un(e))&&(i=!0))}return i}const zL=new WeakMap;function jC(n,t,e=!1){const i=e?zL:t.propsCache,s=i.get(n);if(s)return s;const o=n.props,r={},a=[];let l=!1;if(!ce(n)){const u=d=>{l=!0;const[f,m]=jC(d,t,!0);ot(r,f),m&&a.push(...m)};!e&&t.mixins.length&&t.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!o&&!l)return Ue(n)&&i.set(n,Cr),Cr;if(Y(o))for(let u=0;u<o.length;u++){const d=Wt(o[u]);Ow(d)&&(r[d]=Le)}else if(o)for(const u in o){const d=Wt(u);if(Ow(d)){const f=o[u],m=r[d]=Y(f)||ce(f)?{type:f}:ot({},f),g=m.type;let p=!1,w=!0;if(Y(g))for(let v=0;v<g.length;++v){const _=g[v],y=ce(_)&&_.name;if(y==="Boolean"){p=!0;break}else y==="String"&&(w=!1)}else p=ce(g)&&g.name==="Boolean";m[0]=p,m[1]=w,(p||Se(m,"default"))&&a.push(d)}}const c=[r,a];return Ue(n)&&i.set(n,c),c}function Ow(n){return n[0]!=="$"&&!Tr(n)}const GC=n=>n[0]==="_"||n==="$stable",Gg=n=>Y(n)?n.map(cn):[cn(n)],UL=(n,t,e)=>{if(t._n)return t;const i=$g((...s)=>Gg(t(...s)),e);return i._c=!1,i},KC=(n,t,e)=>{const i=n._ctx;for(const s in n){if(GC(s))continue;const o=n[s];if(ce(o))t[s]=UL(s,o,i);else if(o!=null){const r=Gg(o);t[s]=()=>r}}},ZC=(n,t)=>{const e=Gg(t);n.slots.default=()=>e},JC=(n,t,e)=>{for(const i in t)(e||i!=="_")&&(n[i]=t[i])},WL=(n,t,e)=>{const i=n.slots=UC();if(n.vnode.shapeFlag&32){const s=t._;s?(JC(i,t,e),e&&Ky(i,"_",s,!0)):KC(t,i)}else t&&ZC(n,t)},qL=(n,t,e)=>{const{vnode:i,slots:s}=n;let o=!0,r=Le;if(i.shapeFlag&32){const a=t._;a?e&&a===1?o=!1:JC(s,t,e):(o=!t.$stable,KC(t,s)),r=t}else t&&(ZC(n,t),r={default:1});if(o)for(const a in s)!GC(a)&&r[a]==null&&delete s[a]};function Ru(n,t,e,i,s=!1){if(Y(n)){n.forEach((f,m)=>Ru(f,t&&(Y(t)?t[m]:t),e,i,s));return}if(po(i)&&!s)return;const o=i.shapeFlag&4?jl(i.component):i.el,r=s?null:o,{i:a,r:l}=n,c=t&&t.r,u=a.refs===Le?a.refs={}:a.refs,d=a.setupState;if(c!=null&&c!==l&&(st(c)?(u[c]=null,Se(d,c)&&(d[c]=null)):Nt(c)&&(c.value=null)),ce(l))Ki(l,a,12,[r,u]);else{const f=st(l),m=Nt(l);if(f||m){const g=()=>{if(n.f){const p=f?Se(d,l)?d[l]:u[l]:l.value;s?Y(p)&&Eg(p,o):Y(p)?p.includes(o)||p.push(o):f?(u[l]=[o],Se(d,l)&&(d[l]=u[l])):(l.value=[o],n.k&&(u[n.k]=l.value))}else f?(u[l]=r,Se(d,l)&&(d[l]=r)):m&&(l.value=r,n.k&&(u[n.k]=r))};r?(g.id=-1,Et(g,e)):g()}}}const YC=Symbol("_vte"),jL=n=>n.__isTeleport,$a=n=>n&&(n.disabled||n.disabled===""),Nw=n=>typeof SVGElement<"u"&&n instanceof SVGElement,Fw=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,im=(n,t)=>{const e=n&&n.to;return st(e)?t?t(e):null:e},GL={name:"Teleport",__isTeleport:!0,process(n,t,e,i,s,o,r,a,l,c){const{mc:u,pc:d,pbc:f,o:{insert:m,querySelector:g,createText:p,createComment:w}}=c,v=$a(t.props);let{shapeFlag:_,children:y,dynamicChildren:E}=t;if(n==null){const x=t.el=p(""),S=t.anchor=p("");m(x,e,i),m(S,e,i);const R=t.target=im(t.props,g),V=QC(R,t,p,m);R&&(r==="svg"||Nw(R)?r="svg":(r==="mathml"||Fw(R))&&(r="mathml"));const P=(B,J)=>{_&16&&u(y,B,J,s,o,r,a,l)};v?P(e,S):R&&P(R,V)}else{t.el=n.el,t.targetStart=n.targetStart;const x=t.anchor=n.anchor,S=t.target=n.target,R=t.targetAnchor=n.targetAnchor,V=$a(n.props),P=V?e:S,B=V?x:R;if(r==="svg"||Nw(S)?r="svg":(r==="mathml"||Fw(S))&&(r="mathml"),E?(f(n.dynamicChildren,E,P,s,o,r,a),Kg(n,t,!0)):l||d(n,t,P,B,s,o,r,a,!1),v)V?t.props&&n.props&&t.props.to!==n.props.to&&(t.props.to=n.props.to):xc(t,e,x,c,1);else if((t.props&&t.props.to)!==(n.props&&n.props.to)){const J=t.target=im(t.props,g);J&&xc(t,J,null,c,0)}else V&&xc(t,S,R,c,1)}XC(t)},remove(n,t,e,{um:i,o:{remove:s}},o){const{shapeFlag:r,children:a,anchor:l,targetStart:c,targetAnchor:u,target:d,props:f}=n;if(d&&(s(c),s(u)),o&&s(l),r&16){const m=o||!$a(f);for(let g=0;g<a.length;g++){const p=a[g];i(p,t,e,m,!!p.dynamicChildren)}}},move:xc,hydrate:KL};function xc(n,t,e,{o:{insert:i},m:s},o=2){o===0&&i(n.targetAnchor,t,e);const{el:r,anchor:a,shapeFlag:l,children:c,props:u}=n,d=o===2;if(d&&i(r,t,e),(!d||$a(u))&&l&16)for(let f=0;f<c.length;f++)s(c[f],t,e,2);d&&i(a,t,e)}function KL(n,t,e,i,s,o,{o:{nextSibling:r,parentNode:a,querySelector:l,insert:c,createText:u}},d){const f=t.target=im(t.props,l);if(f){const m=f._lpa||f.firstChild;if(t.shapeFlag&16)if($a(t.props))t.anchor=d(r(n),t,a(n),e,i,s,o),t.targetStart=m,t.targetAnchor=m&&r(m);else{t.anchor=r(n);let g=m;for(;g;){if(g&&g.nodeType===8){if(g.data==="teleport start anchor")t.targetStart=g;else if(g.data==="teleport anchor"){t.targetAnchor=g,f._lpa=t.targetAnchor&&r(t.targetAnchor);break}}g=r(g)}t.targetAnchor||QC(f,t,u,c),d(m&&r(m),t,f,e,i,s,o)}XC(t)}return t.anchor&&r(t.anchor)}const ZL=GL;function XC(n){const t=n.ctx;if(t&&t.ut){let e=n.children[0].el;for(;e&&e!==n.targetAnchor;)e.nodeType===1&&e.setAttribute("data-v-owner",t.uid),e=e.nextSibling;t.ut()}}function QC(n,t,e,i){const s=t.targetStart=e(""),o=t.targetAnchor=e("");return s[YC]=o,n&&(i(s,n),i(o,n)),o}let Dw=!1;const Qo=()=>{Dw||(console.error("Hydration completed but contains mismatches."),Dw=!0)},JL=n=>n.namespaceURI.includes("svg")&&n.tagName!=="foreignObject",YL=n=>n.namespaceURI.includes("MathML"),Sc=n=>{if(JL(n))return"svg";if(YL(n))return"mathml"},Ic=n=>n.nodeType===8;function XL(n){const{mt:t,p:e,o:{patchProp:i,createText:s,nextSibling:o,parentNode:r,remove:a,insert:l,createComment:c}}=n,u=(y,E)=>{if(!E.hasChildNodes()){e(null,y,E),Su(),E._vnode=y;return}d(E.firstChild,y,null,null,null),Su(),E._vnode=y},d=(y,E,x,S,R,V=!1)=>{V=V||!!E.dynamicChildren;const P=Ic(y)&&y.data==="[",B=()=>p(y,E,x,S,R,P),{type:J,ref:H,shapeFlag:le,patchFlag:Re}=E;let $e=y.nodeType;E.el=y,Re===-2&&(V=!1,E.dynamicChildren=null);let ee=null;switch(J){case Ss:$e!==3?E.children===""?(l(E.el=s(""),r(y),y),ee=y):ee=B():(y.data!==E.children&&(Qo(),y.data=E.children),ee=o(y));break;case Pt:_(y)?(ee=o(y),v(E.el=y.content.firstChild,y,x)):$e!==8||P?ee=B():ee=o(y);break;case bo:if(P&&(y=o(y),$e=y.nodeType),$e===1||$e===3){ee=y;const ye=!E.children.length;for(let se=0;se<E.staticCount;se++)ye&&(E.children+=ee.nodeType===1?ee.outerHTML:ee.data),se===E.staticCount-1&&(E.anchor=ee),ee=o(ee);return P?o(ee):ee}else B();break;case It:P?ee=g(y,E,x,S,R,V):ee=B();break;default:if(le&1)($e!==1||E.type.toLowerCase()!==y.tagName.toLowerCase())&&!_(y)?ee=B():ee=f(y,E,x,S,R,V);else if(le&6){E.slotScopeIds=R;const ye=r(y);if(P?ee=w(y):Ic(y)&&y.data==="teleport start"?ee=w(y,y.data,"teleport end"):ee=o(y),t(E,ye,null,x,S,Sc(ye),V),po(E)){let se;P?(se=qe(It),se.anchor=ee?ee.previousSibling:ye.lastChild):se=y.nodeType===3?jd(""):qe("div"),se.el=y,E.component.subTree=se}}else le&64?$e!==8?ee=B():ee=E.type.hydrate(y,E,x,S,R,V,n,m):le&128&&(ee=E.type.hydrate(y,E,x,S,Sc(r(y)),R,V,n,d))}return H!=null&&Ru(H,null,S,E),ee},f=(y,E,x,S,R,V)=>{V=V||!!E.dynamicChildren;const{type:P,props:B,patchFlag:J,shapeFlag:H,dirs:le,transition:Re}=E,$e=P==="input"||P==="option";if($e||J!==-1){le&&yi(E,null,x,"created");let ee=!1;if(_(y)){ee=ik(S,Re)&&x&&x.vnode.props&&x.vnode.props.appear;const se=y.content.firstChild;ee&&Re.beforeEnter(se),v(se,y,x),E.el=y=se}if(H&16&&!(B&&(B.innerHTML||B.textContent))){let se=m(y.firstChild,E,y,x,S,R,V);for(;se;){Qo();const Ni=se;se=se.nextSibling,a(Ni)}}else H&8&&y.textContent!==E.children&&(Qo(),y.textContent=E.children);if(B){if($e||!V||J&48)for(const se in B)($e&&(se.endsWith("value")||se==="indeterminate")||Fl(se)&&!Tr(se)||se[0]===".")&&i(y,se,null,B[se],void 0,x);else if(B.onClick)i(y,"onClick",null,B.onClick,void 0,x);else if(J&4&&go(B.style))for(const se in B.style)B.style[se]}let ye;(ye=B&&B.onVnodeBeforeMount)&&an(ye,x,E),le&&yi(E,null,x,"beforeMount"),((ye=B&&B.onVnodeMounted)||le||ee)&&fk(()=>{ye&&an(ye,x,E),ee&&Re.enter(y),le&&yi(E,null,x,"mounted")},S)}return y.nextSibling},m=(y,E,x,S,R,V,P)=>{P=P||!!E.dynamicChildren;const B=E.children,J=B.length;for(let H=0;H<J;H++){const le=P?B[H]:B[H]=cn(B[H]),Re=le.type===Ss;if(y){if(Re&&!P){let $e=B[H+1];$e&&($e=cn($e)).type===Ss&&(l(s(y.data.slice(le.children.length)),x,o(y)),y.data=le.children)}y=d(y,le,S,R,V,P)}else Re&&!le.children?l(le.el=s(""),x):(Qo(),e(null,le,x,null,S,R,Sc(x),V))}return y},g=(y,E,x,S,R,V)=>{const{slotScopeIds:P}=E;P&&(R=R?R.concat(P):P);const B=r(y),J=m(o(y),E,B,x,S,R,V);return J&&Ic(J)&&J.data==="]"?o(E.anchor=J):(Qo(),l(E.anchor=c("]"),B,J),J)},p=(y,E,x,S,R,V)=>{if(Qo(),E.el=null,V){const J=w(y);for(;;){const H=o(y);if(H&&H!==J)a(H);else break}}const P=o(y),B=r(y);return a(y),e(null,E,B,P,x,S,Sc(B),R),P},w=(y,E="[",x="]")=>{let S=0;for(;y;)if(y=o(y),y&&Ic(y)&&(y.data===E&&S++,y.data===x)){if(S===0)return o(y);S--}return y},v=(y,E,x)=>{const S=E.parentNode;S&&S.replaceChild(y,E);let R=x;for(;R;)R.vnode.el===E&&(R.vnode.el=R.subTree.el=y),R=R.parent},_=y=>y.nodeType===1&&y.tagName.toLowerCase()==="template";return[u,d]}const Et=fk;function ek(n){return nk(n)}function tk(n){return nk(n,XL)}function nk(n,t){const e=Zy();e.__VUE__=!0;const{insert:i,remove:s,patchProp:o,createElement:r,createText:a,createComment:l,setText:c,setElementText:u,parentNode:d,nextSibling:f,setScopeId:m=dn,insertStaticContent:g}=n,p=(k,T,L,D=null,O=null,$=null,G=void 0,z=null,U=!!T.dynamicChildren)=>{if(k===T)return;k&&!ri(k,T)&&(D=wc(k),pi(k,O,$,!0),k=null),T.patchFlag===-2&&(U=!1,T.dynamicChildren=null);const{type:N,ref:K,shapeFlag:oe}=T;switch(N){case Ss:w(k,T,L,D);break;case Pt:v(k,T,L,D);break;case bo:k==null&&_(T,L,D,G);break;case It:H(k,T,L,D,O,$,G,z,U);break;default:oe&1?x(k,T,L,D,O,$,G,z,U):oe&6?le(k,T,L,D,O,$,G,z,U):(oe&64||oe&128)&&N.process(k,T,L,D,O,$,G,z,U,Yo)}K!=null&&O&&Ru(K,k&&k.ref,$,T||k,!T)},w=(k,T,L,D)=>{if(k==null)i(T.el=a(T.children),L,D);else{const O=T.el=k.el;T.children!==k.children&&c(O,T.children)}},v=(k,T,L,D)=>{k==null?i(T.el=l(T.children||""),L,D):T.el=k.el},_=(k,T,L,D)=>{[k.el,k.anchor]=g(k.children,T,L,D,k.el,k.anchor)},y=({el:k,anchor:T},L,D)=>{let O;for(;k&&k!==T;)O=f(k),i(k,L,D),k=O;i(T,L,D)},E=({el:k,anchor:T})=>{let L;for(;k&&k!==T;)L=f(k),s(k),k=L;s(T)},x=(k,T,L,D,O,$,G,z,U)=>{T.type==="svg"?G="svg":T.type==="math"&&(G="mathml"),k==null?S(T,L,D,O,$,G,z,U):P(k,T,O,$,G,z,U)},S=(k,T,L,D,O,$,G,z)=>{let U,N;const{props:K,shapeFlag:oe,transition:ie,dirs:pe}=k;if(U=k.el=r(k.type,$,K&&K.is,K),oe&8?u(U,k.children):oe&16&&V(k.children,U,null,D,O,Yh(k,$),G,z),pe&&yi(k,null,D,"created"),R(U,k,k.scopeId,G,D),K){for(const Xe in K)Xe!=="value"&&!Tr(Xe)&&o(U,Xe,null,K[Xe],$,D);"value"in K&&o(U,"value",null,K.value,$),(N=K.onVnodeBeforeMount)&&an(N,D,k)}pe&&yi(k,null,D,"beforeMount");const ke=ik(O,ie);ke&&ie.beforeEnter(U),i(U,T,L),((N=K&&K.onVnodeMounted)||ke||pe)&&Et(()=>{N&&an(N,D,k),ke&&ie.enter(U),pe&&yi(k,null,D,"mounted")},O)},R=(k,T,L,D,O)=>{if(L&&m(k,L),D)for(let $=0;$<D.length;$++)m(k,D[$]);if(O){let $=O.subTree;if(T===$){const G=O.vnode;R(k,G,G.scopeId,G.slotScopeIds,O.parent)}}},V=(k,T,L,D,O,$,G,z,U=0)=>{for(let N=U;N<k.length;N++){const K=k[N]=z?Ts(k[N]):cn(k[N]);p(null,K,T,L,D,O,$,G,z)}},P=(k,T,L,D,O,$,G)=>{const z=T.el=k.el;let{patchFlag:U,dynamicChildren:N,dirs:K}=T;U|=k.patchFlag&16;const oe=k.props||Le,ie=T.props||Le;let pe;if(L&&eo(L,!1),(pe=ie.onVnodeBeforeUpdate)&&an(pe,L,T,k),K&&yi(T,k,L,"beforeUpdate"),L&&eo(L,!0),(oe.innerHTML&&ie.innerHTML==null||oe.textContent&&ie.textContent==null)&&u(z,""),N?B(k.dynamicChildren,N,z,L,D,Yh(T,O),$):G||se(k,T,z,null,L,D,Yh(T,O),$,!1),U>0){if(U&16)J(z,oe,ie,L,O);else if(U&2&&oe.class!==ie.class&&o(z,"class",null,ie.class,O),U&4&&o(z,"style",oe.style,ie.style,O),U&8){const ke=T.dynamicProps;for(let Xe=0;Xe<ke.length;Xe++){const Oe=ke[Xe],kt=oe[Oe],ii=ie[Oe];(ii!==kt||Oe==="value")&&o(z,Oe,kt,ii,O,L)}}U&1&&k.children!==T.children&&u(z,T.children)}else!G&&N==null&&J(z,oe,ie,L,O);((pe=ie.onVnodeUpdated)||K)&&Et(()=>{pe&&an(pe,L,T,k),K&&yi(T,k,L,"updated")},D)},B=(k,T,L,D,O,$,G)=>{for(let z=0;z<T.length;z++){const U=k[z],N=T[z],K=U.el&&(U.type===It||!ri(U,N)||U.shapeFlag&70)?d(U.el):L;p(U,N,K,null,D,O,$,G,!0)}},J=(k,T,L,D,O)=>{if(T!==L){if(T!==Le)for(const $ in T)!Tr($)&&!($ in L)&&o(k,$,T[$],null,O,D);for(const $ in L){if(Tr($))continue;const G=L[$],z=T[$];G!==z&&$!=="value"&&o(k,$,z,G,O,D)}"value"in L&&o(k,"value",T.value,L.value,O)}},H=(k,T,L,D,O,$,G,z,U)=>{const N=T.el=k?k.el:a(""),K=T.anchor=k?k.anchor:a("");let{patchFlag:oe,dynamicChildren:ie,slotScopeIds:pe}=T;pe&&(z=z?z.concat(pe):pe),k==null?(i(N,L,D),i(K,L,D),V(T.children||[],L,K,O,$,G,z,U)):oe>0&&oe&64&&ie&&k.dynamicChildren?(B(k.dynamicChildren,ie,L,O,$,G,z),(T.key!=null||O&&T===O.subTree)&&Kg(k,T,!0)):se(k,T,L,K,O,$,G,z,U)},le=(k,T,L,D,O,$,G,z,U)=>{T.slotScopeIds=z,k==null?T.shapeFlag&512?O.ctx.activate(T,L,D,G,U):Re(T,L,D,O,$,G,U):$e(k,T,U)},Re=(k,T,L,D,O,$,G)=>{const z=k.component=vk(k,D,O);if(zl(k)&&(z.ctx.renderer=Yo),Ck(z,!1,G),z.asyncDep){if(O&&O.registerDep(z,ee,G),!k.el){const U=z.subTree=qe(Pt);v(null,U,T,L)}}else ee(z,k,T,L,O,$,G)},$e=(k,T,L)=>{const D=T.component=k.component;if(a4(k,T,L))if(D.asyncDep&&!D.asyncResolved){ye(D,T,L);return}else D.next=T,eL(D.update),D.effect.dirty=!0,D.update();else T.el=k.el,D.vnode=T},ee=(k,T,L,D,O,$,G)=>{const z=()=>{if(k.isMounted){let{next:K,bu:oe,u:ie,parent:pe,vnode:ke}=k;{const Xo=sk(k);if(Xo){K&&(K.el=ke.el,ye(k,K,G)),Xo.asyncDep.then(()=>{k.isUnmounted||z()});return}}let Xe=K,Oe;eo(k,!1),K?(K.el=ke.el,ye(k,K,G)):K=ke,oe&&Er(oe),(Oe=K.props&&K.props.onVnodeBeforeUpdate)&&an(Oe,pe,K,ke),eo(k,!0);const kt=lu(k),ii=k.subTree;k.subTree=kt,p(ii,kt,d(ii.el),wc(ii),k,O,$),K.el=kt.el,Xe===null&&Zg(k,kt.el),ie&&Et(ie,O),(Oe=K.props&&K.props.onVnodeUpdated)&&Et(()=>an(Oe,pe,K,ke),O)}else{let K;const{el:oe,props:ie}=T,{bm:pe,m:ke,parent:Xe}=k,Oe=po(T);if(eo(k,!1),pe&&Er(pe),!Oe&&(K=ie&&ie.onVnodeBeforeMount)&&an(K,Xe,T),eo(k,!0),oe&&qh){const kt=()=>{k.subTree=lu(k),qh(oe,k.subTree,k,O,null)};Oe?T.type.__asyncLoader().then(()=>!k.isUnmounted&&kt()):kt()}else{const kt=k.subTree=lu(k);p(null,kt,L,D,k,O,$),T.el=kt.el}if(ke&&Et(ke,O),!Oe&&(K=ie&&ie.onVnodeMounted)){const kt=T;Et(()=>an(K,Xe,kt),O)}(T.shapeFlag&256||Xe&&po(Xe.vnode)&&Xe.vnode.shapeFlag&256)&&k.a&&Et(k.a,O),k.isMounted=!0,T=L=D=null}},U=k.effect=new Vr(z,dn,()=>Od(N),k.scope),N=k.update=()=>{U.dirty&&U.run()};N.i=k,N.id=k.uid,eo(k,!0),N()},ye=(k,T,L)=>{T.component=k;const D=k.vnode.props;k.vnode=T,k.next=null,HL(k,T.props,D,L),qL(k,T.children,L),Ws(),Pw(k),qs()},se=(k,T,L,D,O,$,G,z,U=!1)=>{const N=k&&k.children,K=k?k.shapeFlag:0,oe=T.children,{patchFlag:ie,shapeFlag:pe}=T;if(ie>0){if(ie&128){bc(N,oe,L,D,O,$,G,z,U);return}else if(ie&256){Ni(N,oe,L,D,O,$,G,z,U);return}}pe&8?(K&16&&fa(N,O,$),oe!==N&&u(L,oe)):K&16?pe&16?bc(N,oe,L,D,O,$,G,z,U):fa(N,O,$,!0):(K&8&&u(L,""),pe&16&&V(oe,L,D,O,$,G,z,U))},Ni=(k,T,L,D,O,$,G,z,U)=>{k=k||Cr,T=T||Cr;const N=k.length,K=T.length,oe=Math.min(N,K);let ie;for(ie=0;ie<oe;ie++){const pe=T[ie]=U?Ts(T[ie]):cn(T[ie]);p(k[ie],pe,L,null,O,$,G,z,U)}N>K?fa(k,O,$,!0,!1,oe):V(T,L,D,O,$,G,z,U,oe)},bc=(k,T,L,D,O,$,G,z,U)=>{let N=0;const K=T.length;let oe=k.length-1,ie=K-1;for(;N<=oe&&N<=ie;){const pe=k[N],ke=T[N]=U?Ts(T[N]):cn(T[N]);if(ri(pe,ke))p(pe,ke,L,null,O,$,G,z,U);else break;N++}for(;N<=oe&&N<=ie;){const pe=k[oe],ke=T[ie]=U?Ts(T[ie]):cn(T[ie]);if(ri(pe,ke))p(pe,ke,L,null,O,$,G,z,U);else break;oe--,ie--}if(N>oe){if(N<=ie){const pe=ie+1,ke=pe<K?T[pe].el:D;for(;N<=ie;)p(null,T[N]=U?Ts(T[N]):cn(T[N]),L,ke,O,$,G,z,U),N++}}else if(N>ie)for(;N<=oe;)pi(k[N],O,$,!0),N++;else{const pe=N,ke=N,Xe=new Map;for(N=ke;N<=ie;N++){const Tn=T[N]=U?Ts(T[N]):cn(T[N]);Tn.key!=null&&Xe.set(Tn.key,N)}let Oe,kt=0;const ii=ie-ke+1;let Xo=!1,ww=0;const ma=new Array(ii);for(N=0;N<ii;N++)ma[N]=0;for(N=pe;N<=oe;N++){const Tn=k[N];if(kt>=ii){pi(Tn,O,$,!0);continue}let bi;if(Tn.key!=null)bi=Xe.get(Tn.key);else for(Oe=ke;Oe<=ie;Oe++)if(ma[Oe-ke]===0&&ri(Tn,T[Oe])){bi=Oe;break}bi===void 0?pi(Tn,O,$,!0):(ma[bi-ke]=N+1,bi>=ww?ww=bi:Xo=!0,p(Tn,T[bi],L,null,O,$,G,z,U),kt++)}const _w=Xo?QL(ma):Cr;for(Oe=_w.length-1,N=ii-1;N>=0;N--){const Tn=ke+N,bi=T[Tn],vw=Tn+1<K?T[Tn+1].el:D;ma[N]===0?p(null,bi,L,vw,O,$,G,z,U):Xo&&(Oe<0||N!==_w[Oe]?Qs(bi,L,vw,2):Oe--)}}},Qs=(k,T,L,D,O=null)=>{const{el:$,type:G,transition:z,children:U,shapeFlag:N}=k;if(N&6){Qs(k.component.subTree,T,L,D);return}if(N&128){k.suspense.move(T,L,D);return}if(N&64){G.move(k,T,L,Yo);return}if(G===It){i($,T,L);for(let oe=0;oe<U.length;oe++)Qs(U[oe],T,L,D);i(k.anchor,T,L);return}if(G===bo){y(k,T,L);return}if(D!==2&&N&1&&z)if(D===0)z.beforeEnter($),i($,T,L),Et(()=>z.enter($),O);else{const{leave:oe,delayLeave:ie,afterLeave:pe}=z,ke=()=>i($,T,L),Xe=()=>{oe($,()=>{ke(),pe&&pe()})};ie?ie($,ke,Xe):Xe()}else i($,T,L)},pi=(k,T,L,D=!1,O=!1)=>{const{type:$,props:G,ref:z,children:U,dynamicChildren:N,shapeFlag:K,patchFlag:oe,dirs:ie,cacheIndex:pe}=k;if(oe===-2&&(O=!1),z!=null&&Ru(z,null,L,k,!0),pe!=null&&(T.renderCache[pe]=void 0),K&256){T.ctx.deactivate(k);return}const ke=K&1&&ie,Xe=!po(k);let Oe;if(Xe&&(Oe=G&&G.onVnodeBeforeUnmount)&&an(Oe,T,k),K&6)WR(k.component,L,D);else{if(K&128){k.suspense.unmount(L,D);return}ke&&yi(k,null,T,"beforeUnmount"),K&64?k.type.remove(k,T,L,Yo,D):N&&!N.hasOnce&&($!==It||oe>0&&oe&64)?fa(N,T,L,!1,!0):($===It&&oe&384||!O&&K&16)&&fa(U,T,L),D&&pw(k)}(Xe&&(Oe=G&&G.onVnodeUnmounted)||ke)&&Et(()=>{Oe&&an(Oe,T,k),ke&&yi(k,null,T,"unmounted")},L)},pw=k=>{const{type:T,el:L,anchor:D,transition:O}=k;if(T===It){UR(L,D);return}if(T===bo){E(k);return}const $=()=>{s(L),O&&!O.persisted&&O.afterLeave&&O.afterLeave()};if(k.shapeFlag&1&&O&&!O.persisted){const{leave:G,delayLeave:z}=O,U=()=>G(L,$);z?z(k.el,$,U):U()}else $()},UR=(k,T)=>{let L;for(;k!==T;)L=f(k),s(k),k=L;s(T)},WR=(k,T,L)=>{const{bum:D,scope:O,update:$,subTree:G,um:z,m:U,a:N}=k;Lu(U),Lu(N),D&&Er(D),O.stop(),$&&($.active=!1,pi(G,k,T,L)),z&&Et(z,T),Et(()=>{k.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&k.asyncDep&&!k.asyncResolved&&k.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},fa=(k,T,L,D=!1,O=!1,$=0)=>{for(let G=$;G<k.length;G++)pi(k[G],T,L,D,O)},wc=k=>{if(k.shapeFlag&6)return wc(k.component.subTree);if(k.shapeFlag&128)return k.suspense.next();const T=f(k.anchor||k.el),L=T&&T[YC];return L?f(L):T};let Uh=!1;const bw=(k,T,L)=>{k==null?T._vnode&&pi(T._vnode,null,null,!0):p(T._vnode||null,k,T,null,null,null,L),Uh||(Uh=!0,Pw(),Su(),Uh=!1),T._vnode=k},Yo={p,um:pi,m:Qs,r:pw,mt:Re,mc:V,pc:se,pbc:B,n:wc,o:n};let Wh,qh;return t&&([Wh,qh]=t(Yo)),{render:bw,hydrate:Wh,createApp:FL(bw,Wh)}}function Yh({type:n,props:t},e){return e==="svg"&&n==="foreignObject"||e==="mathml"&&n==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:e}function eo({effect:n,update:t},e){n.allowRecurse=t.allowRecurse=e}function ik(n,t){return(!n||n&&!n.pendingBranch)&&t&&!t.persisted}function Kg(n,t,e=!1){const i=n.children,s=t.children;if(Y(i)&&Y(s))for(let o=0;o<i.length;o++){const r=i[o];let a=s[o];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[o]=Ts(s[o]),a.el=r.el),!e&&a.patchFlag!==-2&&Kg(r,a)),a.type===Ss&&(a.el=r.el)}}function QL(n){const t=n.slice(),e=[0];let i,s,o,r,a;const l=n.length;for(i=0;i<l;i++){const c=n[i];if(c!==0){if(s=e[e.length-1],n[s]<c){t[i]=s,e.push(i);continue}for(o=0,r=e.length-1;o<r;)a=o+r>>1,n[e[a]]<c?o=a+1:r=a;c<n[e[o]]&&(o>0&&(t[i]=e[o-1]),e[o]=i)}}for(o=e.length,r=e[o-1];o-- >0;)e[o]=r,r=t[r];return e}function sk(n){const t=n.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:sk(t)}function Lu(n){if(n)for(let t=0;t<n.length;t++)n[t].active=!1}const ok=Symbol.for("v-scx"),rk=()=>Da(ok);function e4(n,t){return Wl(n,null,t)}function ak(n,t){return Wl(n,null,{flush:"post"})}function lk(n,t){return Wl(n,null,{flush:"sync"})}const Pc={};function Ha(n,t,e){return Wl(n,t,e)}function Wl(n,t,{immediate:e,deep:i,flush:s,once:o,onTrack:r,onTrigger:a}=Le){if(t&&o){const S=t;t=(...R)=>{S(...R),x()}}const l=vt,c=S=>i===!0?S:Es(S,i===!1?1:void 0);let u,d=!1,f=!1;if(Nt(n)?(u=()=>n.value,d=ko(n)):go(n)?(u=()=>c(n),d=!0):Y(n)?(f=!0,d=n.some(S=>go(S)||ko(S)),u=()=>n.map(S=>{if(Nt(S))return S.value;if(go(S))return c(S);if(ce(S))return Ki(S,l,2)})):ce(n)?t?u=()=>Ki(n,l,2):u=()=>(m&&m(),Vn(n,l,3,[g])):u=dn,t&&i){const S=u;u=()=>Es(S())}let m,g=S=>{m=y.onStop=()=>{Ki(S,l,4),m=y.onStop=void 0}},p;if(ql)if(g=dn,t?e&&Vn(t,l,3,[u(),f?[]:void 0,g]):u(),s==="sync"){const S=rk();p=S.__watcherHandles||(S.__watcherHandles=[])}else return dn;let w=f?new Array(n.length).fill(Pc):Pc;const v=()=>{if(!(!y.active||!y.dirty))if(t){const S=y.run();(i||d||(f?S.some((R,V)=>Jt(R,w[V])):Jt(S,w)))&&(m&&m(),Vn(t,l,3,[S,w===Pc?void 0:f&&w[0]===Pc?[]:w,g]),w=S)}else y.run()};v.allowRecurse=!!t;let _;s==="sync"?_=v:s==="post"?_=()=>Et(v,l&&l.suspense):(v.pre=!0,l&&(v.id=l.uid),_=()=>Od(v));const y=new Vr(u,dn,_),E=eC(),x=()=>{y.stop(),E&&Eg(E.effects,y)};return t?e?v():w=y.run():s==="post"?Et(y.run.bind(y),l&&l.suspense):y.run(),p&&p.push(x),x}function t4(n,t,e){const i=this.proxy,s=st(n)?n.includes(".")?ck(i,n):()=>i[n]:n.bind(i,i);let o;ce(t)?o=t:(o=t.handler,e=t);const r=Eo(this),a=Wl(s,o.bind(i),e);return r(),a}function ck(n,t){const e=t.split(".");return()=>{let i=n;for(let s=0;s<e.length&&i;s++)i=i[e[s]];return i}}function Es(n,t=1/0,e){if(t<=0||!Ue(n)||n.__v_skip||(e=e||new Set,e.has(n)))return n;if(e.add(n),t--,Nt(n))Es(n.value,t,e);else if(Y(n))for(let i=0;i<n.length;i++)Es(n[i],t,e);else if(Vo(n)||kr(n))n.forEach(i=>{Es(i,t,e)});else if(Gy(n)){for(const i in n)Es(n[i],t,e);for(const i of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,i)&&Es(n[i],t,e)}return n}function n4(n,t,e=Le){const i=rs(),s=Wt(t),o=un(t),r=uk(n,t),a=wC((l,c)=>{let u,d=Le,f;return lk(()=>{const m=n[t];Jt(u,m)&&(u=m,c())}),{get(){return l(),e.get?e.get(u):u},set(m){if(!Jt(m,u)&&!(d!==Le&&Jt(m,d)))return;const g=i.vnode.props;g&&(t in g||s in g||o in g)&&(`onUpdate:${t}`in g||`onUpdate:${s}`in g||`onUpdate:${o}`in g)||(u=m,c());const p=e.set?e.set(m):m;i.emit(`update:${t}`,p),Jt(m,p)&&Jt(m,d)&&!Jt(p,f)&&c(),d=m,f=p}}});return a[Symbol.iterator]=()=>{let l=0;return{next(){return l<2?{value:l++?r||Le:a,done:!1}:{done:!0}}}},a}const uk=(n,t)=>t==="modelValue"||t==="model-value"?n.modelModifiers:n[`${t}Modifiers`]||n[`${Wt(t)}Modifiers`]||n[`${un(t)}Modifiers`];function i4(n,t,...e){if(n.isUnmounted)return;const i=n.vnode.props||Le;let s=e;const o=t.startsWith("update:"),r=o&&uk(i,t.slice(7));r&&(r.trim&&(s=e.map(u=>st(u)?u.trim():u)),r.number&&(s=e.map(Tu)));let a,l=i[a=Oa(t)]||i[a=Oa(Wt(t))];!l&&o&&(l=i[a=Oa(un(t))]),l&&Vn(l,n,6,s);const c=i[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,Vn(c,n,6,s)}}function dk(n,t,e=!1){const i=t.emitsCache,s=i.get(n);if(s!==void 0)return s;const o=n.emits;let r={},a=!1;if(!ce(n)){const l=c=>{const u=dk(c,t,!0);u&&(a=!0,ot(r,u))};!e&&t.mixins.length&&t.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!o&&!a?(Ue(n)&&i.set(n,null),null):(Y(o)?o.forEach(l=>r[l]=null):ot(r,o),Ue(n)&&i.set(n,r),r)}function Ud(n,t){return!n||!Fl(t)?!1:(t=t.slice(2).replace(/Once$/,""),Se(n,t[0].toLowerCase()+t.slice(1))||Se(n,un(t))||Se(n,t))}function lu(n){const{type:t,vnode:e,proxy:i,withProxy:s,propsOptions:[o],slots:r,attrs:a,emit:l,render:c,renderCache:u,props:d,data:f,setupState:m,ctx:g,inheritAttrs:p}=n,w=ul(n);let v,_;try{if(e.shapeFlag&4){const E=s||i,x=E;v=cn(c.call(x,E,u,d,m,f,g)),_=a}else{const E=t;v=cn(E.length>1?E(d,{attrs:a,slots:r,emit:l}):E(d,null)),_=t.props?a:o4(a)}}catch(E){za.length=0,Bo(E,n,1),v=qe(Pt)}let y=v;if(_&&p!==!1){const E=Object.keys(_),{shapeFlag:x}=y;E.length&&x&7&&(o&&E.some(Tg)&&(_=r4(_,o)),y=Si(y,_,!1,!0))}return e.dirs&&(y=Si(y,null,!1,!0),y.dirs=y.dirs?y.dirs.concat(e.dirs):e.dirs),e.transition&&(y.transition=e.transition),v=y,ul(w),v}function s4(n,t=!0){let e;for(let i=0;i<n.length;i++){const s=n[i];if(Bs(s)){if(s.type!==Pt||s.children==="v-if"){if(e)return;e=s}}else return}return e}const o4=n=>{let t;for(const e in n)(e==="class"||e==="style"||Fl(e))&&((t||(t={}))[e]=n[e]);return t},r4=(n,t)=>{const e={};for(const i in n)(!Tg(i)||!(i.slice(9)in t))&&(e[i]=n[i]);return e};function a4(n,t,e){const{props:i,children:s,component:o}=n,{props:r,children:a,patchFlag:l}=t,c=o.emitsOptions;if(t.dirs||t.transition)return!0;if(e&&l>=0){if(l&1024)return!0;if(l&16)return i?$w(i,r,c):!!r;if(l&8){const u=t.dynamicProps;for(let d=0;d<u.length;d++){const f=u[d];if(r[f]!==i[f]&&!Ud(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:i===r?!1:i?r?$w(i,r,c):!0:!!r;return!1}function $w(n,t,e){const i=Object.keys(t);if(i.length!==Object.keys(n).length)return!0;for(let s=0;s<i.length;s++){const o=i[s];if(t[o]!==n[o]&&!Ud(e,o))return!0}return!1}function Zg({vnode:n,parent:t},e){for(;t;){const i=t.subTree;if(i.suspense&&i.suspense.activeBranch===n&&(i.el=n.el),i===n)(n=t.vnode).el=e,t=t.parent;else break}}const sm=n=>n.__isSuspense;let om=0;const l4={name:"Suspense",__isSuspense:!0,process(n,t,e,i,s,o,r,a,l,c){if(n==null)u4(t,e,i,s,o,r,a,l,c);else{if(o&&o.deps>0&&!n.suspense.isInFallback){t.suspense=n.suspense,t.suspense.vnode=t,t.el=n.el;return}d4(n,t,e,i,s,r,a,l,c)}},hydrate:h4,normalize:f4},c4=l4;function hl(n,t){const e=n.props&&n.props[t];ce(e)&&e()}function u4(n,t,e,i,s,o,r,a,l){const{p:c,o:{createElement:u}}=l,d=u("div"),f=n.suspense=hk(n,s,i,t,d,e,o,r,a,l);c(null,f.pendingBranch=n.ssContent,d,null,i,f,o,r),f.deps>0?(hl(n,"onPending"),hl(n,"onFallback"),c(null,n.ssFallback,t,e,i,null,o,r),Ir(f,n.ssFallback)):f.resolve(!1,!0)}function d4(n,t,e,i,s,o,r,a,{p:l,um:c,o:{createElement:u}}){const d=t.suspense=n.suspense;d.vnode=t,t.el=n.el;const f=t.ssContent,m=t.ssFallback,{activeBranch:g,pendingBranch:p,isInFallback:w,isHydrating:v}=d;if(p)d.pendingBranch=f,ri(f,p)?(l(p,f,d.hiddenContainer,null,s,d,o,r,a),d.deps<=0?d.resolve():w&&(v||(l(g,m,e,i,s,null,o,r,a),Ir(d,m)))):(d.pendingId=om++,v?(d.isHydrating=!1,d.activeBranch=p):c(p,s,d),d.deps=0,d.effects.length=0,d.hiddenContainer=u("div"),w?(l(null,f,d.hiddenContainer,null,s,d,o,r,a),d.deps<=0?d.resolve():(l(g,m,e,i,s,null,o,r,a),Ir(d,m))):g&&ri(f,g)?(l(g,f,e,i,s,d,o,r,a),d.resolve(!0)):(l(null,f,d.hiddenContainer,null,s,d,o,r,a),d.deps<=0&&d.resolve()));else if(g&&ri(f,g))l(g,f,e,i,s,d,o,r,a),Ir(d,f);else if(hl(t,"onPending"),d.pendingBranch=f,f.shapeFlag&512?d.pendingId=f.component.suspenseId:d.pendingId=om++,l(null,f,d.hiddenContainer,null,s,d,o,r,a),d.deps<=0)d.resolve();else{const{timeout:_,pendingId:y}=d;_>0?setTimeout(()=>{d.pendingId===y&&d.fallback(m)},_):_===0&&d.fallback(m)}}function hk(n,t,e,i,s,o,r,a,l,c,u=!1){const{p:d,m:f,um:m,n:g,o:{parentNode:p,remove:w}}=c;let v;const _=m4(n);_&&t&&t.pendingBranch&&(v=t.pendingId,t.deps++);const y=n.props?Eu(n.props.timeout):void 0,E=o,x={vnode:n,parent:t,parentComponent:e,namespace:r,container:i,hiddenContainer:s,deps:0,pendingId:om++,timeout:typeof y=="number"?y:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(S=!1,R=!1){const{vnode:V,activeBranch:P,pendingBranch:B,pendingId:J,effects:H,parentComponent:le,container:Re}=x;let $e=!1;x.isHydrating?x.isHydrating=!1:S||($e=P&&B.transition&&B.transition.mode==="out-in",$e&&(P.transition.afterLeave=()=>{J===x.pendingId&&(f(B,Re,o===E?g(P):o,0),xu(H))}),P&&(p(P.el)!==x.hiddenContainer&&(o=g(P)),m(P,le,x,!0)),$e||f(B,Re,o,0)),Ir(x,B),x.pendingBranch=null,x.isInFallback=!1;let ee=x.parent,ye=!1;for(;ee;){if(ee.pendingBranch){ee.effects.push(...H),ye=!0;break}ee=ee.parent}!ye&&!$e&&xu(H),x.effects=[],_&&t&&t.pendingBranch&&v===t.pendingId&&(t.deps--,t.deps===0&&!R&&t.resolve()),hl(V,"onResolve")},fallback(S){if(!x.pendingBranch)return;const{vnode:R,activeBranch:V,parentComponent:P,container:B,namespace:J}=x;hl(R,"onFallback");const H=g(V),le=()=>{x.isInFallback&&(d(null,S,B,H,P,null,J,a,l),Ir(x,S))},Re=S.transition&&S.transition.mode==="out-in";Re&&(V.transition.afterLeave=le),x.isInFallback=!0,m(V,P,null,!0),Re||le()},move(S,R,V){x.activeBranch&&f(x.activeBranch,S,R,V),x.container=S},next(){return x.activeBranch&&g(x.activeBranch)},registerDep(S,R,V){const P=!!x.pendingBranch;P&&x.deps++;const B=S.vnode.el;S.asyncDep.catch(J=>{Bo(J,S,0)}).then(J=>{if(S.isUnmounted||x.isUnmounted||x.pendingId!==S.suspenseId)return;S.asyncResolved=!0;const{vnode:H}=S;cm(S,J,!1),B&&(H.el=B);const le=!B&&S.subTree.el;R(S,H,p(B||S.subTree.el),B?null:g(S.subTree),x,r,V),le&&w(le),Zg(S,H.el),P&&--x.deps===0&&x.resolve()})},unmount(S,R){x.isUnmounted=!0,x.activeBranch&&m(x.activeBranch,e,S,R),x.pendingBranch&&m(x.pendingBranch,e,S,R)}};return x}function h4(n,t,e,i,s,o,r,a,l){const c=t.suspense=hk(t,i,e,n.parentNode,document.createElement("div"),null,s,o,r,a,!0),u=l(n,c.pendingBranch=t.ssContent,e,c,o,r);return c.deps===0&&c.resolve(!1,!0),u}function f4(n){const{shapeFlag:t,children:e}=n,i=t&32;n.ssContent=Hw(i?e.default:e),n.ssFallback=i?Hw(e.fallback):qe(Pt)}function Hw(n){let t;if(ce(n)){const e=To&&n._c;e&&(n._d=!1,Vs()),n=n(),e&&(n._d=!0,t=Ut,mk())}return Y(n)&&(n=s4(n)),n=cn(n),t&&!n.dynamicChildren&&(n.dynamicChildren=t.filter(e=>e!==n)),n}function fk(n,t){t&&t.pendingBranch?Y(n)?t.effects.push(...n):t.effects.push(n):xu(n)}function Ir(n,t){n.activeBranch=t;const{vnode:e,parentComponent:i}=n;let s=t.el;for(;!s&&t.component;)t=t.component.subTree,s=t.el;e.el=s,i&&i.subTree===e&&(i.vnode.el=s,Zg(i,s))}function m4(n){const t=n.props&&n.props.suspensible;return t!=null&&t!==!1}const It=Symbol.for("v-fgt"),Ss=Symbol.for("v-txt"),Pt=Symbol.for("v-cmt"),bo=Symbol.for("v-stc"),za=[];let Ut=null;function Vs(n=!1){za.push(Ut=n?null:[])}function mk(){za.pop(),Ut=za[za.length-1]||null}let To=1;function rm(n){To+=n,n<0&&Ut&&(Ut.hasOnce=!0)}function gk(n){return n.dynamicChildren=To>0?Ut||Cr:null,mk(),To>0&&Ut&&Ut.push(n),n}function Wd(n,t,e,i,s,o){return gk(Is(n,t,e,i,s,o,!0))}function qd(n,t,e,i,s){return gk(qe(n,t,e,i,s,!0))}function Bs(n){return n?n.__v_isVNode===!0:!1}function ri(n,t){return n.type===t.type&&n.key===t.key}function g4(n){}const pk=({key:n})=>n??null,cu=({ref:n,ref_key:t,ref_for:e})=>(typeof n=="number"&&(n=""+n),n!=null?st(n)||Nt(n)||ce(n)?{i:yt,r:n,k:t,f:!!e}:n:null);function Is(n,t=null,e=null,i=0,s=null,o=n===It?0:1,r=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:t,key:t&&pk(t),ref:t&&cu(t),scopeId:Nd,slotScopeIds:null,children:e,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:o,patchFlag:i,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:yt};return a?(Jg(l,e),o&128&&n.normalize(l)):e&&(l.shapeFlag|=st(e)?8:16),To>0&&!r&&Ut&&(l.patchFlag>0||o&6)&&l.patchFlag!==32&&Ut.push(l),l}const qe=p4;function p4(n,t=null,e=null,i=0,s=null,o=!1){if((!n||n===OC)&&(n=Pt),Bs(n)){const a=Si(n,t,!0);return e&&Jg(a,e),To>0&&!o&&Ut&&(a.shapeFlag&6?Ut[Ut.indexOf(n)]=a:Ut.push(a)),a.patchFlag=-2,a}if(T4(n)&&(n=n.__vccOpts),t){t=bk(t);let{class:a,style:l}=t;a&&!st(a)&&(t.class=Hl(a)),Ue(l)&&(Bg(l)&&!Y(l)&&(l=ot({},l)),t.style=$l(l))}const r=st(n)?1:sm(n)?128:jL(n)?64:Ue(n)?4:ce(n)?2:0;return Is(n,t,e,i,s,r,o,!0)}function bk(n){return n?Bg(n)||WC(n)?ot({},n):n:null}function Si(n,t,e=!1,i=!1){const{props:s,ref:o,patchFlag:r,children:a,transition:l}=n,c=t?_k(s||{},t):s,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&pk(c),ref:t&&t.ref?e&&o?Y(o)?o.concat(cu(t)):[o,cu(t)]:cu(t):o,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetStart:n.targetStart,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:t&&n.type!==It?r===-1?16:r|16:r,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Si(n.ssContent),ssFallback:n.ssFallback&&Si(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&i&&Ls(u,l.clone(u)),u}function jd(n=" ",t=0){return qe(Ss,null,n,t)}function b4(n,t){const e=qe(bo,null,n);return e.staticCount=t,e}function wk(n="",t=!1){return t?(Vs(),qd(Pt,null,n)):qe(Pt,null,n)}function cn(n){return n==null||typeof n=="boolean"?qe(Pt):Y(n)?qe(It,null,n.slice()):typeof n=="object"?Ts(n):qe(Ss,null,String(n))}function Ts(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Si(n)}function Jg(n,t){let e=0;const{shapeFlag:i}=n;if(t==null)t=null;else if(Y(t))e=16;else if(typeof t=="object")if(i&65){const s=t.default;s&&(s._c&&(s._d=!1),Jg(n,s()),s._c&&(s._d=!0));return}else{e=32;const s=t._;!s&&!WC(t)?t._ctx=yt:s===3&&yt&&(yt.slots._===1?t._=1:(t._=2,n.patchFlag|=1024))}else ce(t)?(t={default:t,_ctx:yt},e=32):(t=String(t),i&64?(e=16,t=[jd(t)]):e=8);n.children=t,n.shapeFlag|=e}function _k(...n){const t={};for(let e=0;e<n.length;e++){const i=n[e];for(const s in i)if(s==="class")t.class!==i.class&&(t.class=Hl([t.class,i.class]));else if(s==="style")t.style=$l([t.style,i.style]);else if(Fl(s)){const o=t[s],r=i[s];r&&o!==r&&!(Y(o)&&o.includes(r))&&(t[s]=o?[].concat(o,r):r)}else s!==""&&(t[s]=i[s])}return t}function an(n,t,e,i=null){Vn(n,t,7,[e,i])}const w4=$C();let _4=0;function vk(n,t,e){const i=n.type,s=(t?t.appContext:n.appContext)||w4,o={uid:_4++,vnode:n,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new Ig(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:jC(i,s),emitsOptions:dk(i,s),emit:null,emitted:null,propsDefaults:Le,inheritAttrs:i.inheritAttrs,ctx:Le,data:Le,props:Le,attrs:Le,slots:Le,refs:Le,setupState:Le,setupContext:null,suspense:e,suspenseId:e?e.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return o.ctx={_:o},o.root=t?t.root:o,o.emit=i4.bind(null,o),n.ce&&n.ce(o),o}let vt=null;const rs=()=>vt||yt;let Vu,am;{const n=Zy(),t=(e,i)=>{let s;return(s=n[e])||(s=n[e]=[]),s.push(i),o=>{s.length>1?s.forEach(r=>r(o)):s[0](o)}};Vu=t("__VUE_INSTANCE_SETTERS__",e=>vt=e),am=t("__VUE_SSR_SETTERS__",e=>ql=e)}const Eo=n=>{const t=vt;return Vu(n),n.scope.on(),()=>{n.scope.off(),Vu(t)}},lm=()=>{vt&&vt.scope.off(),Vu(null)};function yk(n){return n.vnode.shapeFlag&4}let ql=!1;function Ck(n,t=!1,e=!1){t&&am(t);const{props:i,children:s}=n.vnode,o=yk(n);$L(n,i,o,t),WL(n,s,e);const r=o?v4(n,t):void 0;return t&&am(!1),r}function v4(n,t){const e=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,Qf);const{setup:i}=e;if(i){const s=n.setupContext=i.length>1?Tk(n):null,o=Eo(n);Ws();const r=Ki(i,n,0,[n.props,s]);if(qs(),o(),Ag(r)){if(r.then(lm,lm),t)return r.then(a=>{cm(n,a,t)}).catch(a=>{Bo(a,n,0)});n.asyncDep=r}else cm(n,r,t)}else kk(n,t)}function cm(n,t,e){ce(t)?n.type.__ssrInlineRender?n.ssrRender=t:n.render=t:Ue(t)&&(n.setupState=Fg(t)),kk(n,e)}let Bu,um;function y4(n){Bu=n,um=t=>{t.render._rc&&(t.withProxy=new Proxy(t.ctx,wL))}}const C4=()=>!Bu;function kk(n,t,e){const i=n.type;if(!n.render){if(!t&&Bu&&!i.render){const s=i.template||jg(n).template;if(s){const{isCustomElement:o,compilerOptions:r}=n.appContext.config,{delimiters:a,compilerOptions:l}=i,c=ot(ot({isCustomElement:o,delimiters:a},r),l);i.render=Bu(s,c)}}n.render=i.render||dn,um&&um(n)}{const s=Eo(n);Ws();try{LL(n)}finally{qs(),s()}}}const k4={get(n,t){return wn(n,"get",""),n[t]}};function Tk(n){const t=e=>{n.exposed=e||{}};return{attrs:new Proxy(n.attrs,k4),slots:n.slots,emit:n.emit,expose:t}}function jl(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Fg(gC(n.exposed)),{get(t,e){if(e in t)return t[e];if(e in Fa)return Fa[e](n)},has(t,e){return e in t||e in Fa}})):n.proxy}function dm(n,t=!0){return ce(n)?n.displayName||n.name:n.name||t&&n.__name}function T4(n){return ce(n)&&"__vccOpts"in n}const Ek=(n,t)=>O3(n,t,ql);function Ak(n,t,e){const i=arguments.length;return i===2?Ue(t)&&!Y(t)?Bs(t)?qe(n,null,[t]):qe(n,t):qe(n,null,t):(i>3?e=Array.prototype.slice.call(arguments,2):i===3&&Bs(e)&&(e=[e]),qe(n,t,e))}function E4(){}function A4(n,t,e,i){const s=e[i];if(s&&xk(s,n))return s;const o=t();return o.memo=n.slice(),o.cacheIndex=i,e[i]=o}function xk(n,t){const e=n.memo;if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(Jt(e[i],t[i]))return!1;return To>0&&Ut&&Ut.push(n),!0}const Sk="3.4.35",x4=dn,S4=Y3,I4=cr,P4=kC,R4={createComponentInstance:vk,setupComponent:Ck,renderComponentRoot:lu,setCurrentRenderingInstance:ul,isVNode:Bs,normalizeVNode:cn,getComponentPublicInstance:jl},L4=R4,V4=null,B4=null,M4=null;/**
* @vue/runtime-dom v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const O4="http://www.w3.org/2000/svg",N4="http://www.w3.org/1998/Math/MathML",Ui=typeof document<"u"?document:null,zw=Ui&&Ui.createElement("template"),F4={insert:(n,t,e)=>{t.insertBefore(n,e||null)},remove:n=>{const t=n.parentNode;t&&t.removeChild(n)},createElement:(n,t,e,i)=>{const s=t==="svg"?Ui.createElementNS(O4,n):t==="mathml"?Ui.createElementNS(N4,n):e?Ui.createElement(n,{is:e}):Ui.createElement(n);return n==="select"&&i&&i.multiple!=null&&s.setAttribute("multiple",i.multiple),s},createText:n=>Ui.createTextNode(n),createComment:n=>Ui.createComment(n),setText:(n,t)=>{n.nodeValue=t},setElementText:(n,t)=>{n.textContent=t},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Ui.querySelector(n),setScopeId(n,t){n.setAttribute(t,"")},insertStaticContent(n,t,e,i,s,o){const r=e?e.previousSibling:t.lastChild;if(s&&(s===o||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),e),!(s===o||!(s=s.nextSibling)););else{zw.innerHTML=i==="svg"?`<svg>${n}</svg>`:i==="mathml"?`<math>${n}</math>`:n;const a=zw.content;if(i==="svg"||i==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}t.insertBefore(a,e)}return[r?r.nextSibling:t.firstChild,e?e.previousSibling:t.lastChild]}},bs="transition",ga="animation",Mr=Symbol("_vtc"),Yg=(n,{slots:t})=>Ak(EC,Pk(n),t);Yg.displayName="Transition";const Ik={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},D4=Yg.props=ot({},zg,Ik),to=(n,t=[])=>{Y(n)?n.forEach(e=>e(...t)):n&&n(...t)},Uw=n=>n?Y(n)?n.some(t=>t.length>1):n.length>1:!1;function Pk(n){const t={};for(const H in n)H in Ik||(t[H]=n[H]);if(n.css===!1)return t;const{name:e="v",type:i,duration:s,enterFromClass:o=`${e}-enter-from`,enterActiveClass:r=`${e}-enter-active`,enterToClass:a=`${e}-enter-to`,appearFromClass:l=o,appearActiveClass:c=r,appearToClass:u=a,leaveFromClass:d=`${e}-leave-from`,leaveActiveClass:f=`${e}-leave-active`,leaveToClass:m=`${e}-leave-to`}=n,g=$4(s),p=g&&g[0],w=g&&g[1],{onBeforeEnter:v,onEnter:_,onEnterCancelled:y,onLeave:E,onLeaveCancelled:x,onBeforeAppear:S=v,onAppear:R=_,onAppearCancelled:V=y}=t,P=(H,le,Re)=>{_s(H,le?u:a),_s(H,le?c:r),Re&&Re()},B=(H,le)=>{H._isLeaving=!1,_s(H,d),_s(H,m),_s(H,f),le&&le()},J=H=>(le,Re)=>{const $e=H?R:_,ee=()=>P(le,H,Re);to($e,[le,ee]),Ww(()=>{_s(le,H?l:o),$i(le,H?u:a),Uw($e)||qw(le,i,p,ee)})};return ot(t,{onBeforeEnter(H){to(v,[H]),$i(H,o),$i(H,r)},onBeforeAppear(H){to(S,[H]),$i(H,l),$i(H,c)},onEnter:J(!1),onAppear:J(!0),onLeave(H,le){H._isLeaving=!0;const Re=()=>B(H,le);$i(H,d),$i(H,f),Lk(),Ww(()=>{H._isLeaving&&(_s(H,d),$i(H,m),Uw(E)||qw(H,i,w,Re))}),to(E,[H,Re])},onEnterCancelled(H){P(H,!1),to(y,[H])},onAppearCancelled(H){P(H,!0),to(V,[H])},onLeaveCancelled(H){B(H),to(x,[H])}})}function $4(n){if(n==null)return null;if(Ue(n))return[Xh(n.enter),Xh(n.leave)];{const t=Xh(n);return[t,t]}}function Xh(n){return Eu(n)}function $i(n,t){t.split(/\s+/).forEach(e=>e&&n.classList.add(e)),(n[Mr]||(n[Mr]=new Set)).add(t)}function _s(n,t){t.split(/\s+/).forEach(i=>i&&n.classList.remove(i));const e=n[Mr];e&&(e.delete(t),e.size||(n[Mr]=void 0))}function Ww(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let H4=0;function qw(n,t,e,i){const s=n._endId=++H4,o=()=>{s===n._endId&&i()};if(e)return setTimeout(o,e);const{type:r,timeout:a,propCount:l}=Rk(n,t);if(!r)return i();const c=r+"end";let u=0;const d=()=>{n.removeEventListener(c,f),o()},f=m=>{m.target===n&&++u>=l&&d()};setTimeout(()=>{u<l&&d()},a+1),n.addEventListener(c,f)}function Rk(n,t){const e=window.getComputedStyle(n),i=g=>(e[g]||"").split(", "),s=i(`${bs}Delay`),o=i(`${bs}Duration`),r=jw(s,o),a=i(`${ga}Delay`),l=i(`${ga}Duration`),c=jw(a,l);let u=null,d=0,f=0;t===bs?r>0&&(u=bs,d=r,f=o.length):t===ga?c>0&&(u=ga,d=c,f=l.length):(d=Math.max(r,c),u=d>0?r>c?bs:ga:null,f=u?u===bs?o.length:l.length:0);const m=u===bs&&/\b(transform|all)(,|$)/.test(i(`${bs}Property`).toString());return{type:u,timeout:d,propCount:f,hasTransform:m}}function jw(n,t){for(;n.length<t.length;)n=n.concat(n);return Math.max(...t.map((e,i)=>Gw(e)+Gw(n[i])))}function Gw(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function Lk(){return document.body.offsetHeight}function z4(n,t,e){const i=n[Mr];i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?n.removeAttribute("class"):e?n.setAttribute("class",t):n.className=t}const Mu=Symbol("_vod"),Vk=Symbol("_vsh"),Bk={beforeMount(n,{value:t},{transition:e}){n[Mu]=n.style.display==="none"?"":n.style.display,e&&t?e.beforeEnter(n):pa(n,t)},mounted(n,{value:t},{transition:e}){e&&t&&e.enter(n)},updated(n,{value:t,oldValue:e},{transition:i}){!t!=!e&&(i?t?(i.beforeEnter(n),pa(n,!0),i.enter(n)):i.leave(n,()=>{pa(n,!1)}):pa(n,t))},beforeUnmount(n,{value:t}){pa(n,t)}};function pa(n,t){n.style.display=t?n[Mu]:"none",n[Vk]=!t}function U4(){Bk.getSSRProps=({value:n})=>{if(!n)return{style:{display:"none"}}}}const Mk=Symbol("");function W4(n){const t=rs();if(!t)return;const e=t.ut=(s=n(t.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${t.uid}"]`)).forEach(o=>fm(o,s))},i=()=>{const s=n(t.proxy);hm(t.subTree,s),e(s)};Ul(()=>{ak(i);const s=new MutationObserver(i);s.observe(t.subTree.el.parentNode,{childList:!0}),zd(()=>s.disconnect())})}function hm(n,t){if(n.shapeFlag&128){const e=n.suspense;n=e.activeBranch,e.pendingBranch&&!e.isHydrating&&e.effects.push(()=>{hm(e.activeBranch,t)})}for(;n.component;)n=n.component.subTree;if(n.shapeFlag&1&&n.el)fm(n.el,t);else if(n.type===It)n.children.forEach(e=>hm(e,t));else if(n.type===bo){let{el:e,anchor:i}=n;for(;e&&(fm(e,t),e!==i);)e=e.nextSibling}}function fm(n,t){if(n.nodeType===1){const e=n.style;let i="";for(const s in t)e.setProperty(`--${s}`,t[s]),i+=`--${s}: ${t[s]};`;e[Mk]=i}}const q4=/(^|;)\s*display\s*:/;function j4(n,t,e){const i=n.style,s=st(e);let o=!1;if(e&&!s){if(t)if(st(t))for(const r of t.split(";")){const a=r.slice(0,r.indexOf(":")).trim();e[a]==null&&uu(i,a,"")}else for(const r in t)e[r]==null&&uu(i,r,"");for(const r in e)r==="display"&&(o=!0),uu(i,r,e[r])}else if(s){if(t!==e){const r=i[Mk];r&&(e+=";"+r),i.cssText=e,o=q4.test(e)}}else t&&n.removeAttribute("style");Mu in n&&(n[Mu]=o?i.display:"",n[Vk]&&(i.display="none"))}const Kw=/\s*!important$/;function uu(n,t,e){if(Y(e))e.forEach(i=>uu(n,t,i));else if(e==null&&(e=""),t.startsWith("--"))n.setProperty(t,e);else{const i=G4(n,t);Kw.test(e)?n.setProperty(un(i),e.replace(Kw,""),"important"):n[i]=e}}const Zw=["Webkit","Moz","ms"],Qh={};function G4(n,t){const e=Qh[t];if(e)return e;let i=Wt(t);if(i!=="filter"&&i in n)return Qh[t]=i;i=Dl(i);for(let s=0;s<Zw.length;s++){const o=Zw[s]+i;if(o in n)return Qh[t]=o}return t}const Jw="http://www.w3.org/1999/xlink";function Yw(n,t,e,i,s,o=c3(t)){i&&t.startsWith("xlink:")?e==null?n.removeAttributeNS(Jw,t.slice(6,t.length)):n.setAttributeNS(Jw,t,e):e==null||o&&!Jy(e)?n.removeAttribute(t):n.setAttribute(t,o?"":xi(e)?String(e):e)}function K4(n,t,e,i){if(t==="innerHTML"||t==="textContent"){if(e==null)return;n[t]=e;return}const s=n.tagName;if(t==="value"&&s!=="PROGRESS"&&!s.includes("-")){const r=s==="OPTION"?n.getAttribute("value")||"":n.value,a=e==null?"":String(e);(r!==a||!("_value"in n))&&(n.value=a),e==null&&n.removeAttribute(t),n._value=e;return}let o=!1;if(e===""||e==null){const r=typeof n[t];r==="boolean"?e=Jy(e):e==null&&r==="string"?(e="",o=!0):r==="number"&&(e=0,o=!0)}try{n[t]=e}catch{}o&&n.removeAttribute(t)}function qi(n,t,e,i){n.addEventListener(t,e,i)}function Z4(n,t,e,i){n.removeEventListener(t,e,i)}const Xw=Symbol("_vei");function J4(n,t,e,i,s=null){const o=n[Xw]||(n[Xw]={}),r=o[t];if(i&&r)r.value=i;else{const[a,l]=Y4(t);if(i){const c=o[t]=eV(i,s);qi(n,a,c,l)}else r&&(Z4(n,a,r,l),o[t]=void 0)}}const Qw=/(?:Once|Passive|Capture)$/;function Y4(n){let t;if(Qw.test(n)){t={};let i;for(;i=n.match(Qw);)n=n.slice(0,n.length-i[0].length),t[i[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):un(n.slice(2)),t]}let ef=0;const X4=Promise.resolve(),Q4=()=>ef||(X4.then(()=>ef=0),ef=Date.now());function eV(n,t){const e=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=e.attached)return;Vn(tV(i,e.value),t,5,[i])};return e.value=n,e.attached=Q4(),e}function tV(n,t){if(Y(t)){const e=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{e.call(n),n._stopped=!0},t.map(i=>s=>!s._stopped&&i&&i(s))}else return t}const e1=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,nV=(n,t,e,i,s,o)=>{const r=s==="svg";t==="class"?z4(n,i,r):t==="style"?j4(n,e,i):Fl(t)?Tg(t)||J4(n,t,e,i,o):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):iV(n,t,i,r))?(K4(n,t,i),!n.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&Yw(n,t,i,r,o,t!=="value")):(t==="true-value"?n._trueValue=i:t==="false-value"&&(n._falseValue=i),Yw(n,t,i,r))};function iV(n,t,e,i){if(i)return!!(t==="innerHTML"||t==="textContent"||t in n&&e1(t)&&ce(e));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&n.tagName==="INPUT"||t==="type"&&n.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return e1(t)&&st(e)?!1:t in n}/*! #__NO_SIDE_EFFECTS__ */function Ok(n,t,e){const i=Ug(n,t);class s extends Gd{constructor(r){super(i,r,e)}}return s.def=i,s}/*! #__NO_SIDE_EFFECTS__ */const sV=(n,t)=>Ok(n,t,Gk),oV=typeof HTMLElement<"u"?HTMLElement:class{};class Gd extends oV{constructor(t,e={},i){super(),this._def=t,this._props=e,this._instance=null,this._connected=!1,this._resolved=!1,this._numberProps=null,this._ob=null,this.shadowRoot&&i?i(this._createVNode(),this.shadowRoot):(this.attachShadow({mode:"open"}),this._def.__asyncLoader||this._resolveProps(this._def))}connectedCallback(){this._connected=!0,this._instance||(this._resolved?this._update():this._resolveDef())}disconnectedCallback(){this._connected=!1,Md(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),mm(null,this.shadowRoot),this._instance=null)})}_resolveDef(){this._resolved=!0;for(let i=0;i<this.attributes.length;i++)this._setAttr(this.attributes[i].name);this._ob=new MutationObserver(i=>{for(const s of i)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const t=(i,s=!1)=>{const{props:o,styles:r}=i;let a;if(o&&!Y(o))for(const l in o){const c=o[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=Eu(this._props[l])),(a||(a=Object.create(null)))[Wt(l)]=!0)}this._numberProps=a,s&&this._resolveProps(i),this._applyStyles(r),this._update()},e=this._def.__asyncLoader;e?e().then(i=>t(i,!0)):t(this._def)}_resolveProps(t){const{props:e}=t,i=Y(e)?e:Object.keys(e||{});for(const s of Object.keys(this))s[0]!=="_"&&i.includes(s)&&this._setProp(s,this[s],!0,!1);for(const s of i.map(Wt))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(o){this._setProp(s,o)}})}_setAttr(t){let e=this.hasAttribute(t)?this.getAttribute(t):void 0;const i=Wt(t);this._numberProps&&this._numberProps[i]&&(e=Eu(e)),this._setProp(i,e,!1)}_getProp(t){return this._props[t]}_setProp(t,e,i=!0,s=!0){e!==this._props[t]&&(this._props[t]=e,s&&this._instance&&this._update(),i&&(e===!0?this.setAttribute(un(t),""):typeof e=="string"||typeof e=="number"?this.setAttribute(un(t),e+""):e||this.removeAttribute(un(t))))}_update(){mm(this._createVNode(),this.shadowRoot)}_createVNode(){const t=qe(this._def,ot({},this._props));return this._instance||(t.ce=e=>{this._instance=e,e.isCE=!0;const i=(o,r)=>{this.dispatchEvent(new CustomEvent(o,{detail:r}))};e.emit=(o,...r)=>{i(o,r),un(o)!==o&&i(un(o),r)};let s=this;for(;s=s&&(s.parentNode||s.host);)if(s instanceof Gd){e.parent=s._instance,e.provides=s._instance.provides;break}}),t}_applyStyles(t){t&&t.forEach(e=>{const i=document.createElement("style");i.textContent=e,this.shadowRoot.appendChild(i)})}}function rV(n="$style"){{const t=rs();if(!t)return Le;const e=t.type.__cssModules;if(!e)return Le;const i=e[n];return i||Le}}const Nk=new WeakMap,Fk=new WeakMap,Ou=Symbol("_moveCb"),t1=Symbol("_enterCb"),Dk={name:"TransitionGroup",props:ot({},D4,{tag:String,moveClass:String}),setup(n,{slots:t}){const e=rs(),i=Hg();let s,o;return $d(()=>{if(!s.length)return;const r=n.moveClass||`${n.name||"v"}-move`;if(!hV(s[0].el,e.vnode.el,r))return;s.forEach(cV),s.forEach(uV);const a=s.filter(dV);Lk(),a.forEach(l=>{const c=l.el,u=c.style;$i(c,r),u.transform=u.webkitTransform=u.transitionDuration="";const d=c[Ou]=f=>{f&&f.target!==c||(!f||/transform$/.test(f.propertyName))&&(c.removeEventListener("transitionend",d),c[Ou]=null,_s(c,r))};c.addEventListener("transitionend",d)})}),()=>{const r=Ae(n),a=Pk(r);let l=r.tag||It;if(s=[],o)for(let c=0;c<o.length;c++){const u=o[c];u.el&&u.el instanceof Element&&(s.push(u),Ls(u,Br(u,a,i,e)),Nk.set(u,u.el.getBoundingClientRect()))}o=t.default?Fd(t.default()):[];for(let c=0;c<o.length;c++){const u=o[c];u.key!=null&&Ls(u,Br(u,a,i,e))}return qe(l,null,o)}}},aV=n=>delete n.mode;Dk.props;const lV=Dk;function cV(n){const t=n.el;t[Ou]&&t[Ou](),t[t1]&&t[t1]()}function uV(n){Fk.set(n,n.el.getBoundingClientRect())}function dV(n){const t=Nk.get(n),e=Fk.get(n),i=t.left-e.left,s=t.top-e.top;if(i||s){const o=n.el.style;return o.transform=o.webkitTransform=`translate(${i}px,${s}px)`,o.transitionDuration="0s",n}}function hV(n,t,e){const i=n.cloneNode(),s=n[Mr];s&&s.forEach(a=>{a.split(/\s+/).forEach(l=>l&&i.classList.remove(l))}),e.split(/\s+/).forEach(a=>a&&i.classList.add(a)),i.style.display="none";const o=t.nodeType===1?t:t.parentNode;o.appendChild(i);const{hasTransform:r}=Rk(i);return o.removeChild(i),r}const Ms=n=>{const t=n.props["onUpdate:modelValue"]||!1;return Y(t)?e=>Er(t,e):t};function fV(n){n.target.composing=!0}function n1(n){const t=n.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Gn=Symbol("_assign"),Nu={created(n,{modifiers:{lazy:t,trim:e,number:i}},s){n[Gn]=Ms(s);const o=i||s.props&&s.props.type==="number";qi(n,t?"change":"input",r=>{if(r.target.composing)return;let a=n.value;e&&(a=a.trim()),o&&(a=Tu(a)),n[Gn](a)}),e&&qi(n,"change",()=>{n.value=n.value.trim()}),t||(qi(n,"compositionstart",fV),qi(n,"compositionend",n1),qi(n,"change",n1))},mounted(n,{value:t}){n.value=t??""},beforeUpdate(n,{value:t,oldValue:e,modifiers:{lazy:i,trim:s,number:o}},r){if(n[Gn]=Ms(r),n.composing)return;const a=(o||n.type==="number")&&!/^0\d/.test(n.value)?Tu(n.value):n.value,l=t??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(i&&t===e||s&&n.value.trim()===l)||(n.value=l))}},Xg={deep:!0,created(n,t,e){n[Gn]=Ms(e),qi(n,"change",()=>{const i=n._modelValue,s=Or(n),o=n.checked,r=n[Gn];if(Y(i)){const a=Pd(i,s),l=a!==-1;if(o&&!l)r(i.concat(s));else if(!o&&l){const c=[...i];c.splice(a,1),r(c)}}else if(Vo(i)){const a=new Set(i);o?a.add(s):a.delete(s),r(a)}else r(Hk(n,o))})},mounted:i1,beforeUpdate(n,t,e){n[Gn]=Ms(e),i1(n,t,e)}};function i1(n,{value:t,oldValue:e},i){n._modelValue=t,Y(t)?n.checked=Pd(t,i.props.value)>-1:Vo(t)?n.checked=t.has(i.props.value):t!==e&&(n.checked=Ps(t,Hk(n,!0)))}const Qg={created(n,{value:t},e){n.checked=Ps(t,e.props.value),n[Gn]=Ms(e),qi(n,"change",()=>{n[Gn](Or(n))})},beforeUpdate(n,{value:t,oldValue:e},i){n[Gn]=Ms(i),t!==e&&(n.checked=Ps(t,i.props.value))}},$k={deep:!0,created(n,{value:t,modifiers:{number:e}},i){const s=Vo(t);qi(n,"change",()=>{const o=Array.prototype.filter.call(n.options,r=>r.selected).map(r=>e?Tu(Or(r)):Or(r));n[Gn](n.multiple?s?new Set(o):o:o[0]),n._assigning=!0,Md(()=>{n._assigning=!1})}),n[Gn]=Ms(i)},mounted(n,{value:t,modifiers:{number:e}}){s1(n,t)},beforeUpdate(n,t,e){n[Gn]=Ms(e)},updated(n,{value:t,modifiers:{number:e}}){n._assigning||s1(n,t)}};function s1(n,t,e){const i=n.multiple,s=Y(t);if(!(i&&!s&&!Vo(t))){for(let o=0,r=n.options.length;o<r;o++){const a=n.options[o],l=Or(a);if(i)if(s){const c=typeof l;c==="string"||c==="number"?a.selected=t.some(u=>String(u)===String(l)):a.selected=Pd(t,l)>-1}else a.selected=t.has(l);else if(Ps(Or(a),t)){n.selectedIndex!==o&&(n.selectedIndex=o);return}}!i&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function Or(n){return"_value"in n?n._value:n.value}function Hk(n,t){const e=t?"_trueValue":"_falseValue";return e in n?n[e]:t}const zk={created(n,t,e){Rc(n,t,e,null,"created")},mounted(n,t,e){Rc(n,t,e,null,"mounted")},beforeUpdate(n,t,e,i){Rc(n,t,e,i,"beforeUpdate")},updated(n,t,e,i){Rc(n,t,e,i,"updated")}};function Uk(n,t){switch(n){case"SELECT":return $k;case"TEXTAREA":return Nu;default:switch(t){case"checkbox":return Xg;case"radio":return Qg;default:return Nu}}}function Rc(n,t,e,i,s){const r=Uk(n.tagName,e.props&&e.props.type)[s];r&&r(n,t,e,i)}function mV(){Nu.getSSRProps=({value:n})=>({value:n}),Qg.getSSRProps=({value:n},t)=>{if(t.props&&Ps(t.props.value,n))return{checked:!0}},Xg.getSSRProps=({value:n},t)=>{if(Y(n)){if(t.props&&Pd(n,t.props.value)>-1)return{checked:!0}}else if(Vo(n)){if(t.props&&n.has(t.props.value))return{checked:!0}}else if(n)return{checked:!0}},zk.getSSRProps=(n,t)=>{if(typeof t.type!="string")return;const e=Uk(t.type.toUpperCase(),t.props&&t.props.type);if(e.getSSRProps)return e.getSSRProps(n,t)}}const gV=["ctrl","shift","alt","meta"],pV={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,t)=>gV.some(e=>n[`${e}Key`]&&!t.includes(e))},bV=(n,t)=>{const e=n._withMods||(n._withMods={}),i=t.join(".");return e[i]||(e[i]=(s,...o)=>{for(let r=0;r<t.length;r++){const a=pV[t[r]];if(a&&a(s,t))return}return n(s,...o)})},wV={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},_V=(n,t)=>{const e=n._withKeys||(n._withKeys={}),i=t.join(".");return e[i]||(e[i]=s=>{if(!("key"in s))return;const o=un(s.key);if(t.some(r=>r===o||wV[r]===o))return n(s)})},Wk=ot({patchProp:nV},F4);let Ua,o1=!1;function qk(){return Ua||(Ua=ek(Wk))}function jk(){return Ua=o1?Ua:tk(Wk),o1=!0,Ua}const mm=(...n)=>{qk().render(...n)},Gk=(...n)=>{jk().hydrate(...n)},Kk=(...n)=>{const t=qk().createApp(...n),{mount:e}=t;return t.mount=i=>{const s=Jk(i);if(!s)return;const o=t._component;!ce(o)&&!o.render&&!o.template&&(o.template=s.innerHTML),s.innerHTML="";const r=e(s,!1,Zk(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),r},t},vV=(...n)=>{const t=jk().createApp(...n),{mount:e}=t;return t.mount=i=>{const s=Jk(i);if(s)return e(s,!0,Zk(s))},t};function Zk(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function Jk(n){return st(n)?document.querySelector(n):n}let r1=!1;const yV=()=>{r1||(r1=!0,mV(),U4())};/**
* vue v3.4.35
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const CV=()=>{},kV=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:EC,BaseTransitionPropsValidators:zg,Comment:Pt,DeprecationTypes:M4,EffectScope:Ig,ErrorCodes:J3,ErrorTypeStrings:S4,Fragment:It,KeepAlive:cL,ReactiveEffect:Vr,Static:bo,Suspense:c4,Teleport:ZL,Text:Ss,TrackOpTypes:G3,Transition:Yg,TransitionGroup:lV,TriggerOpTypes:K3,VueElement:Gd,assertNumber:Z3,callWithAsyncErrorHandling:Vn,callWithErrorHandling:Ki,camelize:Wt,capitalize:Dl,cloneVNode:Si,compatUtils:B4,compile:CV,computed:Ek,createApp:Kk,createBlock:qd,createCommentVNode:wk,createElementBlock:Wd,createElementVNode:Is,createHydrationRenderer:tk,createPropsRestProxy:PL,createRenderer:ek,createSSRApp:vV,createSlots:gL,createStaticVNode:b4,createTextVNode:jd,createVNode:qe,customRef:wC,defineAsyncComponent:aL,defineComponent:Ug,defineCustomElement:Ok,defineEmits:vL,defineExpose:yL,defineModel:TL,defineOptions:CL,defineProps:_L,defineSSRCustomElement:sV,defineSlots:kL,devtools:I4,effect:m3,effectScope:d3,getCurrentInstance:rs,getCurrentScope:eC,getTransitionRawChildren:Fd,guardReactiveProps:bk,h:Ak,handleError:Bo,hasInjectionContext:DL,hydrate:Gk,initCustomFormatter:E4,initDirectivesForSSR:yV,inject:Da,isMemoSame:xk,isProxy:Bg,isReactive:go,isReadonly:Rs,isRef:Nt,isRuntimeOnly:C4,isShallow:ko,isVNode:Bs,markRaw:gC,mergeDefaults:SL,mergeModels:IL,mergeProps:_k,nextTick:Md,normalizeClass:Hl,normalizeProps:a3,normalizeStyle:$l,onActivated:xC,onBeforeMount:PC,onBeforeUnmount:Hd,onBeforeUpdate:RC,onDeactivated:SC,onErrorCaptured:MC,onMounted:Ul,onRenderTracked:BC,onRenderTriggered:VC,onScopeDispose:h3,onServerPrefetch:LC,onUnmounted:zd,onUpdated:$d,openBlock:Vs,popScopeId:iL,provide:HC,proxyRefs:Fg,pushScopeId:nL,queuePostFlushCb:xu,reactive:Vd,readonly:Vg,ref:Na,registerRuntimeCompiler:y4,render:mm,renderList:mL,renderSlot:pL,resolveComponent:Iu,resolveDirective:fL,resolveDynamicComponent:hL,resolveFilter:V4,resolveTransitionHooks:Br,setBlockTracking:rm,setDevtoolsHook:P4,setTransitionHooks:Ls,shallowReactive:mC,shallowReadonly:M3,shallowRef:N3,ssrContextKey:ok,ssrUtils:L4,stop:g3,toDisplayString:Sg,toHandlerKey:Oa,toHandlers:bL,toRaw:Ae,toRef:j3,toRefs:U3,toValue:$3,transformVNodeArgs:g4,triggerRef:D3,unref:Ng,useAttrs:xL,useCssModule:rV,useCssVars:W4,useModel:n4,useSSRContext:rk,useSlots:AL,useTransitionState:Hg,vModelCheckbox:Xg,vModelDynamic:zk,vModelRadio:Qg,vModelSelect:$k,vModelText:Nu,vShow:Bk,version:Sk,warn:x4,watch:Ha,watchEffect:e4,watchPostEffect:ak,watchSyncEffect:lk,withAsyncContext:RL,withCtx:$g,withDefaults:EL,withDirectives:oL,withKeys:_V,withMemo:A4,withModifiers:bV,withScopeId:sL},Symbol.toStringTag,{value:"Module"}));var Yk=typeof global=="object"&&global&&global.Object===Object&&global,TV=typeof self=="object"&&self&&self.Object===Object&&self,Bt=Yk||TV||Function("return this")(),qt=Bt.Symbol,Xk=Object.prototype,EV=Xk.hasOwnProperty,AV=Xk.toString,ba=qt?qt.toStringTag:void 0;function xV(n){var t=EV.call(n,ba),e=n[ba];try{n[ba]=void 0;var i=!0}catch{}var s=AV.call(n);return i&&(t?n[ba]=e:delete n[ba]),s}var SV=Object.prototype,IV=SV.toString;function PV(n){return IV.call(n)}var RV="[object Null]",LV="[object Undefined]",a1=qt?qt.toStringTag:void 0;function en(n){return n==null?n===void 0?LV:RV:a1&&a1 in Object(n)?xV(n):PV(n)}function rt(n){return n!=null&&typeof n=="object"}var VV="[object Symbol]";function _n(n){return typeof n=="symbol"||rt(n)&&en(n)==VV}var BV=NaN;function l1(n){return typeof n=="number"?n:_n(n)?BV:+n}function it(n,t){for(var e=-1,i=n==null?0:n.length,s=Array(i);++e<i;)s[e]=t(n[e],e,n);return s}var me=Array.isArray,MV=1/0,c1=qt?qt.prototype:void 0,u1=c1?c1.toString:void 0;function Mn(n){if(typeof n=="string")return n;if(me(n))return it(n,Mn)+"";if(_n(n))return u1?u1.call(n):"";var t=n+"";return t=="0"&&1/n==-MV?"-0":t}function Kd(n,t){return function(e,i){var s;if(e===void 0&&i===void 0)return t;if(e!==void 0&&(s=e),i!==void 0){if(s===void 0)return i;typeof e=="string"||typeof i=="string"?(e=Mn(e),i=Mn(i)):(e=l1(e),i=l1(i)),s=n(e,i)}return s}}var OV=Kd(function(n,t){return n+t},0);const Qk=OV;var NV=/\s/;function eT(n){for(var t=n.length;t--&&NV.test(n.charAt(t)););return t}var FV=/^\s+/;function tT(n){return n&&n.slice(0,eT(n)+1).replace(FV,"")}function Ce(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")}var d1=NaN,DV=/^[-+]0x[0-9a-f]+$/i,$V=/^0b[01]+$/i,HV=/^0o[0-7]+$/i,zV=parseInt;function Bn(n){if(typeof n=="number")return n;if(_n(n))return d1;if(Ce(n)){var t=typeof n.valueOf=="function"?n.valueOf():n;n=Ce(t)?t+"":t}if(typeof n!="string")return n===0?n:+n;n=tT(n);var e=$V.test(n);return e||HV.test(n)?zV(n.slice(2),e?2:8):DV.test(n)?d1:+n}var h1=1/0,UV=17976931348623157e292;function Ti(n){if(!n)return n===0?n:0;if(n=Bn(n),n===h1||n===-h1){var t=n<0?-1:1;return t*UV}return n===n?n:0}function be(n){var t=Ti(n),e=t%1;return t===t?e?t-e:t:0}var WV="Expected a function";function nT(n,t){if(typeof t!="function")throw new TypeError(WV);return n=be(n),function(){if(--n<1)return t.apply(this,arguments)}}function ft(n){return n}var qV="[object AsyncFunction]",jV="[object Function]",GV="[object GeneratorFunction]",KV="[object Proxy]";function vn(n){if(!Ce(n))return!1;var t=en(n);return t==jV||t==GV||t==qV||t==KV}var du=Bt["__core-js_shared__"],f1=function(){var n=/[^.]+$/.exec(du&&du.keys&&du.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function ZV(n){return!!f1&&f1 in n}var JV=Function.prototype,YV=JV.toString;function Mo(n){if(n!=null){try{return YV.call(n)}catch{}try{return n+""}catch{}}return""}var XV=/[\\^$.*+?()[\]{}|]/g,QV=/^\[object .+?Constructor\]$/,eB=Function.prototype,tB=Object.prototype,nB=eB.toString,iB=tB.hasOwnProperty,sB=RegExp("^"+nB.call(iB).replace(XV,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function iT(n){if(!Ce(n)||ZV(n))return!1;var t=vn(n)?sB:QV;return t.test(Mo(n))}function oB(n,t){return n==null?void 0:n[t]}function Oo(n,t){var e=oB(n,t);return iT(e)?e:void 0}var fl=Oo(Bt,"WeakMap"),Fu=fl&&new fl,sT=Fu?function(n,t){return Fu.set(n,t),n}:ft,m1=Object.create,Jr=function(){function n(){}return function(t){if(!Ce(t))return{};if(m1)return m1(t);n.prototype=t;var e=new n;return n.prototype=void 0,e}}();function ml(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var e=Jr(n.prototype),i=n.apply(e,t);return Ce(i)?i:e}}var rB=1;function aB(n,t,e){var i=t&rB,s=ml(n);function o(){var r=this&&this!==Bt&&this instanceof o?s:n;return r.apply(i?e:this,arguments)}return o}function On(n,t,e){switch(e.length){case 0:return n.call(t);case 1:return n.call(t,e[0]);case 2:return n.call(t,e[0],e[1]);case 3:return n.call(t,e[0],e[1],e[2])}return n.apply(t,e)}var lB=Math.max;function oT(n,t,e,i){for(var s=-1,o=n.length,r=e.length,a=-1,l=t.length,c=lB(o-r,0),u=Array(l+c),d=!i;++a<l;)u[a]=t[a];for(;++s<r;)(d||s<o)&&(u[e[s]]=n[s]);for(;c--;)u[a++]=n[s++];return u}var cB=Math.max;function rT(n,t,e,i){for(var s=-1,o=n.length,r=-1,a=e.length,l=-1,c=t.length,u=cB(o-a,0),d=Array(u+c),f=!i;++s<u;)d[s]=n[s];for(var m=s;++l<c;)d[m+l]=t[l];for(;++r<a;)(f||s<o)&&(d[m+e[r]]=n[s++]);return d}function uB(n,t){for(var e=n.length,i=0;e--;)n[e]===t&&++i;return i}function Zd(){}var dB=4294967295;function Ee(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=dB,this.__views__=[]}Ee.prototype=Jr(Zd.prototype);Ee.prototype.constructor=Ee;function Jd(){}var ep=Fu?function(n){return Fu.get(n)}:Jd,Pr={},hB=Object.prototype,fB=hB.hasOwnProperty;function hu(n){for(var t=n.name+"",e=Pr[t],i=fB.call(Pr,t)?e.length:0;i--;){var s=e[i],o=s.func;if(o==null||o==n)return s.name}return t}function Jn(n,t){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}Jn.prototype=Jr(Zd.prototype);Jn.prototype.constructor=Jn;function mn(n,t){var e=-1,i=n.length;for(t||(t=Array(i));++e<i;)t[e]=n[e];return t}function aT(n){if(n instanceof Ee)return n.clone();var t=new Jn(n.__wrapped__,n.__chain__);return t.__actions__=mn(n.__actions__),t.__index__=n.__index__,t.__values__=n.__values__,t}var mB=Object.prototype,gB=mB.hasOwnProperty;function b(n){if(rt(n)&&!me(n)&&!(n instanceof Ee)){if(n instanceof Jn)return n;if(gB.call(n,"__wrapped__"))return aT(n)}return new Jn(n)}b.prototype=Zd.prototype;b.prototype.constructor=b;function gm(n){var t=hu(n),e=b[t];if(typeof e!="function"||!(t in Ee.prototype))return!1;if(n===e)return!0;var i=ep(e);return!!i&&n===i[0]}var pB=800,bB=16,wB=Date.now;function lT(n){var t=0,e=0;return function(){var i=wB(),s=bB-(i-e);if(e=i,s>0){if(++t>=pB)return arguments[0]}else t=0;return n.apply(void 0,arguments)}}var cT=lT(sT),_B=/\{\n\/\* \[wrapped with (.+)\] \*/,vB=/,? & /;function yB(n){var t=n.match(_B);return t?t[1].split(vB):[]}var CB=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function kB(n,t){var e=t.length;if(!e)return n;var i=e-1;return t[i]=(e>1?"& ":"")+t[i],t=t.join(e>2?", ":" "),n.replace(CB,`{
/* [wrapped with `+t+`] */
`)}function Yd(n){return function(){return n}}var Du=function(){try{var n=Oo(Object,"defineProperty");return n({},"",{}),n}catch{}}(),TB=Du?function(n,t){return Du(n,"toString",{configurable:!0,enumerable:!1,value:Yd(t),writable:!0})}:ft,tp=lT(TB);function ei(n,t){for(var e=-1,i=n==null?0:n.length;++e<i&&t(n[e],e,n)!==!1;);return n}function Xd(n,t,e,i){for(var s=n.length,o=e+(i?1:-1);i?o--:++o<s;)if(t(n[o],o,n))return o;return-1}function uT(n){return n!==n}function EB(n,t,e){for(var i=e-1,s=n.length;++i<s;)if(n[i]===t)return i;return-1}function Yr(n,t,e){return t===t?EB(n,t,e):Xd(n,uT,e)}function Qd(n,t){var e=n==null?0:n.length;return!!e&&Yr(n,t,0)>-1}var AB=1,xB=2,SB=8,IB=16,PB=32,RB=64,LB=128,VB=256,BB=512,MB=[["ary",LB],["bind",AB],["bindKey",xB],["curry",SB],["curryRight",IB],["flip",BB],["partial",PB],["partialRight",RB],["rearg",VB]];function OB(n,t){return ei(MB,function(e){var i="_."+e[0];t&e[1]&&!Qd(n,i)&&n.push(i)}),n.sort()}function dT(n,t,e){var i=t+"";return tp(n,kB(i,OB(yB(i),e)))}var NB=1,FB=2,DB=4,$B=8,g1=32,p1=64;function hT(n,t,e,i,s,o,r,a,l,c){var u=t&$B,d=u?r:void 0,f=u?void 0:r,m=u?o:void 0,g=u?void 0:o;t|=u?g1:p1,t&=~(u?p1:g1),t&DB||(t&=~(NB|FB));var p=[n,t,s,m,d,g,f,a,l,c],w=e.apply(void 0,p);return gm(n)&&cT(w,p),w.placeholder=i,dT(w,n,t)}function Xr(n){var t=n;return t.placeholder}var HB=9007199254740991,zB=/^(?:0|[1-9]\d*)$/;function as(n,t){var e=typeof n;return t=t??HB,!!t&&(e=="number"||e!="symbol"&&zB.test(n))&&n>-1&&n%1==0&&n<t}var UB=Math.min;function WB(n,t){for(var e=n.length,i=UB(t.length,e),s=mn(n);i--;){var o=t[i];n[i]=as(o,e)?s[o]:void 0}return n}var b1="__lodash_placeholder__";function Os(n,t){for(var e=-1,i=n.length,s=0,o=[];++e<i;){var r=n[e];(r===t||r===b1)&&(n[e]=b1,o[s++]=e)}return o}var qB=1,jB=2,GB=8,KB=16,ZB=128,JB=512;function eh(n,t,e,i,s,o,r,a,l,c){var u=t&ZB,d=t&qB,f=t&jB,m=t&(GB|KB),g=t&JB,p=f?void 0:ml(n);function w(){for(var v=arguments.length,_=Array(v),y=v;y--;)_[y]=arguments[y];if(m)var E=Xr(w),x=uB(_,E);if(i&&(_=oT(_,i,s,m)),o&&(_=rT(_,o,r,m)),v-=x,m&&v<c){var S=Os(_,E);return hT(n,t,eh,w.placeholder,e,_,S,a,l,c-v)}var R=d?e:this,V=f?R[n]:n;return v=_.length,a?_=WB(_,a):g&&v>1&&_.reverse(),u&&l<v&&(_.length=l),this&&this!==Bt&&this instanceof w&&(V=p||ml(V)),V.apply(R,_)}return w}function YB(n,t,e){var i=ml(n);function s(){for(var o=arguments.length,r=Array(o),a=o,l=Xr(s);a--;)r[a]=arguments[a];var c=o<3&&r[0]!==l&&r[o-1]!==l?[]:Os(r,l);if(o-=c.length,o<e)return hT(n,t,eh,s.placeholder,void 0,r,c,void 0,void 0,e-o);var u=this&&this!==Bt&&this instanceof s?i:n;return On(u,this,r)}return s}var XB=1;function QB(n,t,e,i){var s=t&XB,o=ml(n);function r(){for(var a=-1,l=arguments.length,c=-1,u=i.length,d=Array(u+l),f=this&&this!==Bt&&this instanceof r?o:n;++c<u;)d[c]=i[c];for(;l--;)d[c++]=arguments[++a];return On(f,s?e:this,d)}return r}var w1="__lodash_placeholder__",tf=1,eM=2,tM=4,_1=8,wa=128,v1=256,nM=Math.min;function iM(n,t){var e=n[1],i=t[1],s=e|i,o=s<(tf|eM|wa),r=i==wa&&e==_1||i==wa&&e==v1&&n[7].length<=t[8]||i==(wa|v1)&&t[7].length<=t[8]&&e==_1;if(!(o||r))return n;i&tf&&(n[2]=t[2],s|=e&tf?0:tM);var a=t[3];if(a){var l=n[3];n[3]=l?oT(l,a,t[4]):a,n[4]=l?Os(n[3],w1):t[4]}return a=t[5],a&&(l=n[5],n[5]=l?rT(l,a,t[6]):a,n[6]=l?Os(n[5],w1):t[6]),a=t[7],a&&(n[7]=a),i&wa&&(n[8]=n[8]==null?t[8]:nM(n[8],t[8])),n[9]==null&&(n[9]=t[9]),n[0]=t[0],n[1]=s,n}var sM="Expected a function",y1=1,oM=2,nf=8,sf=16,of=32,C1=64,k1=Math.max;function ls(n,t,e,i,s,o,r,a){var l=t&oM;if(!l&&typeof n!="function")throw new TypeError(sM);var c=i?i.length:0;if(c||(t&=~(of|C1),i=s=void 0),r=r===void 0?r:k1(be(r),0),a=a===void 0?a:be(a),c-=s?s.length:0,t&C1){var u=i,d=s;i=s=void 0}var f=l?void 0:ep(n),m=[n,t,e,i,s,u,d,o,r,a];if(f&&iM(m,f),n=m[0],t=m[1],e=m[2],i=m[3],s=m[4],a=m[9]=m[9]===void 0?l?0:n.length:k1(m[9]-c,0),!a&&t&(nf|sf)&&(t&=~(nf|sf)),!t||t==y1)var g=aB(n,t,e);else t==nf||t==sf?g=YB(n,t,a):(t==of||t==(y1|of))&&!s.length?g=QB(n,t,e,i):g=eh.apply(void 0,m);var p=f?sT:cT;return dT(p(g,m),n,t)}var rM=128;function np(n,t,e){return t=e?void 0:t,t=n&&t==null?n.length:t,ls(n,rM,void 0,void 0,void 0,void 0,t)}function cs(n,t,e){t=="__proto__"&&Du?Du(n,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):n[t]=e}function ti(n,t){return n===t||n!==n&&t!==t}var aM=Object.prototype,lM=aM.hasOwnProperty;function Gl(n,t,e){var i=n[t];(!(lM.call(n,t)&&ti(i,e))||e===void 0&&!(t in n))&&cs(n,t,e)}function Ri(n,t,e,i){var s=!e;e||(e={});for(var o=-1,r=t.length;++o<r;){var a=t[o],l=i?i(e[a],n[a],a,e,n):void 0;l===void 0&&(l=n[a]),s?cs(e,a,l):Gl(e,a,l)}return e}var T1=Math.max;function fT(n,t,e){return t=T1(t===void 0?n.length-1:t,0),function(){for(var i=arguments,s=-1,o=T1(i.length-t,0),r=Array(o);++s<o;)r[s]=i[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=i[s];return a[t]=e(r),On(n,this,a)}}function ve(n,t){return tp(fT(n,t,ft),n+"")}var cM=9007199254740991;function Kl(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=cM}function tn(n){return n!=null&&Kl(n.length)&&!vn(n)}function Xt(n,t,e){if(!Ce(e))return!1;var i=typeof t;return(i=="number"?tn(e)&&as(t,e.length):i=="string"&&t in e)?ti(e[t],n):!1}function Qr(n){return ve(function(t,e){var i=-1,s=e.length,o=s>1?e[s-1]:void 0,r=s>2?e[2]:void 0;for(o=n.length>3&&typeof o=="function"?(s--,o):void 0,r&&Xt(e[0],e[1],r)&&(o=s<3?void 0:o,s=1),t=Object(t);++i<s;){var a=e[i];a&&n(t,a,i,o)}return t})}var uM=Object.prototype;function Zl(n){var t=n&&n.constructor,e=typeof t=="function"&&t.prototype||uM;return n===e}function ip(n,t){for(var e=-1,i=Array(n);++e<n;)i[e]=t(e);return i}var dM="[object Arguments]";function E1(n){return rt(n)&&en(n)==dM}var mT=Object.prototype,hM=mT.hasOwnProperty,fM=mT.propertyIsEnumerable,Ns=E1(function(){return arguments}())?E1:function(n){return rt(n)&&hM.call(n,"callee")&&!fM.call(n,"callee")};function th(){return!1}var gT=typeof Rn=="object"&&Rn&&!Rn.nodeType&&Rn,A1=gT&&typeof Ln=="object"&&Ln&&!Ln.nodeType&&Ln,mM=A1&&A1.exports===gT,x1=mM?Bt.Buffer:void 0,gM=x1?x1.isBuffer:void 0,pM=gM||th;const Yi=pM;var bM="[object Arguments]",wM="[object Array]",_M="[object Boolean]",vM="[object Date]",yM="[object Error]",CM="[object Function]",kM="[object Map]",TM="[object Number]",EM="[object Object]",AM="[object RegExp]",xM="[object Set]",SM="[object String]",IM="[object WeakMap]",PM="[object ArrayBuffer]",RM="[object DataView]",LM="[object Float32Array]",VM="[object Float64Array]",BM="[object Int8Array]",MM="[object Int16Array]",OM="[object Int32Array]",NM="[object Uint8Array]",FM="[object Uint8ClampedArray]",DM="[object Uint16Array]",$M="[object Uint32Array]",Qe={};Qe[LM]=Qe[VM]=Qe[BM]=Qe[MM]=Qe[OM]=Qe[NM]=Qe[FM]=Qe[DM]=Qe[$M]=!0;Qe[bM]=Qe[wM]=Qe[PM]=Qe[_M]=Qe[RM]=Qe[vM]=Qe[yM]=Qe[CM]=Qe[kM]=Qe[TM]=Qe[EM]=Qe[AM]=Qe[xM]=Qe[SM]=Qe[IM]=!1;function HM(n){return rt(n)&&Kl(n.length)&&!!Qe[en(n)]}function Nn(n){return function(t){return n(t)}}var pT=typeof Rn=="object"&&Rn&&!Rn.nodeType&&Rn,Wa=pT&&typeof Ln=="object"&&Ln&&!Ln.nodeType&&Ln,zM=Wa&&Wa.exports===pT,rf=zM&&Yk.process,Yn=function(){try{var n=Wa&&Wa.require&&Wa.require("util").types;return n||rf&&rf.binding&&rf.binding("util")}catch{}}(),S1=Yn&&Yn.isTypedArray,UM=S1?Nn(S1):HM;const No=UM;var WM=Object.prototype,qM=WM.hasOwnProperty;function bT(n,t){var e=me(n),i=!e&&Ns(n),s=!e&&!i&&Yi(n),o=!e&&!i&&!s&&No(n),r=e||i||s||o,a=r?ip(n.length,String):[],l=a.length;for(var c in n)(t||qM.call(n,c))&&!(r&&(c=="length"||s&&(c=="offset"||c=="parent")||o&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||as(c,l)))&&a.push(c);return a}function wT(n,t){return function(e){return n(t(e))}}var jM=wT(Object.keys,Object),GM=Object.prototype,KM=GM.hasOwnProperty;function sp(n){if(!Zl(n))return jM(n);var t=[];for(var e in Object(n))KM.call(n,e)&&e!="constructor"&&t.push(e);return t}function _t(n){return tn(n)?bT(n):sp(n)}var ZM=Object.prototype,JM=ZM.hasOwnProperty,YM=Qr(function(n,t){if(Zl(t)||tn(t)){Ri(t,_t(t),n);return}for(var e in t)JM.call(t,e)&&Gl(n,e,t[e])});const _T=YM;function XM(n){var t=[];if(n!=null)for(var e in Object(n))t.push(e);return t}var QM=Object.prototype,e6=QM.hasOwnProperty;function t6(n){if(!Ce(n))return XM(n);var t=Zl(n),e=[];for(var i in n)i=="constructor"&&(t||!e6.call(n,i))||e.push(i);return e}function nn(n){return tn(n)?bT(n,!0):t6(n)}var Nr=Qr(function(n,t){Ri(t,nn(t),n)}),n6=Qr(function(n,t,e,i){Ri(t,nn(t),n,i)});const Fr=n6;var i6=Qr(function(n,t,e,i){Ri(t,_t(t),n,i)});const vT=i6;var s6=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o6=/^\w*$/;function op(n,t){if(me(n))return!1;var e=typeof n;return e=="number"||e=="symbol"||e=="boolean"||n==null||_n(n)?!0:o6.test(n)||!s6.test(n)||t!=null&&n in Object(t)}var gl=Oo(Object,"create");function r6(){this.__data__=gl?gl(null):{},this.size=0}function a6(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}var l6="__lodash_hash_undefined__",c6=Object.prototype,u6=c6.hasOwnProperty;function d6(n){var t=this.__data__;if(gl){var e=t[n];return e===l6?void 0:e}return u6.call(t,n)?t[n]:void 0}var h6=Object.prototype,f6=h6.hasOwnProperty;function m6(n){var t=this.__data__;return gl?t[n]!==void 0:f6.call(t,n)}var g6="__lodash_hash_undefined__";function p6(n,t){var e=this.__data__;return this.size+=this.has(n)?0:1,e[n]=gl&&t===void 0?g6:t,this}function Ao(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}Ao.prototype.clear=r6;Ao.prototype.delete=a6;Ao.prototype.get=d6;Ao.prototype.has=m6;Ao.prototype.set=p6;function b6(){this.__data__=[],this.size=0}function nh(n,t){for(var e=n.length;e--;)if(ti(n[e][0],t))return e;return-1}var w6=Array.prototype,_6=w6.splice;function v6(n){var t=this.__data__,e=nh(t,n);if(e<0)return!1;var i=t.length-1;return e==i?t.pop():_6.call(t,e,1),--this.size,!0}function y6(n){var t=this.__data__,e=nh(t,n);return e<0?void 0:t[e][1]}function C6(n){return nh(this.__data__,n)>-1}function k6(n,t){var e=this.__data__,i=nh(e,n);return i<0?(++this.size,e.push([n,t])):e[i][1]=t,this}function us(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}us.prototype.clear=b6;us.prototype.delete=v6;us.prototype.get=y6;us.prototype.has=C6;us.prototype.set=k6;var pl=Oo(Bt,"Map");function T6(){this.size=0,this.__data__={hash:new Ao,map:new(pl||us),string:new Ao}}function E6(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}function ih(n,t){var e=n.__data__;return E6(t)?e[typeof t=="string"?"string":"hash"]:e.map}function A6(n){var t=ih(this,n).delete(n);return this.size-=t?1:0,t}function x6(n){return ih(this,n).get(n)}function S6(n){return ih(this,n).has(n)}function I6(n,t){var e=ih(this,n),i=e.size;return e.set(n,t),this.size+=e.size==i?0:1,this}function ds(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}ds.prototype.clear=T6;ds.prototype.delete=A6;ds.prototype.get=x6;ds.prototype.has=S6;ds.prototype.set=I6;var P6="Expected a function";function Jl(n,t){if(typeof n!="function"||t!=null&&typeof t!="function")throw new TypeError(P6);var e=function(){var i=arguments,s=t?t.apply(this,i):i[0],o=e.cache;if(o.has(s))return o.get(s);var r=n.apply(this,i);return e.cache=o.set(s,r)||o,r};return e.cache=new(Jl.Cache||ds),e}Jl.Cache=ds;var R6=500;function L6(n){var t=Jl(n,function(i){return e.size===R6&&e.clear(),i}),e=t.cache;return t}var V6=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,B6=/\\(\\)?/g,yT=L6(function(n){var t=[];return n.charCodeAt(0)===46&&t.push(""),n.replace(V6,function(e,i,s,o){t.push(s?o.replace(B6,"$1"):i||e)}),t});function Be(n){return n==null?"":Mn(n)}function js(n,t){return me(n)?n:op(n,t)?[n]:yT(Be(n))}var M6=1/0;function Li(n){if(typeof n=="string"||_n(n))return n;var t=n+"";return t=="0"&&1/n==-M6?"-0":t}function Fo(n,t){t=js(t,n);for(var e=0,i=t.length;n!=null&&e<i;)n=n[Li(t[e++])];return e&&e==i?n:void 0}function Fs(n,t,e){var i=n==null?void 0:Fo(n,t);return i===void 0?e:i}function rp(n,t){for(var e=-1,i=t.length,s=Array(i),o=n==null;++e<i;)s[e]=o?void 0:Fs(n,t[e]);return s}function Gs(n,t){for(var e=-1,i=t.length,s=n.length;++e<i;)n[s+e]=t[e];return n}var I1=qt?qt.isConcatSpreadable:void 0;function O6(n){return me(n)||Ns(n)||!!(I1&&n&&n[I1])}function Ft(n,t,e,i,s){var o=-1,r=n.length;for(e||(e=O6),s||(s=[]);++o<r;){var a=n[o];t>0&&e(a)?t>1?Ft(a,t-1,e,i,s):Gs(s,a):i||(s[s.length]=a)}return s}function ap(n){var t=n==null?0:n.length;return t?Ft(n,1):[]}function hs(n){return tp(fT(n,void 0,ap),n+"")}var N6=hs(rp);const CT=N6;var sh=wT(Object.getPrototypeOf,Object),F6="[object Object]",D6=Function.prototype,$6=Object.prototype,kT=D6.toString,H6=$6.hasOwnProperty,z6=kT.call(Object);function Rt(n){if(!rt(n)||en(n)!=F6)return!1;var t=sh(n);if(t===null)return!0;var e=H6.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&kT.call(e)==z6}var U6="[object DOMException]",W6="[object Error]";function oh(n){if(!rt(n))return!1;var t=en(n);return t==W6||t==U6||typeof n.message=="string"&&typeof n.name=="string"&&!Rt(n)}var q6=ve(function(n,t){try{return On(n,void 0,t)}catch(e){return oh(e)?e:new Error(e)}});const lp=q6;var j6="Expected a function";function cp(n,t){var e;if(typeof t!="function")throw new TypeError(j6);return n=be(n),function(){return--n>0&&(e=t.apply(this,arguments)),n<=1&&(t=void 0),e}}var G6=1,K6=32,up=ve(function(n,t,e){var i=G6;if(e.length){var s=Os(e,Xr(up));i|=K6}return ls(n,i,t,e,s)});up.placeholder={};const dp=up;var Z6=hs(function(n,t){return ei(t,function(e){e=Li(e),cs(n,e,dp(n[e],n))}),n});const TT=Z6;var J6=1,Y6=2,X6=32,hp=ve(function(n,t,e){var i=J6|Y6;if(e.length){var s=Os(e,Xr(hp));i|=X6}return ls(t,i,n,e,s)});hp.placeholder={};const ET=hp;function Xn(n,t,e){var i=-1,s=n.length;t<0&&(t=-t>s?0:s+t),e=e>s?s:e,e<0&&(e+=s),s=t>e?0:e-t>>>0,t>>>=0;for(var o=Array(s);++i<s;)o[i]=n[i+t];return o}function Ks(n,t,e){var i=n.length;return e=e===void 0?i:e,!t&&e>=i?n:Xn(n,t,e)}var Q6="\\ud800-\\udfff",e7="\\u0300-\\u036f",t7="\\ufe20-\\ufe2f",n7="\\u20d0-\\u20ff",i7=e7+t7+n7,s7="\\ufe0e\\ufe0f",o7="\\u200d",r7=RegExp("["+o7+Q6+i7+s7+"]");function ea(n){return r7.test(n)}function a7(n){return n.split("")}var AT="\\ud800-\\udfff",l7="\\u0300-\\u036f",c7="\\ufe20-\\ufe2f",u7="\\u20d0-\\u20ff",d7=l7+c7+u7,h7="\\ufe0e\\ufe0f",f7="["+AT+"]",pm="["+d7+"]",bm="\\ud83c[\\udffb-\\udfff]",m7="(?:"+pm+"|"+bm+")",xT="[^"+AT+"]",ST="(?:\\ud83c[\\udde6-\\uddff]){2}",IT="[\\ud800-\\udbff][\\udc00-\\udfff]",g7="\\u200d",PT=m7+"?",RT="["+h7+"]?",p7="(?:"+g7+"(?:"+[xT,ST,IT].join("|")+")"+RT+PT+")*",b7=RT+PT+p7,w7="(?:"+[xT+pm+"?",pm,ST,IT,f7].join("|")+")",_7=RegExp(bm+"(?="+bm+")|"+w7+b7,"g");function v7(n){return n.match(_7)||[]}function di(n){return ea(n)?v7(n):a7(n)}function LT(n){return function(t){t=Be(t);var e=ea(t)?di(t):void 0,i=e?e[0]:t.charAt(0),s=e?Ks(e,1).join(""):t.slice(1);return i[n]()+s}}var Yl=LT("toUpperCase");function fp(n){return Yl(Be(n).toLowerCase())}function mp(n,t,e,i){var s=-1,o=n==null?0:n.length;for(i&&o&&(e=n[++s]);++s<o;)e=t(e,n[s],s,n);return e}function gp(n){return function(t){return n==null?void 0:n[t]}}var y7={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},C7=gp(y7),k7=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,T7="\\u0300-\\u036f",E7="\\ufe20-\\ufe2f",A7="\\u20d0-\\u20ff",x7=T7+E7+A7,S7="["+x7+"]",I7=RegExp(S7,"g");function pp(n){return n=Be(n),n&&n.replace(k7,C7).replace(I7,"")}var P7=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function R7(n){return n.match(P7)||[]}var L7=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function V7(n){return L7.test(n)}var VT="\\ud800-\\udfff",B7="\\u0300-\\u036f",M7="\\ufe20-\\ufe2f",O7="\\u20d0-\\u20ff",N7=B7+M7+O7,BT="\\u2700-\\u27bf",MT="a-z\\xdf-\\xf6\\xf8-\\xff",F7="\\xac\\xb1\\xd7\\xf7",D7="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",$7="\\u2000-\\u206f",H7=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",OT="A-Z\\xc0-\\xd6\\xd8-\\xde",z7="\\ufe0e\\ufe0f",NT=F7+D7+$7+H7,FT="['’]",P1="["+NT+"]",U7="["+N7+"]",DT="\\d+",W7="["+BT+"]",$T="["+MT+"]",HT="[^"+VT+NT+DT+BT+MT+OT+"]",q7="\\ud83c[\\udffb-\\udfff]",j7="(?:"+U7+"|"+q7+")",G7="[^"+VT+"]",zT="(?:\\ud83c[\\udde6-\\uddff]){2}",UT="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="["+OT+"]",K7="\\u200d",R1="(?:"+$T+"|"+HT+")",Z7="(?:"+ur+"|"+HT+")",L1="(?:"+FT+"(?:d|ll|m|re|s|t|ve))?",V1="(?:"+FT+"(?:D|LL|M|RE|S|T|VE))?",WT=j7+"?",qT="["+z7+"]?",J7="(?:"+K7+"(?:"+[G7,zT,UT].join("|")+")"+qT+WT+")*",Y7="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",X7="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Q7=qT+WT+J7,eO="(?:"+[W7,zT,UT].join("|")+")"+Q7,tO=RegExp([ur+"?"+$T+"+"+L1+"(?="+[P1,ur,"$"].join("|")+")",Z7+"+"+V1+"(?="+[P1,ur+R1,"$"].join("|")+")",ur+"?"+R1+"+"+L1,ur+"+"+V1,X7,Y7,DT,eO].join("|"),"g");function nO(n){return n.match(tO)||[]}function bp(n,t,e){return n=Be(n),t=e?void 0:t,t===void 0?V7(n)?nO(n):R7(n):n.match(t)||[]}var iO="['’]",sO=RegExp(iO,"g");function ta(n){return function(t){return mp(bp(pp(t).replace(sO,"")),n,"")}}var oO=ta(function(n,t,e){return t=t.toLowerCase(),n+(e?fp(t):t)});const jT=oO;function GT(){if(!arguments.length)return[];var n=arguments[0];return me(n)?n:[n]}var rO=Bt.isFinite,aO=Math.min;function wp(n){var t=Math[n];return function(e,i){if(e=Bn(e),i=i==null?0:aO(be(i),292),i&&rO(e)){var s=(Be(e)+"e").split("e"),o=t(s[0]+"e"+(+s[1]+i));return s=(Be(o)+"e").split("e"),+(s[0]+"e"+(+s[1]-i))}return t(e)}}var lO=wp("ceil");const KT=lO;function _p(n){var t=b(n);return t.__chain__=!0,t}var cO=Math.ceil,uO=Math.max;function ZT(n,t,e){(e?Xt(n,t,e):t===void 0)?t=1:t=uO(be(t),0);var i=n==null?0:n.length;if(!i||t<1)return[];for(var s=0,o=0,r=Array(cO(i/t));s<i;)r[o++]=Xn(n,s,s+=t);return r}function Do(n,t,e){return n===n&&(e!==void 0&&(n=n<=e?n:e),t!==void 0&&(n=n>=t?n:t)),n}function JT(n,t,e){return e===void 0&&(e=t,t=void 0),e!==void 0&&(e=Bn(e),e=e===e?e:0),t!==void 0&&(t=Bn(t),t=t===t?t:0),Do(Bn(n),t,e)}function dO(){this.__data__=new us,this.size=0}function hO(n){var t=this.__data__,e=t.delete(n);return this.size=t.size,e}function fO(n){return this.__data__.get(n)}function mO(n){return this.__data__.has(n)}var gO=200;function pO(n,t){var e=this.__data__;if(e instanceof us){var i=e.__data__;if(!pl||i.length<gO-1)return i.push([n,t]),this.size=++e.size,this;e=this.__data__=new ds(i)}return e.set(n,t),this.size=e.size,this}function ci(n){var t=this.__data__=new us(n);this.size=t.size}ci.prototype.clear=dO;ci.prototype.delete=hO;ci.prototype.get=fO;ci.prototype.has=mO;ci.prototype.set=pO;function YT(n,t){return n&&Ri(t,_t(t),n)}function bO(n,t){return n&&Ri(t,nn(t),n)}var XT=typeof Rn=="object"&&Rn&&!Rn.nodeType&&Rn,B1=XT&&typeof Ln=="object"&&Ln&&!Ln.nodeType&&Ln,wO=B1&&B1.exports===XT,M1=wO?Bt.Buffer:void 0,O1=M1?M1.allocUnsafe:void 0;function QT(n,t){if(t)return n.slice();var e=n.length,i=O1?O1(e):new n.constructor(e);return n.copy(i),i}function Zs(n,t){for(var e=-1,i=n==null?0:n.length,s=0,o=[];++e<i;){var r=n[e];t(r,e,n)&&(o[s++]=r)}return o}function rh(){return[]}var _O=Object.prototype,vO=_O.propertyIsEnumerable,N1=Object.getOwnPropertySymbols,vp=N1?function(n){return n==null?[]:(n=Object(n),Zs(N1(n),function(t){return vO.call(n,t)}))}:rh;function yO(n,t){return Ri(n,vp(n),t)}var CO=Object.getOwnPropertySymbols,eE=CO?function(n){for(var t=[];n;)Gs(t,vp(n)),n=sh(n);return t}:rh;function kO(n,t){return Ri(n,eE(n),t)}function tE(n,t,e){var i=t(n);return me(n)?i:Gs(i,e(n))}function wm(n){return tE(n,_t,vp)}function yp(n){return tE(n,nn,eE)}var _m=Oo(Bt,"DataView"),vm=Oo(Bt,"Promise"),Rr=Oo(Bt,"Set"),F1="[object Map]",TO="[object Object]",D1="[object Promise]",$1="[object Set]",H1="[object WeakMap]",z1="[object DataView]",EO=Mo(_m),AO=Mo(pl),xO=Mo(vm),SO=Mo(Rr),IO=Mo(fl),Ht=en;(_m&&Ht(new _m(new ArrayBuffer(1)))!=z1||pl&&Ht(new pl)!=F1||vm&&Ht(vm.resolve())!=D1||Rr&&Ht(new Rr)!=$1||fl&&Ht(new fl)!=H1)&&(Ht=function(n){var t=en(n),e=t==TO?n.constructor:void 0,i=e?Mo(e):"";if(i)switch(i){case EO:return z1;case AO:return F1;case xO:return D1;case SO:return $1;case IO:return H1}return t});var PO=Object.prototype,RO=PO.hasOwnProperty;function LO(n){var t=n.length,e=new n.constructor(t);return t&&typeof n[0]=="string"&&RO.call(n,"index")&&(e.index=n.index,e.input=n.input),e}var $u=Bt.Uint8Array;function Cp(n){var t=new n.constructor(n.byteLength);return new $u(t).set(new $u(n)),t}function VO(n,t){var e=t?Cp(n.buffer):n.buffer;return new n.constructor(e,n.byteOffset,n.byteLength)}var BO=/\w*$/;function MO(n){var t=new n.constructor(n.source,BO.exec(n));return t.lastIndex=n.lastIndex,t}var U1=qt?qt.prototype:void 0,W1=U1?U1.valueOf:void 0;function OO(n){return W1?Object(W1.call(n)):{}}function nE(n,t){var e=t?Cp(n.buffer):n.buffer;return new n.constructor(e,n.byteOffset,n.length)}var NO="[object Boolean]",FO="[object Date]",DO="[object Map]",$O="[object Number]",HO="[object RegExp]",zO="[object Set]",UO="[object String]",WO="[object Symbol]",qO="[object ArrayBuffer]",jO="[object DataView]",GO="[object Float32Array]",KO="[object Float64Array]",ZO="[object Int8Array]",JO="[object Int16Array]",YO="[object Int32Array]",XO="[object Uint8Array]",QO="[object Uint8ClampedArray]",eN="[object Uint16Array]",tN="[object Uint32Array]";function nN(n,t,e){var i=n.constructor;switch(t){case qO:return Cp(n);case NO:case FO:return new i(+n);case jO:return VO(n,e);case GO:case KO:case ZO:case JO:case YO:case XO:case QO:case eN:case tN:return nE(n,e);case DO:return new i;case $O:case UO:return new i(n);case HO:return MO(n);case zO:return new i;case WO:return OO(n)}}function iE(n){return typeof n.constructor=="function"&&!Zl(n)?Jr(sh(n)):{}}var iN="[object Map]";function sN(n){return rt(n)&&Ht(n)==iN}var q1=Yn&&Yn.isMap,oN=q1?Nn(q1):sN;const kp=oN;var rN="[object Set]";function aN(n){return rt(n)&&Ht(n)==rN}var j1=Yn&&Yn.isSet,lN=j1?Nn(j1):aN;const Tp=lN;var cN=1,uN=2,dN=4,sE="[object Arguments]",hN="[object Array]",fN="[object Boolean]",mN="[object Date]",gN="[object Error]",oE="[object Function]",pN="[object GeneratorFunction]",bN="[object Map]",wN="[object Number]",rE="[object Object]",_N="[object RegExp]",vN="[object Set]",yN="[object String]",CN="[object Symbol]",kN="[object WeakMap]",TN="[object ArrayBuffer]",EN="[object DataView]",AN="[object Float32Array]",xN="[object Float64Array]",SN="[object Int8Array]",IN="[object Int16Array]",PN="[object Int32Array]",RN="[object Uint8Array]",LN="[object Uint8ClampedArray]",VN="[object Uint16Array]",BN="[object Uint32Array]",Ze={};Ze[sE]=Ze[hN]=Ze[TN]=Ze[EN]=Ze[fN]=Ze[mN]=Ze[AN]=Ze[xN]=Ze[SN]=Ze[IN]=Ze[PN]=Ze[bN]=Ze[wN]=Ze[rE]=Ze[_N]=Ze[vN]=Ze[yN]=Ze[CN]=Ze[RN]=Ze[LN]=Ze[VN]=Ze[BN]=!0;Ze[gN]=Ze[oE]=Ze[kN]=!1;function Kn(n,t,e,i,s,o){var r,a=t&cN,l=t&uN,c=t&dN;if(e&&(r=s?e(n,i,s,o):e(n)),r!==void 0)return r;if(!Ce(n))return n;var u=me(n);if(u){if(r=LO(n),!a)return mn(n,r)}else{var d=Ht(n),f=d==oE||d==pN;if(Yi(n))return QT(n,a);if(d==rE||d==sE||f&&!s){if(r=l||f?{}:iE(n),!a)return l?kO(n,bO(r,n)):yO(n,YT(r,n))}else{if(!Ze[d])return s?n:{};r=nN(n,d,a)}}o||(o=new ci);var m=o.get(n);if(m)return m;o.set(n,r),Tp(n)?n.forEach(function(w){r.add(Kn(w,t,e,w,n,o))}):kp(n)&&n.forEach(function(w,v){r.set(v,Kn(w,t,e,v,n,o))});var g=c?l?yp:wm:l?nn:_t,p=u?void 0:g(n);return ei(p||n,function(w,v){p&&(v=w,w=n[v]),Gl(r,v,Kn(w,t,e,v,n,o))}),r}var MN=4;function ah(n){return Kn(n,MN)}var ON=1,NN=4;function kn(n){return Kn(n,ON|NN)}var FN=1,DN=4;function Xl(n,t){return t=typeof t=="function"?t:void 0,Kn(n,FN|DN,t)}var $N=4;function aE(n,t){return t=typeof t=="function"?t:void 0,Kn(n,$N,t)}function ym(){return new Jn(this.value(),this.__chain__)}function lE(n){for(var t=-1,e=n==null?0:n.length,i=0,s=[];++t<e;){var o=n[t];o&&(s[i++]=o)}return s}function cE(){var n=arguments.length;if(!n)return[];for(var t=Array(n-1),e=arguments[0],i=n;i--;)t[i-1]=arguments[i];return Gs(me(e)?mn(e):[e],Ft(t,1))}var HN="__lodash_hash_undefined__";function zN(n){return this.__data__.set(n,HN),this}function UN(n){return this.__data__.has(n)}function xo(n){var t=-1,e=n==null?0:n.length;for(this.__data__=new ds;++t<e;)this.add(n[t])}xo.prototype.add=xo.prototype.push=zN;xo.prototype.has=UN;function Ep(n,t){for(var e=-1,i=n==null?0:n.length;++e<i;)if(t(n[e],e,n))return!0;return!1}function bl(n,t){return n.has(t)}var WN=1,qN=2;function uE(n,t,e,i,s,o){var r=e&WN,a=n.length,l=t.length;if(a!=l&&!(r&&l>a))return!1;var c=o.get(n),u=o.get(t);if(c&&u)return c==t&&u==n;var d=-1,f=!0,m=e&qN?new xo:void 0;for(o.set(n,t),o.set(t,n);++d<a;){var g=n[d],p=t[d];if(i)var w=r?i(p,g,d,t,n,o):i(g,p,d,n,t,o);if(w!==void 0){if(w)continue;f=!1;break}if(m){if(!Ep(t,function(v,_){if(!bl(m,_)&&(g===v||s(g,v,e,i,o)))return m.push(_)})){f=!1;break}}else if(!(g===p||s(g,p,e,i,o))){f=!1;break}}return o.delete(n),o.delete(t),f}function Ap(n){var t=-1,e=Array(n.size);return n.forEach(function(i,s){e[++t]=[s,i]}),e}function lh(n){var t=-1,e=Array(n.size);return n.forEach(function(i){e[++t]=i}),e}var jN=1,GN=2,KN="[object Boolean]",ZN="[object Date]",JN="[object Error]",YN="[object Map]",XN="[object Number]",QN="[object RegExp]",eF="[object Set]",tF="[object String]",nF="[object Symbol]",iF="[object ArrayBuffer]",sF="[object DataView]",G1=qt?qt.prototype:void 0,af=G1?G1.valueOf:void 0;function oF(n,t,e,i,s,o,r){switch(e){case sF:if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case iF:return!(n.byteLength!=t.byteLength||!o(new $u(n),new $u(t)));case KN:case ZN:case XN:return ti(+n,+t);case JN:return n.name==t.name&&n.message==t.message;case QN:case tF:return n==t+"";case YN:var a=Ap;case eF:var l=i&jN;if(a||(a=lh),n.size!=t.size&&!l)return!1;var c=r.get(n);if(c)return c==t;i|=GN,r.set(n,t);var u=uE(a(n),a(t),i,s,o,r);return r.delete(n),u;case nF:if(af)return af.call(n)==af.call(t)}return!1}var rF=1,aF=Object.prototype,lF=aF.hasOwnProperty;function cF(n,t,e,i,s,o){var r=e&rF,a=wm(n),l=a.length,c=wm(t),u=c.length;if(l!=u&&!r)return!1;for(var d=l;d--;){var f=a[d];if(!(r?f in t:lF.call(t,f)))return!1}var m=o.get(n),g=o.get(t);if(m&&g)return m==t&&g==n;var p=!0;o.set(n,t),o.set(t,n);for(var w=r;++d<l;){f=a[d];var v=n[f],_=t[f];if(i)var y=r?i(_,v,f,t,n,o):i(v,_,f,n,t,o);if(!(y===void 0?v===_||s(v,_,e,i,o):y)){p=!1;break}w||(w=f=="constructor")}if(p&&!w){var E=n.constructor,x=t.constructor;E!=x&&"constructor"in n&&"constructor"in t&&!(typeof E=="function"&&E instanceof E&&typeof x=="function"&&x instanceof x)&&(p=!1)}return o.delete(n),o.delete(t),p}var uF=1,K1="[object Arguments]",Z1="[object Array]",Lc="[object Object]",dF=Object.prototype,J1=dF.hasOwnProperty;function hF(n,t,e,i,s,o){var r=me(n),a=me(t),l=r?Z1:Ht(n),c=a?Z1:Ht(t);l=l==K1?Lc:l,c=c==K1?Lc:c;var u=l==Lc,d=c==Lc,f=l==c;if(f&&Yi(n)){if(!Yi(t))return!1;r=!0,u=!1}if(f&&!u)return o||(o=new ci),r||No(n)?uE(n,t,e,i,s,o):oF(n,t,l,e,i,s,o);if(!(e&uF)){var m=u&&J1.call(n,"__wrapped__"),g=d&&J1.call(t,"__wrapped__");if(m||g){var p=m?n.value():n,w=g?t.value():t;return o||(o=new ci),s(p,w,e,i,o)}}return f?(o||(o=new ci),cF(n,t,e,i,s,o)):!1}function Ql(n,t,e,i,s){return n===t?!0:n==null||t==null||!rt(n)&&!rt(t)?n!==n&&t!==t:hF(n,t,e,i,Ql,s)}var fF=1,mF=2;function xp(n,t,e,i){var s=e.length,o=s,r=!i;if(n==null)return!o;for(n=Object(n);s--;){var a=e[s];if(r&&a[2]?a[1]!==n[a[0]]:!(a[0]in n))return!1}for(;++s<o;){a=e[s];var l=a[0],c=n[l],u=a[1];if(r&&a[2]){if(c===void 0&&!(l in n))return!1}else{var d=new ci;if(i)var f=i(c,u,l,n,t,d);if(!(f===void 0?Ql(u,c,fF|mF,i,d):f))return!1}}return!0}function dE(n){return n===n&&!Ce(n)}function Sp(n){for(var t=_t(n),e=t.length;e--;){var i=t[e],s=n[i];t[e]=[i,s,dE(s)]}return t}function hE(n,t){return function(e){return e==null?!1:e[n]===t&&(t!==void 0||n in Object(e))}}function fE(n){var t=Sp(n);return t.length==1&&t[0][2]?hE(t[0][0],t[0][1]):function(e){return e===n||xp(e,n,t)}}function gF(n,t){return n!=null&&t in Object(n)}function mE(n,t,e){t=js(t,n);for(var i=-1,s=t.length,o=!1;++i<s;){var r=Li(t[i]);if(!(o=n!=null&&e(n,r)))break;n=n[r]}return o||++i!=s?o:(s=n==null?0:n.length,!!s&&Kl(s)&&as(r,s)&&(me(n)||Ns(n)))}function ch(n,t){return n!=null&&mE(n,t,gF)}var pF=1,bF=2;function gE(n,t){return op(n)&&dE(t)?hE(Li(n),t):function(e){var i=Fs(e,n);return i===void 0&&i===t?ch(e,n):Ql(t,i,pF|bF)}}function Ip(n){return function(t){return t==null?void 0:t[n]}}function wF(n){return function(t){return Fo(t,n)}}function Pp(n){return op(n)?Ip(Li(n)):wF(n)}function ge(n){return typeof n=="function"?n:n==null?ft:typeof n=="object"?me(n)?gE(n[0],n[1]):fE(n):Pp(n)}var _F="Expected a function";function pE(n){var t=n==null?0:n.length,e=ge;return n=t?it(n,function(i){if(typeof i[1]!="function")throw new TypeError(_F);return[e(i[0]),i[1]]}):[],ve(function(i){for(var s=-1;++s<t;){var o=n[s];if(On(o[0],this,i))return On(o[1],this,i)}})}function bE(n,t,e){var i=e.length;if(n==null)return!i;for(n=Object(n);i--;){var s=e[i],o=t[s],r=n[s];if(r===void 0&&!(s in n)||!o(r))return!1}return!0}function vF(n){var t=_t(n);return function(e){return bE(e,n,t)}}var yF=1;function wE(n){return vF(Kn(n,yF))}function _E(n,t){return t==null||bE(n,t,_t(t))}function CF(n,t,e,i){for(var s=-1,o=n==null?0:n.length;++s<o;){var r=n[s];t(i,r,e(r),n)}return i}function vE(n){return function(t,e,i){for(var s=-1,o=Object(t),r=i(t),a=r.length;a--;){var l=r[n?a:++s];if(e(o[l],l,o)===!1)break}return t}}var Rp=vE();function Vi(n,t){return n&&Rp(n,t,_t)}function yE(n,t){return function(e,i){if(e==null)return e;if(!tn(e))return n(e,i);for(var s=e.length,o=t?s:-1,r=Object(e);(t?o--:++o<s)&&i(r[o],o,r)!==!1;);return e}}var Js=yE(Vi);function kF(n,t,e,i){return Js(n,function(s,o,r){t(i,s,e(s),r)}),i}function uh(n,t){return function(e,i){var s=me(e)?CF:kF,o=t?t():{};return s(e,n,ge(i),o)}}var TF=Object.prototype,EF=TF.hasOwnProperty,AF=uh(function(n,t,e){EF.call(n,e)?++n[e]:cs(n,e,1)});const CE=AF;function kE(n,t){var e=Jr(n);return t==null?e:YT(e,t)}var xF=8;function dh(n,t,e){t=e?void 0:t;var i=ls(n,xF,void 0,void 0,void 0,void 0,void 0,t);return i.placeholder=dh.placeholder,i}dh.placeholder={};var SF=16;function hh(n,t,e){t=e?void 0:t;var i=ls(n,SF,void 0,void 0,void 0,void 0,void 0,t);return i.placeholder=hh.placeholder,i}hh.placeholder={};var IF=function(){return Bt.Date.now()};const qa=IF;var PF="Expected a function",RF=Math.max,LF=Math.min;function Fn(n,t,e){var i,s,o,r,a,l,c=0,u=!1,d=!1,f=!0;if(typeof n!="function")throw new TypeError(PF);t=Bn(t)||0,Ce(e)&&(u=!!e.leading,d="maxWait"in e,o=d?RF(Bn(e.maxWait)||0,t):o,f="trailing"in e?!!e.trailing:f);function m(S){var R=i,V=s;return i=s=void 0,c=S,r=n.apply(V,R),r}function g(S){return c=S,a=setTimeout(v,t),u?m(S):r}function p(S){var R=S-l,V=S-c,P=t-R;return d?LF(P,o-V):P}function w(S){var R=S-l,V=S-c;return l===void 0||R>=t||R<0||d&&V>=o}function v(){var S=qa();if(w(S))return _(S);a=setTimeout(v,p(S))}function _(S){return a=void 0,f&&i?m(S):(i=s=void 0,r)}function y(){a!==void 0&&clearTimeout(a),c=0,i=l=s=a=void 0}function E(){return a===void 0?r:_(qa())}function x(){var S=qa(),R=w(S);if(i=arguments,s=this,l=S,R){if(a===void 0)return g(l);if(d)return clearTimeout(a),a=setTimeout(v,t),m(l)}return a===void 0&&(a=setTimeout(v,t)),r}return x.cancel=y,x.flush=E,x}function TE(n,t){return n==null||n!==n?t:n}var EE=Object.prototype,VF=EE.hasOwnProperty,BF=ve(function(n,t){n=Object(n);var e=-1,i=t.length,s=i>2?t[2]:void 0;for(s&&Xt(t[0],t[1],s)&&(i=1);++e<i;)for(var o=t[e],r=nn(o),a=-1,l=r.length;++a<l;){var c=r[a],u=n[c];(u===void 0||ti(u,EE[c])&&!VF.call(n,c))&&(n[c]=o[c])}return n});const AE=BF;function Cm(n,t,e){(e!==void 0&&!ti(n[t],e)||e===void 0&&!(t in n))&&cs(n,t,e)}function ct(n){return rt(n)&&tn(n)}function km(n,t){if(!(t==="constructor"&&typeof n[t]=="function")&&t!="__proto__")return n[t]}function Lp(n){return Ri(n,nn(n))}function MF(n,t,e,i,s,o,r){var a=km(n,e),l=km(t,e),c=r.get(l);if(c){Cm(n,e,c);return}var u=o?o(a,l,e+"",n,t,r):void 0,d=u===void 0;if(d){var f=me(l),m=!f&&Yi(l),g=!f&&!m&&No(l);u=l,f||m||g?me(a)?u=a:ct(a)?u=mn(a):m?(d=!1,u=QT(l,!0)):g?(d=!1,u=nE(l,!0)):u=[]:Rt(l)||Ns(l)?(u=a,Ns(a)?u=Lp(a):(!Ce(a)||vn(a))&&(u=iE(l))):d=!1}d&&(r.set(l,u),s(u,l,i,o,r),r.delete(l)),Cm(n,e,u)}function fh(n,t,e,i,s){n!==t&&Rp(t,function(o,r){if(s||(s=new ci),Ce(o))MF(n,t,r,e,fh,i,s);else{var a=i?i(km(n,r),o,r+"",n,t,s):void 0;a===void 0&&(a=o),Cm(n,r,a)}},nn)}function xE(n,t,e,i,s,o){return Ce(n)&&Ce(t)&&(o.set(t,n),fh(n,t,void 0,xE,o),o.delete(t)),n}var mh=Qr(function(n,t,e,i){fh(n,t,e,i)}),OF=ve(function(n){return n.push(void 0,xE),On(mh,void 0,n)});const SE=OF;var NF="Expected a function";function IE(n,t,e){if(typeof n!="function")throw new TypeError(NF);return setTimeout(function(){n.apply(void 0,e)},t)}var FF=ve(function(n,t){return IE(n,1,t)});const PE=FF;var DF=ve(function(n,t,e){return IE(n,Bn(t)||0,e)});const RE=DF;function Vp(n,t,e){for(var i=-1,s=n==null?0:n.length;++i<s;)if(e(t,n[i]))return!0;return!1}var $F=200;function ec(n,t,e,i){var s=-1,o=Qd,r=!0,a=n.length,l=[],c=t.length;if(!a)return l;e&&(t=it(t,Nn(e))),i?(o=Vp,r=!1):t.length>=$F&&(o=bl,r=!1,t=new xo(t));e:for(;++s<a;){var u=n[s],d=e==null?u:e(u);if(u=i||u!==0?u:0,r&&d===d){for(var f=c;f--;)if(t[f]===d)continue e;l.push(u)}else o(t,d,i)||l.push(u)}return l}var HF=ve(function(n,t){return ct(n)?ec(n,Ft(t,1,ct,!0)):[]});const LE=HF;function yn(n){var t=n==null?0:n.length;return t?n[t-1]:void 0}var zF=ve(function(n,t){var e=yn(t);return ct(e)&&(e=void 0),ct(n)?ec(n,Ft(t,1,ct,!0),ge(e)):[]});const VE=zF;var UF=ve(function(n,t){var e=yn(t);return ct(e)&&(e=void 0),ct(n)?ec(n,Ft(t,1,ct,!0),void 0,e):[]});const BE=UF;var WF=Kd(function(n,t){return n/t},1);const ME=WF;function OE(n,t,e){var i=n==null?0:n.length;return i?(t=e||t===void 0?1:be(t),Xn(n,t<0?0:t,i)):[]}function NE(n,t,e){var i=n==null?0:n.length;return i?(t=e||t===void 0?1:be(t),t=i-t,Xn(n,0,t<0?0:t)):[]}function gh(n,t,e,i){for(var s=n.length,o=i?s:-1;(i?o--:++o<s)&&t(n[o],o,n););return e?Xn(n,i?0:o,i?o+1:s):Xn(n,i?o+1:0,i?s:o)}function FE(n,t){return n&&n.length?gh(n,ge(t),!0,!0):[]}function DE(n,t){return n&&n.length?gh(n,ge(t),!0):[]}function Bi(n){return typeof n=="function"?n:ft}function Hu(n,t){var e=me(n)?ei:Js;return e(n,Bi(t))}function qF(n,t){for(var e=n==null?0:n.length;e--&&t(n[e],e,n)!==!1;);return n}var $E=vE(!0);function Bp(n,t){return n&&$E(n,t,_t)}var HE=yE(Bp,!0);function zu(n,t){var e=me(n)?qF:HE;return e(n,Bi(t))}function zE(n,t,e){n=Be(n),t=Mn(t);var i=n.length;e=e===void 0?i:Do(be(e),0,i);var s=e;return e-=t.length,e>=0&&n.slice(e,s)==t}function jF(n,t){return it(t,function(e){return[e,n[e]]})}function GF(n){var t=-1,e=Array(n.size);return n.forEach(function(i){e[++t]=[i,i]}),e}var KF="[object Map]",ZF="[object Set]";function UE(n){return function(t){var e=Ht(t);return e==KF?Ap(t):e==ZF?GF(t):jF(t,n(t))}}var JF=UE(_t);const Uu=JF;var YF=UE(nn);const Wu=YF;var XF={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},QF=gp(XF),WE=/[&<>"']/g,eD=RegExp(WE.source);function Mp(n){return n=Be(n),n&&eD.test(n)?n.replace(WE,QF):n}var qE=/[\\^$.*+?()[\]{}|]/g,tD=RegExp(qE.source);function Op(n){return n=Be(n),n&&tD.test(n)?n.replace(qE,"\\$&"):n}function jE(n,t){for(var e=-1,i=n==null?0:n.length;++e<i;)if(!t(n[e],e,n))return!1;return!0}function nD(n,t){var e=!0;return Js(n,function(i,s,o){return e=!!t(i,s,o),e}),e}function GE(n,t,e){var i=me(n)?jE:nD;return e&&Xt(n,t,e)&&(t=void 0),i(n,ge(t))}var iD=4294967295;function Np(n){return n?Do(be(n),0,iD):0}function sD(n,t,e,i){var s=n.length;for(e=be(e),e<0&&(e=-e>s?0:s+e),i=i===void 0||i>s?s:be(i),i<0&&(i+=s),i=e>i?0:Np(i);e<i;)n[e++]=t;return n}function KE(n,t,e,i){var s=n==null?0:n.length;return s?(e&&typeof e!="number"&&Xt(n,t,e)&&(e=0,i=s),sD(n,t,e,i)):[]}function ZE(n,t){var e=[];return Js(n,function(i,s,o){t(i,s,o)&&e.push(i)}),e}function JE(n,t){var e=me(n)?Zs:ZE;return e(n,ge(t))}function YE(n){return function(t,e,i){var s=Object(t);if(!tn(t)){var o=ge(e);t=_t(t),e=function(a){return o(s[a],a,s)}}var r=n(t,e,i);return r>-1?s[o?t[r]:r]:void 0}}var oD=Math.max;function Fp(n,t,e){var i=n==null?0:n.length;if(!i)return-1;var s=e==null?0:be(e);return s<0&&(s=oD(i+s,0)),Xd(n,ge(t),s)}var rD=YE(Fp);const XE=rD;function QE(n,t,e){var i;return e(n,function(s,o,r){if(t(s,o,r))return i=o,!1}),i}function eA(n,t){return QE(n,ge(t),Vi)}var aD=Math.max,lD=Math.min;function Dp(n,t,e){var i=n==null?0:n.length;if(!i)return-1;var s=i-1;return e!==void 0&&(s=be(e),s=e<0?aD(i+s,0):lD(s,i-1)),Xd(n,ge(t),s,!0)}var cD=YE(Dp);const tA=cD;function nA(n,t){return QE(n,ge(t),Bp)}function qu(n){return n&&n.length?n[0]:void 0}function iA(n,t){var e=-1,i=tn(n)?Array(n.length):[];return Js(n,function(s,o,r){i[++e]=t(s,o,r)}),i}function na(n,t){var e=me(n)?it:iA;return e(n,ge(t))}function sA(n,t){return Ft(na(n,t),1)}var uD=1/0;function oA(n,t){return Ft(na(n,t),uD)}function rA(n,t,e){return e=e===void 0?1:be(e),Ft(na(n,t),e)}var dD=1/0;function aA(n){var t=n==null?0:n.length;return t?Ft(n,dD):[]}function lA(n,t){var e=n==null?0:n.length;return e?(t=t===void 0?1:be(t),Ft(n,t)):[]}var hD=512;function cA(n){return ls(n,hD)}var fD=wp("floor");const uA=fD;var mD="Expected a function",gD=8,pD=32,bD=128,wD=256;function dA(n){return hs(function(t){var e=t.length,i=e,s=Jn.prototype.thru;for(n&&t.reverse();i--;){var o=t[i];if(typeof o!="function")throw new TypeError(mD);if(s&&!r&&hu(o)=="wrapper")var r=new Jn([],!0)}for(i=r?i:e;++i<e;){o=t[i];var a=hu(o),l=a=="wrapper"?ep(o):void 0;l&&gm(l[0])&&l[1]==(bD|gD|pD|wD)&&!l[4].length&&l[9]==1?r=r[hu(l[0])].apply(r,l[3]):r=o.length==1&&gm(o)?r[a]():r.thru(o)}return function(){var c=arguments,u=c[0];if(r&&c.length==1&&me(u))return r.plant(u).value();for(var d=0,f=e?t[d].apply(this,c):u;++d<e;)f=t[d].call(this,f);return f}})}var _D=dA();const hA=_D;var vD=dA(!0);const fA=vD;function mA(n,t){return n==null?n:Rp(n,Bi(t),nn)}function gA(n,t){return n==null?n:$E(n,Bi(t),nn)}function pA(n,t){return n&&Vi(n,Bi(t))}function bA(n,t){return n&&Bp(n,Bi(t))}function wA(n){for(var t=-1,e=n==null?0:n.length,i={};++t<e;){var s=n[t];i[s[0]]=s[1]}return i}function ph(n,t){return Zs(t,function(e){return vn(n[e])})}function _A(n){return n==null?[]:ph(n,_t(n))}function vA(n){return n==null?[]:ph(n,nn(n))}var yD=Object.prototype,CD=yD.hasOwnProperty,kD=uh(function(n,t,e){CD.call(n,e)?n[e].push(t):cs(n,e,[t])});const yA=kD;function $p(n,t){return n>t}function bh(n){return function(t,e){return typeof t=="string"&&typeof e=="string"||(t=Bn(t),e=Bn(e)),n(t,e)}}var TD=bh($p);const CA=TD;var ED=bh(function(n,t){return n>=t});const kA=ED;var AD=Object.prototype,xD=AD.hasOwnProperty;function SD(n,t){return n!=null&&xD.call(n,t)}function TA(n,t){return n!=null&&mE(n,t,SD)}var ID=Math.max,PD=Math.min;function RD(n,t,e){return n>=PD(t,e)&&n<ID(t,e)}function EA(n,t,e){return t=Ti(t),e===void 0?(e=t,t=0):e=Ti(e),n=Bn(n),RD(n,t,e)}var LD="[object String]";function So(n){return typeof n=="string"||!me(n)&&rt(n)&&en(n)==LD}function Hp(n,t){return it(t,function(e){return n[e]})}function $o(n){return n==null?[]:Hp(n,_t(n))}var VD=Math.max;function AA(n,t,e,i){n=tn(n)?n:$o(n),e=e&&!i?be(e):0;var s=n.length;return e<0&&(e=VD(s+e,0)),So(n)?e<=s&&n.indexOf(t,e)>-1:!!s&&Yr(n,t,e)>-1}var BD=Math.max;function xA(n,t,e){var i=n==null?0:n.length;if(!i)return-1;var s=e==null?0:be(e);return s<0&&(s=BD(i+s,0)),Yr(n,t,s)}function SA(n){var t=n==null?0:n.length;return t?Xn(n,0,-1):[]}var MD=Math.min;function zp(n,t,e){for(var i=e?Vp:Qd,s=n[0].length,o=n.length,r=o,a=Array(o),l=1/0,c=[];r--;){var u=n[r];r&&t&&(u=it(u,Nn(t))),l=MD(u.length,l),a[r]=!e&&(t||s>=120&&u.length>=120)?new xo(r&&u):void 0}u=n[0];var d=-1,f=a[0];e:for(;++d<s&&c.length<l;){var m=u[d],g=t?t(m):m;if(m=e||m!==0?m:0,!(f?bl(f,g):i(c,g,e))){for(r=o;--r;){var p=a[r];if(!(p?bl(p,g):i(n[r],g,e)))continue e}f&&f.push(g),c.push(m)}}return c}function Up(n){return ct(n)?n:[]}var OD=ve(function(n){var t=it(n,Up);return t.length&&t[0]===n[0]?zp(t):[]});const IA=OD;var ND=ve(function(n){var t=yn(n),e=it(n,Up);return t===yn(e)?t=void 0:e.pop(),e.length&&e[0]===n[0]?zp(e,ge(t)):[]});const PA=ND;var FD=ve(function(n){var t=yn(n),e=it(n,Up);return t=typeof t=="function"?t:void 0,t&&e.pop(),e.length&&e[0]===n[0]?zp(e,void 0,t):[]});const RA=FD;function DD(n,t,e,i){return Vi(n,function(s,o,r){t(i,e(s),o,r)}),i}function LA(n,t){return function(e,i){return DD(e,n,t(i),{})}}var $D=Object.prototype,HD=$D.toString,zD=LA(function(n,t,e){t!=null&&typeof t.toString!="function"&&(t=HD.call(t)),n[t]=e},Yd(ft));const VA=zD;var BA=Object.prototype,UD=BA.hasOwnProperty,WD=BA.toString,qD=LA(function(n,t,e){t!=null&&typeof t.toString!="function"&&(t=WD.call(t)),UD.call(n,t)?n[t].push(e):n[t]=[e]},ge);const MA=qD;function OA(n,t){return t.length<2?n:Fo(n,Xn(t,0,-1))}function tc(n,t,e){t=js(t,n),n=OA(n,t);var i=n==null?n:n[Li(yn(t))];return i==null?void 0:On(i,n,e)}var jD=ve(tc);const NA=jD;var GD=ve(function(n,t,e){var i=-1,s=typeof t=="function",o=tn(n)?Array(n.length):[];return Js(n,function(r){o[++i]=s?On(t,r,e):tc(r,t,e)}),o});const FA=GD;var KD="[object ArrayBuffer]";function ZD(n){return rt(n)&&en(n)==KD}var Y1=Yn&&Yn.isArrayBuffer,JD=Y1?Nn(Y1):ZD;const DA=JD;var YD="[object Boolean]";function $A(n){return n===!0||n===!1||rt(n)&&en(n)==YD}var XD="[object Date]";function QD(n){return rt(n)&&en(n)==XD}var X1=Yn&&Yn.isDate,e8=X1?Nn(X1):QD;const HA=e8;function Xi(n){return rt(n)&&n.nodeType===1&&!Rt(n)}var t8="[object Map]",n8="[object Set]",i8=Object.prototype,s8=i8.hasOwnProperty;function zA(n){if(n==null)return!0;if(tn(n)&&(me(n)||typeof n=="string"||typeof n.splice=="function"||Yi(n)||No(n)||Ns(n)))return!n.length;var t=Ht(n);if(t==t8||t==n8)return!n.size;if(Zl(n))return!sp(n).length;for(var e in n)if(s8.call(n,e))return!1;return!0}function Ds(n,t){return Ql(n,t)}function Wp(n,t,e){e=typeof e=="function"?e:void 0;var i=e?e(n,t):void 0;return i===void 0?Ql(n,t,void 0,e):!!i}var o8=Bt.isFinite;function UA(n){return typeof n=="number"&&o8(n)}function qp(n){return typeof n=="number"&&n==be(n)}function WA(n,t){return n===t||xp(n,t,Sp(t))}function qA(n,t,e){return e=typeof e=="function"?e:void 0,xp(n,t,Sp(t),e)}var r8="[object Number]";function jp(n){return typeof n=="number"||rt(n)&&en(n)==r8}function jA(n){return jp(n)&&n!=+n}var a8=du?vn:th,l8="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.";function GA(n){if(a8(n))throw new Error(l8);return iT(n)}function KA(n){return n==null}function ZA(n){return n===null}var c8="[object RegExp]";function u8(n){return rt(n)&&en(n)==c8}var Q1=Yn&&Yn.isRegExp,d8=Q1?Nn(Q1):u8;const wh=d8;var e0=9007199254740991;function JA(n){return qp(n)&&n>=-e0&&n<=e0}function YA(n){return n===void 0}var h8="[object WeakMap]";function XA(n){return rt(n)&&Ht(n)==h8}var f8="[object WeakSet]";function QA(n){return rt(n)&&en(n)==f8}var m8=1;function e2(n){return ge(typeof n=="function"?n:Kn(n,m8))}var g8=Array.prototype,p8=g8.join;function t2(n,t){return n==null?"":p8.call(n,t)}var b8=ta(function(n,t,e){return n+(e?"-":"")+t.toLowerCase()});const n2=b8;var w8=uh(function(n,t,e){cs(n,e,t)});const i2=w8;function _8(n,t,e){for(var i=e+1;i--;)if(n[i]===t)return i;return i}var v8=Math.max,y8=Math.min;function s2(n,t,e){var i=n==null?0:n.length;if(!i)return-1;var s=i;return e!==void 0&&(s=be(e),s=s<0?v8(i+s,0):y8(s,i-1)),t===t?_8(n,t,s):Xd(n,uT,s,!0)}var C8=ta(function(n,t,e){return n+(e?" ":"")+t.toLowerCase()});const o2=C8;var k8=LT("toLowerCase");const r2=k8;function Gp(n,t){return n<t}var T8=bh(Gp);const a2=T8;var E8=bh(function(n,t){return n<=t});const l2=E8;function c2(n,t){var e={};return t=ge(t),Vi(n,function(i,s,o){cs(e,t(i,s,o),i)}),e}function Kp(n,t){var e={};return t=ge(t),Vi(n,function(i,s,o){cs(e,s,t(i,s,o))}),e}var A8=1;function u2(n){return fE(Kn(n,A8))}var x8=1;function d2(n,t){return gE(n,Kn(t,x8))}function _h(n,t,e){for(var i=-1,s=n.length;++i<s;){var o=n[i],r=t(o);if(r!=null&&(a===void 0?r===r&&!_n(r):e(r,a)))var a=r,l=o}return l}function h2(n){return n&&n.length?_h(n,ft,$p):void 0}function f2(n,t){return n&&n.length?_h(n,ge(t),$p):void 0}function Zp(n,t){for(var e,i=-1,s=n.length;++i<s;){var o=t(n[i]);o!==void 0&&(e=e===void 0?o:e+o)}return e}var S8=NaN;function m2(n,t){var e=n==null?0:n.length;return e?Zp(n,t)/e:S8}function g2(n){return m2(n,ft)}function p2(n,t){return m2(n,ge(t))}var nc=Qr(function(n,t,e){fh(n,t,e)}),I8=ve(function(n,t){return function(e){return tc(e,n,t)}});const b2=I8;var P8=ve(function(n,t){return function(e){return tc(n,e,t)}});const w2=P8;function _2(n){return n&&n.length?_h(n,ft,Gp):void 0}function v2(n,t){return n&&n.length?_h(n,ge(t),Gp):void 0}function Jp(n,t,e){var i=_t(t),s=ph(t,i),o=!(Ce(e)&&"chain"in e)||!!e.chain,r=vn(n);return ei(s,function(a){var l=t[a];n[a]=l,r&&(n.prototype[a]=function(){var c=this.__chain__;if(o||c){var u=n(this.__wrapped__),d=u.__actions__=mn(this.__actions__);return d.push({func:l,args:arguments,thisArg:n}),u.__chain__=c,u}return l.apply(n,Gs([this.value()],arguments))})}),n}var R8=Kd(function(n,t){return n*t},1);const y2=R8;var L8="Expected a function";function ia(n){if(typeof n!="function")throw new TypeError(L8);return function(){var t=arguments;switch(t.length){case 0:return!n.call(this);case 1:return!n.call(this,t[0]);case 2:return!n.call(this,t[0],t[1]);case 3:return!n.call(this,t[0],t[1],t[2])}return!n.apply(this,t)}}function V8(n){for(var t,e=[];!(t=n.next()).done;)e.push(t.value);return e}var B8="[object Map]",M8="[object Set]",lf=qt?qt.iterator:void 0;function Yp(n){if(!n)return[];if(tn(n))return So(n)?di(n):mn(n);if(lf&&n[lf])return V8(n[lf]());var t=Ht(n),e=t==B8?Ap:t==M8?lh:$o;return e(n)}function Tm(){this.__values__===void 0&&(this.__values__=Yp(this.value()));var n=this.__index__>=this.__values__.length,t=n?void 0:this.__values__[this.__index__++];return{done:n,value:t}}function C2(n,t){var e=n.length;if(e)return t+=t<0?e:0,as(t,e)?n[t]:void 0}function k2(n,t){return n&&n.length?C2(n,be(t)):void 0}function T2(n){return n=be(n),ve(function(t){return C2(t,n)})}function Xp(n,t){return t=js(t,n),n=OA(n,t),n==null||delete n[Li(yn(t))]}function O8(n){return Rt(n)?void 0:n}var N8=1,F8=2,D8=4,$8=hs(function(n,t){var e={};if(n==null)return e;var i=!1;t=it(t,function(o){return o=js(o,n),i||(i=o.length>1),o}),Ri(n,yp(n),e),i&&(e=Kn(e,N8|F8|D8,O8));for(var s=t.length;s--;)Xp(e,t[s]);return e});const E2=$8;function ic(n,t,e,i){if(!Ce(n))return n;t=js(t,n);for(var s=-1,o=t.length,r=o-1,a=n;a!=null&&++s<o;){var l=Li(t[s]),c=e;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(s!=r){var u=a[l];c=i?i(u,l,a):void 0,c===void 0&&(c=Ce(u)?u:as(t[s+1])?[]:{})}Gl(a,l,c),a=a[l]}return n}function A2(n,t,e){for(var i=-1,s=t.length,o={};++i<s;){var r=t[i],a=Fo(n,r);e(a,r)&&ic(o,js(r,n),a)}return o}function Qp(n,t){if(n==null)return{};var e=it(yp(n),function(i){return[i]});return t=ge(t),A2(n,e,function(i,s){return t(i,s[0])})}function x2(n,t){return Qp(n,ia(ge(t)))}function S2(n){return cp(2,n)}function H8(n,t){var e=n.length;for(n.sort(t);e--;)n[e]=n[e].value;return n}function I2(n,t){if(n!==t){var e=n!==void 0,i=n===null,s=n===n,o=_n(n),r=t!==void 0,a=t===null,l=t===t,c=_n(t);if(!a&&!c&&!o&&n>t||o&&r&&l&&!a&&!c||i&&r&&l||!e&&l||!s)return 1;if(!i&&!o&&!c&&n<t||c&&e&&s&&!i&&!o||a&&e&&s||!r&&s||!l)return-1}return 0}function z8(n,t,e){for(var i=-1,s=n.criteria,o=t.criteria,r=s.length,a=e.length;++i<r;){var l=I2(s[i],o[i]);if(l){if(i>=a)return l;var c=e[i];return l*(c=="desc"?-1:1)}}return n.index-t.index}function P2(n,t,e){t.length?t=it(t,function(o){return me(o)?function(r){return Fo(r,o.length===1?o[0]:o)}:o}):t=[ft];var i=-1;t=it(t,Nn(ge));var s=iA(n,function(o,r,a){var l=it(t,function(c){return c(o)});return{criteria:l,index:++i,value:o}});return H8(s,function(o,r){return z8(o,r,e)})}function R2(n,t,e,i){return n==null?[]:(me(t)||(t=t==null?[]:[t]),e=i?void 0:e,me(e)||(e=e==null?[]:[e]),P2(n,t,e))}function eb(n){return hs(function(t){return t=it(t,Nn(ge)),ve(function(e){var i=this;return n(t,function(s){return On(s,i,e)})})})}var U8=eb(it);const L2=U8;var W8=ve,q8=Math.min,j8=W8(function(n,t){t=t.length==1&&me(t[0])?it(t[0],Nn(ge)):it(Ft(t,1),Nn(ge));var e=t.length;return ve(function(i){for(var s=-1,o=q8(i.length,e);++s<o;)i[s]=t[s].call(this,i[s]);return On(n,this,i)})});const V2=j8;var G8=eb(jE);const B2=G8;var K8=eb(Ep);const M2=K8;var Z8=9007199254740991,J8=Math.floor;function Em(n,t){var e="";if(!n||t<1||t>Z8)return e;do t%2&&(e+=n),t=J8(t/2),t&&(n+=n);while(t);return e}var Y8=Ip("length"),O2="\\ud800-\\udfff",X8="\\u0300-\\u036f",Q8="\\ufe20-\\ufe2f",e9="\\u20d0-\\u20ff",t9=X8+Q8+e9,n9="\\ufe0e\\ufe0f",i9="["+O2+"]",Am="["+t9+"]",xm="\\ud83c[\\udffb-\\udfff]",s9="(?:"+Am+"|"+xm+")",N2="[^"+O2+"]",F2="(?:\\ud83c[\\udde6-\\uddff]){2}",D2="[\\ud800-\\udbff][\\udc00-\\udfff]",o9="\\u200d",$2=s9+"?",H2="["+n9+"]?",r9="(?:"+o9+"(?:"+[N2,F2,D2].join("|")+")"+H2+$2+")*",a9=H2+$2+r9,l9="(?:"+[N2+Am+"?",Am,F2,D2,i9].join("|")+")",t0=RegExp(xm+"(?="+xm+")|"+l9+a9,"g");function c9(n){for(var t=t0.lastIndex=0;t0.test(n);)++t;return t}function sa(n){return ea(n)?c9(n):Y8(n)}var u9=Math.ceil;function ju(n,t){t=t===void 0?" ":Mn(t);var e=t.length;if(e<2)return e?Em(t,n):t;var i=Em(t,u9(n/sa(t)));return ea(t)?Ks(di(i),0,n).join(""):i.slice(0,n)}var d9=Math.ceil,h9=Math.floor;function z2(n,t,e){n=Be(n),t=be(t);var i=t?sa(n):0;if(!t||i>=t)return n;var s=(t-i)/2;return ju(h9(s),e)+n+ju(d9(s),e)}function U2(n,t,e){n=Be(n),t=be(t);var i=t?sa(n):0;return t&&i<t?n+ju(t-i,e):n}function W2(n,t,e){n=Be(n),t=be(t);var i=t?sa(n):0;return t&&i<t?ju(t-i,e)+n:n}var f9=/^\s+/,m9=Bt.parseInt;function q2(n,t,e){return e||t==null?t=0:t&&(t=+t),m9(Be(n).replace(f9,""),t||0)}var g9=32,tb=ve(function(n,t){var e=Os(t,Xr(tb));return ls(n,g9,void 0,t,e)});tb.placeholder={};const nb=tb;var p9=64,ib=ve(function(n,t){var e=Os(t,Xr(ib));return ls(n,p9,void 0,t,e)});ib.placeholder={};const j2=ib;var b9=uh(function(n,t,e){n[e?0:1].push(t)},function(){return[[],[]]});const G2=b9;function w9(n,t){return A2(n,t,function(e,i){return ch(n,i)})}var _9=hs(function(n,t){return n==null?{}:w9(n,t)});const K2=_9;function Sm(n){for(var t,e=this;e instanceof Zd;){var i=aT(e);i.__index__=0,i.__values__=void 0,t?s.__wrapped__=i:t=i;var s=i;e=e.__wrapped__}return s.__wrapped__=n,t}function Z2(n){return function(t){return n==null?void 0:Fo(n,t)}}function v9(n,t,e,i){for(var s=e-1,o=n.length;++s<o;)if(i(n[s],t))return s;return-1}var y9=Array.prototype,n0=y9.splice;function sb(n,t,e,i){var s=i?v9:Yr,o=-1,r=t.length,a=n;for(n===t&&(t=mn(t)),e&&(a=it(n,Nn(e)));++o<r;)for(var l=0,c=t[o],u=e?e(c):c;(l=s(a,u,l,i))>-1;)a!==n&&n0.call(a,l,1),n0.call(n,l,1);return n}function ob(n,t){return n&&n.length&&t&&t.length?sb(n,t):n}var C9=ve(ob);const J2=C9;function Y2(n,t,e){return n&&n.length&&t&&t.length?sb(n,t,ge(e)):n}function X2(n,t,e){return n&&n.length&&t&&t.length?sb(n,t,void 0,e):n}var k9=Array.prototype,T9=k9.splice;function Q2(n,t){for(var e=n?t.length:0,i=e-1;e--;){var s=t[e];if(e==i||s!==o){var o=s;as(s)?T9.call(n,s,1):Xp(n,s)}}return n}var E9=hs(function(n,t){var e=n==null?0:n.length,i=rp(n,t);return Q2(n,it(t,function(s){return as(s,e)?+s:s}).sort(I2)),i});const ex=E9;var A9=Math.floor,x9=Math.random;function rb(n,t){return n+A9(x9()*(t-n+1))}var S9=parseFloat,I9=Math.min,P9=Math.random;function tx(n,t,e){if(e&&typeof e!="boolean"&&Xt(n,t,e)&&(t=e=void 0),e===void 0&&(typeof t=="boolean"?(e=t,t=void 0):typeof n=="boolean"&&(e=n,n=void 0)),n===void 0&&t===void 0?(n=0,t=1):(n=Ti(n),t===void 0?(t=n,n=0):t=Ti(t)),n>t){var i=n;n=t,t=i}if(e||n%1||t%1){var s=P9();return I9(n+s*(t-n+S9("1e-"+((s+"").length-1))),t)}return rb(n,t)}var R9=Math.ceil,L9=Math.max;function V9(n,t,e,i){for(var s=-1,o=L9(R9((t-n)/(e||1)),0),r=Array(o);o--;)r[i?o:++s]=n,n+=e;return r}function nx(n){return function(t,e,i){return i&&typeof i!="number"&&Xt(t,e,i)&&(e=i=void 0),t=Ti(t),e===void 0?(e=t,t=0):e=Ti(e),i=i===void 0?t<e?1:-1:Ti(i),V9(t,e,i,n)}}var B9=nx();const ix=B9;var M9=nx(!0);const sx=M9;var O9=256,N9=hs(function(n,t){return ls(n,O9,void 0,void 0,void 0,t)});const ox=N9;function rx(n,t,e,i,s){return s(n,function(o,r,a){e=i?(i=!1,o):t(e,o,r,a)}),e}function ax(n,t,e){var i=me(n)?mp:rx,s=arguments.length<3;return i(n,ge(t),e,s,Js)}function F9(n,t,e,i){var s=n==null?0:n.length;for(i&&s&&(e=n[--s]);s--;)e=t(e,n[s],s,n);return e}function lx(n,t,e){var i=me(n)?F9:rx,s=arguments.length<3;return i(n,ge(t),e,s,HE)}function cx(n,t){var e=me(n)?Zs:ZE;return e(n,ia(ge(t)))}function ux(n,t){var e=[];if(!(n&&n.length))return e;var i=-1,s=[],o=n.length;for(t=ge(t);++i<o;){var r=n[i];t(r,i,n)&&(e.push(r),s.push(i))}return Q2(n,s),e}function dx(n,t,e){return(e?Xt(n,t,e):t===void 0)?t=1:t=be(t),Em(Be(n),t)}function hx(){var n=arguments,t=Be(n[0]);return n.length<3?t:t.replace(n[1],n[2])}var D9="Expected a function";function fx(n,t){if(typeof n!="function")throw new TypeError(D9);return t=t===void 0?t:be(t),ve(n,t)}function mx(n,t,e){t=js(t,n);var i=-1,s=t.length;for(s||(s=1,n=void 0);++i<s;){var o=n==null?void 0:n[Li(t[i])];o===void 0&&(i=s,o=e),n=vn(o)?o.call(n):o}return n}var $9=Array.prototype,H9=$9.reverse;function Gu(n){return n==null?n:H9.call(n)}var z9=wp("round");const gx=z9;function px(n){var t=n.length;return t?n[rb(0,t-1)]:void 0}function U9(n){return px($o(n))}function bx(n){var t=me(n)?px:U9;return t(n)}function vh(n,t){var e=-1,i=n.length,s=i-1;for(t=t===void 0?i:t;++e<t;){var o=rb(e,s),r=n[o];n[o]=n[e],n[e]=r}return n.length=t,n}function W9(n,t){return vh(mn(n),Do(t,0,n.length))}function q9(n,t){var e=$o(n);return vh(e,Do(t,0,e.length))}function wx(n,t,e){(e?Xt(n,t,e):t===void 0)?t=1:t=be(t);var i=me(n)?W9:q9;return i(n,t)}function ab(n,t,e){return n==null?n:ic(n,t,e)}function _x(n,t,e,i){return i=typeof i=="function"?i:void 0,n==null?n:ic(n,t,e,i)}function j9(n){return vh(mn(n))}function G9(n){return vh($o(n))}function vx(n){var t=me(n)?j9:G9;return t(n)}var K9="[object Map]",Z9="[object Set]";function yx(n){if(n==null)return 0;if(tn(n))return So(n)?sa(n):n.length;var t=Ht(n);return t==K9||t==Z9?n.size:sp(n).length}function Cx(n,t,e){var i=n==null?0:n.length;return i?(e&&typeof e!="number"&&Xt(n,t,e)?(t=0,e=i):(t=t==null?0:be(t),e=e===void 0?i:be(e)),Xn(n,t,e)):[]}var J9=ta(function(n,t,e){return n+(e?"_":"")+t.toLowerCase()});const kx=J9;function Y9(n,t){var e;return Js(n,function(i,s,o){return e=t(i,s,o),!e}),!!e}function Tx(n,t,e){var i=me(n)?Ep:Y9;return e&&Xt(n,t,e)&&(t=void 0),i(n,ge(t))}var X9=ve(function(n,t){if(n==null)return[];var e=t.length;return e>1&&Xt(n,t[0],t[1])?t=[]:e>2&&Xt(t[0],t[1],t[2])&&(t=[t[0]]),P2(n,Ft(t,1),[])});const Ex=X9;var Q9=4294967295,e$=Q9-1,t$=Math.floor,n$=Math.min;function lb(n,t,e,i){var s=0,o=n==null?0:n.length;if(o===0)return 0;t=e(t);for(var r=t!==t,a=t===null,l=_n(t),c=t===void 0;s<o;){var u=t$((s+o)/2),d=e(n[u]),f=d!==void 0,m=d===null,g=d===d,p=_n(d);if(r)var w=i||g;else c?w=g&&(i||f):a?w=g&&f&&(i||!m):l?w=g&&f&&!m&&(i||!p):m||p?w=!1:w=i?d<=t:d<t;w?s=u+1:o=u}return n$(o,e$)}var i$=4294967295,s$=i$>>>1;function yh(n,t,e){var i=0,s=n==null?i:n.length;if(typeof t=="number"&&t===t&&s<=s$){for(;i<s;){var o=i+s>>>1,r=n[o];r!==null&&!_n(r)&&(e?r<=t:r<t)?i=o+1:s=o}return s}return lb(n,t,ft,e)}function Ax(n,t){return yh(n,t)}function xx(n,t,e){return lb(n,t,ge(e))}function Sx(n,t){var e=n==null?0:n.length;if(e){var i=yh(n,t);if(i<e&&ti(n[i],t))return i}return-1}function Ix(n,t){return yh(n,t,!0)}function Px(n,t,e){return lb(n,t,ge(e),!0)}function Rx(n,t){var e=n==null?0:n.length;if(e){var i=yh(n,t,!0)-1;if(ti(n[i],t))return i}return-1}function Lx(n,t){for(var e=-1,i=n.length,s=0,o=[];++e<i;){var r=n[e],a=t?t(r):r;if(!e||!ti(a,l)){var l=a;o[s++]=r===0?0:r}}return o}function Vx(n){return n&&n.length?Lx(n):[]}function Bx(n,t){return n&&n.length?Lx(n,ge(t)):[]}var o$=4294967295;function Mx(n,t,e){return e&&typeof e!="number"&&Xt(n,t,e)&&(t=e=void 0),e=e===void 0?o$:e>>>0,e?(n=Be(n),n&&(typeof t=="string"||t!=null&&!wh(t))&&(t=Mn(t),!t&&ea(n))?Ks(di(n),0,e):n.split(t,e)):[]}var r$="Expected a function",a$=Math.max;function Ox(n,t){if(typeof n!="function")throw new TypeError(r$);return t=t==null?0:a$(be(t),0),ve(function(e){var i=e[t],s=Ks(e,0,t);return i&&Gs(s,i),On(n,this,s)})}var l$=ta(function(n,t,e){return n+(e?" ":"")+Yl(t)});const cb=l$;function Nx(n,t,e){return n=Be(n),e=e==null?0:Do(be(e),0,n.length),t=Mn(t),n.slice(e,e+t.length)==t}function Fx(){return{}}function Dx(){return""}function $x(){return!0}var c$=Kd(function(n,t){return n-t},0);const Hx=c$;function zx(n){return n&&n.length?Zp(n,ft):0}function Ux(n,t){return n&&n.length?Zp(n,ge(t)):0}function Wx(n){var t=n==null?0:n.length;return t?Xn(n,1,t):[]}function qx(n,t,e){return n&&n.length?(t=e||t===void 0?1:be(t),Xn(n,0,t<0?0:t)):[]}function jx(n,t,e){var i=n==null?0:n.length;return i?(t=e||t===void 0?1:be(t),t=i-t,Xn(n,t<0?0:t,i)):[]}function Gx(n,t){return n&&n.length?gh(n,ge(t),!1,!0):[]}function Kx(n,t){return n&&n.length?gh(n,ge(t)):[]}function Zx(n,t){return t(n),n}var Jx=Object.prototype,u$=Jx.hasOwnProperty;function i0(n,t,e,i){return n===void 0||ti(n,Jx[e])&&!u$.call(i,e)?t:n}var d$={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function h$(n){return"\\"+d$[n]}var Yx=/<%=([\s\S]+?)%>/g,f$=/<%-([\s\S]+?)%>/g,m$=/<%([\s\S]+?)%>/g,g$={escape:f$,evaluate:m$,interpolate:Yx,variable:"",imports:{_:{escape:Mp}}};const Ku=g$;var p$="Invalid `variable` option passed into `_.template`",b$=/\b__p \+= '';/g,w$=/\b(__p \+=) '' \+/g,_$=/(__e\(.*?\)|\b__t\)) \+\n'';/g,v$=/[()=,{}\[\]\/\s]/,y$=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Vc=/($^)/,C$=/['\n\r\u2028\u2029\\]/g,k$=Object.prototype,s0=k$.hasOwnProperty;function Xx(n,t,e){var i=Ku.imports._.templateSettings||Ku;e&&Xt(n,t,e)&&(t=void 0),n=Be(n),t=Fr({},t,i,i0);var s=Fr({},t.imports,i.imports,i0),o=_t(s),r=Hp(s,o),a,l,c=0,u=t.interpolate||Vc,d="__p += '",f=RegExp((t.escape||Vc).source+"|"+u.source+"|"+(u===Yx?y$:Vc).source+"|"+(t.evaluate||Vc).source+"|$","g"),m=s0.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+`
`:"";n.replace(f,function(w,v,_,y,E,x){return _||(_=y),d+=n.slice(c,x).replace(C$,h$),v&&(a=!0,d+=`' +
__e(`+v+`) +
'`),E&&(l=!0,d+=`';
`+E+`;
__p += '`),_&&(d+=`' +
((__t = (`+_+`)) == null ? '' : __t) +
'`),c=x+w.length,w}),d+=`';
`;var g=s0.call(t,"variable")&&t.variable;if(!g)d=`with (obj) {
`+d+`
}
`;else if(v$.test(g))throw new Error(p$);d=(l?d.replace(b$,""):d).replace(w$,"$1").replace(_$,"$1;"),d="function("+(g||"obj")+`) {
`+(g?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(a?", __e = _.escape":"")+(l?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+d+`return __p
}`;var p=lp(function(){return Function(o,m+"return "+d).apply(void 0,r)});if(p.source=d,oh(p))throw p;return p}var T$="Expected a function";function $s(n,t,e){var i=!0,s=!0;if(typeof n!="function")throw new TypeError(T$);return Ce(e)&&(i="leading"in e?!!e.leading:i,s="trailing"in e?!!e.trailing:s),Fn(n,t,{leading:i,maxWait:t,trailing:s})}function oa(n,t){return t(n)}var E$=9007199254740991,cf=4294967295,A$=Math.min;function Qx(n,t){if(n=be(n),n<1||n>E$)return[];var e=cf,i=A$(n,cf);t=Bi(t),n-=cf;for(var s=ip(i,t);++e<n;)t(e);return s}function Im(){return this}function eS(n,t){var e=n;return e instanceof Ee&&(e=e.value()),mp(t,function(i,s){return s.func.apply(s.thisArg,Gs([i],s.args))},e)}function uo(){return eS(this.__wrapped__,this.__actions__)}function tS(n){return Be(n).toLowerCase()}function nS(n){return me(n)?it(n,Li):_n(n)?[n]:mn(yT(Be(n)))}var o0=9007199254740991;function iS(n){return n?Do(be(n),-o0,o0):n===0?n:0}function sS(n){return Be(n).toUpperCase()}function oS(n,t,e){var i=me(n),s=i||Yi(n)||No(n);if(t=ge(t),e==null){var o=n&&n.constructor;s?e=i?new o:[]:Ce(n)?e=vn(o)?Jr(sh(n)):{}:e={}}return(s?ei:Vi)(n,function(r,a,l){return t(e,r,a,l)}),e}function rS(n,t){for(var e=n.length;e--&&Yr(t,n[e],0)>-1;);return e}function aS(n,t){for(var e=-1,i=n.length;++e<i&&Yr(t,n[e],0)>-1;);return e}function lS(n,t,e){if(n=Be(n),n&&(e||t===void 0))return tT(n);if(!n||!(t=Mn(t)))return n;var i=di(n),s=di(t),o=aS(i,s),r=rS(i,s)+1;return Ks(i,o,r).join("")}function cS(n,t,e){if(n=Be(n),n&&(e||t===void 0))return n.slice(0,eT(n)+1);if(!n||!(t=Mn(t)))return n;var i=di(n),s=rS(i,di(t))+1;return Ks(i,0,s).join("")}var x$=/^\s+/;function uS(n,t,e){if(n=Be(n),n&&(e||t===void 0))return n.replace(x$,"");if(!n||!(t=Mn(t)))return n;var i=di(n),s=aS(i,di(t));return Ks(i,s).join("")}var S$=30,I$="...",P$=/\w*$/;function dS(n,t){var e=S$,i=I$;if(Ce(t)){var s="separator"in t?t.separator:s;e="length"in t?be(t.length):e,i="omission"in t?Mn(t.omission):i}n=Be(n);var o=n.length;if(ea(n)){var r=di(n);o=r.length}if(e>=o)return n;var a=e-sa(i);if(a<1)return i;var l=r?Ks(r,0,a).join(""):n.slice(0,a);if(s===void 0)return l+i;if(r&&(a+=l.length-a),wh(s)){if(n.slice(a).search(s)){var c,u=l;for(s.global||(s=RegExp(s.source,Be(P$.exec(s))+"g")),s.lastIndex=0;c=s.exec(u);)var d=c.index;l=l.slice(0,d===void 0?a:d)}}else if(n.indexOf(Mn(s),a)!=a){var f=l.lastIndexOf(s);f>-1&&(l=l.slice(0,f))}return l+i}function hS(n){return np(n,1)}var R$={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},L$=gp(R$),fS=/&(?:amp|lt|gt|quot|#39);/g,V$=RegExp(fS.source);function mS(n){return n=Be(n),n&&V$.test(n)?n.replace(fS,L$):n}var B$=1/0,M$=Rr&&1/lh(new Rr([,-0]))[1]==B$?function(n){return new Rr(n)}:Jd,O$=200;function Hs(n,t,e){var i=-1,s=Qd,o=n.length,r=!0,a=[],l=a;if(e)r=!1,s=Vp;else if(o>=O$){var c=t?null:M$(n);if(c)return lh(c);r=!1,s=bl,l=new xo}else l=t?[]:a;e:for(;++i<o;){var u=n[i],d=t?t(u):u;if(u=e||u!==0?u:0,r&&d===d){for(var f=l.length;f--;)if(l[f]===d)continue e;t&&l.push(d),a.push(u)}else s(l,d,e)||(l!==a&&l.push(d),a.push(u))}return a}var N$=ve(function(n){return Hs(Ft(n,1,ct,!0))});const gS=N$;var F$=ve(function(n){var t=yn(n);return ct(t)&&(t=void 0),Hs(Ft(n,1,ct,!0),ge(t))});const pS=F$;var D$=ve(function(n){var t=yn(n);return t=typeof t=="function"?t:void 0,Hs(Ft(n,1,ct,!0),void 0,t)});const bS=D$;function wS(n){return n&&n.length?Hs(n):[]}function _S(n,t){return n&&n.length?Hs(n,ge(t)):[]}function vS(n,t){return t=typeof t=="function"?t:void 0,n&&n.length?Hs(n,void 0,t):[]}var $$=0;function yS(n){var t=++$$;return Be(n)+t}function ub(n,t){return n==null?!0:Xp(n,t)}var H$=Math.max;function Ch(n){if(!(n&&n.length))return[];var t=0;return n=Zs(n,function(e){if(ct(e))return t=H$(e.length,t),!0}),ip(t,function(e){return it(n,Ip(e))})}function db(n,t){if(!(n&&n.length))return[];var e=Ch(n);return t==null?e:it(e,function(i){return On(t,void 0,i)})}function CS(n,t,e,i){return ic(n,t,e(Fo(n,t)),i)}function kS(n,t,e){return n==null?n:CS(n,t,Bi(e))}function TS(n,t,e,i){return i=typeof i=="function"?i:void 0,n==null?n:CS(n,t,Bi(e),i)}var z$=ta(function(n,t,e){return n+(e?" ":"")+t.toUpperCase()});const ES=z$;function AS(n){return n==null?[]:Hp(n,nn(n))}var U$=ve(function(n,t){return ct(n)?ec(n,t):[]});const xS=U$;function SS(n,t){return nb(Bi(t),n)}var W$=hs(function(n){var t=n.length,e=t?n[0]:0,i=this.__wrapped__,s=function(o){return rp(o,n)};return t>1||this.__actions__.length||!(i instanceof Ee)||!as(e)?this.thru(s):(i=i.slice(e,+e+(t?1:0)),i.__actions__.push({func:oa,args:[s],thisArg:void 0}),new Jn(i,this.__chain__).thru(function(o){return t&&!o.length&&o.push(void 0),o}))});const IS=W$;function PS(){return _p(this)}function RS(){var n=this.__wrapped__;if(n instanceof Ee){var t=n;return this.__actions__.length&&(t=new Ee(this)),t=t.reverse(),t.__actions__.push({func:oa,args:[Gu],thisArg:void 0}),new Jn(t,this.__chain__)}return this.thru(Gu)}function hb(n,t,e){var i=n.length;if(i<2)return i?Hs(n[0]):[];for(var s=-1,o=Array(i);++s<i;)for(var r=n[s],a=-1;++a<i;)a!=s&&(o[s]=ec(o[s]||r,n[a],t,e));return Hs(Ft(o,1),t,e)}var q$=ve(function(n){return hb(Zs(n,ct))});const LS=q$;var j$=ve(function(n){var t=yn(n);return ct(t)&&(t=void 0),hb(Zs(n,ct),ge(t))});const VS=j$;var G$=ve(function(n){var t=yn(n);return t=typeof t=="function"?t:void 0,hb(Zs(n,ct),void 0,t)});const BS=G$;var K$=ve(Ch);const MS=K$;function OS(n,t,e){for(var i=-1,s=n.length,o=t.length,r={};++i<s;){var a=i<o?t[i]:void 0;e(r,n[i],a)}return r}function NS(n,t){return OS(n||[],t||[],Gl)}function FS(n,t){return OS(n||[],t||[],ic)}var Z$=ve(function(n){var t=n.length,e=t>1?n[t-1]:void 0;return e=typeof e=="function"?(n.pop(),e):void 0,db(n,e)});const DS=Z$,X={chunk:ZT,compact:lE,concat:cE,difference:LE,differenceBy:VE,differenceWith:BE,drop:OE,dropRight:NE,dropRightWhile:FE,dropWhile:DE,fill:KE,findIndex:Fp,findLastIndex:Dp,first:qu,flatten:ap,flattenDeep:aA,flattenDepth:lA,fromPairs:wA,head:qu,indexOf:xA,initial:SA,intersection:IA,intersectionBy:PA,intersectionWith:RA,join:t2,last:yn,lastIndexOf:s2,nth:k2,pull:J2,pullAll:ob,pullAllBy:Y2,pullAllWith:X2,pullAt:ex,remove:ux,reverse:Gu,slice:Cx,sortedIndex:Ax,sortedIndexBy:xx,sortedIndexOf:Sx,sortedLastIndex:Ix,sortedLastIndexBy:Px,sortedLastIndexOf:Rx,sortedUniq:Vx,sortedUniqBy:Bx,tail:Wx,take:qx,takeRight:jx,takeRightWhile:Gx,takeWhile:Kx,union:gS,unionBy:pS,unionWith:bS,uniq:wS,uniqBy:_S,uniqWith:vS,unzip:Ch,unzipWith:db,without:xS,xor:LS,xorBy:VS,xorWith:BS,zip:MS,zipObject:NS,zipObjectDeep:FS,zipWith:DS},We={countBy:CE,each:Hu,eachRight:zu,every:GE,filter:JE,find:XE,findLast:tA,flatMap:sA,flatMapDeep:oA,flatMapDepth:rA,forEach:Hu,forEachRight:zu,groupBy:yA,includes:AA,invokeMap:FA,keyBy:i2,map:na,orderBy:R2,partition:G2,reduce:ax,reduceRight:lx,reject:cx,sample:bx,sampleSize:wx,shuffle:vx,size:yx,some:Tx,sortBy:Ex},J$={now:qa},ut={after:nT,ary:np,before:cp,bind:dp,bindKey:ET,curry:dh,curryRight:hh,debounce:Fn,defer:PE,delay:RE,flip:cA,memoize:Jl,negate:ia,once:S2,overArgs:V2,partial:nb,partialRight:j2,rearg:ox,rest:fx,spread:Ox,throttle:$s,unary:hS,wrap:SS},re={castArray:GT,clone:ah,cloneDeep:kn,cloneDeepWith:Xl,cloneWith:aE,conformsTo:_E,eq:ti,gt:CA,gte:kA,isArguments:Ns,isArray:me,isArrayBuffer:DA,isArrayLike:tn,isArrayLikeObject:ct,isBoolean:$A,isBuffer:Yi,isDate:HA,isElement:Xi,isEmpty:zA,isEqual:Ds,isEqualWith:Wp,isError:oh,isFinite:UA,isFunction:vn,isInteger:qp,isLength:Kl,isMap:kp,isMatch:WA,isMatchWith:qA,isNaN:jA,isNative:GA,isNil:KA,isNull:ZA,isNumber:jp,isObject:Ce,isObjectLike:rt,isPlainObject:Rt,isRegExp:wh,isSafeInteger:JA,isSet:Tp,isString:So,isSymbol:_n,isTypedArray:No,isUndefined:YA,isWeakMap:XA,isWeakSet:QA,lt:a2,lte:l2,toArray:Yp,toFinite:Ti,toInteger:be,toLength:Np,toNumber:Bn,toPlainObject:Lp,toSafeInteger:iS,toString:Be},sn={add:Qk,ceil:KT,divide:ME,floor:uA,max:h2,maxBy:f2,mean:g2,meanBy:p2,min:_2,minBy:v2,multiply:y2,round:gx,subtract:Hx,sum:zx,sumBy:Ux},fb={clamp:JT,inRange:EA,random:tx},fe={assign:_T,assignIn:Nr,assignInWith:Fr,assignWith:vT,at:CT,create:kE,defaults:AE,defaultsDeep:SE,entries:Uu,entriesIn:Wu,extend:Nr,extendWith:Fr,findKey:eA,findLastKey:nA,forIn:mA,forInRight:gA,forOwn:pA,forOwnRight:bA,functions:_A,functionsIn:vA,get:Fs,has:TA,hasIn:ch,invert:VA,invertBy:MA,invoke:NA,keys:_t,keysIn:nn,mapKeys:c2,mapValues:Kp,merge:nc,mergeWith:mh,omit:E2,omitBy:x2,pick:K2,pickBy:Qp,result:mx,set:ab,setWith:_x,toPairs:Uu,toPairsIn:Wu,transform:oS,unset:ub,update:kS,updateWith:TS,values:$o,valuesIn:AS},Mi={at:IS,chain:_p,commit:ym,lodash:b,next:Tm,plant:Sm,reverse:RS,tap:Zx,thru:oa,toIterator:Im,toJSON:uo,value:uo,valueOf:uo,wrapperChain:PS},Me={camelCase:jT,capitalize:fp,deburr:pp,endsWith:zE,escape:Mp,escapeRegExp:Op,kebabCase:n2,lowerCase:o2,lowerFirst:r2,pad:z2,padEnd:U2,padStart:W2,parseInt:q2,repeat:dx,replace:hx,snakeCase:kx,split:Mx,startCase:cb,startsWith:Nx,template:Xx,templateSettings:Ku,toLower:tS,toUpper:sS,trim:lS,trimEnd:cS,trimStart:uS,truncate:dS,unescape:mS,upperCase:ES,upperFirst:Yl,words:bp},Fe={attempt:lp,bindAll:TT,cond:pE,conforms:wE,constant:Yd,defaultTo:TE,flow:hA,flowRight:fA,identity:ft,iteratee:e2,matches:u2,matchesProperty:d2,method:b2,methodOf:w2,mixin:Jp,noop:Jd,nthArg:T2,over:L2,overEvery:B2,overSome:M2,property:Pp,propertyOf:Z2,range:ix,rangeRight:sx,stubArray:rh,stubFalse:th,stubObject:Fx,stubString:Dx,stubTrue:$x,times:Qx,toPath:nS,uniqueId:yS};function Y$(){var n=new Ee(this.__wrapped__);return n.__actions__=mn(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=mn(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=mn(this.__views__),n}function X$(){if(this.__filtered__){var n=new Ee(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}var Q$=Math.max,eH=Math.min;function tH(n,t,e){for(var i=-1,s=e.length;++i<s;){var o=e[i],r=o.size;switch(o.type){case"drop":n+=r;break;case"dropRight":t-=r;break;case"take":t=eH(t,n+r);break;case"takeRight":n=Q$(n,t-r);break}}return{start:n,end:t}}var nH=1,iH=2,sH=Math.min;function oH(){var n=this.__wrapped__.value(),t=this.__dir__,e=me(n),i=t<0,s=e?n.length:0,o=tH(0,s,this.__views__),r=o.start,a=o.end,l=a-r,c=i?a:r-1,u=this.__iteratees__,d=u.length,f=0,m=sH(l,this.__takeCount__);if(!e||!i&&s==l&&m==l)return eS(n,this.__actions__);var g=[];e:for(;l--&&f<m;){c+=t;for(var p=-1,w=n[c];++p<d;){var v=u[p],_=v.iteratee,y=v.type,E=_(w);if(y==iH)w=E;else if(!E){if(y==nH)continue e;break e}}g[f++]=w}return g}/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var rH="4.17.21",aH=2,lH=1,cH=3,$S=4294967295,uH=Array.prototype,dH=Object.prototype,HS=dH.hasOwnProperty,r0=qt?qt.iterator:void 0,hH=Math.max,a0=Math.min,mb=function(n){return function(t,e,i){if(i==null){var s=Ce(e),o=s&&_t(e),r=o&&o.length&&ph(e,o);(r?r.length:s)||(i=e,e=t,t=this)}return n(t,e,i)}}(Jp);b.after=ut.after;b.ary=ut.ary;b.assign=fe.assign;b.assignIn=fe.assignIn;b.assignInWith=fe.assignInWith;b.assignWith=fe.assignWith;b.at=fe.at;b.before=ut.before;b.bind=ut.bind;b.bindAll=Fe.bindAll;b.bindKey=ut.bindKey;b.castArray=re.castArray;b.chain=Mi.chain;b.chunk=X.chunk;b.compact=X.compact;b.concat=X.concat;b.cond=Fe.cond;b.conforms=Fe.conforms;b.constant=Fe.constant;b.countBy=We.countBy;b.create=fe.create;b.curry=ut.curry;b.curryRight=ut.curryRight;b.debounce=ut.debounce;b.defaults=fe.defaults;b.defaultsDeep=fe.defaultsDeep;b.defer=ut.defer;b.delay=ut.delay;b.difference=X.difference;b.differenceBy=X.differenceBy;b.differenceWith=X.differenceWith;b.drop=X.drop;b.dropRight=X.dropRight;b.dropRightWhile=X.dropRightWhile;b.dropWhile=X.dropWhile;b.fill=X.fill;b.filter=We.filter;b.flatMap=We.flatMap;b.flatMapDeep=We.flatMapDeep;b.flatMapDepth=We.flatMapDepth;b.flatten=X.flatten;b.flattenDeep=X.flattenDeep;b.flattenDepth=X.flattenDepth;b.flip=ut.flip;b.flow=Fe.flow;b.flowRight=Fe.flowRight;b.fromPairs=X.fromPairs;b.functions=fe.functions;b.functionsIn=fe.functionsIn;b.groupBy=We.groupBy;b.initial=X.initial;b.intersection=X.intersection;b.intersectionBy=X.intersectionBy;b.intersectionWith=X.intersectionWith;b.invert=fe.invert;b.invertBy=fe.invertBy;b.invokeMap=We.invokeMap;b.iteratee=Fe.iteratee;b.keyBy=We.keyBy;b.keys=_t;b.keysIn=fe.keysIn;b.map=We.map;b.mapKeys=fe.mapKeys;b.mapValues=fe.mapValues;b.matches=Fe.matches;b.matchesProperty=Fe.matchesProperty;b.memoize=ut.memoize;b.merge=fe.merge;b.mergeWith=fe.mergeWith;b.method=Fe.method;b.methodOf=Fe.methodOf;b.mixin=mb;b.negate=ia;b.nthArg=Fe.nthArg;b.omit=fe.omit;b.omitBy=fe.omitBy;b.once=ut.once;b.orderBy=We.orderBy;b.over=Fe.over;b.overArgs=ut.overArgs;b.overEvery=Fe.overEvery;b.overSome=Fe.overSome;b.partial=ut.partial;b.partialRight=ut.partialRight;b.partition=We.partition;b.pick=fe.pick;b.pickBy=fe.pickBy;b.property=Fe.property;b.propertyOf=Fe.propertyOf;b.pull=X.pull;b.pullAll=X.pullAll;b.pullAllBy=X.pullAllBy;b.pullAllWith=X.pullAllWith;b.pullAt=X.pullAt;b.range=Fe.range;b.rangeRight=Fe.rangeRight;b.rearg=ut.rearg;b.reject=We.reject;b.remove=X.remove;b.rest=ut.rest;b.reverse=X.reverse;b.sampleSize=We.sampleSize;b.set=fe.set;b.setWith=fe.setWith;b.shuffle=We.shuffle;b.slice=X.slice;b.sortBy=We.sortBy;b.sortedUniq=X.sortedUniq;b.sortedUniqBy=X.sortedUniqBy;b.split=Me.split;b.spread=ut.spread;b.tail=X.tail;b.take=X.take;b.takeRight=X.takeRight;b.takeRightWhile=X.takeRightWhile;b.takeWhile=X.takeWhile;b.tap=Mi.tap;b.throttle=ut.throttle;b.thru=oa;b.toArray=re.toArray;b.toPairs=fe.toPairs;b.toPairsIn=fe.toPairsIn;b.toPath=Fe.toPath;b.toPlainObject=re.toPlainObject;b.transform=fe.transform;b.unary=ut.unary;b.union=X.union;b.unionBy=X.unionBy;b.unionWith=X.unionWith;b.uniq=X.uniq;b.uniqBy=X.uniqBy;b.uniqWith=X.uniqWith;b.unset=fe.unset;b.unzip=X.unzip;b.unzipWith=X.unzipWith;b.update=fe.update;b.updateWith=fe.updateWith;b.values=fe.values;b.valuesIn=fe.valuesIn;b.without=X.without;b.words=Me.words;b.wrap=ut.wrap;b.xor=X.xor;b.xorBy=X.xorBy;b.xorWith=X.xorWith;b.zip=X.zip;b.zipObject=X.zipObject;b.zipObjectDeep=X.zipObjectDeep;b.zipWith=X.zipWith;b.entries=fe.toPairs;b.entriesIn=fe.toPairsIn;b.extend=fe.assignIn;b.extendWith=fe.assignInWith;mb(b,b);b.add=sn.add;b.attempt=Fe.attempt;b.camelCase=Me.camelCase;b.capitalize=Me.capitalize;b.ceil=sn.ceil;b.clamp=fb.clamp;b.clone=re.clone;b.cloneDeep=re.cloneDeep;b.cloneDeepWith=re.cloneDeepWith;b.cloneWith=re.cloneWith;b.conformsTo=re.conformsTo;b.deburr=Me.deburr;b.defaultTo=Fe.defaultTo;b.divide=sn.divide;b.endsWith=Me.endsWith;b.eq=re.eq;b.escape=Me.escape;b.escapeRegExp=Me.escapeRegExp;b.every=We.every;b.find=We.find;b.findIndex=X.findIndex;b.findKey=fe.findKey;b.findLast=We.findLast;b.findLastIndex=X.findLastIndex;b.findLastKey=fe.findLastKey;b.floor=sn.floor;b.forEach=We.forEach;b.forEachRight=We.forEachRight;b.forIn=fe.forIn;b.forInRight=fe.forInRight;b.forOwn=fe.forOwn;b.forOwnRight=fe.forOwnRight;b.get=fe.get;b.gt=re.gt;b.gte=re.gte;b.has=fe.has;b.hasIn=fe.hasIn;b.head=X.head;b.identity=ft;b.includes=We.includes;b.indexOf=X.indexOf;b.inRange=fb.inRange;b.invoke=fe.invoke;b.isArguments=re.isArguments;b.isArray=me;b.isArrayBuffer=re.isArrayBuffer;b.isArrayLike=re.isArrayLike;b.isArrayLikeObject=re.isArrayLikeObject;b.isBoolean=re.isBoolean;b.isBuffer=re.isBuffer;b.isDate=re.isDate;b.isElement=re.isElement;b.isEmpty=re.isEmpty;b.isEqual=re.isEqual;b.isEqualWith=re.isEqualWith;b.isError=re.isError;b.isFinite=re.isFinite;b.isFunction=re.isFunction;b.isInteger=re.isInteger;b.isLength=re.isLength;b.isMap=re.isMap;b.isMatch=re.isMatch;b.isMatchWith=re.isMatchWith;b.isNaN=re.isNaN;b.isNative=re.isNative;b.isNil=re.isNil;b.isNull=re.isNull;b.isNumber=re.isNumber;b.isObject=Ce;b.isObjectLike=re.isObjectLike;b.isPlainObject=re.isPlainObject;b.isRegExp=re.isRegExp;b.isSafeInteger=re.isSafeInteger;b.isSet=re.isSet;b.isString=re.isString;b.isSymbol=re.isSymbol;b.isTypedArray=re.isTypedArray;b.isUndefined=re.isUndefined;b.isWeakMap=re.isWeakMap;b.isWeakSet=re.isWeakSet;b.join=X.join;b.kebabCase=Me.kebabCase;b.last=yn;b.lastIndexOf=X.lastIndexOf;b.lowerCase=Me.lowerCase;b.lowerFirst=Me.lowerFirst;b.lt=re.lt;b.lte=re.lte;b.max=sn.max;b.maxBy=sn.maxBy;b.mean=sn.mean;b.meanBy=sn.meanBy;b.min=sn.min;b.minBy=sn.minBy;b.stubArray=Fe.stubArray;b.stubFalse=Fe.stubFalse;b.stubObject=Fe.stubObject;b.stubString=Fe.stubString;b.stubTrue=Fe.stubTrue;b.multiply=sn.multiply;b.nth=X.nth;b.noop=Fe.noop;b.now=J$.now;b.pad=Me.pad;b.padEnd=Me.padEnd;b.padStart=Me.padStart;b.parseInt=Me.parseInt;b.random=fb.random;b.reduce=We.reduce;b.reduceRight=We.reduceRight;b.repeat=Me.repeat;b.replace=Me.replace;b.result=fe.result;b.round=sn.round;b.sample=We.sample;b.size=We.size;b.snakeCase=Me.snakeCase;b.some=We.some;b.sortedIndex=X.sortedIndex;b.sortedIndexBy=X.sortedIndexBy;b.sortedIndexOf=X.sortedIndexOf;b.sortedLastIndex=X.sortedLastIndex;b.sortedLastIndexBy=X.sortedLastIndexBy;b.sortedLastIndexOf=X.sortedLastIndexOf;b.startCase=Me.startCase;b.startsWith=Me.startsWith;b.subtract=sn.subtract;b.sum=sn.sum;b.sumBy=sn.sumBy;b.template=Me.template;b.times=Fe.times;b.toFinite=re.toFinite;b.toInteger=be;b.toLength=re.toLength;b.toLower=Me.toLower;b.toNumber=re.toNumber;b.toSafeInteger=re.toSafeInteger;b.toString=re.toString;b.toUpper=Me.toUpper;b.trim=Me.trim;b.trimEnd=Me.trimEnd;b.trimStart=Me.trimStart;b.truncate=Me.truncate;b.unescape=Me.unescape;b.uniqueId=Fe.uniqueId;b.upperCase=Me.upperCase;b.upperFirst=Me.upperFirst;b.each=We.forEach;b.eachRight=We.forEachRight;b.first=X.head;mb(b,function(){var n={};return Vi(b,function(t,e){HS.call(b.prototype,e)||(n[e]=t)}),n}(),{chain:!1});b.VERSION=rH;(b.templateSettings=Me.templateSettings).imports._=b;ei(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){b[n].placeholder=b});ei(["drop","take"],function(n,t){Ee.prototype[n]=function(e){e=e===void 0?1:hH(be(e),0);var i=this.__filtered__&&!t?new Ee(this):this.clone();return i.__filtered__?i.__takeCount__=a0(e,i.__takeCount__):i.__views__.push({size:a0(e,$S),type:n+(i.__dir__<0?"Right":"")}),i},Ee.prototype[n+"Right"]=function(e){return this.reverse()[n](e).reverse()}});ei(["filter","map","takeWhile"],function(n,t){var e=t+1,i=e==lH||e==cH;Ee.prototype[n]=function(s){var o=this.clone();return o.__iteratees__.push({iteratee:ge(s),type:e}),o.__filtered__=o.__filtered__||i,o}});ei(["head","last"],function(n,t){var e="take"+(t?"Right":"");Ee.prototype[n]=function(){return this[e](1).value()[0]}});ei(["initial","tail"],function(n,t){var e="drop"+(t?"":"Right");Ee.prototype[n]=function(){return this.__filtered__?new Ee(this):this[e](1)}});Ee.prototype.compact=function(){return this.filter(ft)};Ee.prototype.find=function(n){return this.filter(n).head()};Ee.prototype.findLast=function(n){return this.reverse().find(n)};Ee.prototype.invokeMap=ve(function(n,t){return typeof n=="function"?new Ee(this):this.map(function(e){return tc(e,n,t)})});Ee.prototype.reject=function(n){return this.filter(ia(ge(n)))};Ee.prototype.slice=function(n,t){n=be(n);var e=this;return e.__filtered__&&(n>0||t<0)?new Ee(e):(n<0?e=e.takeRight(-n):n&&(e=e.drop(n)),t!==void 0&&(t=be(t),e=t<0?e.dropRight(-t):e.take(t-n)),e)};Ee.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()};Ee.prototype.toArray=function(){return this.take($S)};Vi(Ee.prototype,function(n,t){var e=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),s=b[i?"take"+(t=="last"?"Right":""):t],o=i||/^find/.test(t);s&&(b.prototype[t]=function(){var r=this.__wrapped__,a=i?[1]:arguments,l=r instanceof Ee,c=a[0],u=l||me(r),d=function(v){var _=s.apply(b,Gs([v],a));return i&&f?_[0]:_};u&&e&&typeof c=="function"&&c.length!=1&&(l=u=!1);var f=this.__chain__,m=!!this.__actions__.length,g=o&&!f,p=l&&!m;if(!o&&u){r=p?r:new Ee(this);var w=n.apply(r,a);return w.__actions__.push({func:oa,args:[d],thisArg:void 0}),new Jn(w,f)}return g&&p?n.apply(this,a):(w=this.thru(d),g?i?w.value()[0]:w.value():w)})});ei(["pop","push","shift","sort","splice","unshift"],function(n){var t=uH[n],e=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",i=/^(?:pop|shift)$/.test(n);b.prototype[n]=function(){var s=arguments;if(i&&!this.__chain__){var o=this.value();return t.apply(me(o)?o:[],s)}return this[e](function(r){return t.apply(me(r)?r:[],s)})}});Vi(Ee.prototype,function(n,t){var e=b[t];if(e){var i=e.name+"";HS.call(Pr,i)||(Pr[i]=[]),Pr[i].push({name:t,func:e})}});Pr[eh(void 0,aH).name]=[{name:"wrapper",func:void 0}];Ee.prototype.clone=Y$;Ee.prototype.reverse=X$;Ee.prototype.value=oH;b.prototype.at=Mi.at;b.prototype.chain=Mi.wrapperChain;b.prototype.commit=Mi.commit;b.prototype.next=Mi.next;b.prototype.plant=Mi.plant;b.prototype.reverse=Mi.reverse;b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=Mi.value;b.prototype.first=b.prototype.head;r0&&(b.prototype[r0]=Mi.toIterator);/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */const fH=Object.freeze(Object.defineProperty({__proto__:null,add:Qk,after:nT,ary:np,assign:_T,assignIn:Nr,assignInWith:Fr,assignWith:vT,at:CT,attempt:lp,before:cp,bind:dp,bindAll:TT,bindKey:ET,camelCase:jT,capitalize:fp,castArray:GT,ceil:KT,chain:_p,chunk:ZT,clamp:JT,clone:ah,cloneDeep:kn,cloneDeepWith:Xl,cloneWith:aE,commit:ym,compact:lE,concat:cE,cond:pE,conforms:wE,conformsTo:_E,constant:Yd,countBy:CE,create:kE,curry:dh,curryRight:hh,debounce:Fn,deburr:pp,default:b,defaultTo:TE,defaults:AE,defaultsDeep:SE,defer:PE,delay:RE,difference:LE,differenceBy:VE,differenceWith:BE,divide:ME,drop:OE,dropRight:NE,dropRightWhile:FE,dropWhile:DE,each:Hu,eachRight:zu,endsWith:zE,entries:Uu,entriesIn:Wu,eq:ti,escape:Mp,escapeRegExp:Op,every:GE,extend:Nr,extendWith:Fr,fill:KE,filter:JE,find:XE,findIndex:Fp,findKey:eA,findLast:tA,findLastIndex:Dp,findLastKey:nA,first:qu,flatMap:sA,flatMapDeep:oA,flatMapDepth:rA,flatten:ap,flattenDeep:aA,flattenDepth:lA,flip:cA,floor:uA,flow:hA,flowRight:fA,forEach:Hu,forEachRight:zu,forIn:mA,forInRight:gA,forOwn:pA,forOwnRight:bA,fromPairs:wA,functions:_A,functionsIn:vA,get:Fs,groupBy:yA,gt:CA,gte:kA,has:TA,hasIn:ch,head:qu,identity:ft,inRange:EA,includes:AA,indexOf:xA,initial:SA,intersection:IA,intersectionBy:PA,intersectionWith:RA,invert:VA,invertBy:MA,invoke:NA,invokeMap:FA,isArguments:Ns,isArray:me,isArrayBuffer:DA,isArrayLike:tn,isArrayLikeObject:ct,isBoolean:$A,isBuffer:Yi,isDate:HA,isElement:Xi,isEmpty:zA,isEqual:Ds,isEqualWith:Wp,isError:oh,isFinite:UA,isFunction:vn,isInteger:qp,isLength:Kl,isMap:kp,isMatch:WA,isMatchWith:qA,isNaN:jA,isNative:GA,isNil:KA,isNull:ZA,isNumber:jp,isObject:Ce,isObjectLike:rt,isPlainObject:Rt,isRegExp:wh,isSafeInteger:JA,isSet:Tp,isString:So,isSymbol:_n,isTypedArray:No,isUndefined:YA,isWeakMap:XA,isWeakSet:QA,iteratee:e2,join:t2,kebabCase:n2,keyBy:i2,keys:_t,keysIn:nn,last:yn,lastIndexOf:s2,lodash:b,lowerCase:o2,lowerFirst:r2,lt:a2,lte:l2,map:na,mapKeys:c2,mapValues:Kp,matches:u2,matchesProperty:d2,max:h2,maxBy:f2,mean:g2,meanBy:p2,memoize:Jl,merge:nc,mergeWith:mh,method:b2,methodOf:w2,min:_2,minBy:v2,mixin:Jp,multiply:y2,negate:ia,next:Tm,noop:Jd,now:qa,nth:k2,nthArg:T2,omit:E2,omitBy:x2,once:S2,orderBy:R2,over:L2,overArgs:V2,overEvery:B2,overSome:M2,pad:z2,padEnd:U2,padStart:W2,parseInt:q2,partial:nb,partialRight:j2,partition:G2,pick:K2,pickBy:Qp,plant:Sm,property:Pp,propertyOf:Z2,pull:J2,pullAll:ob,pullAllBy:Y2,pullAllWith:X2,pullAt:ex,random:tx,range:ix,rangeRight:sx,rearg:ox,reduce:ax,reduceRight:lx,reject:cx,remove:ux,repeat:dx,replace:hx,rest:fx,result:mx,reverse:Gu,round:gx,sample:bx,sampleSize:wx,set:ab,setWith:_x,shuffle:vx,size:yx,slice:Cx,snakeCase:kx,some:Tx,sortBy:Ex,sortedIndex:Ax,sortedIndexBy:xx,sortedIndexOf:Sx,sortedLastIndex:Ix,sortedLastIndexBy:Px,sortedLastIndexOf:Rx,sortedUniq:Vx,sortedUniqBy:Bx,split:Mx,spread:Ox,startCase:cb,startsWith:Nx,stubArray:rh,stubFalse:th,stubObject:Fx,stubString:Dx,stubTrue:$x,subtract:Hx,sum:zx,sumBy:Ux,tail:Wx,take:qx,takeRight:jx,takeRightWhile:Gx,takeWhile:Kx,tap:Zx,template:Xx,templateSettings:Ku,throttle:$s,thru:oa,times:Qx,toArray:Yp,toFinite:Ti,toInteger:be,toIterator:Im,toJSON:uo,toLength:Np,toLower:tS,toNumber:Bn,toPairs:Uu,toPairsIn:Wu,toPath:nS,toPlainObject:Lp,toSafeInteger:iS,toString:Be,toUpper:sS,transform:oS,trim:lS,trimEnd:cS,trimStart:uS,truncate:dS,unary:hS,unescape:mS,union:gS,unionBy:pS,unionWith:bS,uniq:wS,uniqBy:_S,uniqWith:vS,uniqueId:yS,unset:ub,unzip:Ch,unzipWith:db,update:kS,updateWith:TS,upperCase:ES,upperFirst:Yl,value:uo,valueOf:uo,values:$o,valuesIn:AS,without:xS,words:bp,wrap:SS,wrapperAt:IS,wrapperChain:PS,wrapperCommit:ym,wrapperLodash:b,wrapperNext:Tm,wrapperPlant:Sm,wrapperReverse:RS,wrapperToIterator:Im,wrapperValue:uo,xor:LS,xorBy:VS,xorWith:BS,zip:MS,zipObject:NS,zipObjectDeep:FS,zipWith:DS},Symbol.toStringTag,{value:"Module"}));/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Pm;try{Pm={window,document}}catch{/* istanbul ignore next -- @preserve */Pm={window:{},document:{}}}var j=Pm;function mH(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const no=mH(),ue={isMac:zS(no),isWindows:gH(no),isGecko:pH(no),isSafari:bH(no),isiOS:wH(no),isAndroid:_H(no),isBlink:vH(no),get isMediaForcedColors(){return CH()},get isMotionReduced(){return kH()},features:{isRegExpUnicodePropertySupported:yH()}};function zS(n){return n.indexOf("macintosh")>-1}function gH(n){return n.indexOf("windows")>-1}function pH(n){return!!n.match(/gecko\/\d+/)}function bH(n){return n.indexOf(" applewebkit/")>-1&&n.indexOf("chrome")===-1}function wH(n){return!!n.match(/iphone|ipad/i)||zS(n)&&navigator.maxTouchPoints>0}function _H(n){return n.indexOf("android")>-1}function vH(n){return n.indexOf("chrome/")>-1&&n.indexOf("edge/")<0}function yH(){let n=!1;try{n="ć".search(new RegExp("[\\p{L}]","u"))===0}catch{}return n}function CH(){return j.window.matchMedia?j.window.matchMedia("(forced-colors: active)").matches:!1}function kH(){return j.window.matchMedia?j.window.matchMedia("(prefers-reduced-motion)").matches:!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function US(n,t,e,i){e=e||function(l,c){return l===c};const s=Array.isArray(n)?n:Array.prototype.slice.call(n),o=Array.isArray(t)?t:Array.prototype.slice.call(t),r=TH(s,o,e);return i?AH(r,o.length):EH(o,r)}function TH(n,t,e){const i=l0(n,t,e);if(i===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const s=c0(n,i),o=c0(t,i),r=l0(s,o,e),a=n.length-r,l=t.length-r;return{firstIndex:i,lastIndexOld:a,lastIndexNew:l}}function l0(n,t,e){for(let i=0;i<Math.max(n.length,t.length);i++)if(n[i]===void 0||t[i]===void 0||!e(n[i],t[i]))return i;return-1}function c0(n,t){return n.slice(t).reverse()}function EH(n,t){const e=[],{firstIndex:i,lastIndexOld:s,lastIndexNew:o}=t;return o-i>0&&e.push({index:i,type:"insert",values:n.slice(i,o)}),s-i>0&&e.push({index:i+(o-i),type:"delete",howMany:s-i}),e}function AH(n,t){const{firstIndex:e,lastIndexOld:i,lastIndexNew:s}=n;if(e===-1)return Array(t).fill("equal");let o=[];return e>0&&(o=o.concat(Array(e).fill("equal"))),s-e>0&&(o=o.concat(Array(s-e).fill("insert"))),i-e>0&&(o=o.concat(Array(i-e).fill("delete"))),s<t&&(o=o.concat(Array(t-s).fill("equal"))),o}function ja(n,t,e){e=e||function(p,w){return p===w};const i=n.length,s=t.length;if(i>200||s>200||i+s>300)return ja.fastDiff(n,t,e,!0);let o,r;if(s<i){const p=n;n=t,t=p,o="delete",r="insert"}else o="insert",r="delete";const a=n.length,l=t.length,c=l-a,u={},d={};function f(p){const w=(d[p-1]!==void 0?d[p-1]:-1)+1,v=d[p+1]!==void 0?d[p+1]:-1,_=w>v?-1:1;u[p+_]&&(u[p]=u[p+_].slice(0)),u[p]||(u[p]=[]),u[p].push(w>v?o:r);let y=Math.max(w,v),E=y-p;for(;E<a&&y<l&&e(n[E],t[y]);)E++,y++,u[p].push("equal");return y}let m=0,g;do{for(g=-m;g<c;g++)d[g]=f(g);for(g=c+m;g>c;g--)d[g]=f(g);d[c]=f(c),m++}while(d[c]!==l);return u[c].slice(1)}ja.fastDiff=US;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function u0(){return function n(){n.called=!0}}class Qi{constructor(t,e){h(this,"source");h(this,"name");h(this,"path");h(this,"stop");h(this,"off");h(this,"return");this.source=t,this.name=e,this.path=[],this.stop=u0(),this.off=u0()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Dt=new Array(256).fill("").map((n,t)=>("0"+t.toString(16)).slice(-2));function Cn(){const n=Math.random()*4294967296>>>0,t=Math.random()*4294967296>>>0,e=Math.random()*4294967296>>>0,i=Math.random()*4294967296>>>0;return"e"+Dt[n>>0&255]+Dt[n>>8&255]+Dt[n>>16&255]+Dt[n>>24&255]+Dt[t>>0&255]+Dt[t>>8&255]+Dt[t>>16&255]+Dt[t>>24&255]+Dt[e>>0&255]+Dt[e>>8&255]+Dt[e>>16&255]+Dt[e>>24&255]+Dt[i>>0&255]+Dt[i>>8&255]+Dt[i>>16&255]+Dt[i>>24&255]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Pn={get(n="normal"){return typeof n!="number"?this[n]||this.normal:n},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};function WS(n,t){const e=Pn.get(t.priority);for(let i=0;i<n.length;i++)if(Pn.get(n[i].priority)<e){n.splice(i,0,t);return}n.push(t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const xH="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";class C extends Error{constructor(e,i,s){super(SH(e,s));h(this,"context");h(this,"data");this.name="CKEditorError",this.context=i,this.data=s}is(e){return e==="CKEditorError"}static rethrowUnexpectedError(e,i){if(e.is&&e.is("CKEditorError"))throw e;const s=new C(e.message,i);throw s.stack=e.stack,s}}function Te(n,t){console.warn(...IH(n,t))}function qS(n){return`
Read more: ${xH}#error-${n}`}function SH(n,t){const e=new WeakSet,s=t?` ${JSON.stringify(t,(r,a)=>{if(typeof a=="object"&&a!==null){if(e.has(a))return`[object ${a.constructor.name}]`;e.add(a)}return a})}`:"",o=qS(n);return n+s+o}function IH(n,t){const e=qS(n);return t?[n,t,e]:[n,e]}const PH="42.0.2",RH=new Date(2024,6,25);/* istanbul ignore next -- @preserve */if(globalThis.CKEDITOR_VERSION)throw new C("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=PH;const dr=Symbol("listeningTo"),Rm=Symbol("emitterId"),Fi=Symbol("delegations"),jS=De(Object);function De(n){if(!n)return jS;class t extends n{on(i,s,o){this.listenTo(this,i,s,o)}once(i,s,o){let r=!1;const a=(l,...c)=>{r||(r=!0,l.off(),s.call(this,l,...c))};this.listenTo(this,i,a,o)}off(i,s){this.stopListening(this,i,s)}listenTo(i,s,o,r={}){let a,l;this[dr]||(this[dr]={});const c=this[dr];uf(i)||GS(i);const u=uf(i);(a=c[u])||(a=c[u]={emitter:i,callbacks:{}}),(l=a.callbacks[s])||(l=a.callbacks[s]=[]),l.push(o),MH(this,i,s,o,r)}stopListening(i,s,o){const r=this[dr];let a=i&&uf(i);const l=r&&a?r[a]:void 0,c=l&&s?l.callbacks[s]:void 0;if(!(!r||i&&!l||s&&!c))if(o)df(this,i,s,o),c.indexOf(o)!==-1&&(c.length===1?delete l.callbacks[s]:df(this,i,s,o));else if(c){for(;o=c.pop();)df(this,i,s,o);delete l.callbacks[s]}else if(l){for(s in l.callbacks)this.stopListening(i,s);delete r[a]}else{for(a in r)this.stopListening(r[a].emitter);delete this[dr]}}fire(i,...s){try{const o=i instanceof Qi?i:new Qi(this,i),r=o.name;let a=ZS(this,r);if(o.path.push(this),a){const c=[o,...s];a=Array.from(a);for(let u=0;u<a.length&&(a[u].callback.apply(this,c),o.off.called&&(delete o.off.called,this._removeEventListener(r,a[u].callback)),!o.stop.called);u++);}const l=this[Fi];if(l){const c=l.get(r),u=l.get("*");c&&d0(c,o,s),u&&d0(u,o,s)}return o.return}catch(o){/* istanbul ignore next -- @preserve */C.rethrowUnexpectedError(o,this)}}delegate(...i){return{to:(s,o)=>{this[Fi]||(this[Fi]=new Map),i.forEach(r=>{const a=this[Fi].get(r);a?a.set(s,o):this[Fi].set(r,new Map([[s,o]]))})}}}stopDelegating(i,s){if(this[Fi])if(!i)this[Fi].clear();else if(!s)this[Fi].delete(i);else{const o=this[Fi].get(i);o&&o.delete(s)}}_addEventListener(i,s,o){BH(this,i);const r=Lm(this,i),a=Pn.get(o.priority),l={callback:s,priority:a};for(const c of r)WS(c,l)}_removeEventListener(i,s){const o=Lm(this,i);for(const r of o)for(let a=0;a<r.length;a++)r[a].callback==s&&(r.splice(a,1),a--)}}return t}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(n=>{De[n]=jS.prototype[n]});function LH(n,t){const e=n[dr];return e&&e[t]?e[t].emitter:null}function GS(n,t){n[Rm]||(n[Rm]=t||Cn())}function uf(n){return n[Rm]}function KS(n){return n._events||Object.defineProperty(n,"_events",{value:{}}),n._events}function VH(){return{callbacks:[],childEvents:[]}}function BH(n,t){const e=KS(n);if(e[t])return;let i=t,s=null;const o=[];for(;i!==""&&!e[i];)e[i]=VH(),o.push(e[i]),s&&e[i].childEvents.push(s),s=i,i=i.substr(0,i.lastIndexOf(":"));if(i!==""){for(const r of o)r.callbacks=e[i].callbacks.slice();e[i].childEvents.push(s)}}function Lm(n,t){const e=KS(n)[t];if(!e)return[];let i=[e.callbacks];for(let s=0;s<e.childEvents.length;s++){const o=Lm(n,e.childEvents[s]);i=i.concat(o)}return i}function ZS(n,t){let e;return!n._events||!(e=n._events[t])||!e.callbacks.length?t.indexOf(":")>-1?ZS(n,t.substr(0,t.lastIndexOf(":"))):null:e.callbacks}function d0(n,t,e){for(let[i,s]of n){s?typeof s=="function"&&(s=s(t.name)):s=t.name;const o=new Qi(t.source,s);o.path=[...t.path],i.fire(o,...e)}}function MH(n,t,e,i,s){t._addEventListener?t._addEventListener(e,i,s):n._addEventListener.call(t,e,i,s)}function df(n,t,e,i){t._removeEventListener?t._removeEventListener(e,i):n._removeEventListener.call(t,e,i)}const Ga=Symbol("observableProperties"),wl=Symbol("boundObservables"),Ka=Symbol("boundProperties"),io=Symbol("decoratedMethods"),h0=Symbol("decoratedOriginal"),JS=Ve(De());function Ve(n){var e,i,s,o,r;if(!n)return JS;class t extends(r=n,o=Ga,s=io,i=Ka,e=wl,r){constructor(){super(...arguments);h(this,o);h(this,s);h(this,i);h(this,e)}set(c,u){if(Ce(c)){Object.keys(c).forEach(f=>{this.set(f,c[f])},this);return}hf(this);const d=this[Ga];if(c in this&&!d.has(c))throw new C("observable-set-cannot-override",this);Object.defineProperty(this,c,{enumerable:!0,configurable:!0,get(){return d.get(c)},set(f){const m=d.get(c);let g=this.fire(`set:${c}`,c,f,m);g===void 0&&(g=f),(m!==g||!d.has(c))&&(d.set(c,g),this.fire(`change:${c}`,c,g,m))}}),this[c]=u}bind(...c){if(!c.length||!f0(c))throw new C("observable-bind-wrong-properties",this);if(new Set(c).size!==c.length)throw new C("observable-bind-duplicate-properties",this);hf(this);const u=this[Ka];c.forEach(f=>{if(u.has(f))throw new C("observable-bind-rebind",this)});const d=new Map;return c.forEach(f=>{const m={property:f,to:[]};u.set(f,m),d.set(f,m)}),{to:OH,toMany:NH,_observable:this,_bindProperties:c,_to:[],_bindings:d}}unbind(...c){if(!this[Ga])return;const u=this[Ka],d=this[wl];if(c.length){if(!f0(c))throw new C("observable-unbind-wrong-properties",this);c.forEach(f=>{const m=u.get(f);m&&(m.to.forEach(([g,p])=>{const w=d.get(g),v=w[p];v.delete(m),v.size||delete w[p],Object.keys(w).length||(d.delete(g),this.stopListening(g,"change"))}),u.delete(f))})}else d.forEach((f,m)=>{this.stopListening(m,"change")}),d.clear(),u.clear()}decorate(c){hf(this);const u=this[c];if(!u)throw new C("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:c});this.on(c,(d,f)=>{d.return=u.apply(this,f)}),this[c]=function(...d){return this.fire(c,d)},this[c][h0]=u,this[io]||(this[io]=[]),this[io].push(c)}stopListening(c,u,d){if(!c&&this[io]){for(const f of this[io])this[f]=this[f][h0];delete this[io]}super.stopListening(c,u,d)}}return t}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(n=>{Ve[n]=JS.prototype[n]});function hf(n){n[Ga]||(Object.defineProperty(n,Ga,{value:new Map}),Object.defineProperty(n,wl,{value:new Map}),Object.defineProperty(n,Ka,{value:new Map}))}function OH(...n){const t=DH(...n),e=Array.from(this._bindings.keys()),i=e.length;if(!t.callback&&t.to.length>1)throw new C("observable-bind-to-no-callback",this);if(i>1&&t.callback)throw new C("observable-bind-to-extra-callback",this);t.to.forEach(s=>{if(s.properties.length&&s.properties.length!==i)throw new C("observable-bind-to-properties-length",this);s.properties.length||(s.properties=this._bindProperties)}),this._to=t.to,t.callback&&(this._bindings.get(e[0]).callback=t.callback),zH(this._observable,this._to),HH(this),this._bindProperties.forEach(s=>{YS(this._observable,s)})}function NH(n,t,e){if(this._bindings.size>1)throw new C("observable-bind-to-many-not-one-binding",this);this.to(...FH(n,t),e)}function FH(n,t){const e=n.map(i=>[i,t]);return Array.prototype.concat.apply([],e)}function f0(n){return n.every(t=>typeof t=="string")}function DH(...n){if(!n.length)throw new C("observable-bind-to-parse-error",null);const t={to:[]};let e;return typeof n[n.length-1]=="function"&&(t.callback=n.pop()),n.forEach(i=>{if(typeof i=="string")e.properties.push(i);else if(typeof i=="object")e={observable:i,properties:[]},t.to.push(e);else throw new C("observable-bind-to-parse-error",null)}),t}function $H(n,t,e,i){const s=n[wl],o=s.get(e),r=o||{};r[i]||(r[i]=new Set),r[i].add(t),o||s.set(e,r)}function HH(n){let t;n._bindings.forEach((e,i)=>{n._to.forEach(s=>{t=s.properties[e.callback?0:n._bindProperties.indexOf(i)],e.to.push([s.observable,t]),$H(n._observable,e,s.observable,t)})})}function YS(n,t){const i=n[Ka].get(t);let s;i.callback?s=i.callback.apply(n,i.to.map(o=>o[0][o[1]])):(s=i.to[0],s=s[0][s[1]]),Object.prototype.hasOwnProperty.call(n,t)?n[t]=s:n.set(t,s)}function zH(n,t){t.forEach(e=>{const i=n[wl];let s;i.get(e.observable)||n.listenTo(e.observable,"change",(o,r)=>{s=i.get(e.observable)[r],s&&s.forEach(a=>{YS(n,a.property)})})})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class XS{constructor(){h(this,"_replacedElements");this._replacedElements=[]}replace(t,e){this._replacedElements.push({element:t,newElement:e}),t.style.display="none",e&&t.parentNode.insertBefore(e,t.nextSibling)}restore(){this._replacedElements.forEach(({element:t,newElement:e})=>{t.style.display="",e&&e.remove()}),this._replacedElements=[]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vm(n){let t=0;for(const e of n)t++;return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function $t(n,t){const e=Math.min(n.length,t.length);for(let i=0;i<e;i++)if(n[i]!=t[i])return i;return n.length==t.length?"same":n.length<t.length?"prefix":"extension"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Dn(n){return!!(n&&n[Symbol.iterator])}function xt(n,t,e={},i=[]){const s=e&&e.xmlns,o=s?n.createElementNS(s,t):n.createElement(t);for(const r in e)o.setAttribute(r,e[r]);(So(i)||!Dn(i))&&(i=[i]);for(let r of i)So(r)&&(r=n.createTextNode(r)),o.appendChild(r);return o}class QS{constructor(t,e){h(this,"_config");this._config={},e&&this.define(m0(e)),t&&this._setObjectToTarget(this._config,t)}set(t,e){this._setToTarget(this._config,t,e)}define(t,e){this._setToTarget(this._config,t,e,!0)}get(t){return this._getFromSource(this._config,t)}*names(){for(const t of Object.keys(this._config))yield t}_setToTarget(t,e,i,s=!1){if(Rt(e)){this._setObjectToTarget(t,e,s);return}const o=e.split(".");e=o.pop();for(const r of o)Rt(t[r])||(t[r]={}),t=t[r];if(Rt(i)){Rt(t[e])||(t[e]={}),t=t[e],this._setObjectToTarget(t,i,s);return}s&&typeof t[e]<"u"||(t[e]=i)}_getFromSource(t,e){const i=e.split(".");e=i.pop();for(const s of i){if(!Rt(t[s])){t=null;break}t=t[s]}return t?m0(t[e]):void 0}_setObjectToTarget(t,e,i){Object.keys(e).forEach(s=>{this._setToTarget(t,s,e[s],i)})}}function m0(n){return Xl(n,UH)}function UH(n){return Xi(n)||typeof n=="function"?n:void 0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function zs(n){if(n){if(n.defaultView)return n instanceof n.defaultView.Document;if(n.ownerDocument&&n.ownerDocument.defaultView)return n instanceof n.ownerDocument.defaultView.Node}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Zu(n){const t=Object.prototype.toString.apply(n);return t=="[object Window]"||t=="[object global]"}const e5=on(De());function on(n){if(!n)return e5;class t extends n{listenTo(i,s,o,r={}){if(zs(i)||Zu(i)){const a={capture:!!r.useCapture,passive:!!r.usePassive},l=this._getProxyEmitter(i,a)||new WH(i,a);this.listenTo(l,s,o,r)}else super.listenTo(i,s,o,r)}stopListening(i,s,o){if(zs(i)||Zu(i)){const r=this._getAllProxyEmitters(i);for(const a of r)this.stopListening(a,s,o)}else super.stopListening(i,s,o)}_getProxyEmitter(i,s){return LH(this,t5(i,s))}_getAllProxyEmitters(i){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(s=>this._getProxyEmitter(i,s)).filter(s=>!!s)}}return t}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(n=>{on[n]=e5.prototype[n]});class WH extends De(){constructor(e,i){super();h(this,"_domNode");h(this,"_options");h(this,"_domListeners");GS(this,t5(e,i)),this._domNode=e,this._options=i}attach(e){if(this._domListeners&&this._domListeners[e])return;const i=this._createDomListener(e);this._domNode.addEventListener(e,i,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=i}detach(e){let i;this._domListeners[e]&&(!(i=this._events[e])||!i.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,i,s){this.attach(e),De().prototype._addEventListener.call(this,e,i,s)}_removeEventListener(e,i){De().prototype._removeEventListener.call(this,e,i),this.detach(e)}_createDomListener(e){const i=s=>{this.fire(e,s)};return i.removeListener=()=>{this._domNode.removeEventListener(e,i,this._options),delete this._domListeners[e]},i}}function qH(n){return n["data-ck-expando"]||(n["data-ck-expando"]=Cn())}function t5(n,t){let e=qH(n);for(const i of Object.keys(t).sort())t[i]&&(e+="-"+i);return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function jH(n){const t=[];let e=n;for(;e&&e.nodeType!=Node.DOCUMENT_NODE;)t.unshift(e),e=e.parentNode;return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function GH(n){return n instanceof HTMLTextAreaElement?n.value:n.innerHTML}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function n5(n){const t=n.ownerDocument.defaultView.getComputedStyle(n);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function dt(n){return Object.prototype.toString.call(n)=="[object Text]"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function kh(n){return Object.prototype.toString.apply(n)=="[object Range]"}function i5(n){return!n||!n.parentNode||n.offsetParent===j.document.body?null:n.offsetParent}const s5=["top","right","bottom","left","width","height"];class he{constructor(t){h(this,"top");h(this,"right");h(this,"bottom");h(this,"left");h(this,"width");h(this,"height");h(this,"_source");const e=kh(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),Bm(t)||e)if(e){const i=he.getDomRangeRects(t);Bc(this,he.getBoundingRect(i))}else Bc(this,t.getBoundingClientRect());else if(Zu(t)){const{innerWidth:i,innerHeight:s}=t;Bc(this,{top:0,right:i,bottom:s,left:0,width:i,height:s})}else Bc(this,t)}clone(){return new he(this)}moveTo(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}moveBy(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}getIntersection(t){const e={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left),width:0,height:0};if(e.width=e.right-e.left,e.height=e.bottom-e.top,e.width<0||e.height<0)return null;{const i=new he(e);return i._source=this._source,i}}getIntersectionArea(t){const e=this.getIntersection(t);return e?e.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let e=this.clone();if(g0(t))return e;let i=t,s=t.parentNode||t.commonAncestorContainer,o;for(;s&&!g0(s);){const r=KH(s)==="visible";i instanceof HTMLElement&&p0(i)==="absolute"&&(o=i);const a=p0(s);if(r||o&&(a==="relative"&&r||a!=="relative")){i=s,s=s.parentNode;continue}const l=new he(s),c=e.getIntersection(l);if(c)c.getArea()<e.getArea()&&(e=c);else return null;i=s,s=s.parentNode}return e}isEqual(t){for(const e of s5)if(this[e]!==t[e])return!1;return!0}contains(t){const e=this.getIntersection(t);return!!(e&&e.isEqual(t))}toAbsoluteRect(){const{scrollX:t,scrollY:e}=j.window,i=this.clone().moveBy(t,e);if(Bm(i._source)){const s=i5(i._source);s&&ZH(i,s)}return i}excludeScrollbarsAndBorders(){const t=this._source;let e,i,s;if(Zu(t))e=t.innerWidth-t.document.documentElement.clientWidth,i=t.innerHeight-t.document.documentElement.clientHeight,s=t.getComputedStyle(t.document.documentElement).direction;else{const o=n5(t);e=t.offsetWidth-t.clientWidth-o.left-o.right,i=t.offsetHeight-t.clientHeight-o.top-o.bottom,s=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=o.left,this.top+=o.top,this.right-=o.right,this.bottom-=o.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=e,s==="ltr"?this.right-=e:this.left+=e,this.height-=i,this.bottom-=i,this}static getDomRangeRects(t){const e=[],i=Array.from(t.getClientRects());if(i.length)for(const s of i)e.push(new he(s));else{let s=t.startContainer;dt(s)&&(s=s.parentNode);const o=new he(s.getBoundingClientRect());o.right=o.left,o.width=0,e.push(o)}return e}static getBoundingRect(t){const e={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let i=0;for(const s of t)i++,e.left=Math.min(e.left,s.left),e.top=Math.min(e.top,s.top),e.right=Math.max(e.right,s.right),e.bottom=Math.max(e.bottom,s.bottom);return i==0?null:(e.width=e.right-e.left,e.height=e.bottom-e.top,new he(e))}}function Bc(n,t){for(const e of s5)n[e]=t[e]}function g0(n){return Bm(n)?n===n.ownerDocument.body:!1}function Bm(n){return n!==null&&typeof n=="object"&&n.nodeType===1&&typeof n.getBoundingClientRect=="function"}function p0(n){return n instanceof HTMLElement?n.ownerDocument.defaultView.getComputedStyle(n).position:"static"}function KH(n){return n instanceof HTMLElement?n.ownerDocument.defaultView.getComputedStyle(n).overflow:"visible"}function ZH(n,t){const e=new he(t),i=n5(t);let s=0,o=0;s-=e.left,o-=e.top,s+=t.scrollLeft,o+=t.scrollTop,s-=i.left,o-=i.top,n.moveBy(s,o)}const nt=class nt{constructor(t,e){h(this,"_element");h(this,"_callback");nt._observerInstance||nt._createObserver(),this._element=t,this._callback=e,nt._addElementCallback(t,e),nt._observerInstance.observe(t)}get element(){return this._element}destroy(){nt._deleteElementCallback(this._element,this._callback)}static _addElementCallback(t,e){nt._elementCallbacks||(nt._elementCallbacks=new Map);let i=nt._elementCallbacks.get(t);i||(i=new Set,nt._elementCallbacks.set(t,i)),i.add(e)}static _deleteElementCallback(t,e){const i=nt._getElementCallbacks(t);i&&(i.delete(e),i.size||(nt._elementCallbacks.delete(t),nt._observerInstance.unobserve(t))),nt._elementCallbacks&&!nt._elementCallbacks.size&&(nt._observerInstance=null,nt._elementCallbacks=null)}static _getElementCallbacks(t){return nt._elementCallbacks?nt._elementCallbacks.get(t):null}static _createObserver(){nt._observerInstance=new j.window.ResizeObserver(t=>{for(const e of t){const i=nt._getElementCallbacks(e.target);if(i)for(const s of i)s(e)}})}};h(nt,"_observerInstance",null),h(nt,"_elementCallbacks",null);let Dr=nt;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function b0(n,t){n instanceof HTMLTextAreaElement&&(n.value=t),n.innerHTML=t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ra(n){return t=>t+n}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ra(n){let t=0;for(;n.previousSibling;)n=n.previousSibling,t++;return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function o5(n,t,e){n.insertBefore(e,n.childNodes[t]||null)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Za(n){return n&&n.nodeType===Node.COMMENT_NODE}function r5(n){try{j.document.createAttribute(n)}catch{return!1}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Io(n){return!!(n&&n.getClientRects&&n.getClientRects().length)}function gb({element:n,target:t,positions:e,limiter:i,fitInViewport:s,viewportOffsetConfig:o}){vn(t)&&(t=t()),vn(i)&&(i=i());const r=i5(n),a=JH(o),l=new he(n),c=w0(t,a);let u;if(!c||!a.getIntersection(c))return null;const d={targetRect:c,elementRect:l,positionedElementAncestor:r,viewportRect:a};if(!i&&!s)u=new a5(e[0],d);else{if(i){const f=w0(i,a);f&&(d.limiterRect=f)}u=YH(e,d)}return u}function w0(n,t){const e=new he(n).getVisible();return e?e.getIntersection(t):null}function JH(n){n=Object.assign({top:0,bottom:0,left:0,right:0},n);const t=new he(j.window);return t.top+=n.top,t.height-=n.top,t.bottom-=n.bottom,t.height-=n.bottom,t}function YH(n,t){const{elementRect:e}=t,i=e.getArea(),s=n.map(a=>new a5(a,t)).filter(a=>!!a.name);let o=0,r=null;for(const a of s){const{limiterIntersectionArea:l,viewportIntersectionArea:c}=a;if(l===i)return a;const u=c**2+l**2;u>o&&(o=u,r=a)}return r}class a5{constructor(t,e){h(this,"name");h(this,"config");h(this,"_positioningFunctionCoordinates");h(this,"_options");h(this,"_cachedRect");h(this,"_cachedAbsoluteRect");const i=t(e.targetRect,e.elementRect,e.viewportRect,e.limiterRect);if(!i)return;const{left:s,top:o,name:r,config:a}=i;this.name=r,this.config=a,this._positioningFunctionCoordinates={left:s,top:o},this._options=e}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const t=this._options.limiterRect;return t?t.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=this._rect.toAbsoluteRect(),this._cachedAbsoluteRect)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function _0(n){const t=n.parentNode;t&&t.removeChild(n)}function XH({target:n,viewportOffset:t=0,ancestorOffset:e=0,alignToTop:i,forceScroll:s}){const o=pb(n);let r=o,a=null;for(t=tz(t);r;){let l;r==o?l=v0(n):l=v0(a),ez({parent:l,getRect:()=>y0(n,r),alignToTop:i,ancestorOffset:e,forceScroll:s});const c=y0(n,r);if(QH({window:r,rect:c,viewportOffset:t,alignToTop:i,forceScroll:s}),r.parent!=r){if(a=r.frameElement,r=r.parent,!a)return}else r=null}}function QH({window:n,rect:t,alignToTop:e,forceScroll:i,viewportOffset:s}){const o=t.clone().moveBy(0,s.bottom),r=t.clone().moveBy(0,-s.top),a=new he(n).excludeScrollbarsAndBorders(),l=[r,o],c=e&&i,u=l.every(p=>a.contains(p));let{scrollX:d,scrollY:f}=n;const m=d,g=f;c?f-=a.top-t.top+s.top:u||(c5(r,a)?f-=a.top-t.top+s.top:l5(o,a)&&(e?f+=t.top-a.top-s.top:f+=t.bottom-a.bottom+s.bottom)),u||(u5(t,a)?d-=a.left-t.left+s.left:d5(t,a)&&(d+=t.right-a.right+s.right)),(d!=m||f!==g)&&n.scrollTo(d,f)}function ez({parent:n,getRect:t,alignToTop:e,forceScroll:i,ancestorOffset:s=0,limiterElement:o}){const r=pb(n),a=e&&i;let l,c,u;const d=o||r.document.body;for(;n!=d;)c=t(),l=new he(n).excludeScrollbarsAndBorders(),u=l.contains(c),a?n.scrollTop-=l.top-c.top+s:u||(c5(c,l)?n.scrollTop-=l.top-c.top+s:l5(c,l)&&(e?n.scrollTop+=c.top-l.top-s:n.scrollTop+=c.bottom-l.bottom+s)),u||(u5(c,l)?n.scrollLeft-=l.left-c.left+s:d5(c,l)&&(n.scrollLeft+=c.right-l.right+s)),n=n.parentNode}function l5(n,t){return n.bottom>t.bottom}function c5(n,t){return n.top<t.top}function u5(n,t){return n.left<t.left}function d5(n,t){return n.right>t.right}function pb(n){return kh(n)?n.startContainer.ownerDocument.defaultView:n.ownerDocument.defaultView}function v0(n){if(kh(n)){let t=n.commonAncestorContainer;return dt(t)&&(t=t.parentNode),t}else return n.parentNode}function y0(n,t){const e=pb(n),i=new he(n);if(e===t)return i;{let s=e;for(;s!=t;){const o=s.frameElement,r=new he(o).excludeScrollbarsAndBorders();i.moveBy(r.left,r.top),s=s.parent}}return i}function tz(n){return typeof n=="number"?{top:n,bottom:n,left:n,right:n}:n}const nz={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},iz={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},C0={37:"←",38:"↑",39:"→",40:"↓",9:"⇥",33:"Page Up",34:"Page Down"},_e=lz(),sz=Object.fromEntries(Object.entries(_e).map(([n,t])=>{let e;return t in C0?e=C0[t]:e=n.charAt(0).toUpperCase()+n.slice(1),[t,e]}));function Po(n){let t;if(typeof n=="string"){if(t=_e[n.toLowerCase()],!t)throw new C("keyboard-unknown-key",null,{key:n})}else t=n.keyCode+(n.altKey?_e.alt:0)+(n.ctrlKey?_e.ctrl:0)+(n.shiftKey?_e.shift:0)+(n.metaKey?_e.cmd:0);return t}function Th(n){return typeof n=="string"&&(n=cz(n)),n.map(t=>typeof t=="string"?rz(t):t).reduce((t,e)=>e+t,0)}function Ju(n){let t=Th(n);return Object.entries(ue.isMac||ue.isiOS?nz:iz).reduce((s,[o,r])=>(t&_e[o]&&(t&=~_e[o],s+=r),s),"")+(t?sz[t]:"")}function oz(n){return n==_e.arrowright||n==_e.arrowleft||n==_e.arrowup||n==_e.arrowdown}function Eh(n,t){const e=t==="ltr";switch(n){case _e.arrowleft:return e?"left":"right";case _e.arrowright:return e?"right":"left";case _e.arrowup:return"up";case _e.arrowdown:return"down"}}function rz(n){if(n.endsWith("!"))return Po(n.slice(0,-1));const t=Po(n);return(ue.isMac||ue.isiOS)&&t==_e.ctrl?_e.cmd:t}function az(n,t){const e=Eh(n,t);return e==="down"||e==="right"}function lz(){const n={pageup:33,pagedown:34,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let t=65;t<=90;t++){const e=String.fromCharCode(t);n[e.toLowerCase()]=t}for(let t=48;t<=57;t++)n[t-48]=t;for(let t=112;t<=123;t++)n["f"+(t-111)]=t;return Object.assign(n,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),n}function cz(n){return n.split("+").map(t=>t.trim())}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const uz=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig"];function k0(n){return uz.includes(n)?"rtl":"ltr"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Pe(n){return Array.isArray(n)?n:[n]}/* istanbul ignore else -- @preserve */j.window.CKEDITOR_TRANSLATIONS||(j.window.CKEDITOR_TRANSLATIONS={});function dz(n,t,e=1,i){if(typeof e!="number")throw new C("translation-service-quantity-not-a-number",null,{quantity:e});const s=i||j.window.CKEDITOR_TRANSLATIONS,o=mz(s);o===1&&(n=Object.keys(s)[0]);const r=t.id||t.string;if(o===0||!fz(n,r,s))return e!==1?t.plural:t.string;const a=s[n].dictionary,l=s[n].getPluralForm||(d=>d===1?0:1),c=a[r];if(typeof c=="string")return c;const u=Number(l(e));return c[u]}function hz(n){return Array.isArray(n)?n.reduce((t,e)=>nc(t,e)):n}function fz(n,t,e){return!!e[n]&&!!e[n].dictionary[t]}function mz(n){return Object.keys(n).length}class gz{constructor({uiLanguage:t="en",contentLanguage:e,translations:i}={}){h(this,"uiLanguage");h(this,"uiLanguageDirection");h(this,"contentLanguage");h(this,"contentLanguageDirection");h(this,"t");h(this,"translations");this.uiLanguage=t,this.contentLanguage=e||this.uiLanguage,this.uiLanguageDirection=k0(this.uiLanguage),this.contentLanguageDirection=k0(this.contentLanguage),this.translations=hz(i),this.t=(s,o)=>this._t(s,o)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(t,e=[]){e=Pe(e),typeof t=="string"&&(t={string:t});const s=!!t.plural?e[0]:1,o=dz(this.uiLanguage,t,s,this.translations);return pz(o,e)}}function pz(n,t){return n.replace(/%(\d+)/g,(e,i)=>i<t.length?t[i]:e)}class rn extends De(){constructor(e={},i={}){super();h(this,"_items");h(this,"_itemMap");h(this,"_idProperty");h(this,"_bindToCollection");h(this,"_bindToExternalToInternalMap");h(this,"_bindToInternalToExternalMap");h(this,"_skippedIndexesFromExternal");const s=Dn(e);if(s||(i=e),this._items=[],this._itemMap=new Map,this._idProperty=i.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],s)for(const o of e)this._items.push(o),this._itemMap.set(this._getItemIdBeforeAdding(o),o)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,i){return this.addMany([e],i)}addMany(e,i){if(i===void 0)i=this._items.length;else if(i>this._items.length||i<0)throw new C("collection-add-item-invalid-index",this);let s=0;for(const o of e){const r=this._getItemIdBeforeAdding(o),a=i+s;this._items.splice(a,0,o),this._itemMap.set(r,o),this.fire("add",o,a),s++}return this.fire("change",{added:e,removed:[],index:i}),this}get(e){let i;if(typeof e=="string")i=this._itemMap.get(e);else if(typeof e=="number")i=this._items[e];else throw new C("collection-get-invalid-arg",this);return i||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const i=this._idProperty,s=e[i];return s&&this._itemMap.has(s)}}getIndex(e){let i;return typeof e=="string"?i=this._itemMap.get(e):i=e,i?this._items.indexOf(i):-1}remove(e){const[i,s]=this._remove(e);return this.fire("change",{added:[],removed:[i],index:s}),i}map(e,i){return this._items.map(e,i)}forEach(e,i){this._items.forEach(e,i)}find(e,i){return this._items.find(e,i)}filter(e,i){return this._items.filter(e,i)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new C("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:i=>{this._setUpBindToBinding(s=>new i(s))},using:i=>{typeof i=="function"?this._setUpBindToBinding(i):this._setUpBindToBinding(s=>s[i])}}}_setUpBindToBinding(e){const i=this._bindToCollection,s=(o,r,a)=>{const l=i._bindToCollection==this,c=i._bindToInternalToExternalMap.get(r);if(l&&c)this._bindToExternalToInternalMap.set(r,c),this._bindToInternalToExternalMap.set(c,r);else{const u=e(r);if(!u){this._skippedIndexesFromExternal.push(a);return}let d=a;for(const f of this._skippedIndexesFromExternal)a>f&&d--;for(const f of i._skippedIndexesFromExternal)d>=f&&d++;this._bindToExternalToInternalMap.set(r,u),this._bindToInternalToExternalMap.set(u,r),this.add(u,d);for(let f=0;f<i._skippedIndexesFromExternal.length;f++)d<=i._skippedIndexesFromExternal[f]&&i._skippedIndexesFromExternal[f]++}};for(const o of i)s(null,o,i.getIndex(o));this.listenTo(i,"add",s),this.listenTo(i,"remove",(o,r,a)=>{const l=this._bindToExternalToInternalMap.get(r);l&&this.remove(l),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((c,u)=>(a<u&&c.push(u-1),a>u&&c.push(u),c),[])})}_getItemIdBeforeAdding(e){const i=this._idProperty;let s;if(i in e){if(s=e[i],typeof s!="string")throw new C("collection-add-invalid-id",this);if(this.get(s))throw new C("collection-add-item-already-exists",this)}else e[i]=s=Cn();return s}_remove(e){let i,s,o,r=!1;const a=this._idProperty;if(typeof e=="string"?(s=e,o=this._itemMap.get(s),r=!o,o&&(i=this._items.indexOf(o))):typeof e=="number"?(i=e,o=this._items[i],r=!o,o&&(s=o[a])):(o=e,s=o[a],i=this._items.indexOf(o),r=i==-1||!this._itemMap.get(s)),r)throw new C("collection-remove-404",this);this._items.splice(i,1),this._itemMap.delete(s);const l=this._bindToInternalToExternalMap.get(o);return this._bindToInternalToExternalMap.delete(o),this._bindToExternalToInternalMap.delete(l),this.fire("remove",o,i),[o,i]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ye(n){const t=n.next();return t.done?null:t.value}class Ge extends on(Ve()){constructor(){super();h(this,"_elements",new Set);h(this,"_nextEventLoopTimeout",null);this.set("isFocused",!1),this.set("focusedElement",null)}add(e){if(this._elements.has(e))throw new C("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>this._focus(e),{useCapture:!0}),this.listenTo(e,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}class tt{constructor(){h(this,"_listener");this._listener=new(on())}listenTo(t){this._listener.listenTo(t,"keydown",(e,i)=>{this._listener.fire("_keydown:"+Po(i),i)})}set(t,e,i={}){const s=Th(t),o=i.priority;this._listener.listenTo(this._listener,"_keydown:"+s,(r,a)=>{e(a,()=>{a.preventDefault(),a.stopPropagation(),r.stop()}),r.return=!0},{priority:o})}press(t){return!!this._listener.fire("_keydown:"+Po(t),t)}stopListening(t){this._listener.stopListening(t)}destroy(){this.stopListening()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function bz(n){const t=new Map;for(const e in n)t.set(e,n[e]);return t}function Ii(n){return Dn(n)?new Map(n):bz(n)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const wz=1e4;function _z(n,t,e,i){if(Math.max(t.length,n.length)>wz)return n.slice(0,e).concat(t).concat(n.slice(e+i,n.length));{const s=Array.from(n);return s.splice(e,i,...t),s}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function bb(n,t){let e;function i(...s){i.cancel(),e=setTimeout(()=>n(...s),t)}return i.cancel=()=>{clearTimeout(e)},i}function vz(n){function t(d){return d.length>=40&&d.length<=255?"VALID":"INVALID"}if(!n)return"INVALID";let e="";try{e=atob(n)}catch{return"INVALID"}const i=e.split("-"),s=i[0],o=i[1];if(!o)return t(n);try{atob(o)}catch{try{if(atob(s),!atob(s).length)return t(n)}catch{return t(n)}}if(s.length<40||s.length>255)return"INVALID";let r="";try{atob(s),r=atob(o)}catch{return"INVALID"}if(r.length!==8)return"INVALID";const a=Number(r.substring(0,4)),l=Number(r.substring(4,6))-1,c=Number(r.substring(6,8)),u=new Date(a,l,c);return u<RH||isNaN(Number(u))?"INVALID":"VALID"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function yz(n){return!!n&&n.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(n)}function Cz(n){return!!n&&n.length==1&&/[\ud800-\udbff]/.test(n)}function kz(n){return!!n&&n.length==1&&/[\udc00-\udfff]/.test(n)}function wb(n,t){return Cz(n.charAt(t-1))&&kz(n.charAt(t))}function _b(n,t){return yz(n.charAt(t))}const Tz=Ez();function h5(n,t){const e=String(n).matchAll(Tz);return Array.from(e).some(i=>i.index<t&&t<i.index+i[0].length)}function Ez(){const n=[new RegExp("\\p{Emoji}[\\u{E0020}-\\u{E007E}]+\\u{E007F}","u"),new RegExp("\\p{Emoji}\\u{FE0F}?\\u{20E3}","u"),new RegExp("\\p{Emoji}\\u{FE0F}","u"),new RegExp("(?=\\p{General_Category=Other_Symbol})\\p{Emoji}\\p{Emoji_Modifier}*","u")],t=new RegExp("\\p{Regional_Indicator}{2}","u").source,e="(?:"+n.map(s=>s.source).join("|")+")",i=`${t}|${e}(?:‍${e})*`;return new RegExp(i,"ug")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const fu=new WeakMap;let T0=!1;function vb({view:n,element:t,text:e,isDirectHost:i=!0,keepOnFocus:s=!1}){const o=n.document;fu.has(o)||(fu.set(o,new Map),o.registerPostFixer(a=>ff(o,a)),o.on("change:isComposing",()=>{n.change(a=>ff(o,a))},{priority:"high"})),t.is("editableElement")&&t.on("change:placeholder",(a,l,c)=>{r(c)}),t.placeholder?r(t.placeholder):e&&r(e),e&&Pz();function r(a){fu.get(o).set(t,{text:a,isDirectHost:i,keepOnFocus:s,hostElement:i?t:null}),n.change(l=>ff(o,l))}}function Az(n,t){return t.hasClass("ck-placeholder")?!1:(n.addClass("ck-placeholder",t),!0)}function xz(n,t){return t.hasClass("ck-placeholder")?(n.removeClass("ck-placeholder",t),!0):!1}function Sz(n,t){if(!n.isAttached()||Array.from(n.getChildren()).some(r=>!r.is("uiElement")))return!1;const i=n.document,o=i.selection.anchor;return i.isComposing&&o&&o.parent===n?!1:t||!i.isFocused?!0:!!o&&o.parent!==n}function ff(n,t){const e=fu.get(n),i=[];let s=!1;for(const[o,r]of e)r.isDirectHost&&(i.push(o),E0(t,o,r)&&(s=!0));for(const[o,r]of e){if(r.isDirectHost)continue;const a=Iz(o);a&&(i.includes(a)||(r.hostElement=a,E0(t,o,r)&&(s=!0)))}return s}function E0(n,t,e){const{text:i,isDirectHost:s,hostElement:o}=e;let r=!1;return o.getAttribute("data-placeholder")!==i&&(n.setAttribute("data-placeholder",i,o),r=!0),(s||t.childCount==1)&&Sz(o,e.keepOnFocus)?Az(n,o)&&(r=!0):xz(n,o)&&(r=!0),r}function Iz(n){if(n.childCount){const t=n.getChild(0);if(t.is("element")&&!t.is("uiElement")&&!t.is("attributeElement"))return t}return null}function Pz(){T0||Te("enableplaceholder-deprecated-text-option"),T0=!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Ho=class{is(){throw new Error("is() method is abstract")}},zo=class extends De(Ho){constructor(e){super();h(this,"document");h(this,"parent");this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))==-1)throw new C("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let i=this;for(;i.parent;)e.unshift(i.index),i=i.parent;return e}getAncestors(e={}){const i=[];let s=e.includeSelf?this:this.parent;for(;s;)i[e.parentFirst?"push":"unshift"](s),s=s.parent;return i}getCommonAncestor(e,i={}){const s=this.getAncestors(i),o=e.getAncestors(i);let r=0;for(;s[r]==o[r]&&s[r];)r++;return r===0?null:s[r-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const i=this.getPath(),s=e.getPath(),o=$t(i,s);switch(o){case"prefix":return!0;case"extension":return!1;default:return i[o]<s[o]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,i){this.fire(`change:${e}`,i),this.parent&&this.parent._fireChange(e,i)}toJSON(){const e=ah(this);return delete e.parent,e}};zo.prototype.is=function(n){return n==="node"||n==="view:node"};let et=class Mm extends zo{constructor(e,i){super(e);h(this,"_textData");this._textData=i}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof Mm?this===e||this.data===e.data:!1}_clone(){return new Mm(this.document,this.data)}};et.prototype.is=function(n){return n==="$text"||n==="view:$text"||n==="text"||n==="view:text"||n==="node"||n==="view:node"};let Ci=class extends Ho{constructor(e,i,s){super();h(this,"textNode");h(this,"data");h(this,"offsetInText");if(this.textNode=e,i<0||i>e.data.length)throw new C("view-textproxy-wrong-offsetintext",this);if(s<0||i+s>e.data.length)throw new C("view-textproxy-wrong-length",this);this.data=e.data.substring(i,i+s),this.offsetInText=i}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(e={}){const i=[];let s=e.includeSelf?this.textNode:this.parent;for(;s!==null;)i[e.parentFirst?"push":"unshift"](s),s=s.parent;return i}};Ci.prototype.is=function(n){return n==="$textProxy"||n==="view:$textProxy"||n==="textProxy"||n==="view:textProxy"};class Qt{constructor(...t){h(this,"_patterns",[]);this.add(...t)}add(...t){for(let e of t)(typeof e=="string"||e instanceof RegExp)&&(e={name:e}),this._patterns.push(e)}match(...t){for(const e of t)for(const i of this._patterns){const s=A0(e,i);if(s)return{element:e,pattern:i,match:s}}return null}matchAll(...t){const e=[];for(const i of t)for(const s of this._patterns){const o=A0(i,s);o&&e.push({element:i,pattern:s,match:o})}return e.length>0?e:null}getElementName(){if(this._patterns.length!==1)return null;const t=this._patterns[0],e=t.name;return typeof t!="function"&&e&&!(e instanceof RegExp)?e:null}}function A0(n,t){if(typeof t=="function")return t(n);const e={};return t.name&&(e.name=Rz(t.name,n.name),!e.name)||t.attributes&&(e.attributes=Mz(t.attributes,n),!e.attributes)||t.classes&&(e.classes=Oz(t.classes,n),!e.classes)||t.styles&&(e.styles=Nz(t.styles,n),!e.styles)?null:e}function Rz(n,t){return n instanceof RegExp?!!t.match(n):n===t}function yb(n,t,e){const i=Lz(n),s=Array.from(t),o=[];if(i.forEach(([r,a])=>{s.forEach(l=>{Vz(r,l)&&Bz(a,l,e)&&o.push(l)})}),!(!i.length||o.length<i.length))return o}function Lz(n){return Array.isArray(n)?n.map(t=>Rt(t)?((t.key===void 0||t.value===void 0)&&Te("matcher-pattern-missing-key-or-value",t),[t.key,t.value]):[t,!0]):Rt(n)?Object.entries(n):[[n,!0]]}function Vz(n,t){return n===!0||n===t||n instanceof RegExp&&t.match(n)}function Bz(n,t,e){if(n===!0)return!0;const i=e(t);return n===i||n instanceof RegExp&&!!String(i).match(n)}function Mz(n,t){const e=new Set(t.getAttributeKeys());return Rt(n)?(n.style!==void 0&&Te("matcher-pattern-deprecated-attributes-style-key",n),n.class!==void 0&&Te("matcher-pattern-deprecated-attributes-class-key",n)):(e.delete("style"),e.delete("class")),yb(n,e,i=>t.getAttribute(i))}function Oz(n,t){return yb(n,t.getClassNames(),()=>{})}function Nz(n,t){return yb(n,t.getStyleNames(!0),e=>t.getStyle(e))}class Yu{constructor(t){h(this,"_styles");h(this,"_styleProcessor");this._styles={},this._styleProcessor=t}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=Dz(t);for(const[i,s]of e)this._styleProcessor.toNormalizedForm(i,s,this._styles)}has(t){if(this.isEmpty)return!1;const i=this._styleProcessor.getReducedForm(t,this._styles).find(([s])=>s===t);return Array.isArray(i)}set(t,e){if(Ce(t))for(const[i,s]of Object.entries(t))this._styleProcessor.toNormalizedForm(i,s,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=Om(t);ub(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this.getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!Ce(this._styles[t]))return this._styles[t];const i=this._styleProcessor.getReducedForm(t,this._styles).find(([s])=>s===t);if(Array.isArray(i))return i[1]}getStyleNames(t=!1){return this.isEmpty?[]:t?this._styleProcessor.getStyleNames(this._styles):this.getStylesEntries().map(([i])=>i)}clear(){this._styles={}}getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const i of e)t.push(...this._styleProcessor.getReducedForm(i,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const s=e.splice(0,e.length-1).join("."),o=Fs(this._styles,s);if(!o)return;!Object.keys(o).length&&this.remove(s)}}class Fz{constructor(){h(this,"_normalizers");h(this,"_extractors");h(this,"_reducers");h(this,"_consumables");this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(t,e,i){if(Ce(e)){mf(i,Om(t),e);return}if(this._normalizers.has(t)){const s=this._normalizers.get(t),{path:o,value:r}=s(e);mf(i,o,r)}else mf(i,t,e)}getNormalized(t,e){if(!t)return nc({},e);if(e[t]!==void 0)return e[t];if(this._extractors.has(t)){const i=this._extractors.get(t);if(typeof i=="string")return Fs(e,i);const s=i(t,e);if(s)return s}return Fs(e,Om(t))}getReducedForm(t,e){const i=this.getNormalized(t,e);return i===void 0?[]:this._reducers.has(t)?this._reducers.get(t)(i):[[t,i]]}getStyleNames(t){const e=Array.from(this._consumables.keys()).filter(s=>{const o=this.getNormalized(s,t);return o&&typeof o=="object"?Object.keys(o).length:o}),i=new Set([...e,...Object.keys(t)]);return Array.from(i)}getRelatedStyles(t){return this._consumables.get(t)||[]}setNormalizer(t,e){this._normalizers.set(t,e)}setExtractor(t,e){this._extractors.set(t,e)}setReducer(t,e){this._reducers.set(t,e)}setStyleRelation(t,e){this._mapStyleNames(t,e);for(const i of e)this._mapStyleNames(i,[t])}_mapStyleNames(t,e){this._consumables.has(t)||this._consumables.set(t,[]),this._consumables.get(t).push(...e)}}function Dz(n){let t=null,e=0,i=0,s=null;const o=new Map;if(n==="")return o;n.charAt(n.length-1)!=";"&&(n=n+";");for(let r=0;r<n.length;r++){const a=n.charAt(r);if(t===null)switch(a){case":":s||(s=n.substr(e,r-e),i=r+1);break;case'"':case"'":t=a;break;case";":{const l=n.substr(i,r-i);s&&o.set(s.trim(),l.trim()),s=null,e=r+1;break}}else a===t&&(t=null)}return o}function Om(n){return n.replace("-",".")}function mf(n,t,e){let i=e;Ce(e)&&(i=nc({},Fs(n,t),e)),ab(n,t,i)}let hi=class f5 extends zo{constructor(e,i,s,o){super(e);h(this,"name");h(this,"_unsafeAttributesToRender",[]);h(this,"_attrs");h(this,"_children");h(this,"_classes");h(this,"_styles");h(this,"_customProperties",new Map);if(this.name=i,this._attrs=$z(s),this._children=[],o&&this._insertChild(0,o),this._classes=new Set,this._attrs.has("class")){const r=this._attrs.get("class");x0(this._classes,r),this._attrs.delete("class")}this._styles=new Yu(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style"))}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if(e=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(e=="style"){const i=this._styles.toString();return i==""?void 0:i}return this._attrs.get(e)}hasAttribute(e){return e=="class"?this._classes.size>0:e=="style"?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof f5))return!1;if(this===e)return!0;if(this.name!=e.name||this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[i,s]of this._attrs)if(!e._attrs.has(i)||e._attrs.get(i)!==s)return!1;for(const i of this._classes)if(!e._classes.has(i))return!1;for(const i of this._styles.getStyleNames())if(!e._styles.has(i)||e._styles.getAsString(i)!==this._styles.getAsString(i))return!1;return!0}hasClass(...e){for(const i of e)if(!this._classes.has(i))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(e){return this._styles.getStyleNames(e)}hasStyle(...e){for(const i of e)if(!this._styles.has(i))return!1;return!0}findAncestor(...e){const i=new Qt(...e);let s=this.parent;for(;s&&!s.is("documentFragment");){if(i.match(s))return s;s=s.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),i=this._styles.toString(),s=Array.from(this._attrs).map(o=>`${o[0]}="${o[1]}"`).sort().join(" ");return this.name+(e==""?"":` class="${e}"`)+(i?` style="${i}"`:"")+(s==""?"":` ${s}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const i=[];if(e)for(const o of this.getChildren())i.push(o._clone(e));const s=new this.constructor(this.document,this.name,this._attrs,i);return s._classes=new Set(this._classes),s._styles.set(this._styles.getNormalized()),s._customProperties=new Map(this._customProperties),s.getFillerOffset=this.getFillerOffset,s._unsafeAttributesToRender=this._unsafeAttributesToRender,s}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,i){this._fireChange("children",this);let s=0;const o=Hz(this.document,i);for(const r of o)r.parent!==null&&r._remove(),r.parent=this,r.document=this.document,this._children.splice(e,0,r),e++,s++;return s}_removeChildren(e,i=1){this._fireChange("children",this);for(let s=e;s<e+i;s++)this._children[s].parent=null;return this._children.splice(e,i)}_setAttribute(e,i){const s=String(i);this._fireChange("attributes",this),e=="class"?x0(this._classes,s):e=="style"?this._styles.setTo(s):this._attrs.set(e,s)}_removeAttribute(e){return this._fireChange("attributes",this),e=="class"?this._classes.size>0?(this._classes.clear(),!0):!1:e=="style"?this._styles.isEmpty?!1:(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const i of Pe(e))this._classes.add(i)}_removeClass(e){this._fireChange("attributes",this);for(const i of Pe(e))this._classes.delete(i)}_setStyle(e,i){this._fireChange("attributes",this),typeof e!="string"?this._styles.set(e):this._styles.set(e,i)}_removeStyle(e){this._fireChange("attributes",this);for(const i of Pe(e))this._styles.remove(i)}_setCustomProperty(e,i){this._customProperties.set(e,i)}_removeCustomProperty(e){return this._customProperties.delete(e)}};hi.prototype.is=function(n,t){return t?t===this.name&&(n==="element"||n==="view:element"):n==="element"||n==="view:element"||n==="node"||n==="view:node"};function $z(n){const t=Ii(n);for(const[e,i]of t)i===null?t.delete(e):typeof i!="string"&&t.set(e,String(i));return t}function x0(n,t){const e=t.split(/\s+/);n.clear(),e.forEach(i=>n.add(i))}function Hz(n,t){return typeof t=="string"?[new et(n,t)]:(Dn(t)||(t=[t]),Array.from(t).map(e=>typeof e=="string"?new et(n,e):e instanceof Ci?new et(n,e.data):e))}class _l extends hi{constructor(t,e,i,s){super(t,e,i,s),this.getFillerOffset=zz}}_l.prototype.is=function(n,t){return t?t===this.name&&(n==="containerElement"||n==="view:containerElement"||n==="element"||n==="view:element"):n==="containerElement"||n==="view:containerElement"||n==="element"||n==="view:element"||n==="node"||n==="view:node"};function zz(){const n=[...this.getChildren()],t=n[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const e of n)if(!e.is("uiElement"))return null;return this.childCount}class Ah extends Ve(_l){constructor(t,e,i,s){super(t,e,i,s),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",o=>o&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}destroy(){this.stopListening()}}Ah.prototype.is=function(n,t){return t?t===this.name&&(n==="editableElement"||n==="view:editableElement"||n==="containerElement"||n==="view:containerElement"||n==="element"||n==="view:element"):n==="editableElement"||n==="view:editableElement"||n==="containerElement"||n==="view:containerElement"||n==="element"||n==="view:element"||n==="node"||n==="view:node"};const S0=Symbol("rootName");class m5 extends Ah{constructor(t,e){super(t,e),this.rootName="main"}get rootName(){return this.getCustomProperty(S0)}set rootName(t){this._setCustomProperty(S0,t)}set _name(t){this.name=t}}m5.prototype.is=function(n,t){return t?t===this.name&&(n==="rootElement"||n==="view:rootElement"||n==="editableElement"||n==="view:editableElement"||n==="containerElement"||n==="view:containerElement"||n==="element"||n==="view:element"):n==="rootElement"||n==="view:rootElement"||n==="editableElement"||n==="view:editableElement"||n==="containerElement"||n==="view:containerElement"||n==="element"||n==="view:element"||n==="node"||n==="view:node"};let ho=class{constructor(t={}){h(this,"direction");h(this,"boundaries");h(this,"singleCharacters");h(this,"shallow");h(this,"ignoreElementEnd");h(this,"_position");h(this,"_boundaryStartParent");h(this,"_boundaryEndParent");if(!t.boundaries&&!t.startPosition)throw new C("view-tree-walker-no-start-position",null);if(t.direction&&t.direction!="forward"&&t.direction!="backward")throw new C("view-tree-walker-unknown-direction",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this._position=W._createAt(t.startPosition):this._position=W._createAt(t.boundaries[t.direction=="backward"?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(t){let e,i;do i=this.position,e=this.next();while(!e.done&&t(e.value));e.done||(this._position=i)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,i=t.parent;if(i.parent===null&&t.offset===i.childCount)return{done:!0,value:void 0};if(i===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let s;if(i instanceof et){if(t.isAtEnd)return this._position=W._createAfter(i),this._next();s=i.data[t.offset]}else s=i.getChild(t.offset);if(s instanceof hi){if(!this.shallow)t=new W(s,0);else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,this._formatReturnValue("elementStart",s,e,t,1)}if(s instanceof et){if(this.singleCharacters)return t=new W(s,0),this._position=t,this._next();let o=s.data.length,r;return s==this._boundaryEndParent?(o=this.boundaries.end.offset,r=new Ci(s,0,o),t=W._createAfter(r)):(r=new Ci(s,0,s.data.length),t.offset++),this._position=t,this._formatReturnValue("text",r,e,t,o)}if(typeof s=="string"){let o;this.singleCharacters?o=1:o=(i===this._boundaryEndParent?this.boundaries.end.offset:i.data.length)-t.offset;const r=new Ci(i,t.offset,o);return t.offset+=o,this._position=t,this._formatReturnValue("text",r,e,t,o)}return t=W._createAfter(i),this._position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",i,e,t)}_previous(){let t=this.position.clone();const e=this.position,i=t.parent;if(i.parent===null&&t.offset===0)return{done:!0,value:void 0};if(i==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let s;if(i instanceof et){if(t.isAtStart)return this._position=W._createBefore(i),this._previous();s=i.data[t.offset-1]}else s=i.getChild(t.offset-1);if(s instanceof hi)return this.shallow?(t.offset--,this._position=t,this._formatReturnValue("elementStart",s,e,t,1)):(t=new W(s,s.childCount),this._position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",s,e,t));if(s instanceof et){if(this.singleCharacters)return t=new W(s,s.data.length),this._position=t,this._previous();let o=s.data.length,r;if(s==this._boundaryStartParent){const a=this.boundaries.start.offset;r=new Ci(s,a,s.data.length-a),o=r.data.length,t=W._createBefore(r)}else r=new Ci(s,0,s.data.length),t.offset--;return this._position=t,this._formatReturnValue("text",r,e,t,o)}if(typeof s=="string"){let o;if(this.singleCharacters)o=1;else{const a=i===this._boundaryStartParent?this.boundaries.start.offset:0;o=t.offset-a}t.offset-=o;const r=new Ci(i,t.offset,o);return this._position=t,this._formatReturnValue("text",r,e,t,o)}return t=W._createBefore(i),this._position=t,this._formatReturnValue("elementStart",i,e,t,1)}_formatReturnValue(t,e,i,s,o){return e instanceof Ci&&(e.offsetInText+e.data.length==e.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(s=W._createAfter(e.textNode),this._position=s):i=W._createAfter(e.textNode)),e.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(s=W._createBefore(e.textNode),this._position=s):i=W._createBefore(e.textNode))),{done:!1,value:{type:t,item:e,previousPosition:i,nextPosition:s,length:o}}}},W=class Hi extends Ho{constructor(e,i){super();h(this,"parent");h(this,"offset");this.parent=e,this.offset=i}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof Ah);)if(e.parent)e=e.parent;else return null;return e}getShiftedBy(e){const i=Hi._createAt(this),s=i.offset+e;return i.offset=s<0?0:s,i}getLastMatchingPosition(e,i={}){i.startPosition=this;const s=new ho(i);return s.skip(e),s.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const i=this.getAncestors(),s=e.getAncestors();let o=0;for(;i[o]==s[o]&&i[o];)o++;return o===0?null:i[o-1]}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return this.compareWith(e)=="before"}isAfter(e){return this.compareWith(e)=="after"}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const i=this.parent.is("node")?this.parent.getPath():[],s=e.parent.is("node")?e.parent.getPath():[];i.push(this.offset),s.push(e.offset);const o=$t(i,s);switch(o){case"prefix":return"before";case"extension":return"after";default:return i[o]<s[o]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new ho(e)}clone(){return new Hi(this.parent,this.offset)}static _createAt(e,i){if(e instanceof Hi)return new this(e.parent,e.offset);{const s=e;if(i=="end")i=s.is("$text")?s.data.length:s.childCount;else{if(i=="before")return this._createBefore(s);if(i=="after")return this._createAfter(s);if(i!==0&&!i)throw new C("view-createpositionat-offset-required",s)}return new Hi(s,i)}}static _createAfter(e){if(e.is("$textProxy"))return new Hi(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new C("view-position-after-root",e,{root:e});return new Hi(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new Hi(e.textNode,e.offsetInText);if(!e.parent)throw new C("view-position-before-root",e,{root:e});return new Hi(e.parent,e.index)}};W.prototype.is=function(n){return n==="position"||n==="view:position"};let we=class vs extends Ho{constructor(e,i=null){super();h(this,"start");h(this,"end");this.start=e.clone(),this.end=i?i.clone():e.clone()}*[Symbol.iterator](){yield*new ho({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Mc,{direction:"backward"}),i=this.end.getLastMatchingPosition(Mc);return e.parent.is("$text")&&e.isAtStart&&(e=W._createBefore(e.parent)),i.parent.is("$text")&&i.isAtEnd&&(i=W._createAfter(i.parent)),new vs(e,i)}getTrimmed(){let e=this.start.getLastMatchingPosition(Mc);if(e.isAfter(this.end)||e.isEqual(this.end))return new vs(e,e);let i=this.end.getLastMatchingPosition(Mc,{direction:"backward"});const s=e.nodeAfter,o=i.nodeBefore;return s&&s.is("$text")&&(e=new W(s,0)),o&&o.is("$text")&&(i=new W(o,o.data.length)),new vs(e,i)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,i=!1){e.isCollapsed&&(i=!1);const s=this.containsPosition(e.start)||i&&this.start.isEqual(e.start),o=this.containsPosition(e.end)||i&&this.end.isEqual(e.end);return s&&o}getDifference(e){const i=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&i.push(new vs(this.start,e.start)),this.containsPosition(e.end)&&i.push(new vs(e.end,this.end))):i.push(this.clone()),i}getIntersection(e){if(this.isIntersecting(e)){let i=this.start,s=this.end;return this.containsPosition(e.start)&&(i=e.start),this.containsPosition(e.end)&&(s=e.end),new vs(i,s)}return null}getWalker(e={}){return e.boundaries=this,new ho(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,i=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(i=this.end.parent.previousSibling),e&&e.is("element")&&e===i?e:null}clone(){return new vs(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const i=new ho(e);for(const s of i)yield s.item}*getPositions(e={}){e.boundaries=this;const i=new ho(e);yield i.position;for(const s of i)yield s.nextPosition}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,i,s,o){return new this(new W(e,i),new W(s,o))}static _createFromPositionAndShift(e,i){const s=e,o=e.getShiftedBy(i);return i>0?new this(s,o):new this(o,s)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const i=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(W._createBefore(e),i)}};we.prototype.is=function(n){return n==="range"||n==="view:range"};function Mc(n){return!!(n.item.is("attributeElement")||n.item.is("uiElement"))}let Zi=class g5 extends De(Ho){constructor(...e){super();h(this,"_ranges");h(this,"_lastRangeBackward");h(this,"_isFake");h(this,"_fakeSelectionLabel");this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",e.length&&this.setTo(...e)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const i of this._ranges)(!e||i.start.isBefore(e.start))&&(e=i);return e?e.clone():null}getLastRange(){let e=null;for(const i of this._ranges)(!e||i.end.isAfter(e.end))&&(e=i);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake||this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel||this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const i of this._ranges){let s=!1;for(const o of e._ranges)if(i.isEqual(o)){s=!0;break}if(!s)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const i=Vm(this.getRanges()),s=Vm(e.getRanges());if(i!=s)return!1;if(i==0)return!0;for(let o of this.getRanges()){o=o.getTrimmed();let r=!1;for(let a of e.getRanges())if(a=a.getTrimmed(),o.start.isEqual(a.start)&&o.end.isEqual(a.end)){r=!0;break}if(!r)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...e){let[i,s,o]=e;if(typeof s=="object"&&(o=s,s=void 0),i===null)this._setRanges([]),this._setFakeOptions(o);else if(i instanceof g5||i instanceof Cb)this._setRanges(i.getRanges(),i.isBackward),this._setFakeOptions({fake:i.isFake,label:i.fakeSelectionLabel});else if(i instanceof we)this._setRanges([i],o&&o.backward),this._setFakeOptions(o);else if(i instanceof W)this._setRanges([new we(i)]),this._setFakeOptions(o);else if(i instanceof zo){const r=!!o&&!!o.backward;let a;if(s===void 0)throw new C("view-selection-setto-required-second-parameter",this);s=="in"?a=we._createIn(i):s=="on"?a=we._createOn(i):a=new we(W._createAt(i,s)),this._setRanges([a],r),this._setFakeOptions(o)}else if(Dn(i))this._setRanges(i,o&&o.backward),this._setFakeOptions(o);else throw new C("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(e,i){if(this.anchor===null)throw new C("view-selection-setfocus-no-ranges",this);const s=W._createAt(e,i);if(s.compareWith(this.focus)=="same")return;const o=this.anchor;this._ranges.pop(),s.compareWith(o)=="before"?this._addRange(new we(s,o),!0):this._addRange(new we(o,s)),this.fire("change")}_setRanges(e,i=!1){e=Array.from(e),this._ranges=[];for(const s of e)this._addRange(s);this._lastRangeBackward=!!i}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,i=!1){if(!(e instanceof we))throw new C("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!i}_pushRange(e){for(const i of this._ranges)if(e.isIntersecting(i))throw new C("view-selection-range-intersects",this,{addedRange:e,intersectingRange:i});this._ranges.push(new we(e.start,e.end))}};Zi.prototype.is=function(n){return n==="selection"||n==="view:selection"};let Cb=class extends De(Ho){constructor(...e){super();h(this,"_selection");this._selection=new Zi,this._selection.delegate("change").to(this),e.length&&this._selection.setTo(...e)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}_setTo(...e){this._selection.setTo(...e)}_setFocus(e,i){this._selection.setFocus(e,i)}};Cb.prototype.is=function(n){return n==="selection"||n=="documentSelection"||n=="view:selection"||n=="view:documentSelection"};class aa extends Qi{constructor(e,i,s){super(e,i);h(this,"startRange");h(this,"_eventPhase");h(this,"_currentTarget");this.startRange=s,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}const gf=Symbol("bubbling contexts");function Nm(n){class t extends n{fire(i,...s){try{const o=i instanceof Qi?i:new Qi(this,i),r=pf(this);if(!r.size)return;if(_a(o,"capturing",this),er(r,"$capture",o,...s))return o.return;const a=o.startRange||this.selection.getFirstRange(),l=a?a.getContainedElement():null,c=l?!!p5(r,l):!1;let u=l||Uz(a);if(_a(o,"atTarget",u),!c){if(er(r,"$text",o,...s))return o.return;_a(o,"bubbling",u)}for(;u;){if(u.is("rootElement")){if(er(r,"$root",o,...s))return o.return}else if(u.is("element")&&er(r,u.name,o,...s))return o.return;if(er(r,u,o,...s))return o.return;u=u.parent,_a(o,"bubbling",u)}return _a(o,"bubbling",this),er(r,"$document",o,...s),o.return}catch(o){/* istanbul ignore next -- @preserve */C.rethrowUnexpectedError(o,this)}}_addEventListener(i,s,o){const r=Pe(o.context||"$document"),a=pf(this);for(const l of r){let c=a.get(l);c||(c=new(De()),a.set(l,c)),this.listenTo(c,i,s,o)}}_removeEventListener(i,s){const o=pf(this);for(const r of o.values())this.stopListening(r,i,s)}}return t}{const n=Nm(Object);["fire","_addEventListener","_removeEventListener"].forEach(t=>{Nm[t]=n.prototype[t]})}function _a(n,t,e){n instanceof aa&&(n._eventPhase=t,n._currentTarget=e)}function er(n,t,e,...i){const s=typeof t=="string"?n.get(t):p5(n,t);return s?(s.fire(e,...i),e.stop.called):!1}function p5(n,t){for(const[e,i]of n)if(typeof e=="function"&&e(t))return i;return null}function pf(n){return n[gf]||(n[gf]=new Map),n[gf]}function Uz(n){if(!n)return null;const t=n.start.parent,e=n.end.parent,i=t.getPath(),s=e.getPath();return i.length>s.length?t:e}let xh=class extends Nm(Ve()){constructor(e){super();h(this,"selection");h(this,"roots");h(this,"stylesProcessor");h(this,"_postFixers",new Set);this.selection=new Cb,this.roots=new rn({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.forEach(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let i=!1;do for(const s of this._postFixers)if(i=s(e),i)break;while(i)}};const I0=10;class wo extends hi{constructor(e,i,s,o){super(e,i,s,o);h(this,"_priority",I0);h(this,"_id",null);h(this,"_clonesGroup",null);this.getFillerOffset=Wz}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new C("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e=!1){const i=super._clone(e);return i._priority=this._priority,i._id=this._id,i}}h(wo,"DEFAULT_PRIORITY",I0);wo.prototype.is=function(n,t){return t?t===this.name&&(n==="attributeElement"||n==="view:attributeElement"||n==="element"||n==="view:element"):n==="attributeElement"||n==="view:attributeElement"||n==="element"||n==="view:element"||n==="node"||n==="view:node"};function Wz(){if(bf(this))return null;let n=this.parent;for(;n&&n.is("attributeElement");){if(bf(n)>1)return null;n=n.parent}return!n||bf(n)>1?null:this.childCount}function bf(n){return Array.from(n.getChildren()).filter(t=>!t.is("uiElement")).length}class kb extends hi{constructor(t,e,i,s){super(t,e,i,s),this.getFillerOffset=qz}_insertChild(t,e){if(e&&(e instanceof zo||Array.from(e).length>0))throw new C("view-emptyelement-cannot-add",[this,e]);return 0}}kb.prototype.is=function(n,t){return t?t===this.name&&(n==="emptyElement"||n==="view:emptyElement"||n==="element"||n==="view:element"):n==="emptyElement"||n==="view:emptyElement"||n==="element"||n==="view:element"||n==="node"||n==="view:node"};function qz(){return null}class Sh extends hi{constructor(t,e,i,s){super(t,e,i,s),this.getFillerOffset=Gz}_insertChild(t,e){if(e&&(e instanceof zo||Array.from(e).length>0))throw new C("view-uielement-cannot-add",[this,e]);return 0}render(t,e){return this.toDomElement(t)}toDomElement(t){const e=t.createElement(this.name);for(const i of this.getAttributeKeys())e.setAttribute(i,this.getAttribute(i));return e}}Sh.prototype.is=function(n,t){return t?t===this.name&&(n==="uiElement"||n==="view:uiElement"||n==="element"||n==="view:element"):n==="uiElement"||n==="view:uiElement"||n==="element"||n==="view:element"||n==="node"||n==="view:node"};function jz(n){n.document.on("arrowKey",(t,e)=>Kz(t,e,n.domConverter),{priority:"low"})}function Gz(){return null}function Kz(n,t,e){if(t.keyCode==_e.arrowright){const i=t.domTarget.ownerDocument.defaultView.getSelection(),s=i.rangeCount==1&&i.getRangeAt(0).collapsed;if(s||t.shiftKey){const o=i.focusNode,r=i.focusOffset,a=e.domPositionToView(o,r);if(a===null)return;let l=!1;const c=a.getLastMatchingPosition(u=>(u.item.is("uiElement")&&(l=!0),!!(u.item.is("uiElement")||u.item.is("attributeElement"))));if(l){const u=e.viewPositionToDom(c);s?i.collapse(u.parent,u.offset):i.extend(u.parent,u.offset)}}}}class Tb extends hi{constructor(t,e,i,s){super(t,e,i,s),this.getFillerOffset=Zz}_insertChild(t,e){if(e&&(e instanceof zo||Array.from(e).length>0))throw new C("view-rawelement-cannot-add",[this,e]);return 0}render(t,e){}}Tb.prototype.is=function(n,t){return t?t===this.name&&(n==="rawElement"||n==="view:rawElement"||n==="element"||n==="view:element"):n==="rawElement"||n==="view:rawElement"||n===this.name||n==="view:"+this.name||n==="element"||n==="view:element"||n==="node"||n==="view:node"};function Zz(){return null}let _o=class extends De(Ho){constructor(e,i){super();h(this,"document");h(this,"_children",[]);h(this,"_customProperties",new Map);this.document=e,i&&this._insertChild(0,i)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,i){this._fireChange("children",this);let s=0;const o=Jz(this.document,i);for(const r of o)r.parent!==null&&r._remove(),r.parent=this,this._children.splice(e,0,r),e++,s++;return s}_removeChildren(e,i=1){this._fireChange("children",this);for(let s=e;s<e+i;s++)this._children[s].parent=null;return this._children.splice(e,i)}_fireChange(e,i){this.fire("change:"+e,i)}_setCustomProperty(e,i){this._customProperties.set(e,i)}_removeCustomProperty(e){return this._customProperties.delete(e)}};_o.prototype.is=function(n){return n==="documentFragment"||n==="view:documentFragment"};function Jz(n,t){return typeof t=="string"?[new et(n,t)]:(Dn(t)||(t=[t]),Array.from(t).map(e=>typeof e=="string"?new et(n,e):e instanceof Ci?new et(n,e.data):e))}class b5{constructor(t){h(this,"document");h(this,"_cloneGroups",new Map);h(this,"_slotFactory",null);this.document=t}setSelection(...t){this.document.selection._setTo(...t)}setSelectionFocus(t,e){this.document.selection._setFocus(t,e)}createDocumentFragment(t){return new _o(this.document,t)}createText(t){return new et(this.document,t)}createAttributeElement(t,e,i={}){const s=new wo(this.document,t,e);return typeof i.priority=="number"&&(s._priority=i.priority),i.id&&(s._id=i.id),i.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),s}createContainerElement(t,e,i={},s={}){let o=null;Rt(i)?s=i:o=i;const r=new _l(this.document,t,e,o);return s.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),r}createEditableElement(t,e,i={}){const s=new Ah(this.document,t,e);return i.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),s}createEmptyElement(t,e,i={}){const s=new kb(this.document,t,e);return i.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...i.renderUnsafeAttributes),s}createUIElement(t,e,i){const s=new Sh(this.document,t,e);return i&&(s.render=i),s}createRawElement(t,e,i,s={}){const o=new Tb(this.document,t,e);return i&&(o.render=i),s.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),o}setAttribute(t,e,i){i._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,i){Rt(t)&&i===void 0?e._setStyle(t):i._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,i){i._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}breakAttributes(t){return t instanceof W?this._breakAttributes(t):this._breakAttributesRange(t)}breakContainer(t){const e=t.parent;if(!e.is("containerElement"))throw new C("view-writer-break-non-container-element",this.document);if(!e.parent)throw new C("view-writer-break-root",this.document);if(t.isAtStart)return W._createBefore(e);if(!t.isAtEnd){const i=e._clone(!1);this.insert(W._createAfter(e),i);const s=new we(t,W._createAt(e,"end")),o=new W(i,0);this.move(s,o)}return W._createAfter(e)}mergeAttributes(t){const e=t.offset,i=t.parent;if(i.is("$text"))return t;if(i.is("attributeElement")&&i.childCount===0){const r=i.parent,a=i.index;return i._remove(),this._removeFromClonedElementsGroup(i),this.mergeAttributes(new W(r,a))}const s=i.getChild(e-1),o=i.getChild(e);if(!s||!o)return t;if(s.is("$text")&&o.is("$text"))return R0(s,o);if(s.is("attributeElement")&&o.is("attributeElement")&&s.isSimilar(o)){const r=s.childCount;return s._appendChild(o.getChildren()),o._remove(),this._removeFromClonedElementsGroup(o),this.mergeAttributes(new W(s,r))}return t}mergeContainers(t){const e=t.nodeBefore,i=t.nodeAfter;if(!e||!i||!e.is("containerElement")||!i.is("containerElement"))throw new C("view-writer-merge-containers-invalid-position",this.document);const s=e.getChild(e.childCount-1),o=s instanceof et?W._createAt(s,"end"):W._createAt(e,"end");return this.move(we._createIn(i),W._createAt(e,"end")),this.remove(we._createOn(i)),o}insert(t,e){e=Dn(e)?[...e]:[e],w5(e,this.document);const i=e.reduce((r,a)=>{const l=r[r.length-1],c=!a.is("uiElement");return!l||l.breakAttributes!=c?r.push({breakAttributes:c,nodes:[a]}):l.nodes.push(a),r},[]);let s=null,o=t;for(const{nodes:r,breakAttributes:a}of i){const l=this._insertNodes(o,r,a);s||(s=l.start),o=l.end}return s?new we(s,o):new we(t)}remove(t){const e=t instanceof we?t:we._createOn(t);if(va(e,this.document),e.isCollapsed)return new _o(this.document);const{start:i,end:s}=this._breakAttributesRange(e,!0),o=i.parent,r=s.offset-i.offset,a=o._removeChildren(i.offset,r);for(const c of a)this._removeFromClonedElementsGroup(c);const l=this.mergeAttributes(i);return e.start=l,e.end=l.clone(),new _o(this.document,a)}clear(t,e){va(t,this.document);const i=t.getWalker({direction:"backward",ignoreElementEnd:!0});for(const s of i){const o=s.item;let r;if(o.is("element")&&e.isSimilar(o))r=we._createOn(o);else if(!s.nextPosition.isAfter(t.start)&&o.is("$textProxy")){const a=o.getAncestors().find(l=>l.is("element")&&e.isSimilar(l));a&&(r=we._createIn(a))}r&&(r.end.isAfter(t.end)&&(r.end=t.end),r.start.isBefore(t.start)&&(r.start=t.start),this.remove(r))}}move(t,e){let i;if(e.isAfter(t.end)){e=this._breakAttributes(e,!0);const s=e.parent,o=s.childCount;t=this._breakAttributesRange(t,!0),i=this.remove(t),e.offset+=s.childCount-o}else i=this.remove(t);return this.insert(e,i)}wrap(t,e){if(!(e instanceof wo))throw new C("view-writer-wrap-invalid-attribute",this.document);if(va(t,this.document),t.isCollapsed){let i=t.start;i.parent.is("element")&&!Yz(i.parent)&&(i=i.getLastMatchingPosition(o=>o.item.is("uiElement"))),i=this._wrapPosition(i,e);const s=this.document.selection;return s.isCollapsed&&s.getFirstPosition().isEqual(t.start)&&this.setSelection(i),new we(i)}else return this._wrapRange(t,e)}unwrap(t,e){if(!(e instanceof wo))throw new C("view-writer-unwrap-invalid-attribute",this.document);if(va(t,this.document),t.isCollapsed)return t;const{start:i,end:s}=this._breakAttributesRange(t,!0),o=i.parent,r=this._unwrapChildren(o,i.offset,s.offset,e),a=this.mergeAttributes(r.start);a.isEqual(r.start)||r.end.offset--;const l=this.mergeAttributes(r.end);return new we(a,l)}rename(t,e){const i=new _l(this.document,t,e.getAttributes());return this.insert(W._createAfter(e),i),this.move(we._createIn(e),W._createAt(i,0)),this.remove(we._createOn(e)),i}clearClonedElementsGroup(t){this._cloneGroups.delete(t)}createPositionAt(t,e){return W._createAt(t,e)}createPositionAfter(t){return W._createAfter(t)}createPositionBefore(t){return W._createBefore(t)}createRange(t,e){return new we(t,e)}createRangeOn(t){return we._createOn(t)}createRangeIn(t){return we._createIn(t)}createSelection(...t){return new Zi(...t)}createSlot(t="children"){if(!this._slotFactory)throw new C("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,t)}_registerSlotFactory(t){this._slotFactory=t}_clearSlotFactory(){this._slotFactory=null}_insertNodes(t,e,i){let s;if(i?s=Fm(t):s=t.parent.is("$text")?t.parent.parent:t.parent,!s)throw new C("view-writer-invalid-position-container",this.document);let o;i?o=this._breakAttributes(t,!0):o=t.parent.is("$text")?wf(t):t;const r=s._insertChild(o.offset,e);for(const u of e)this._addToClonedElementsGroup(u);const a=o.getShiftedBy(r),l=this.mergeAttributes(o);l.isEqual(o)||a.offset--;const c=this.mergeAttributes(a);return new we(l,c)}_wrapChildren(t,e,i,s){let o=e;const r=[];for(;o<i;){const l=t.getChild(o),c=l.is("$text"),u=l.is("attributeElement");if(u&&this._wrapAttributeElement(s,l))r.push(new W(t,o));else if(c||!u||Xz(s,l)){const d=s._clone();l._remove(),d._appendChild(l),t._insertChild(o,d),this._addToClonedElementsGroup(d),r.push(new W(t,o))}else this._wrapChildren(l,0,l.childCount,s);o++}let a=0;for(const l of r){if(l.offset-=a,l.offset==e)continue;this.mergeAttributes(l).isEqual(l)||(a++,i--)}return we._createFromParentsAndOffsets(t,e,t,i)}_unwrapChildren(t,e,i,s){let o=e;const r=[];for(;o<i;){const l=t.getChild(o);if(!l.is("attributeElement")){o++;continue}if(l.isSimilar(s)){const c=l.getChildren(),u=l.childCount;l._remove(),t._insertChild(o,c),this._removeFromClonedElementsGroup(l),r.push(new W(t,o),new W(t,o+u)),o+=u,i+=u-1;continue}if(this._unwrapAttributeElement(s,l)){r.push(new W(t,o),new W(t,o+1)),o++;continue}this._unwrapChildren(l,0,l.childCount,s),o++}let a=0;for(const l of r){if(l.offset-=a,l.offset==e||l.offset==i)continue;this.mergeAttributes(l).isEqual(l)||(a++,i--)}return we._createFromParentsAndOffsets(t,e,t,i)}_wrapRange(t,e){const{start:i,end:s}=this._breakAttributesRange(t,!0),o=i.parent,r=this._wrapChildren(o,i.offset,s.offset,e),a=this.mergeAttributes(r.start);a.isEqual(r.start)||r.end.offset--;const l=this.mergeAttributes(r.end);return new we(a,l)}_wrapPosition(t,e){if(e.isSimilar(t.parent))return P0(t.clone());t.parent.is("$text")&&(t=wf(t));const i=this.createAttributeElement("_wrapPosition-fake-element");i._priority=Number.POSITIVE_INFINITY,i.isSimilar=()=>!1,t.parent._insertChild(t.offset,i);const s=new we(t,t.getShiftedBy(1));this.wrap(s,e);const o=new W(i.parent,i.index);i._remove();const r=o.nodeBefore,a=o.nodeAfter;return r instanceof et&&a instanceof et?R0(r,a):P0(o)}_wrapAttributeElement(t,e){if(!L0(t,e)||t.name!==e.name||t.priority!==e.priority)return!1;for(const i of t.getAttributeKeys())if(!(i==="class"||i==="style")&&e.hasAttribute(i)&&e.getAttribute(i)!==t.getAttribute(i))return!1;for(const i of t.getStyleNames())if(e.hasStyle(i)&&e.getStyle(i)!==t.getStyle(i))return!1;for(const i of t.getAttributeKeys())i==="class"||i==="style"||e.hasAttribute(i)||this.setAttribute(i,t.getAttribute(i),e);for(const i of t.getStyleNames())e.hasStyle(i)||this.setStyle(i,t.getStyle(i),e);for(const i of t.getClassNames())e.hasClass(i)||this.addClass(i,e);return!0}_unwrapAttributeElement(t,e){if(!L0(t,e)||t.name!==e.name||t.priority!==e.priority)return!1;for(const i of t.getAttributeKeys())if(!(i==="class"||i==="style")&&(!e.hasAttribute(i)||e.getAttribute(i)!==t.getAttribute(i)))return!1;if(!e.hasClass(...t.getClassNames()))return!1;for(const i of t.getStyleNames())if(!e.hasStyle(i)||e.getStyle(i)!==t.getStyle(i))return!1;for(const i of t.getAttributeKeys())i==="class"||i==="style"||this.removeAttribute(i,e);return this.removeClass(Array.from(t.getClassNames()),e),this.removeStyle(Array.from(t.getStyleNames()),e),!0}_breakAttributesRange(t,e=!1){const i=t.start,s=t.end;if(va(t,this.document),t.isCollapsed){const l=this._breakAttributes(t.start,e);return new we(l,l)}const o=this._breakAttributes(s,e),r=o.parent.childCount,a=this._breakAttributes(i,e);return o.offset+=o.parent.childCount-r,new we(a,o)}_breakAttributes(t,e=!1){const i=t.offset,s=t.parent;if(t.parent.is("emptyElement"))throw new C("view-writer-cannot-break-empty-element",this.document);if(t.parent.is("uiElement"))throw new C("view-writer-cannot-break-ui-element",this.document);if(t.parent.is("rawElement"))throw new C("view-writer-cannot-break-raw-element",this.document);if(!e&&s.is("$text")&&Dm(s.parent)||Dm(s))return t.clone();if(s.is("$text"))return this._breakAttributes(wf(t),e);const o=s.childCount;if(i==o){const r=new W(s.parent,s.index+1);return this._breakAttributes(r,e)}else if(i===0){const r=new W(s.parent,s.index);return this._breakAttributes(r,e)}else{const r=s.index+1,a=s._clone();s.parent._insertChild(r,a),this._addToClonedElementsGroup(a);const l=s.childCount-i,c=s._removeChildren(i,l);a._appendChild(c);const u=new W(s.parent,r);return this._breakAttributes(u,e)}}_addToClonedElementsGroup(t){if(!t.root.is("rootElement"))return;if(t.is("element"))for(const s of t.getChildren())this._addToClonedElementsGroup(s);const e=t.id;if(!e)return;let i=this._cloneGroups.get(e);i||(i=new Set,this._cloneGroups.set(e,i)),i.add(t),t._clonesGroup=i}_removeFromClonedElementsGroup(t){if(t.is("element"))for(const s of t.getChildren())this._removeFromClonedElementsGroup(s);const e=t.id;if(!e)return;const i=this._cloneGroups.get(e);i&&i.delete(t)}}function Yz(n){return Array.from(n.getChildren()).some(t=>!t.is("uiElement"))}function Fm(n){let t=n.parent;for(;!Dm(t);){if(!t)return;t=t.parent}return t}function Xz(n,t){return n.priority<t.priority?!0:n.priority>t.priority?!1:n.getIdentity()<t.getIdentity()}function P0(n){const t=n.nodeBefore;if(t&&t.is("$text"))return new W(t,t.data.length);const e=n.nodeAfter;return e&&e.is("$text")?new W(e,0):n}function wf(n){if(n.offset==n.parent.data.length)return new W(n.parent.parent,n.parent.index+1);if(n.offset===0)return new W(n.parent.parent,n.parent.index);const t=n.parent.data.slice(n.offset);return n.parent._data=n.parent.data.slice(0,n.offset),n.parent.parent._insertChild(n.parent.index+1,new et(n.root.document,t)),new W(n.parent.parent,n.parent.index+1)}function R0(n,t){const e=n.data.length;return n._data+=t.data,t._remove(),new W(n,e)}const Qz=[et,wo,_l,kb,Tb,Sh];function w5(n,t){for(const e of n){if(!Qz.some(i=>e instanceof i))throw new C("view-writer-insert-invalid-node-type",t);e.is("$text")||w5(e.getChildren(),t)}}function Dm(n){return n&&(n.is("containerElement")||n.is("documentFragment"))}function va(n,t){const e=Fm(n.start),i=Fm(n.end);if(!e||!i||e!==i)throw new C("view-writer-invalid-range-container",t)}function L0(n,t){return n.id===null&&t.id===null}const _5=n=>n.createTextNode(" "),v5=n=>{const t=n.createElement("span");return t.dataset.ckeFiller="true",t.innerText=" ",t},y5=n=>{const t=n.createElement("br");return t.dataset.ckeFiller="true",t},ai=7,vl="⁠".repeat(ai);function Sn(n){return typeof n=="string"?n.substr(0,ai)===vl:dt(n)&&n.data.substr(0,ai)===vl}function _r(n){return n.data.length==ai&&Sn(n)}function V0(n){const t=typeof n=="string"?n:n.data;return Sn(n)?t.slice(ai):t}function eU(n){n.document.on("arrowKey",tU,{priority:"low"})}function tU(n,t){if(t.keyCode==_e.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(e.rangeCount==1&&e.getRangeAt(0).collapsed){const i=e.getRangeAt(0).startContainer,s=e.getRangeAt(0).startOffset;Sn(i)&&s<=ai&&e.collapse(i,0)}}}let nU=class extends Ve(){constructor(e,i){super();h(this,"domDocuments",new Set);h(this,"domConverter");h(this,"markedAttributes",new Set);h(this,"markedChildren",new Set);h(this,"markedTexts",new Set);h(this,"selection");h(this,"_inlineFiller",null);h(this,"_fakeSelectionContainer",null);this.domConverter=e,this.selection=i,this.set("isFocused",!1),this.set("isSelecting",!1),ue.isBlink&&!ue.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()}),this.set("isComposing",!1),this.on("change:isComposing",()=>{this.isComposing||this.render()})}markToSync(e,i){if(e==="text")this.domConverter.mapViewToDom(i.parent)&&this.markedTexts.add(i);else{if(!this.domConverter.mapViewToDom(i))return;if(e==="attributes")this.markedAttributes.add(i);else if(e==="children")this.markedChildren.add(i);else throw new C("view-renderer-unknown-type",this)}}render(){if(this.isComposing&&!ue.isAndroid)return;let e=null;const i=ue.isBlink&&!ue.isAndroid?!this.isSelecting:!0;for(const s of this.markedChildren)this._updateChildrenMappings(s);i?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=W._createBefore(e.parent)));for(const s of this.markedAttributes)this._updateAttrs(s);for(const s of this.markedChildren)this._updateChildren(s,{inlineFillerPosition:e});for(const s of this.markedTexts)!this.markedChildren.has(s.parent)&&this.domConverter.mapViewToDom(s.parent)&&this._updateText(s,{inlineFillerPosition:e});if(i)if(e){const s=this.domConverter.viewPositionToDom(e),o=s.parent.ownerDocument;Sn(s.parent)?this._inlineFiller=s.parent:this._inlineFiller=B0(o,s.parent,s.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const i=this.domConverter.mapViewToDom(e);if(!i)return;const s=Array.from(i.childNodes),o=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),r=this._diffNodeLists(s,o),a=this._findUpdateActions(r,s,o,sU);if(a.indexOf("update")!==-1){const l={equal:0,insert:0,delete:0};for(const c of a)if(c==="update"){const u=l.equal+l.insert,d=l.equal+l.delete,f=e.getChild(u);f&&!f.is("uiElement")&&!f.is("rawElement")&&this._updateElementMappings(f,s[d]),_0(o[u]),l.equal++}else l[c]++}}_updateElementMappings(e,i){this.domConverter.unbindDomElement(i),this.domConverter.bindElements(i,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?W._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),i=this.domConverter.viewPositionToDom(e);return!!(i&&dt(i.parent)&&Sn(i.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!Sn(e))throw new C("view-renderer-filler-was-lost",this);_r(e)?e.remove():e.data=e.data.substr(ai),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),i=e.parent,s=e.offset;if(!this.domConverter.mapViewToDom(i.root)||!i.is("element")||!iU(i))return!1;const o=e.nodeBefore,r=e.nodeAfter;return!(o instanceof et||r instanceof et||s===i.getFillerOffset()&&(!o||!o.is("element","br"))||ue.isAndroid&&(o||r))}_updateText(e,i){const s=this.domConverter.findCorrespondingDomText(e);let r=this.domConverter.viewToDom(e).data;const a=i.inlineFillerPosition;a&&a.parent==e.parent&&a.offset==e.index&&(r=vl+r),M0(s,r)}_updateAttrs(e){const i=this.domConverter.mapViewToDom(e);if(!i)return;const s=Array.from(i.attributes).map(r=>r.name),o=e.getAttributeKeys();for(const r of o)this.domConverter.setDomElementAttribute(i,r,e.getAttribute(r),e);for(const r of s)e.hasAttribute(r)||this.domConverter.removeDomElementAttribute(i,r)}_updateChildren(e,i){const s=this.domConverter.mapViewToDom(e);if(!s)return;if(ue.isAndroid){let f=null;for(const m of Array.from(s.childNodes)){if(f&&dt(f)&&dt(m)){s.normalize();break}f=m}}const o=i.inlineFillerPosition,r=s.childNodes,a=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));o&&o.parent===e&&B0(s.ownerDocument,a,o.offset);const l=this._diffNodeLists(r,a),c=this._findUpdateActions(l,r,a,oU);let u=0;const d=new Set;for(const f of c)f==="delete"?(d.add(r[u]),_0(r[u])):(f==="equal"||f==="update")&&u++;u=0;for(const f of c)f==="insert"?(o5(s,u,a[u]),u++):f==="update"?(M0(r[u],a[u].data),u++):f==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(a[u])),u++);for(const f of d)f.parentNode||this.domConverter.unbindDomElement(f)}_diffNodeLists(e,i){return e=lU(e,this._fakeSelectionContainer),ja(e,i,rU.bind(null,this.domConverter))}_findUpdateActions(e,i,s,o){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let r=[],a=[],l=[];const c={equal:0,insert:0,delete:0};for(const u of e)u==="insert"?l.push(s[c.equal+c.insert]):u==="delete"?a.push(i[c.equal+c.delete]):(r=r.concat(ja(a,l,o).map(d=>d==="equal"?"update":d)),r.push("equal"),a=[],l=[]),c[u]++;return r.concat(ja(a,l,o).map(u=>u==="equal"?"update":u))}_markDescendantTextToSync(e){if(e){if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const i of e.getChildren())this._markDescendantTextToSync(i)}}_updateSelection(){if(ue.isBlink&&!ue.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);!this.isFocused||!e||(this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&ue.isAndroid||this._updateDomSelection(e))}_updateFakeSelection(e){const i=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=cU(i));const s=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(s,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!s.parentElement||s.parentElement!=e)&&e.appendChild(s),s.textContent=this.selection.fakeSelectionLabel||" ";const o=i.getSelection(),r=i.createRange();o.removeAllRanges(),r.selectNodeContents(s),o.addRange(r)}_updateDomSelection(e){const i=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(i))return;const s=this.domConverter.viewPositionToDom(this.selection.anchor),o=this.domConverter.viewPositionToDom(this.selection.focus);i.setBaseAndExtent(s.parent,s.offset,o.parent,o.offset),ue.isGecko&&aU(o,i)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const i=e&&this.domConverter.domSelectionToView(e);return!(i&&this.selection.isEqual(i)||!this.selection.isCollapsed&&this.selection.isSimilar(i))}_fakeSelectionNeedsUpdate(e){const i=this._fakeSelectionContainer,s=e.ownerDocument.getSelection();return!i||i.parentElement!==e||s.anchorNode!==i&&!i.contains(s.anchorNode)?!0:i.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments){const i=e.getSelection();if(i.rangeCount){const s=e.activeElement,o=this.domConverter.mapDomToView(s);s&&o&&i.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}};function iU(n){if(n.getAttribute("contenteditable")=="false")return!1;const t=n.findAncestor(e=>e.hasAttribute("contenteditable"));return!t||t.getAttribute("contenteditable")=="true"}function B0(n,t,e){const i=t instanceof Array?t:t.childNodes,s=i[e];if(dt(s))return s.data=vl+s.data,s;{const o=n.createTextNode(vl);return Array.isArray(t)?i.splice(e,0,o):o5(t,e,o),o}}function sU(n,t){return zs(n)&&zs(t)&&!dt(n)&&!dt(t)&&!Za(n)&&!Za(t)&&n.tagName.toLowerCase()===t.tagName.toLowerCase()}function oU(n,t){return zs(n)&&zs(t)&&dt(n)&&dt(t)}function rU(n,t,e){return t===e?!0:dt(t)&&dt(e)?t.data===e.data:!!(n.isBlockFiller(t)&&n.isBlockFiller(e))}function aU(n,t){let e=n.parent,i=n.offset;if(dt(e)&&_r(e)&&(i=Ra(e)+1,e=e.parentNode),e.nodeType!=Node.ELEMENT_NODE||i!=e.childNodes.length-1)return;const s=e.childNodes[i];s&&s.tagName=="BR"&&t.addRange(t.getRangeAt(0))}function lU(n,t){const e=Array.from(n);return e.length==0||!t||e[e.length-1]==t&&e.pop(),e}function cU(n){const t=n.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t}function M0(n,t){const e=n.data;if(e==t)return;const i=US(e,t);for(const s of i)s.type==="insert"?n.insertData(s.index,s.values.join("")):n.deleteData(s.index,s.howMany)}const uU=y5(j.document),dU=_5(j.document),hU=v5(j.document),Oc="data-ck-unsafe-attribute-",O0="data-ck-unsafe-element";class Ih{constructor(t,{blockFillerMode:e,renderingMode:i="editing"}={}){h(this,"document");h(this,"renderingMode");h(this,"blockFillerMode");h(this,"preElements");h(this,"blockElements");h(this,"inlineObjectElements");h(this,"unsafeElements");h(this,"_domDocument");h(this,"_domToViewMapping",new WeakMap);h(this,"_viewToDomMapping",new WeakMap);h(this,"_fakeSelectionMapping",new WeakMap);h(this,"_rawContentElementMatcher",new Qt);h(this,"_inlineObjectElementMatcher",new Qt);h(this,"_elementsWithTemporaryCustomProperties",new Set);this.document=t,this.renderingMode=i,this.blockFillerMode=e||(i==="editing"?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?j.document:j.document.implementation.createHTMLDocument("")}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new Zi(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const i of Array.from(t.children))this.unbindDomElement(i)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}shouldRenderAttribute(t,e,i){return this.renderingMode==="data"?!0:(t=t.toLowerCase(),t.startsWith("on")||t==="srcdoc"&&e.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:i==="img"&&(t==="src"||t==="srcset")||i==="source"&&t==="srcset"?!0:!e.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(t,e){if(this.renderingMode==="data"){t.innerHTML=e;return}const i=new DOMParser().parseFromString(e,"text/html"),s=i.createDocumentFragment(),o=i.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);const r=i.createTreeWalker(s,NodeFilter.SHOW_ELEMENT),a=[];let l;for(;l=r.nextNode();)a.push(l);for(const c of a){for(const d of c.getAttributeNames())this.setDomElementAttribute(c,d,c.getAttribute(d));const u=c.tagName.toLowerCase();this._shouldRenameElement(u)&&(F0(u),c.replaceWith(this._createReplacementDomElement(u,c)))}for(;t.firstChild;)t.firstChild.remove();t.append(s)}viewToDom(t,e={}){if(t.is("$text")){const i=this._processDataFromViewText(t);return this._domDocument.createTextNode(i)}else{const i=t;if(this.mapViewToDom(i))if(i.getCustomProperty("editingPipeline:doNotReuseOnce"))this._elementsWithTemporaryCustomProperties.add(i);else return this.mapViewToDom(i);let s;if(i.is("documentFragment"))s=this._domDocument.createDocumentFragment(),e.bind&&this.bindDocumentFragments(s,i);else{if(i.is("uiElement"))return i.name==="$comment"?s=this._domDocument.createComment(i.getCustomProperty("$rawContent")):s=i.render(this._domDocument,this),e.bind&&this.bindElements(s,i),s;this._shouldRenameElement(i.name)?(F0(i.name),s=this._createReplacementDomElement(i.name)):i.hasAttribute("xmlns")?s=this._domDocument.createElementNS(i.getAttribute("xmlns"),i.name):s=this._domDocument.createElement(i.name),i.is("rawElement")&&i.render(s,this),e.bind&&this.bindElements(s,i);for(const o of i.getAttributeKeys())this.setDomElementAttribute(s,o,i.getAttribute(o),i)}if(e.withChildren!==!1)for(const o of this.viewChildrenToDom(i,e))s instanceof HTMLTemplateElement?s.content.appendChild(o):s.appendChild(o);return s}}setDomElementAttribute(t,e,i,s){const o=this.shouldRenderAttribute(e,i,t.tagName.toLowerCase())||s&&s.shouldRenderUnsafeAttribute(e);if(o||Te("domconverter-unsafe-attribute-detected",{domElement:t,key:e,value:i}),!r5(e)){Te("domconverter-invalid-attribute-detected",{domElement:t,key:e,value:i});return}t.hasAttribute(e)&&!o?t.removeAttribute(e):t.hasAttribute(Oc+e)&&o&&t.removeAttribute(Oc+e),t.setAttribute(o?e:Oc+e,i)}removeDomElementAttribute(t,e){e!=O0&&(t.removeAttribute(e),t.removeAttribute(Oc+e))}*viewChildrenToDom(t,e={}){const i=t.getFillerOffset&&t.getFillerOffset();let s=0;for(const o of t.getChildren()){i===s&&(yield this._getBlockFiller());const r=o.is("element")&&!!o.getCustomProperty("dataPipeline:transparentRendering")&&!Ye(o.getAttributes());r&&this.renderingMode=="data"?yield*this.viewChildrenToDom(o,e):(r&&Te("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:o}),yield this.viewToDom(o,e)),s++}i===s&&(yield this._getBlockFiller())}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),i=this.viewPositionToDom(t.end),s=this._domDocument.createRange();return s.setStart(e.parent,e.offset),s.setEnd(i.parent,i.offset),s}viewPositionToDom(t){const e=t.parent;if(e.is("$text")){const i=this.findCorrespondingDomText(e);if(!i)return null;let s=t.offset;return Sn(i)&&(s+=ai),{parent:i,offset:s}}else{let i,s,o;if(t.offset===0){if(i=this.mapViewToDom(e),!i)return null;o=i.childNodes[0]}else{const a=t.nodeBefore;if(s=a.is("$text")?this.findCorrespondingDomText(a):this.mapViewToDom(a),!s)return null;i=s.parentNode,o=s.nextSibling}if(dt(o)&&Sn(o))return{parent:o,offset:ai};const r=s?Ra(s)+1:0;return{parent:i,offset:r}}}domToView(t,e={}){const i=[],s=this._domToView(t,e,i),o=s.next().value;return!o||(s.next(),this._processDomInlineNodes(null,i,e),o.is("$text")&&o.data.length==0)?null:o}*domChildrenToView(t,e={},i=[]){let s=[];t instanceof HTMLTemplateElement?s=[...t.content.childNodes]:s=[...t.childNodes];for(let o=0;o<s.length;o++){const r=s[o],a=this._domToView(r,e,i),l=a.next().value;l!==null&&(this._isBlockViewElement(l)&&this._processDomInlineNodes(t,i,e),yield l,a.next())}this._processDomInlineNodes(t,i,e)}domSelectionToView(t){if(gU(t))return new Zi([]);if(t.rangeCount===1){let s=t.getRangeAt(0).startContainer;dt(s)&&(s=s.parentNode);const o=this.fakeSelectionToView(s);if(o)return o}const e=this.isDomSelectionBackward(t),i=[];for(let s=0;s<t.rangeCount;s++){const o=t.getRangeAt(s),r=this.domRangeToView(o);r&&i.push(r)}return new Zi(i,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),i=this.domPositionToView(t.endContainer,t.endOffset);return e&&i?new we(e,i):null}domPositionToView(t,e=0){if(this.isBlockFiller(t))return this.domPositionToView(t.parentNode,Ra(t));const i=this.mapDomToView(t);if(i&&(i.is("uiElement")||i.is("rawElement")))return W._createBefore(i);if(dt(t)){if(_r(t))return this.domPositionToView(t.parentNode,Ra(t));const s=this.findCorrespondingViewText(t);let o=e;return s?(Sn(t)&&(o-=ai,o=o<0?0:o),new W(s,o)):null}else{if(e===0){const s=this.mapDomToView(t);if(s)return new W(s,0)}else{const s=t.childNodes[e-1];if(dt(s)&&_r(s)||s&&this.isBlockFiller(s))return this.domPositionToView(s.parentNode,Ra(s));const o=dt(s)?this.findCorrespondingViewText(s):this.mapDomToView(s);if(o&&o.parent)return new W(o.parent,o.index+1)}return null}}mapDomToView(t){return this.getHostViewElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(_r(t))return null;const e=this.getHostViewElement(t);if(e)return e;const i=t.previousSibling;if(i){if(!this.isElement(i))return null;const s=this.mapDomToView(i);if(s){const o=s.nextSibling;return o instanceof et?o:null}}else{const s=this.mapDomToView(t.parentNode);if(s){const o=s.getChild(0);return o instanceof et?o:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){const{scrollX:i,scrollY:s}=j.window,o=[];N0(e,r=>{const{scrollLeft:a,scrollTop:l}=r;o.push([a,l])}),e.focus(),N0(e,r=>{const[a,l]=o.shift();r.scrollLeft=a,r.scrollTop=l}),j.window.scrollTo(i,s)}}_clearDomSelection(){const t=this.mapViewToDom(this.document.selection.editableElement);if(!t)return;const e=t.ownerDocument.defaultView.getSelection(),i=this.domSelectionToView(e);i&&i.rangeCount>0&&e.removeAllRanges()}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(t){return this.blockFillerMode=="br"?t.isEqualNode(uU):t.tagName==="BR"&&C5(t,this.blockElements)&&t.parentNode.childNodes.length===1?!0:t.isEqualNode(hU)||mU(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=this._domDocument.createRange();try{e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset)}catch{return!1}const i=e.collapsed;return e.detach(),i}getHostViewElement(t){const e=jH(t);for(e.pop();e.length;){const i=e.pop(),s=this._domToViewMapping.get(i);if(s&&(s.is("uiElement")||s.is("rawElement")))return s}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}registerRawContentMatcher(t){this._rawContentElementMatcher.add(t)}registerInlineObjectMatcher(t){this._inlineObjectElementMatcher.add(t)}_clearTemporaryCustomProperties(){for(const t of this._elementsWithTemporaryCustomProperties)t._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return _5(this._domDocument);case"markedNbsp":return v5(this._domDocument);case"br":return y5(this._domDocument)}}_isDomSelectionPositionCorrect(t,e){if(dt(t)&&Sn(t)&&e<ai||this.isElement(t)&&Sn(t.childNodes[e]))return!1;const i=this.mapDomToView(t);return!(i&&(i.is("uiElement")||i.is("rawElement")))}*_domToView(t,e,i){if(this.isBlockFiller(t))return null;const s=this.getHostViewElement(t);if(s)return s;if(Za(t)&&e.skipComments)return null;if(dt(t)){if(_r(t))return null;{const o=t.data;if(o==="")return null;const r=new et(this.document,o);return i.push(r),r}}else{let o=this.mapDomToView(t);if(o)return this._isInlineObjectElement(o)&&i.push(o),o;if(this.isDocumentFragment(t))o=new _o(this.document),e.bind&&this.bindDocumentFragments(t,o);else{o=this._createViewElement(t,e),e.bind&&this.bindElements(t,o);const a=t.attributes;if(a)for(let l=a.length,c=0;c<l;c++)o._setAttribute(a[c].name,a[c].value);if(this._isViewElementWithRawContent(o,e))return o._setCustomProperty("$rawContent",t.innerHTML),this._isBlockViewElement(o)||i.push(o),o;if(Za(t))return o._setCustomProperty("$rawContent",t.data),o}yield o;const r=[];if(e.withChildren!==!1)for(const a of this.domChildrenToView(t,e,r))o._appendChild(a);if(this._isInlineObjectElement(o))i.push(o);else for(const a of r)i.push(a)}}_processDomInlineNodes(t,e,i){if(!e.length||t&&!this.isDocumentFragment(t)&&!this._isBlockDomElement(t))return;let s=!1;for(let o=0;o<e.length;o++){const r=e[o];if(!r.is("$text")){s=!1;continue}let a,l=!1;if(this._isPreFormatted(r))a=V0(r.data);else{a=r.data.replace(/[ \n\t\r]{1,}/g," "),l=/[^\S\u00A0]/.test(a.charAt(a.length-1));const c=o>0?e[o-1]:null,u=o+1<e.length?e[o+1]:null,d=!c||c.is("element")&&c.name=="br"||s,f=u?!1:!Sn(r.data);i.withChildren!==!1&&(d&&(a=a.replace(/^ /,"")),f&&(a=a.replace(/ $/,""))),a=V0(a),a=a.replace(/ \u00A0/g,"  ");const m=u&&u.is("element")&&u.name!="br",g=u&&u.is("$text")&&u.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(a)||!u||m||g)&&(a=a.replace(/\u00A0$/," ")),(d||c&&c.is("element")&&c.name!="br")&&(a=a.replace(/^\u00A0/," "))}a.length==0&&r.parent?(r._remove(),e.splice(o,1),o--):(r._data=a,s=l)}e.length=0}_processDataFromViewText(t){let e=t.data;if(this._isPreFormatted(t))return e;if(e.charAt(0)==" "){const i=this._getTouchingInlineViewNode(t,!1);(i&&i.is("$textProxy")&&this._nodeEndsWithSpace(i)||!i)&&(e=" "+e.substr(1))}if(e.charAt(e.length-1)==" "){const i=this._getTouchingInlineViewNode(t,!0),s=i&&i.is("$textProxy")&&i.data.charAt(0)==" ";(e.charAt(e.length-2)==" "||!i||s)&&(e=e.substr(0,e.length-1)+" ")}return e.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(this._isPreFormatted(t))return!1;const e=this._processDataFromViewText(t);return e.charAt(e.length-1)==" "}_isPreFormatted(t){if(fU(t,this.preElements))return!0;for(const e of t.getAncestors({parentFirst:!0}))if(!(!e.is("element")||!e.hasStyle("white-space")||e.getStyle("white-space")==="inherit"))return["pre","pre-wrap","break-spaces"].includes(e.getStyle("white-space"));return!1}_getTouchingInlineViewNode(t,e){const i=new ho({startPosition:e?W._createAfter(t):W._createBefore(t),direction:e?"forward":"backward"});for(const s of i){if(s.item.is("element","br"))return null;if(this._isInlineObjectElement(s.item))return s.item;if(s.item.is("containerElement"))return null;if(s.item.is("$textProxy"))return s.item}return null}_isBlockDomElement(t){return this.isElement(t)&&this.blockElements.includes(t.tagName.toLowerCase())}_isBlockViewElement(t){return t.is("element")&&this.blockElements.includes(t.name)}_isInlineObjectElement(t){return t.is("element")?t.name=="br"||this.inlineObjectElements.includes(t.name)||!!this._inlineObjectElementMatcher.match(t):!1}_createViewElement(t,e){if(Za(t))return new Sh(this.document,"$comment");const i=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();return new hi(this.document,i)}_isViewElementWithRawContent(t,e){return e.withChildren!==!1&&t.is("element")&&!!this._rawContentElementMatcher.match(t)}_shouldRenameElement(t){const e=t.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(e)}_createReplacementDomElement(t,e){const i=this._domDocument.createElement("span");if(i.setAttribute(O0,t),e){for(;e.firstChild;)i.appendChild(e.firstChild);for(const s of e.getAttributeNames())i.setAttribute(s,e.getAttribute(s))}return i}}function fU(n,t){return n.getAncestors().some(e=>e.is("element")&&t.includes(e.name))}function N0(n,t){let e=n;for(;e;)t(e),e=e.parentElement}function mU(n,t){return n.isEqualNode(dU)&&C5(n,t)&&n.parentNode.childNodes.length===1}function C5(n,t){const e=n.parentNode;return!!e&&!!e.tagName&&t.includes(e.tagName.toLowerCase())}function F0(n){n==="script"&&Te("domconverter-unsafe-script-element-detected"),n==="style"&&Te("domconverter-unsafe-style-element-detected")}function gU(n){if(!ue.isGecko||!n.rangeCount)return!1;const t=n.getRangeAt(0).startContainer;try{Object.prototype.toString.call(t)}catch{return!0}return!1}class Oi extends on(){constructor(e){super();h(this,"view");h(this,"document");h(this,"_isEnabled",!1);this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}class $r{constructor(t,e,i){h(this,"view");h(this,"document");h(this,"domEvent");h(this,"domTarget");this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,Nr(this,i)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class fs extends Oi{constructor(){super(...arguments);h(this,"useCapture",!1)}observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(s=>{this.listenTo(e,s,(o,r)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(r.target)&&this.onDomEvent(r)},{useCapture:this.useCapture})})}stopObserving(e){this.stopListening(e)}fire(e,i,s){this.isEnabled&&this.document.fire(e,new $r(this.view,i,s))}}class pU extends fs{constructor(){super(...arguments);h(this,"domEventType",["keydown","keyup"])}onDomEvent(e){const i={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return Po(this)}};this.fire(e.type,e,i)}}class bU extends Oi{constructor(e){super(e);h(this,"_fireSelectionChangeDoneDebounced");this._fireSelectionChangeDoneDebounced=Fn(i=>{this.document.fire("selectionChangeDone",i)},200)}observe(){const e=this.document;e.on("arrowKey",(i,s)=>{e.selection.isFake&&this.isEnabled&&s.preventDefault()},{context:"$capture"}),e.on("arrowKey",(i,s)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(s.keyCode)},{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const i=this.document.selection,s=new Zi(i.getRanges(),{backward:i.isBackward,fake:!1});(e==_e.arrowleft||e==_e.arrowup)&&s.setTo(s.getFirstPosition()),(e==_e.arrowright||e==_e.arrowdown)&&s.setTo(s.getLastPosition());const o={oldSelection:i,newSelection:s,domSelection:null};this.document.fire("selectionChange",o),this._fireSelectionChangeDoneDebounced(o)}}let k5=class extends Oi{constructor(e){super(e);h(this,"domConverter");h(this,"renderer");h(this,"_config");h(this,"_domElements");h(this,"_mutationObserver");this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const i of this._domElements)this._mutationObserver.observe(i,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const i=this.domConverter,s=new Set,o=new Set;for(const a of e){const l=i.mapDomToView(a.target);l&&(l.is("uiElement")||l.is("rawElement")||a.type==="childList"&&!this._isBogusBrMutation(a)&&o.add(l))}for(const a of e){const l=i.mapDomToView(a.target);if(!(l&&(l.is("uiElement")||l.is("rawElement")))&&a.type==="characterData"){const c=i.findCorrespondingViewText(a.target);c&&!o.has(c.parent)?s.add(c):!c&&Sn(a.target)&&o.add(i.mapDomToView(a.target.parentNode))}}let r=!1;for(const a of s)r=!0,this.renderer.markToSync("text",a);for(const a of o){const l=i.mapViewToDom(a),c=Array.from(a.getChildren()),u=Array.from(i.domChildrenToView(l,{withChildren:!1}));Wp(c,u,wU)||(r=!0,this.renderer.markToSync("children",a))}r&&this.view.forceRender()}_isBogusBrMutation(e){let i=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(i=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),i&&i.is("element","br")}};function wU(n,t){if(!Array.isArray(n))return n===t?!0:n.is("$text")&&t.is("$text")?n.data===t.data:!1}class Xu extends fs{constructor(e){super(e);h(this,"_renderTimeoutId");h(this,"_isFocusChanging",!1);h(this,"domEventType",["focus","blur"]);this.useCapture=!0;const i=this.document;i.on("focus",()=>{this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(()=>{this.flush(),e.change(()=>{})},50)}),i.on("blur",(s,o)=>{const r=i.selection.editableElement;(r===null||r===o.target)&&(i.isFocused=!1,this._isFocusChanging=!1,e.change(()=>{}))})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}class _U extends Oi{constructor(e){super(e);h(this,"mutationObserver");h(this,"focusObserver");h(this,"selection");h(this,"domConverter");h(this,"_documents");h(this,"_fireSelectionChangeDoneDebounced");h(this,"_clearInfiniteLoopInterval");h(this,"_documentIsSelectingInactivityTimeoutDebounced");h(this,"_loopbackCounter");this.mutationObserver=e.getObserver(k5),this.focusObserver=e.getObserver(Xu),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=Fn(i=>{this.document.fire("selectionChangeDone",i)},200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=Fn(()=>this.document.isSelecting=!1,5e3),this._loopbackCounter=0}observe(e){const i=e.ownerDocument,s=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},o=()=>{this.document.isSelecting&&(this._handleSelectionChange(null,i),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",s,{priority:"highest"}),this.listenTo(e,"keydown",o,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",o,{priority:"highest",useCapture:!0}),!this._documents.has(i)&&(this.listenTo(i,"mouseup",o,{priority:"highest",useCapture:!0}),this.listenTo(i,"selectionchange",(r,a)=>{this.document.isComposing&&!ue.isAndroid||(this._handleSelectionChange(a,i),this._documentIsSelectingInactivityTimeoutDebounced())}),this._documents.add(i))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e,i){if(!this.isEnabled)return;const s=i.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(s.anchorNode))return;this.mutationObserver.flush();const o=this.domConverter.domSelectionToView(s);if(o.rangeCount==0){this.view.hasDomSelection=!1;return}if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!(this.selection.isEqual(o)&&this.domConverter.isDomSelectionCorrect(s))){if(++this._loopbackCounter>60){this._reportInfiniteLoop();return}if(this.selection.isSimilar(o))this.view.forceRender();else{const r={oldSelection:this.selection,newSelection:o,domSelection:s};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}}_clearInfiniteLoop(){this._loopbackCounter=0}}class vU extends fs{constructor(e){super(e);h(this,"domEventType",["compositionstart","compositionupdate","compositionend"]);const i=this.document;i.on("compositionstart",()=>{i.isComposing=!0},{priority:"low"}),i.on("compositionend",()=>{i.isComposing=!1},{priority:"low"})}onDomEvent(e){this.fire(e.type,e,{data:e.data})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class T5{constructor(t,e={}){h(this,"_files");h(this,"_native");this._files=e.cacheFiles?D0(t):null,this._native=t}get files(){return this._files||(this._files=D0(this._native)),this._files}get types(){return this._native.types}getData(t){return this._native.getData(t)}setData(t,e){this._native.setData(t,e)}set effectAllowed(t){this._native.effectAllowed=t}get effectAllowed(){return this._native.effectAllowed}set dropEffect(t){this._native.dropEffect=t}get dropEffect(){return this._native.dropEffect}setDragImage(t,e,i){this._native.setDragImage(t,e,i)}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}}function D0(n){const t=Array.from(n.files||[]),e=Array.from(n.items||[]);return t.length?t:e.filter(i=>i.kind==="file").map(i=>i.getAsFile())}class yU extends fs{constructor(){super(...arguments);h(this,"domEventType","beforeinput")}onDomEvent(e){const i=e.getTargetRanges(),s=this.view,o=s.document;let r=null,a=null,l=[];if(e.dataTransfer&&(r=new T5(e.dataTransfer)),e.data!==null?a=e.data:r&&(a=r.getData("text/plain")),o.selection.isFake)l=Array.from(o.selection.getRanges());else if(i.length)l=i.map(c=>{const u=s.domConverter.domPositionToView(c.startContainer,c.startOffset),d=s.domConverter.domPositionToView(c.endContainer,c.endOffset);if(u)return s.createRange(u,d);if(d)return s.createRange(d)}).filter(c=>!!c);else if(ue.isAndroid){const c=e.target.ownerDocument.defaultView.getSelection();l=Array.from(s.domConverter.domSelectionToView(c).getRanges())}if(ue.isAndroid&&e.inputType=="insertCompositionText"&&a&&a.endsWith(`
`)){this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[s.createRange(l[0].end)]});return}if(e.inputType=="insertText"&&a&&a.includes(`
`)){const c=a.split(/\n{1,2}/g);let u=l;for(let d=0;d<c.length;d++){const f=c[d];f!=""&&(this.fire(e.type,e,{data:f,dataTransfer:r,targetRanges:u,inputType:e.inputType,isComposing:e.isComposing}),u=[o.selection.getFirstRange()]),d+1<c.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:u}),u=[o.selection.getFirstRange()])}return}this.fire(e.type,e,{data:a,dataTransfer:r,targetRanges:l,inputType:e.inputType,isComposing:e.isComposing})}}class CU extends Oi{constructor(t){super(t),this.document.on("keydown",(e,i)=>{if(this.isEnabled&&oz(i.keyCode)){const s=new aa(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(s,i),s.stop.called&&e.stop()}})}observe(){}stopObserving(){}}class kU extends Oi{constructor(t){super(t);const e=this.document;e.on("keydown",(i,s)=>{if(!this.isEnabled||s.keyCode!=_e.tab||s.ctrlKey)return;const o=new aa(e,"tab",e.selection.getFirstRange());e.fire(o,s),o.stop.called&&i.stop()})}observe(){}stopObserving(){}}let TU=class extends Ve(){constructor(e){super();h(this,"document");h(this,"domConverter");h(this,"domRoots",new Map);h(this,"_renderer");h(this,"_initialDomRootAttributes",new WeakMap);h(this,"_observers",new Map);h(this,"_writer");h(this,"_ongoingChange",!1);h(this,"_postFixersInProgress",!1);h(this,"_renderingDisabled",!1);h(this,"_hasChangedSinceTheLastRendering",!1);this.document=new xh(e),this.domConverter=new Ih(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new nU(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new b5(this.document),this.addObserver(k5),this.addObserver(Xu),this.addObserver(_U),this.addObserver(pU),this.addObserver(bU),this.addObserver(vU),this.addObserver(CU),this.addObserver(yU),this.addObserver(kU),eU(this),jz(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0}),ue.isiOS&&this.listenTo(this.document,"blur",(i,s)=>{this.domConverter.mapDomToView(s.domEvent.relatedTarget)||this.domConverter._clearDomSelection()})}attachDomRoot(e,i="main"){const s=this.document.getRoot(i);s._name=e.tagName.toLowerCase();const o={};for(const{name:a,value:l}of Array.from(e.attributes))o[a]=l,a==="class"?this._writer.addClass(l.split(" "),s):this._writer.setAttribute(a,l,s);this._initialDomRootAttributes.set(e,o);const r=()=>{this._writer.setAttribute("contenteditable",(!s.isReadOnly).toString(),s),s.isReadOnly?this._writer.addClass("ck-read-only",s):this._writer.removeClass("ck-read-only",s)};r(),this.domRoots.set(i,e),this.domConverter.bindElements(e,s),this._renderer.markToSync("children",s),this._renderer.markToSync("attributes",s),this._renderer.domDocuments.add(e.ownerDocument),s.on("change:children",(a,l)=>this._renderer.markToSync("children",l)),s.on("change:attributes",(a,l)=>this._renderer.markToSync("attributes",l)),s.on("change:text",(a,l)=>this._renderer.markToSync("text",l)),s.on("change:isReadOnly",()=>this.change(r)),s.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const a of this._observers.values())a.observe(e,i)}detachDomRoot(e){const i=this.domRoots.get(e);Array.from(i.attributes).forEach(({name:o})=>i.removeAttribute(o));const s=this._initialDomRootAttributes.get(i);for(const o in s)i.setAttribute(o,s[o]);this.domRoots.delete(e),this.domConverter.unbindDomElement(i);for(const o of this._observers.values())o.stopObserving(i)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let i=this._observers.get(e);if(i)return i;i=new e(this),this._observers.set(e,i);for(const[s,o]of this.domRoots)i.observe(o,s);return i.enable(),i}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:i,viewportOffset:s=20,ancestorOffset:o=20}={}){const r=this.document.selection.getFirstRange();if(!r)return;const a=kn({alignToTop:e,forceScroll:i,viewportOffset:s,ancestorOffset:o});typeof s=="number"&&(s={top:s,bottom:s,left:s,right:s});const l={target:this.domConverter.viewRangeToDom(r),viewportOffset:s,ancestorOffset:o,alignToTop:e,forceScroll:i};this.fire("scrollToTheSelection",l,a),XH(l)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new C("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const i=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),i}catch(i){/* istanbul ignore next -- @preserve */C.rethrowUnexpectedError(i,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(Xu).flush(),this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,i){return W._createAt(e,i)}createPositionAfter(e){return W._createAfter(e)}createPositionBefore(e){return W._createBefore(e)}createRange(e,i){return new we(e,i)}createRangeOn(e){return we._createOn(e)}createRangeIn(e){return we._createIn(e)}createSelection(...e){return new Zi(...e)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ys{is(){throw new Error("is() method is abstract")}}let Uo=class extends Ys{constructor(e){super();h(this,"parent",null);h(this,"_attrs");this._attrs=Ii(e)}get document(){return null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))===null)throw new C("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if((e=this.parent.getChildStartOffset(this))===null)throw new C("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const e=[];let i=this;for(;i.parent;)e.unshift(i.startOffset),i=i.parent;return e}getAncestors(e={}){const i=[];let s=e.includeSelf?this:this.parent;for(;s;)i[e.parentFirst?"push":"unshift"](s),s=s.parent;return i}getCommonAncestor(e,i={}){const s=this.getAncestors(i),o=e.getAncestors(i);let r=0;for(;s[r]==o[r]&&s[r];)r++;return r===0?null:s[r-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const i=this.getPath(),s=e.getPath(),o=$t(i,s);switch(o){case"prefix":return!0;case"extension":return!1;default:return i[o]<s[o]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((i,s)=>(i[s[0]]=s[1],i),{})),e}_clone(e){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,i){this._attrs.set(e,i)}_setAttributesTo(e){this._attrs=Ii(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}};Uo.prototype.is=function(n){return n==="node"||n==="model:node"};class Ja{constructor(t){h(this,"_nodes",[]);t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,e)=>t+e.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const e=this._nodes.indexOf(t);return e==-1?null:e}getNodeStartOffset(t){const e=this.getNodeIndex(t);return e===null?null:this._nodes.slice(0,e).reduce((i,s)=>i+s.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new C("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(e)}offsetToIndex(t){let e=0;for(const i of this._nodes){if(t>=e&&t<e+i.offsetSize)return this.getNodeIndex(i);e+=i.offsetSize}if(e!=t)throw new C("model-nodelist-offset-out-of-bounds",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,e){for(const i of e)if(!(i instanceof Uo))throw new C("model-nodelist-insertnodes-not-node",this);this._nodes=_z(this._nodes,Array.from(e),t,0)}_removeNodes(t,e=1){return this._nodes.splice(t,e)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class He extends Uo{constructor(e,i){super(i);h(this,"_data");this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new He(this.data,this.getAttributes())}static fromJSON(e){return new He(e.data,e.attributes)}}He.prototype.is=function(n){return n==="$text"||n==="model:$text"||n==="text"||n==="model:text"||n==="node"||n==="model:node"};class li extends Ys{constructor(e,i,s){super();h(this,"textNode");h(this,"data");h(this,"offsetInText");if(this.textNode=e,i<0||i>e.offsetSize)throw new C("model-textproxy-wrong-offsetintext",this);if(s<0||i+s>e.offsetSize)throw new C("model-textproxy-wrong-length",this);this.data=e.data.substring(i,i+s),this.offsetInText=i}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const i=[];let s=e.includeSelf?this:this.parent;for(;s;)i[e.parentFirst?"push":"unshift"](s),s=s.parent;return i}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}li.prototype.is=function(n){return n==="$textProxy"||n==="model:$textProxy"||n==="textProxy"||n==="model:textProxy"};let Je=class mu extends Uo{constructor(e,i,s){super(i);h(this,"name");h(this,"_children",new Ja);this.name=e,s&&this._insertChild(0,s)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let i=this;for(const s of e)i=i.getChild(i.offsetToIndex(s));return i}findAncestor(e,i={}){let s=i.includeSelf?this:this.parent;for(;s;){if(s.name===e)return s;s=s.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const i of this._children)e.children.push(i.toJSON())}return e}_clone(e=!1){const i=e?Array.from(this._children).map(s=>s._clone(!0)):void 0;return new mu(this.name,this.getAttributes(),i)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,i){const s=EU(i);for(const o of s)o.parent!==null&&o._remove(),o.parent=this;this._children._insertNodes(e,s)}_removeChildren(e,i=1){const s=this._children._removeNodes(e,i);for(const o of s)o.parent=null;return s}static fromJSON(e){let i;if(e.children){i=[];for(const s of e.children)s.name?i.push(mu.fromJSON(s)):i.push(He.fromJSON(s))}return new mu(e.name,e.attributes,i)}};Je.prototype.is=function(n,t){return t?t===this.name&&(n==="element"||n==="model:element"):n==="element"||n==="model:element"||n==="node"||n==="model:node"};function EU(n){return typeof n=="string"?[new He(n)]:(Dn(n)||(n=[n]),Array.from(n).map(t=>typeof t=="string"?new He(t):t instanceof li?new He(t.data,t.getAttributes()):t))}class ji{constructor(t){h(this,"direction");h(this,"boundaries");h(this,"singleCharacters");h(this,"shallow");h(this,"ignoreElementEnd");h(this,"_position");h(this,"_boundaryStartParent");h(this,"_boundaryEndParent");h(this,"_visitedParent");if(!t||!t.boundaries&&!t.startPosition)throw new C("model-tree-walker-no-start-position",null);const e=t.direction||"forward";if(e!="forward"&&e!="backward")throw new C("model-tree-walker-unknown-direction",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,t.startPosition?this._position=t.startPosition.clone():this._position=M._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(t){let e,i,s,o;do s=this.position,o=this._visitedParent,{done:e,value:i}=this.next();while(!e&&t(i));e||(this._position=s,this._visitedParent=o)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),i=this._visitedParent;if(i.parent===null&&e.offset===i.maxOffset)return{done:!0,value:void 0};if(i===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const s=Ya(e,i),o=s||E5(e,i,s);if(o instanceof Je){if(!this.shallow)e.path.push(0),this._visitedParent=o;else{if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++}return this._position=e,so("elementStart",o,t,e,1)}if(o instanceof He){let r;if(this.singleCharacters)r=1;else{let c=o.endOffset;this._boundaryEndParent==i&&this.boundaries.end.offset<c&&(c=this.boundaries.end.offset),r=c-e.offset}const a=e.offset-o.startOffset,l=new li(o,a,r);return e.offset+=r,this._position=e,so("text",l,t,e,r)}return e.path.pop(),e.offset++,this._position=e,this._visitedParent=i.parent,this.ignoreElementEnd?this._next():so("elementEnd",i,t,e)}_previous(){const t=this.position,e=this.position.clone(),i=this._visitedParent;if(i.parent===null&&e.offset===0)return{done:!0,value:void 0};if(i==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const s=e.parent,o=Ya(e,s),r=o||A5(e,s,o);if(r instanceof Je)return e.offset--,this.shallow?(this._position=e,so("elementStart",r,t,e,1)):(e.path.push(r.maxOffset),this._position=e,this._visitedParent=r,this.ignoreElementEnd?this._previous():so("elementEnd",r,t,e));if(r instanceof He){let a;if(this.singleCharacters)a=1;else{let u=r.startOffset;this._boundaryStartParent==i&&this.boundaries.start.offset>u&&(u=this.boundaries.start.offset),a=e.offset-u}const l=e.offset-r.startOffset,c=new li(r,l-a,a);return e.offset-=a,this._position=e,so("text",c,t,e,a)}return e.path.pop(),this._position=e,this._visitedParent=i.parent,so("elementStart",i,t,e,1)}}function so(n,t,e,i,s){return{done:!1,value:{type:n,item:t,previousPosition:e,nextPosition:i,length:s}}}class M extends Ys{constructor(e,i,s="toNone"){super();h(this,"root");h(this,"path");h(this,"stickiness");if(!e.is("element")&&!e.is("documentFragment"))throw new C("model-position-root-invalid",e);if(!(i instanceof Array)||i.length===0)throw new C("model-position-path-incorrect-format",e,{path:i});e.is("rootElement")?i=i.slice():(i=[...e.getPath(),...i],e=e.root),this.root=e,this.path=i,this.stickiness=s}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let i=0;i<this.path.length-1;i++)if(e=e.getChild(e.offsetToIndex(this.path[i])),!e)throw new C("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new C("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return Ya(this,this.parent)}get nodeAfter(){const e=this.parent;return E5(this,e,Ya(this,e))}get nodeBefore(){const e=this.parent;return A5(this,e,Ya(this,e))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const i=$t(this.path,e.path);switch(i){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[i]<e.path[i]?"before":"after"}}getLastMatchingPosition(e,i={}){i.startPosition=this;const s=new ji(i);return s.skip(e),s.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const i=this.parent;return i.is("element")?i.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const i=$t(this.path,e.path),s=typeof i=="string"?Math.min(this.path.length,e.path.length):i;return this.path.slice(0,s)}getCommonAncestor(e){const i=this.getAncestors(),s=e.getAncestors();let o=0;for(;i[o]==s[o]&&i[o];)o++;return o===0?null:i[o-1]}getShiftedBy(e){const i=this.clone(),s=i.offset+e;return i.offset=s<0?0:s,i}isAfter(e){return this.compareWith(e)=="after"}isBefore(e){return this.compareWith(e)=="before"}isEqual(e){return this.compareWith(e)=="same"}isTouching(e){if(this.root!==e.root)return!1;const i=Math.min(this.path.length,e.path.length);for(let s=0;s<i;s++){const o=this.path[s]-e.path[s];if(o<-1||o>1)return!1;if(o===1)return $0(e,this,s);if(o===-1)return $0(this,e,s)}return this.path.length===e.path.length?!0:this.path.length>e.path.length?$m(this.path,i):$m(e.path,i)}hasSameParentAs(e){if(this.root!==e.root)return!1;const i=this.getParentPath(),s=e.getParentPath();return $t(i,s)=="same"}getTransformedByOperation(e){let i;switch(e.type){case"insert":i=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":i=this._getTransformedByMoveOperation(e);break;case"split":i=this._getTransformedBySplitOperation(e);break;case"merge":i=this._getTransformedByMergeOperation(e);break;default:i=M._createAt(this);break}return i}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const i=e.movedRange;return i.containsPosition(this)||i.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const i=e.movedRange,s=i.containsPosition(this)||i.start.isEqual(this);let o;return s?(o=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(o=o._getTransformedByDeletion(e.deletionPosition,1))):this.isEqual(e.deletionPosition)?o=M._createAt(e.deletionPosition):o=this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),o}_getTransformedByDeletion(e,i){const s=M._createAt(this);if(this.root!=e.root)return s;if($t(e.getParentPath(),this.getParentPath())=="same"){if(e.offset<this.offset){if(e.offset+i>this.offset)return null;s.offset-=i}}else if($t(e.getParentPath(),this.getParentPath())=="prefix"){const o=e.path.length-1;if(e.offset<=this.path[o]){if(e.offset+i>this.path[o])return null;s.path[o]-=i}}return s}_getTransformedByInsertion(e,i){const s=M._createAt(this);if(this.root!=e.root)return s;if($t(e.getParentPath(),this.getParentPath())=="same")(e.offset<this.offset||e.offset==this.offset&&this.stickiness!="toPrevious")&&(s.offset+=i);else if($t(e.getParentPath(),this.getParentPath())=="prefix"){const o=e.path.length-1;e.offset<=this.path[o]&&(s.path[o]+=i)}return s}_getTransformedByMove(e,i,s){if(i=i._getTransformedByDeletion(e,s),e.isEqual(i))return M._createAt(this);const o=this._getTransformedByDeletion(e,s);return o===null||e.isEqual(this)&&this.stickiness=="toNext"||e.getShiftedBy(s).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(e,i):o._getTransformedByInsertion(i,s)}_getCombined(e,i){const s=e.path.length-1,o=M._createAt(i);return o.stickiness=this.stickiness,o.offset=o.offset+this.path[s]-e.offset,o.path=[...o.path,...this.path.slice(s+1)],o}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,i,s="toNone"){if(e instanceof M)return new M(e.root,e.path,e.stickiness);{const o=e;if(i=="end")i=o.maxOffset;else{if(i=="before")return this._createBefore(o,s);if(i=="after")return this._createAfter(o,s);if(i!==0&&!i)throw new C("model-createpositionat-offset-required",[this,e])}if(!o.is("element")&&!o.is("documentFragment"))throw new C("model-position-parent-incorrect",[this,e]);const r=o.getPath();return r.push(i),new this(o.root,r,s)}}static _createAfter(e,i){if(!e.parent)throw new C("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,i)}static _createBefore(e,i){if(!e.parent)throw new C("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,i)}static fromJSON(e,i){if(e.root==="$graveyard"){const s=new M(i.graveyard,e.path);return s.stickiness=e.stickiness,s}if(!i.getRoot(e.root))throw new C("model-position-fromjson-no-root",i,{rootName:e.root});return new M(i.getRoot(e.root),e.path,e.stickiness)}}M.prototype.is=function(n){return n==="position"||n==="model:position"};function Ya(n,t){const e=t.getChild(t.offsetToIndex(n.offset));return e&&e.is("$text")&&e.startOffset<n.offset?e:null}function E5(n,t,e){return e!==null?null:t.getChild(t.offsetToIndex(n.offset))}function A5(n,t,e){return e!==null?null:t.getChild(t.offsetToIndex(n.offset)-1)}function $0(n,t,e){return!(e+1===n.path.length||!$m(t.path,e+1)||!AU(n,e+1))}function $m(n,t){for(;t<n.length;){if(n[t]!==0)return!1;t++}return!0}function AU(n,t){let e=n.parent,i=n.path.length-1,s=0;for(;i>=t;){if(n.path[i]+s!==e.maxOffset)return!1;s=1,i--,e=e.parent}return!0}class I extends Ys{constructor(e,i){super();h(this,"start");h(this,"end");this.start=M._createAt(e),this.end=i?M._createAt(i):M._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new ji({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),i=this.end.getParentPath();return $t(e,i)=="same"}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,i=!1){e.isCollapsed&&(i=!1);const s=this.containsPosition(e.start)||i&&this.start.isEqual(e.start),o=this.containsPosition(e.end)||i&&this.end.isEqual(e.end);return s&&o}containsItem(e){const i=M._createBefore(e);return this.containsPosition(i)||this.start.isEqual(i)}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const i=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&i.push(new I(this.start,e.start)),this.containsPosition(e.end)&&i.push(new I(e.end,this.end))):i.push(new I(this.start,this.end)),i}getIntersection(e){if(this.isIntersecting(e)){let i=this.start,s=this.end;return this.containsPosition(e.start)&&(i=e.start),this.containsPosition(e.end)&&(s=e.end),new I(i,s)}return null}getJoined(e,i=!1){let s=this.isIntersecting(e);if(s||(this.start.isBefore(e.start)?s=i?this.end.isTouching(e.start):this.end.isEqual(e.start):s=i?e.end.isTouching(this.start):e.end.isEqual(this.start)),!s)return null;let o=this.start,r=this.end;return e.start.isBefore(o)&&(o=e.start),e.end.isAfter(r)&&(r=e.end),new I(o,r)}getMinimalFlatRanges(){const e=[],i=this.start.getCommonPath(this.end).length,s=M._createAt(this.start);let o=s.parent;for(;s.path.length>i+1;){const r=o.maxOffset-s.offset;r!==0&&e.push(new I(s,s.getShiftedBy(r))),s.path=s.path.slice(0,-1),s.offset++,o=o.parent}for(;s.path.length<=this.end.path.length;){const r=this.end.path[s.path.length-1],a=r-s.offset;a!==0&&e.push(new I(s,s.getShiftedBy(a))),s.offset=r,s.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new ji(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const i=new ji(e);for(const s of i)yield s.item}*getPositions(e={}){e.boundaries=this;const i=new ji(e);yield i.position;for(const s of i)yield s.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new I(this.start,this.end)]}getTransformedByOperations(e){const i=[new I(this.start,this.end)];for(const s of e)for(let o=0;o<i.length;o++){const r=i[o].getTransformedByOperation(s);i.splice(o,1,...r),o+=r.length-1}for(let s=0;s<i.length;s++){const o=i[s];for(let r=s+1;r<i.length;r++){const a=i[r];(o.containsRange(a)||a.containsRange(o)||o.isEqual(a))&&i.splice(r,1)}}return i}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,i=this.end.nodeBefore;return e&&e.is("element")&&e===i?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,i=!1){return this._getTransformedByInsertion(e.position,e.howMany,i)}_getTransformedByMoveOperation(e,i=!1){const s=e.sourcePosition,o=e.howMany,r=e.targetPosition;return this._getTransformedByMove(s,r,o,i)}_getTransformedBySplitOperation(e){const i=this.start._getTransformedBySplitOperation(e);let s=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(s=this.end.getShiftedBy(1)),i.root!=s.root&&(s=this.end.getShiftedBy(-1)),new I(i,s)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new I(this.start);let i=this.start._getTransformedByMergeOperation(e),s=this.end._getTransformedByMergeOperation(e);return i.root!=s.root&&(s=this.end.getShiftedBy(-1)),i.isAfter(s)?(e.sourcePosition.isBefore(e.targetPosition)?(i=M._createAt(s),i.offset=0):(e.deletionPosition.isEqual(i)||(s=e.deletionPosition),i=e.targetPosition),new I(i,s)):new I(i,s)}_getTransformedByInsertion(e,i,s=!1){if(s&&this.containsPosition(e))return[new I(this.start,e),new I(e.getShiftedBy(i),this.end._getTransformedByInsertion(e,i))];{const o=new I(this.start,this.end);return o.start=o.start._getTransformedByInsertion(e,i),o.end=o.end._getTransformedByInsertion(e,i),[o]}}_getTransformedByMove(e,i,s,o=!1){if(this.isCollapsed){const f=this.start._getTransformedByMove(e,i,s);return[new I(f)]}const r=I._createFromPositionAndShift(e,s),a=i._getTransformedByDeletion(e,s);if(this.containsPosition(i)&&!o&&(r.containsPosition(this.start)||r.containsPosition(this.end))){const f=this.start._getTransformedByMove(e,i,s),m=this.end._getTransformedByMove(e,i,s);return[new I(f,m)]}let l;const c=this.getDifference(r);let u=null;const d=this.getIntersection(r);if(c.length==1?u=new I(c[0].start._getTransformedByDeletion(e,s),c[0].end._getTransformedByDeletion(e,s)):c.length==2&&(u=new I(this.start,this.end._getTransformedByDeletion(e,s))),u?l=u._getTransformedByInsertion(a,s,d!==null||o):l=[],d){const f=new I(d.start._getCombined(r.start,a),d.end._getCombined(r.start,a));l.length==2?l.splice(1,0,f):l.push(f)}return l}_getTransformedByDeletion(e,i){let s=this.start._getTransformedByDeletion(e,i),o=this.end._getTransformedByDeletion(e,i);return s==null&&o==null?null:(s==null&&(s=e),o==null&&(o=e),new I(s,o))}static _createFromPositionAndShift(e,i){const s=e,o=e.getShiftedBy(i);return i>0?new this(s,o):new this(o,s)}static _createIn(e){return new this(M._createAt(e,0),M._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(M._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(e.length===0)throw new C("range-create-from-ranges-empty-array",null);if(e.length==1)return e[0].clone();const i=e[0];e.sort((r,a)=>r.start.isAfter(a.start)?1:-1);const s=e.indexOf(i),o=new this(i.start,i.end);if(s>0)for(let r=s-1;e[r].end.isEqual(o.start);r++)o.start=M._createAt(e[r].start);for(let r=s+1;r<e.length&&e[r].start.isEqual(o.end);r++)o.end=M._createAt(e[r].end);return o}static fromJSON(e,i){return new this(M.fromJSON(e.start,i),M.fromJSON(e.end,i))}}I.prototype.is=function(n){return n==="range"||n==="model:range"};class x5 extends De(){constructor(){super();h(this,"_modelToViewMapping",new WeakMap);h(this,"_viewToModelMapping",new WeakMap);h(this,"_viewToModelLengthCallbacks",new Map);h(this,"_markerNameToElements",new Map);h(this,"_elementToMarkerNames",new Map);h(this,"_deferredBindingRemovals",new Map);h(this,"_unboundMarkerNames",new Set);this.on("modelToViewPosition",(e,i)=>{if(i.viewPosition)return;const s=this._modelToViewMapping.get(i.modelPosition.parent);if(!s)throw new C("mapping-model-position-view-parent-not-found",this,{modelPosition:i.modelPosition});i.viewPosition=this.findPositionIn(s,i.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,i)=>{if(i.modelPosition)return;const s=this.findMappedViewAncestor(i.viewPosition),o=this._viewToModelMapping.get(s),r=this._toModelOffset(i.viewPosition.parent,i.viewPosition.offset,s);i.modelPosition=M._createAt(o,r)},{priority:"low"})}bindElements(e,i){this._modelToViewMapping.set(e,i),this._viewToModelMapping.set(i,e)}unbindViewElement(e,i={}){const s=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const o of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(o);i.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e),this._modelToViewMapping.get(s)==e&&this._modelToViewMapping.delete(s))}unbindModelElement(e){const i=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(i)==e&&this._viewToModelMapping.delete(i)}bindElementToMarker(e,i){const s=this._markerNameToElements.get(i)||new Set;s.add(e);const o=this._elementToMarkerNames.get(e)||new Set;o.add(i),this._markerNameToElements.set(i,s),this._elementToMarkerNames.set(e,o)}unbindElementFromMarkerName(e,i){const s=this._markerNameToElements.get(i);s&&(s.delete(e),s.size==0&&this._markerNameToElements.delete(i));const o=this._elementToMarkerNames.get(e);o&&(o.delete(i),o.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,i]of this._deferredBindingRemovals)e.root==i&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new I(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new we(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const i={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",i),i.modelPosition}toViewPosition(e,i={}){const s={modelPosition:e,mapper:this,isPhantom:i.isPhantom};return this.fire("modelToViewPosition",s),s.viewPosition}markerNameToElements(e){const i=this._markerNameToElements.get(e);if(!i)return null;const s=new Set;for(const o of i)if(o.is("attributeElement"))for(const r of o.getElementsWithSameId())s.add(r);else s.add(o);return s}registerViewToModelLength(e,i){this._viewToModelLengthCallbacks.set(e,i)}findMappedViewAncestor(e){let i=e.parent;for(;!this._viewToModelMapping.has(i);)i=i.parent;return i}_toModelOffset(e,i,s){if(s!=e){const r=this._toModelOffset(e.parent,e.index,s),a=this._toModelOffset(e,i,e);return r+a}if(e.is("$text"))return i;let o=0;for(let r=0;r<i;r++)o+=this.getModelLength(e.getChild(r));return o}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name))return this._viewToModelLengthCallbacks.get(e.name)(e);if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let i=0;for(const s of e.getChildren())i+=this.getModelLength(s);return i}}findPositionIn(e,i){let s,o=0,r=0,a=0;if(e.is("$text"))return new W(e,i);for(;r<i;)s=e.getChild(a),o=this.getModelLength(s),r+=o,a++;return r==i?this._moveViewPositionToTextNode(new W(e,a)):this.findPositionIn(s,i-(r-o))}_moveViewPositionToTextNode(e){const i=e.nodeBefore,s=e.nodeAfter;return i instanceof et?new W(i,i.data.length):s instanceof et?new W(s,0):e}}class xU{constructor(){h(this,"_consumable",new Map);h(this,"_textProxyRegistry",new Map)}add(t,e){e=Nc(e),t instanceof li&&(t=this._getSymbolForTextProxy(t)),this._consumable.has(t)||this._consumable.set(t,new Map),this._consumable.get(t).set(e,!0)}consume(t,e){return e=Nc(e),t instanceof li&&(t=this._getSymbolForTextProxy(t)),this.test(t,e)?(this._consumable.get(t).set(e,!1),!0):!1}test(t,e){e=Nc(e),t instanceof li&&(t=this._getSymbolForTextProxy(t));const i=this._consumable.get(t);if(i===void 0)return null;const s=i.get(e);return s===void 0?null:s}revert(t,e){e=Nc(e),t instanceof li&&(t=this._getSymbolForTextProxy(t));const i=this.test(t,e);return i===!1?(this._consumable.get(t).set(e,!0),!0):i===!0?!1:null}verifyAllConsumed(t){const e=[];for(const[i,s]of this._consumable)for(const[o,r]of s){const a=o.split(":")[0];r&&t==a&&e.push({event:o,item:i.name||i.description})}if(e.length)throw new C("conversion-model-consumable-not-consumed",null,{items:e})}_getSymbolForTextProxy(t){let e=null;const i=this._textProxyRegistry.get(t.startOffset);if(i){const s=i.get(t.endOffset);s&&(e=s.get(t.parent))}return e||(e=this._addSymbolForTextProxy(t)),e}_addSymbolForTextProxy(t){const e=t.startOffset,i=t.endOffset,s=t.parent,o=Symbol("$textProxy:"+t.data);let r,a;return r=this._textProxyRegistry.get(e),r||(r=new Map,this._textProxyRegistry.set(e,r)),a=r.get(i),a||(a=new Map,r.set(i,a)),a.set(s,o),o}}function Nc(n){const t=n.split(":");return t[0]=="insert"?t[0]:t[0]=="addMarker"||t[0]=="removeMarker"?n:t.length>1?t[0]+":"+t[1]:t[0]}class S5 extends De(){constructor(e){super();h(this,"_conversionApi");h(this,"_firedEventsMap");this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,i,s){const o=this._createConversionApi(s,e.getRefreshedItems());for(const a of e.getMarkersToRemove())this._convertMarkerRemove(a.name,a.range,o);const r=this._reduceChanges(e.getChanges());for(const a of r)a.type==="insert"?this._convertInsert(I._createFromPositionAndShift(a.position,a.length),o):a.type==="reinsert"?this._convertReinsert(I._createFromPositionAndShift(a.position,a.length),o):a.type==="remove"?this._convertRemove(a.position,a.length,a.name,o):this._convertAttribute(a.range,a.attributeKey,a.attributeOldValue,a.attributeNewValue,o);o.mapper.flushDeferredBindings();for(const a of o.mapper.flushUnboundMarkerNames()){const l=i.get(a).getRange();this._convertMarkerRemove(a,l,o),this._convertMarkerAdd(a,l,o)}for(const a of e.getMarkersToAdd())this._convertMarkerAdd(a.name,a.range,o);o.consumable.verifyAllConsumed("insert")}convert(e,i,s,o={}){const r=this._createConversionApi(s,void 0,o);this._convertInsert(e,r);for(const[a,l]of i)this._convertMarkerAdd(a,l,r);r.consumable.verifyAllConsumed("insert")}convertSelection(e,i,s){const o=this._createConversionApi(s);this.fire("cleanSelection",{selection:e},o);const r=e.getFirstPosition().root;if(!o.mapper.toViewElement(r))return;const a=Array.from(i.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(o.consumable,e,a),this.fire("selection",{selection:e},o),!!e.isCollapsed){for(const l of a)if(o.consumable.test(e,"addMarker:"+l.name)){const c=l.getRange();if(!SU(e.getFirstPosition(),l,o.mapper))continue;const u={item:e,markerName:l.name,markerRange:c};this.fire(`addMarker:${l.name}`,u,o)}for(const l of e.getAttributeKeys())if(o.consumable.test(e,"attribute:"+l)){const c={item:e,range:e.getFirstRange(),attributeKey:l,attributeOldValue:null,attributeNewValue:e.getAttribute(l)};this.fire(`attribute:${l}:$text`,c,o)}}}_convertInsert(e,i,s={}){s.doNotAddConsumables||this._addConsumablesForInsert(i.consumable,e);for(const o of Array.from(e.getWalker({shallow:!0})).map(H0))this._testAndFire("insert",o,i)}_convertRemove(e,i,s,o){this.fire(`remove:${s}`,{position:e,length:i},o)}_convertAttribute(e,i,s,o,r){this._addConsumablesForRange(r.consumable,e,`attribute:${i}`);for(const a of e){const l={item:a.item,range:I._createFromPositionAndShift(a.previousPosition,a.length),attributeKey:i,attributeOldValue:s,attributeNewValue:o};this._testAndFire(`attribute:${i}`,l,r)}}_convertReinsert(e,i){const s=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(i.consumable,s);for(const o of s.map(H0))this._testAndFire("insert",{...o,reconversion:!0},i)}_convertMarkerAdd(e,i,s){if(i.root.rootName=="$graveyard")return;const o=`addMarker:${e}`;if(s.consumable.add(i,o),this.fire(o,{markerName:e,markerRange:i},s),!!s.consumable.consume(i,o)){this._addConsumablesForRange(s.consumable,i,o);for(const r of i.getItems()){if(!s.consumable.test(r,o))continue;const a={item:r,range:I._createOn(r),markerName:e,markerRange:i};this.fire(o,a,s)}}}_convertMarkerRemove(e,i,s){i.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:i},s)}_reduceChanges(e){const i={changes:e};return this.fire("reduceChanges",i),i.changes}_addConsumablesForInsert(e,i){for(const s of i){const o=s.item;if(e.test(o,"insert")===null){e.add(o,"insert");for(const r of o.getAttributeKeys())e.add(o,"attribute:"+r)}}return e}_addConsumablesForRange(e,i,s){for(const o of i.getItems())e.add(o,s);return e}_addConsumablesForSelection(e,i,s){e.add(i,"selection");for(const o of s)e.add(i,"addMarker:"+o.name);for(const o of i.getAttributeKeys())e.add(i,"attribute:"+o);return e}_testAndFire(e,i,s){const o=IU(e,i),r=i.item.is("$textProxy")?s.consumable._getSymbolForTextProxy(i.item):i.item,a=this._firedEventsMap.get(s),l=a.get(r);if(!l)a.set(r,new Set([o]));else if(!l.has(o))l.add(o);else return;this.fire(o,i,s)}_testAndFireAddAttributes(e,i){const s={item:e,range:I._createOn(e)};for(const o of s.item.getAttributeKeys())s.attributeKey=o,s.attributeOldValue=null,s.attributeNewValue=s.item.getAttribute(o),this._testAndFire(`attribute:${o}`,s,i)}_createConversionApi(e,i=new Set,s={}){const o={...this._conversionApi,consumable:new xU,writer:e,options:s,convertItem:r=>this._convertInsert(I._createOn(r),o),convertChildren:r=>this._convertInsert(I._createIn(r),o,{doNotAddConsumables:!0}),convertAttributes:r=>this._testAndFireAddAttributes(r,o),canReuseView:r=>!i.has(o.mapper.toModelElement(r))};return this._firedEventsMap.set(o,new Map),o}}function SU(n,t,e){const i=t.getRange(),s=Array.from(n.getAncestors());return s.shift(),s.reverse(),!s.some(r=>{if(i.containsItem(r))return!!e.toViewElement(r).getCustomProperty("addHighlight")})}function IU(n,t){const e=t.item.is("element")?t.item.name:"$text";return`${n}:${e}`}function H0(n){const t=n.item,e=I._createFromPositionAndShift(n.previousPosition,n.length);return{item:t,range:e}}class In extends De(Ys){constructor(...e){super();h(this,"_lastRangeBackward",!1);h(this,"_attrs",new Map);h(this,"_ranges",[]);e.length&&this.setTo(...e)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const i of this._ranges){let s=!1;for(const o of e._ranges)if(i.isEqual(o)){s=!0;break}if(!s)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new I(e.start,e.end)}getFirstRange(){let e=null;for(const i of this._ranges)(!e||i.start.isBefore(e.start))&&(e=i);return e?new I(e.start,e.end):null}getLastRange(){let e=null;for(const i of this._ranges)(!e||i.end.isAfter(e.end))&&(e=i);return e?new I(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(...e){let[i,s,o]=e;if(typeof s=="object"&&(o=s,s=void 0),i===null)this._setRanges([]);else if(i instanceof In)this._setRanges(i.getRanges(),i.isBackward);else if(i&&typeof i.getRanges=="function")this._setRanges(i.getRanges(),i.isBackward);else if(i instanceof I)this._setRanges([i],!!o&&!!o.backward);else if(i instanceof M)this._setRanges([new I(i)]);else if(i instanceof Uo){const r=!!o&&!!o.backward;let a;if(s=="in")a=I._createIn(i);else if(s=="on")a=I._createOn(i);else if(s!==void 0)a=new I(M._createAt(i,s));else throw new C("model-selection-setto-required-second-parameter",[this,i]);this._setRanges([a],r)}else if(Dn(i))this._setRanges(i,o&&!!o.backward);else throw new C("model-selection-setto-not-selectable",[this,i])}_setRanges(e,i=!1){const s=Array.from(e),o=s.some(r=>{if(!(r instanceof I))throw new C("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every(a=>!a.isEqual(r))});s.length===this._ranges.length&&!o||(this._replaceAllRanges(s),this._lastRangeBackward=!!i,this.fire("change:range",{directChange:!0}))}setFocus(e,i){if(this.anchor===null)throw new C("model-selection-setfocus-no-ranges",[this,e]);const s=M._createAt(e,i);if(s.compareWith(this.focus)=="same")return;const o=this.anchor;this._ranges.length&&this._popRange(),s.compareWith(o)=="before"?(this._pushRange(new I(s,o)),this._lastRangeBackward=!0):(this._pushRange(new I(o,s)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,i){this.getAttribute(e)!==i&&(this._attrs.set(e,i),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const e=new WeakSet;for(const i of this.getRanges()){const s=z0(i.start,e);RU(s,i)&&(yield s);for(const r of i.getWalker()){const a=r.item;r.type=="elementEnd"&&PU(a,e,i)&&(yield a)}const o=z0(i.end,e);LU(o,i)&&(yield o)}}containsEntireContent(e=this.anchor.root){const i=M._createAt(e,0),s=M._createAt(e,"end");return i.isTouching(this.getFirstPosition())&&s.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new I(e.start,e.end))}_checkRange(e){for(let i=0;i<this._ranges.length;i++)if(e.isIntersecting(this._ranges[i]))throw new C("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[i]})}_replaceAllRanges(e){this._removeAllRanges();for(const i of e)this._pushRange(i)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}In.prototype.is=function(n){return n==="selection"||n==="model:selection"};function I5(n,t){return t.has(n)?!1:(t.add(n),n.root.document.model.schema.isBlock(n)&&!!n.parent)}function PU(n,t,e){return I5(n,t)&&Eb(n,e)}function z0(n,t){const i=n.parent.root.document.model.schema,s=n.parent.getAncestors({parentFirst:!0,includeSelf:!0});let o=!1;const r=s.find(a=>o?!1:(o=i.isLimit(a),!o&&I5(a,t)));return s.forEach(a=>t.add(a)),r}function Eb(n,t){const e=VU(n);return e?!t.containsRange(I._createOn(e),!0):!0}function RU(n,t){return n?t.isCollapsed||n.isEmpty?!0:t.start.isTouching(M._createAt(n,n.maxOffset))?!1:Eb(n,t):!1}function LU(n,t){return n?t.isCollapsed||n.isEmpty?!0:t.end.isTouching(M._createAt(n,0))?!1:Eb(n,t):!1}function VU(n){const t=n.root.document.model.schema;let e=n.parent;for(;e;){if(t.isBlock(e))return e;e=e.parent}}class hn extends De(I){constructor(t,e){super(t,e),BU.call(this)}detach(){this.stopListening()}toRange(){return new I(this.start,this.end)}static fromRange(t){return new hn(t.start,t.end)}}hn.prototype.is=function(n){return n==="liveRange"||n==="model:liveRange"||n=="range"||n==="model:range"};function BU(){this.listenTo(this.root.document.model,"applyOperation",(n,t)=>{const e=t[0];e.isDocumentOperation&&MU.call(this,e)},{priority:"low"})}function MU(n){const t=this.getTransformedByOperation(n),e=I._createFromRanges(t),i=!e.isEqual(this),s=OU(this,n);let o=null;if(i){e.root.rootName=="$graveyard"&&(n.type=="remove"?o=n.sourcePosition:o=n.deletionPosition);const r=this.toRange();this.start=e.start,this.end=e.end,this.fire("change:range",r,{deletionPosition:o})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:o})}function OU(n,t){switch(t.type){case"insert":return n.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return n.containsPosition(t.sourcePosition)||n.start.isEqual(t.sourcePosition)||n.containsPosition(t.targetPosition);case"split":return n.containsPosition(t.splitPosition)||n.containsPosition(t.insertionPosition)}return!1}const yl="selection:";class fi extends De(Ys){constructor(e){super();h(this,"_selection");this._selection=new NU(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}_setFocus(e,i){this._selection.setFocus(e,i)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,i){this._selection.setAttribute(e,i)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return yl+e}static _isStoreAttributeKey(e){return e.startsWith(yl)}}fi.prototype.is=function(n){return n==="selection"||n=="model:selection"||n=="documentSelection"||n=="model:documentSelection"};class NU extends In{constructor(e){super();h(this,"markers",new rn({idProperty:"name"}));h(this,"_model");h(this,"_document");h(this,"_attributePriority",new Map);h(this,"_selectionRestorePosition",null);h(this,"_hasChangedRange",!1);h(this,"_overriddenGravityRegister",new Set);h(this,"_observedMarkers",new Set);this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(i,s)=>{const o=s[0];!o.isDocumentOperation||o.type=="marker"||o.type=="rename"||o.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(i,s,o,r)=>{this._updateMarker(s,r)}),this.listenTo(this._document,"change",(i,s)=>{FU(this._model,s)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,i){super.setFocus(e,i),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,i){if(this._setAttribute(e,i)){const s=[e];this.fire("change:attribute",{attributeKeys:s,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const i=[e];this.fire("change:attribute",{attributeKeys:i,directChange:!0})}}overrideGravity(){const e=Cn();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new C("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const i=this._prepareRange(e);i&&this._ranges.push(i)}_validateSelectionRanges(e){for(const i of e)if(!this._document._validateSelectionRange(i))throw new C("document-selection-wrong-position",this,{range:i})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const i=hn.fromRange(e);return i.on("change:range",(s,o,r)=>{if(this._hasChangedRange=!0,i.root==this._document.graveyard){this._selectionRestorePosition=r.deletionPosition;const a=this._ranges.indexOf(i);this._ranges.splice(a,1),i.detach()}}),i}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let i=!1;for(const o of this._model.markers){const r=o.name.split(":",1)[0];if(!this._observedMarkers.has(r))continue;const a=o.getRange();for(const l of this.getRanges())a.containsRange(l,!l.isCollapsed)&&e.push(o)}const s=Array.from(this.markers);for(const o of e)this.markers.has(o)||(this.markers.add(o),i=!0);for(const o of Array.from(this.markers))e.includes(o)||(this.markers.remove(o),i=!0);i&&this.fire("change:marker",{oldMarkers:s,directChange:!1})}_updateMarker(e,i){const s=e.name.split(":",1)[0];if(!this._observedMarkers.has(s))return;let o=!1;const r=Array.from(this.markers),a=this.markers.has(e);if(!i)a&&(this.markers.remove(e),o=!0);else{let l=!1;for(const c of this.getRanges())if(i.containsRange(c,!c.isCollapsed)){l=!0;break}l&&!a?(this.markers.add(e),o=!0):!l&&a&&(this.markers.remove(e),o=!0)}o&&this.fire("change:marker",{oldMarkers:r,directChange:!1})}_updateAttributes(e){const i=Ii(this._getSurroundingAttributes()),s=Ii(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[r,a]of this._attributePriority)a=="low"&&(this._attrs.delete(r),this._attributePriority.delete(r));this._setAttributesTo(i);const o=[];for(const[r,a]of this.getAttributes())(!s.has(r)||s.get(r)!==a)&&o.push(r);for(const[r]of s)this.hasAttribute(r)||o.push(r);o.length>0&&this.fire("change:attribute",{attributeKeys:o,directChange:!1})}_setAttribute(e,i,s=!0){const o=s?"normal":"low";return o=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===i?!1:(this._attrs.set(e,i),this._attributePriority.set(e,o),!0)}_removeAttribute(e,i=!0){const s=i?"normal":"low";return s=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,s),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const i=new Set;for(const[s,o]of this.getAttributes())e.get(s)!==o&&this._removeAttribute(s,!1);for(const[s,o]of e)this._setAttribute(s,o,!1)&&i.add(s);return i}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const i of e.getAttributeKeys())i.startsWith(yl)&&(yield[i.substr(yl.length),e.getAttribute(i)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),i=this._model.schema;if(e.root.rootName=="$graveyard")return null;let s=null;if(this.isCollapsed){const o=e.textNode?e.textNode:e.nodeBefore,r=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(s=ya(o,i)),s||(s=ya(r,i)),!this.isGravityOverridden&&!s){let a=o;for(;a&&!s;)a=a.previousSibling,s=ya(a,i)}if(!s){let a=r;for(;a&&!s;)a=a.nextSibling,s=ya(a,i)}s||(s=this.getStoredAttributes())}else{const o=this.getFirstRange();for(const r of o){if(r.item.is("element")&&i.isObject(r.item)){s=ya(r.item,i);break}if(r.type=="text"){s=r.item.getAttributes();break}}}return s}_fixGraveyardSelection(e){const i=this._model.schema.getNearestSelectionRange(e);i&&this._pushRange(i)}}function ya(n,t){if(!n)return null;if(n instanceof li||n instanceof He)return n.getAttributes();if(!t.isInline(n))return null;if(!t.isObject(n))return[];const e=[];for(const[i,s]of n.getAttributes())t.checkAttribute("$text",i)&&t.getAttributeProperties(i).copyFromObject!==!1&&e.push([i,s]);return e}function FU(n,t){const e=n.document.differ;for(const i of e.getChanges()){if(i.type!="insert")continue;const s=i.position.parent;i.length===s.maxOffset&&n.enqueueChange(t,r=>{const a=Array.from(s.getAttributeKeys()).filter(l=>l.startsWith(yl));for(const l of a)r.removeAttribute(l,s)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class P5{constructor(t){h(this,"_dispatchers");this._dispatchers=t}add(t){for(const e of this._dispatchers)t(e);return this}}class DU extends P5{elementToElement(t){return this.add(iW(t))}elementToStructure(t){return this.add(sW(t))}attributeToElement(t){return this.add(oW(t))}attributeToAttribute(t){return this.add(rW(t))}markerToElement(t){return this.add(aW(t))}markerToHighlight(t){return this.add(cW(t))}markerToData(t){return this.add(lW(t))}}function R5(){return(n,t,e)=>{if(!e.consumable.consume(t.item,n.name))return;const i=e.writer,s=e.mapper.toViewPosition(t.range.start),o=i.createText(t.item.data);i.insert(s,o)}}function L5(){return(n,t,e)=>{e.convertAttributes(t.item),!t.reconversion&&t.item.is("element")&&!t.item.isEmpty&&e.convertChildren(t.item)}}function $U(){return(n,t,e)=>{const i=e.mapper.toViewPosition(t.position),s=t.position.getShiftedBy(t.length),o=e.mapper.toViewPosition(s,{isPhantom:!0}),r=e.writer.createRange(i,o),a=e.writer.remove(r.getTrimmed());for(const l of e.writer.createRangeIn(a).getItems())e.mapper.unbindViewElement(l,{defer:!0})}}function V5(n,t){const e=n.createAttributeElement("span",t.attributes);return t.classes&&e._addClass(t.classes),typeof t.priority=="number"&&(e._priority=t.priority),e._id=t.id,e}function HU(){return(n,t,e)=>{const i=t.selection;if(i.isCollapsed||!e.consumable.consume(i,"selection"))return;const s=[];for(const o of i.getRanges())s.push(e.mapper.toViewRange(o));e.writer.setSelection(s,{backward:i.isBackward})}}function zU(){return(n,t,e)=>{const i=t.selection;if(!i.isCollapsed||!e.consumable.consume(i,"selection"))return;const s=e.writer,o=i.getFirstPosition(),r=e.mapper.toViewPosition(o),a=s.breakAttributes(r);s.setSelection(a)}}function UU(){return(n,t,e)=>{const i=e.writer,s=i.document.selection;for(const o of s.getRanges())o.isCollapsed&&o.end.parent.isAttached()&&e.writer.mergeAttributes(o.start);i.setSelection(null)}}function WU(n){return(t,e,i)=>{if(!i.consumable.test(e.item,t.name))return;const s=n(e.attributeOldValue,i,e),o=n(e.attributeNewValue,i,e);if(!s&&!o)return;i.consumable.consume(e.item,t.name);const r=i.writer,a=r.document.selection;if(e.item instanceof In||e.item instanceof fi)r.wrap(a.getFirstRange(),o);else{let l=i.mapper.toViewRange(e.range);e.attributeOldValue!==null&&s&&(l=r.unwrap(l,s)),e.attributeNewValue!==null&&o&&r.wrap(l,o)}}}function qU(n,t=pW){return(e,i,s)=>{if(!t(i.item,s.consumable,{preflight:!0}))return;const o=n(i.item,s,i);if(!o)return;t(i.item,s.consumable);const r=s.mapper.toViewPosition(i.range.start);s.mapper.bindElements(i.item,o),s.writer.insert(r,o),s.convertAttributes(i.item),F5(o,i.item.getChildren(),s,{reconversion:i.reconversion})}}function jU(n,t){return(e,i,s)=>{if(!t(i.item,s.consumable,{preflight:!0}))return;const o=new Map;s.writer._registerSlotFactory(hW(i.item,o,s));const r=n(i.item,s,i);if(s.writer._clearSlotFactory(),!r)return;fW(i.item,o,s),t(i.item,s.consumable);const a=s.mapper.toViewPosition(i.range.start);s.mapper.bindElements(i.item,r),s.writer.insert(a,r),s.convertAttributes(i.item),mW(r,o,s,{reconversion:i.reconversion})}}function GU(n){return(t,e,i)=>{e.isOpening=!0;const s=n(e,i);e.isOpening=!1;const o=n(e,i);if(!s||!o)return;const r=e.markerRange;if(r.isCollapsed&&!i.consumable.consume(r,t.name))return;for(const c of r)if(!i.consumable.consume(c.item,t.name))return;const a=i.mapper,l=i.writer;l.insert(a.toViewPosition(r.start),s),i.mapper.bindElementToMarker(s,e.markerName),r.isCollapsed||(l.insert(a.toViewPosition(r.end),o),i.mapper.bindElementToMarker(o,e.markerName)),t.stop()}}function KU(){return(n,t,e)=>{const i=e.mapper.markerNameToElements(t.markerName);if(i){for(const s of i)e.mapper.unbindElementFromMarkerName(s,t.markerName),e.writer.clear(e.writer.createRangeOn(s),s);e.writer.clearClonedElementsGroup(t.markerName),n.stop()}}}function ZU(n){return(t,e,i)=>{const s=n(e.markerName,i);if(!s)return;const o=e.markerRange;i.consumable.consume(o,t.name)&&(U0(o,!1,i,e,s),U0(o,!0,i,e,s),t.stop())}}function U0(n,t,e,i,s){const o=t?n.start:n.end,r=o.nodeAfter&&o.nodeAfter.is("element")?o.nodeAfter:null,a=o.nodeBefore&&o.nodeBefore.is("element")?o.nodeBefore:null;if(r||a){let c,u;t&&r||!t&&!a?(c=r,u=!0):(c=a,u=!1);const d=e.mapper.toViewElement(c);if(d){JU(d,t,u,e,i,s);return}}const l=e.mapper.toViewPosition(o);YU(l,t,e,i,s)}function JU(n,t,e,i,s,o){const r=`data-${o.group}-${t?"start":"end"}-${e?"before":"after"}`,a=n.hasAttribute(r)?n.getAttribute(r).split(","):[];a.unshift(o.name),i.writer.setAttribute(r,a.join(","),n),i.mapper.bindElementToMarker(n,s.markerName)}function YU(n,t,e,i,s){const o=`${s.group}-${t?"start":"end"}`,r=s.name?{name:s.name}:null,a=e.writer.createUIElement(o,r);e.writer.insert(n,a),e.mapper.bindElementToMarker(a,i.markerName)}function XU(n){return(t,e,i)=>{const s=n(e.markerName,i);if(!s)return;const o=i.mapper.markerNameToElements(e.markerName);if(!o)return;for(const a of o)i.mapper.unbindElementFromMarkerName(a,e.markerName),a.is("containerElement")?(r(`data-${s.group}-start-before`,a),r(`data-${s.group}-start-after`,a),r(`data-${s.group}-end-before`,a),r(`data-${s.group}-end-after`,a)):i.writer.clear(i.writer.createRangeOn(a),a);i.writer.clearClonedElementsGroup(e.markerName),t.stop();function r(a,l){if(l.hasAttribute(a)){const c=new Set(l.getAttribute(a).split(","));c.delete(s.name),c.size==0?i.writer.removeAttribute(a,l):i.writer.setAttribute(a,Array.from(c).join(","),l)}}}}function QU(n){return(t,e,i)=>{if(!i.consumable.test(e.item,t.name))return;const s=n(e.attributeOldValue,i,e),o=n(e.attributeNewValue,i,e);if(!s&&!o)return;i.consumable.consume(e.item,t.name);const r=i.mapper.toViewElement(e.item),a=i.writer;if(!r)throw new C("conversion-attribute-to-attribute-on-text",i.dispatcher,e);if(e.attributeOldValue!==null&&s)if(s.key=="class"){const l=typeof s.value=="string"?s.value.split(/\s+/):s.value;for(const c of l)a.removeClass(c,r)}else if(s.key=="style")if(typeof s.value=="string"){const l=new Yu(a.document.stylesProcessor);l.setTo(s.value);for(const[c]of l.getStylesEntries())a.removeStyle(c,r)}else{const l=Object.keys(s.value);for(const c of l)a.removeStyle(c,r)}else a.removeAttribute(s.key,r);if(e.attributeNewValue!==null&&o)if(o.key=="class"){const l=typeof o.value=="string"?o.value.split(/\s+/):o.value;for(const c of l)a.addClass(c,r)}else if(o.key=="style")if(typeof o.value=="string"){const l=new Yu(a.document.stylesProcessor);l.setTo(o.value);for(const[c,u]of l.getStylesEntries())a.setStyle(c,u,r)}else{const l=Object.keys(o.value);for(const c of l)a.setStyle(c,o.value[c],r)}else a.setAttribute(o.key,o.value,r)}}function eW(n){return(t,e,i)=>{if(!e.item||!(e.item instanceof In||e.item instanceof fi)&&!e.item.is("$textProxy"))return;const s=Ab(n,e,i);if(!s||!i.consumable.consume(e.item,t.name))return;const o=i.writer,r=V5(o,s),a=o.document.selection;if(e.item instanceof In||e.item instanceof fi)o.wrap(a.getFirstRange(),r);else{const l=i.mapper.toViewRange(e.range),c=o.wrap(l,r);for(const u of c.getItems())if(u.is("attributeElement")&&u.isSimilar(r)){i.mapper.bindElementToMarker(u,e.markerName);break}}}}function tW(n){return(t,e,i)=>{if(!e.item||!(e.item instanceof Je))return;const s=Ab(n,e,i);if(!s||!i.consumable.test(e.item,t.name))return;const o=i.mapper.toViewElement(e.item);if(o&&o.getCustomProperty("addHighlight")){i.consumable.consume(e.item,t.name);for(const a of I._createIn(e.item))i.consumable.consume(a.item,t.name);o.getCustomProperty("addHighlight")(o,s,i.writer),i.mapper.bindElementToMarker(o,e.markerName)}}}function nW(n){return(t,e,i)=>{if(e.markerRange.isCollapsed)return;const s=Ab(n,e,i);if(!s)return;const o=V5(i.writer,s),r=i.mapper.markerNameToElements(e.markerName);if(r){for(const a of r)i.mapper.unbindElementFromMarkerName(a,e.markerName),a.is("attributeElement")?i.writer.unwrap(i.writer.createRangeOn(a),o):a.getCustomProperty("removeHighlight")(a,s.id,i.writer);i.writer.clearClonedElementsGroup(e.markerName),t.stop()}}}function iW(n){const t=B5(n.model),e=Cl(n.view,"container");return t.attributes.length&&(t.children=!0),i=>{i.on(`insert:${t.name}`,qU(e,N5(t)),{priority:n.converterPriority||"normal"}),(t.children||t.attributes.length)&&i.on("reduceChanges",O5(t),{priority:"low"})}}function sW(n){const t=B5(n.model),e=Cl(n.view,"container");return t.children=!0,i=>{if(i._conversionApi.schema.checkChild(t.name,"$text"))throw new C("conversion-element-to-structure-disallowed-text",i,{elementName:t.name});i.on(`insert:${t.name}`,jU(e,N5(t)),{priority:n.converterPriority||"normal"}),i.on("reduceChanges",O5(t),{priority:"low"})}}function oW(n){n=kn(n);let t=n.model;typeof t=="string"&&(t={key:t});let e=`attribute:${t.key}`;if(t.name&&(e+=":"+t.name),t.values)for(const s of t.values)n.view[s]=Cl(n.view[s],"attribute");else n.view=Cl(n.view,"attribute");const i=M5(n);return s=>{s.on(e,WU(i),{priority:n.converterPriority||"normal"})}}function rW(n){n=kn(n);let t=n.model;typeof t=="string"&&(t={key:t});let e=`attribute:${t.key}`;if(t.name&&(e+=":"+t.name),t.values)for(const s of t.values)n.view[s]=W0(n.view[s]);else n.view=W0(n.view);const i=M5(n);return s=>{s.on(e,QU(i),{priority:n.converterPriority||"normal"})}}function aW(n){const t=Cl(n.view,"ui");return e=>{e.on(`addMarker:${n.model}`,GU(t),{priority:n.converterPriority||"normal"}),e.on(`removeMarker:${n.model}`,KU(),{priority:n.converterPriority||"normal"})}}function lW(n){n=kn(n);const t=n.model;let e=n.view;return e||(e=i=>({group:t,name:i.substr(n.model.length+1)})),i=>{i.on(`addMarker:${t}`,ZU(e),{priority:n.converterPriority||"normal"}),i.on(`removeMarker:${t}`,XU(e),{priority:n.converterPriority||"normal"})}}function cW(n){return t=>{t.on(`addMarker:${n.model}`,eW(n.view),{priority:n.converterPriority||"normal"}),t.on(`addMarker:${n.model}`,tW(n.view),{priority:n.converterPriority||"normal"}),t.on(`removeMarker:${n.model}`,nW(n.view),{priority:n.converterPriority||"normal"})}}function B5(n){return typeof n=="string"&&(n={name:n}),{name:n.name,attributes:n.attributes?Pe(n.attributes):[],children:!!n.children}}function Cl(n,t){return typeof n=="function"?n:(e,i)=>uW(n,i,t)}function uW(n,t,e){typeof n=="string"&&(n={name:n});let i;const s=t.writer,o=Object.assign({},n.attributes);if(e=="container")i=s.createContainerElement(n.name,o);else if(e=="attribute"){const r={priority:n.priority||wo.DEFAULT_PRIORITY};i=s.createAttributeElement(n.name,o,r)}else i=s.createUIElement(n.name,o);if(n.styles){const r=Object.keys(n.styles);for(const a of r)s.setStyle(a,n.styles[a],i)}if(n.classes){const r=n.classes;if(typeof r=="string")s.addClass(r,i);else for(const a of r)s.addClass(a,i)}return i}function M5(n){return n.model.values?(t,e,i)=>{const s=n.view[t];return s?s(t,e,i):null}:n.view}function W0(n){return typeof n=="string"?t=>({key:n,value:t}):typeof n=="object"?n.value?()=>n:t=>({key:n.key,value:t}):n}function Ab(n,t,e){const i=typeof n=="function"?n(t,e):n;return i?(i.priority||(i.priority=10),i.id||(i.id=t.markerName),i):null}function dW(n){return(t,e)=>{if(!t.is("element",n.name))return!1;if(e.type=="attribute"){if(n.attributes.includes(e.attributeKey))return!0}else{/* istanbul ignore else: This is always true because otherwise it would not register a reducer callback. -- @preserve */if(n.children)return!0}return!1}}function O5(n){const t=dW(n);return(e,i)=>{const s=[];i.reconvertedElements||(i.reconvertedElements=new Set);for(const o of i.changes){const r=o.type=="attribute"?o.range.start.nodeAfter:o.position.parent;if(!r||!t(r,o)){s.push(o);continue}if(!i.reconvertedElements.has(r)){i.reconvertedElements.add(r);const a=M._createBefore(r);let l=s.length;for(let c=s.length-1;c>=0;c--){const u=s[c],f=(u.type=="attribute"?u.range.start:u.position).compareWith(a);if(f=="before"||u.type=="remove"&&f=="same")break;l=c}s.splice(l,0,{type:"remove",name:r.name,position:a,length:1},{type:"reinsert",name:r.name,position:a,length:1})}}i.changes=s}}function N5(n){return(t,e,i={})=>{const s=["insert"];for(const o of n.attributes)t.hasAttribute(o)&&s.push(`attribute:${o}`);return s.every(o=>e.test(t,o))?(i.preflight||s.forEach(o=>e.consume(t,o)),!0):!1}}function hW(n,t,e){return(i,s)=>{const o=i.createContainerElement("$slot");let r=null;if(s==="children")r=Array.from(n.getChildren());else if(typeof s=="function")r=Array.from(n.getChildren()).filter(a=>s(a));else throw new C("conversion-slot-mode-unknown",e.dispatcher,{modeOrFilter:s});return t.set(o,r),o}}function fW(n,t,e){const i=Array.from(t.values()).flat(),s=new Set(i);if(s.size!=i.length)throw new C("conversion-slot-filter-overlap",e.dispatcher,{element:n});if(s.size!=n.childCount)throw new C("conversion-slot-filter-incomplete",e.dispatcher,{element:n})}function mW(n,t,e,i){e.mapper.on("modelToViewPosition",r,{priority:"highest"});let s=null,o=null;for([s,o]of t)F5(n,o,e,i),e.writer.move(e.writer.createRangeIn(s),e.writer.createPositionBefore(s)),e.writer.remove(s);e.mapper.off("modelToViewPosition",r);function r(a,l){const c=l.modelPosition.nodeAfter,u=o.indexOf(c);u<0||(l.viewPosition=l.mapper.findPositionIn(s,u))}}function F5(n,t,e,i){for(const s of t)gW(n.root,s,e,i)||e.convertItem(s)}function gW(n,t,e,i){const{writer:s,mapper:o}=e;if(!i.reconversion)return!1;const r=o.toViewElement(t);return!r||r.root==n||!e.canReuseView(r)?!1:(s.move(s.createRangeOn(r),o.toViewPosition(M._createBefore(t))),!0)}function pW(n,t,{preflight:e}={}){return e?t.test(n,"insert"):t.consume(n,"insert")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function D5(n){const{schema:t,document:e}=n.model;for(const i of e.getRoots())if(i.isEmpty&&!t.checkChild(i,"$text")&&t.checkChild(i,"paragraph"))return n.insertElement("paragraph",i),!0;return!1}function $5(n,t,e){const i=e.createContext(n);return!(!e.checkChild(i,"paragraph")||!e.checkChild(i.push("paragraph"),t))}function H5(n,t){const e=t.createElement("paragraph");return t.insert(e,n),t.createPositionAt(e,0)}class bW extends P5{elementToElement(t){return this.add(z5(t))}elementToAttribute(t){return this.add(vW(t))}attributeToAttribute(t){return this.add(yW(t))}elementToMarker(t){return this.add(CW(t))}dataToMarker(t){return this.add(kW(t))}}function q0(){return(n,t,e)=>{if(!t.modelRange&&e.consumable.consume(t.viewItem,{name:!0})){const{modelRange:i,modelCursor:s}=e.convertChildren(t.viewItem,t.modelCursor);t.modelRange=i,t.modelCursor=s}}}function wW(){return(n,t,{schema:e,consumable:i,writer:s})=>{let o=t.modelCursor;if(!i.test(t.viewItem))return;if(!e.checkChild(o,"$text")){if(!$5(o,"$text",e)||t.viewItem.data.trim().length==0)return;const a=o.nodeBefore;o=H5(o,s),a&&a.is("element","$marker")&&(s.move(s.createRangeOn(a),o),o=s.createPositionAfter(a))}i.consume(t.viewItem);const r=s.createText(t.viewItem.data);s.insert(r,o),t.modelRange=s.createRange(o,o.getShiftedBy(r.offsetSize)),t.modelCursor=t.modelRange.end}}function _W(n,t){return(e,i)=>{const s=i.newSelection,o=[];for(const a of s.getRanges())o.push(t.toModelRange(a));const r=n.createSelection(o,{backward:s.isBackward});r.isEqual(n.document.selection)||n.change(a=>{a.setSelection(r)})}}function z5(n){n=kn(n);const t=Hm(n),e=xb(n.view),i=e?`element:${e}`:"element";return s=>{s.on(i,t,{priority:n.converterPriority||"normal"})}}function vW(n){n=kn(n),U5(n);const t=W5(n,!1),e=xb(n.view),i=e?`element:${e}`:"element";return s=>{s.on(i,t,{priority:n.converterPriority||"low"})}}function yW(n){n=kn(n);let t=null;(typeof n.view=="string"||n.view.key)&&(t=AW(n)),U5(n,t);const e=W5(n,!0);return i=>{i.on("element",e,{priority:n.converterPriority||"low"})}}function CW(n){const t=IW(n.model);return z5({...n,model:t})}function kW(n){n=kn(n),n.model||(n.model=s=>s?n.view+":"+s:n.view);const t={view:n.view,model:n.model},e=Hm(j0(t,"start")),i=Hm(j0(t,"end"));return s=>{s.on(`element:${n.view}-start`,e,{priority:n.converterPriority||"normal"}),s.on(`element:${n.view}-end`,i,{priority:n.converterPriority||"normal"});const o=Pn.low,r=Pn.highest,a=Pn.get(n.converterPriority)/r;s.on("element",TW(t),{priority:o+a})}}function TW(n){return(t,e,i)=>{const s=`data-${n.view}`;if(!i.consumable.test(e.viewItem,{attributes:s+"-end-after"})&&!i.consumable.test(e.viewItem,{attributes:s+"-start-after"})&&!i.consumable.test(e.viewItem,{attributes:s+"-end-before"})&&!i.consumable.test(e.viewItem,{attributes:s+"-start-before"}))return;e.modelRange||Object.assign(e,i.convertChildren(e.viewItem,e.modelCursor)),i.consumable.consume(e.viewItem,{attributes:s+"-end-after"})&&o(e.modelRange.end,e.viewItem.getAttribute(s+"-end-after").split(",")),i.consumable.consume(e.viewItem,{attributes:s+"-start-after"})&&o(e.modelRange.end,e.viewItem.getAttribute(s+"-start-after").split(",")),i.consumable.consume(e.viewItem,{attributes:s+"-end-before"})&&o(e.modelRange.start,e.viewItem.getAttribute(s+"-end-before").split(",")),i.consumable.consume(e.viewItem,{attributes:s+"-start-before"})&&o(e.modelRange.start,e.viewItem.getAttribute(s+"-start-before").split(","));function o(r,a){for(const l of a){const c=n.model(l,i),u=i.writer.createElement("$marker",{"data-name":c});i.writer.insert(u,r),e.modelCursor.isEqual(r)?e.modelCursor=e.modelCursor.getShiftedBy(1):e.modelCursor=e.modelCursor._getTransformedByInsertion(r,1),e.modelRange=e.modelRange._getTransformedByInsertion(r,1)[0]}}}}function xb(n){return typeof n=="string"?n:typeof n=="object"&&typeof n.name=="string"?n.name:null}function Hm(n){const t=new Qt(n.view);return(e,i,s)=>{const o=t.match(i.viewItem);if(!o)return;const r=o.match;if(r.name=!0,!s.consumable.test(i.viewItem,r))return;const a=EW(n.model,i.viewItem,s);a&&s.safeInsert(a,i.modelCursor)&&(s.consumable.consume(i.viewItem,r),s.convertChildren(i.viewItem,a),s.updateConversionResult(a,i))}}function EW(n,t,e){return n instanceof Function?n(t,e):e.writer.createElement(n)}function AW(n){typeof n.view=="string"&&(n.view={key:n.view});const t=n.view.key,e=typeof n.view.value>"u"?/[\s\S]*/:n.view.value;let i;return t=="class"||t=="style"?i={[t=="class"?"classes":"styles"]:e}:i={attributes:{[t]:e}},n.view.name&&(i.name=n.view.name),n.view=i,t}function U5(n,t=null){const e=t===null?!0:o=>o.getAttribute(t),i=typeof n.model!="object"?n.model:n.model.key,s=typeof n.model!="object"||typeof n.model.value>"u"?e:n.model.value;n.model={key:i,value:s}}function W5(n,t){const e=new Qt(n.view);return(i,s,o)=>{if(!s.modelRange&&t)return;const r=e.match(s.viewItem);if(!r||(xW(n.view,s.viewItem)?r.match.name=!0:delete r.match.name,!o.consumable.test(s.viewItem,r.match)))return;const a=n.model.key,l=typeof n.model.value=="function"?n.model.value(s.viewItem,o):n.model.value;if(l===null)return;s.modelRange||Object.assign(s,o.convertChildren(s.viewItem,s.modelCursor)),SW(s.modelRange,{key:a,value:l},t,o)&&(o.consumable.test(s.viewItem,{name:!0})&&(r.match.name=!0),o.consumable.consume(s.viewItem,r.match))}}function xW(n,t){const e=typeof n=="function"?n(t):n;return typeof e=="object"&&!xb(e)?!1:!e.classes&&!e.attributes&&!e.styles}function SW(n,t,e,i){let s=!1;for(const o of Array.from(n.getItems({shallow:e})))i.schema.checkAttribute(o,t.key)&&(s=!0,!o.hasAttribute(t.key)&&i.writer.setAttribute(t.key,t.value,o));return s}function IW(n){return(t,e)=>{const i=typeof n=="string"?n:n(t,e);return e.writer.createElement("$marker",{"data-name":i})}}function j0(n,t){const e=(i,s)=>{const o=i.getAttribute("name"),r=n.model(o,s);return s.writer.createElement("$marker",{"data-name":r})};return{view:`${n.view}-${t}`,model:e}}function PW(n){n.document.registerPostFixer(t=>RW(t,n))}function RW(n,t){const e=t.document.selection,i=t.schema,s=[];let o=!1;for(const r of e.getRanges()){const a=q5(r,i);a&&!a.isEqual(r)?(s.push(a),o=!0):s.push(r)}return o&&n.setSelection(MW(s),{backward:e.isBackward}),!1}function q5(n,t){return n.isCollapsed?LW(n,t):VW(n,t)}function LW(n,t){const e=n.start,i=t.getNearestSelectionRange(e);if(!i){const o=e.getAncestors().reverse().find(r=>t.isObject(r));return o?I._createOn(o):null}if(!i.isCollapsed)return i;const s=i.start;return e.isEqual(s)?null:new I(s)}function VW(n,t){const{start:e,end:i}=n,s=t.checkChild(e,"$text"),o=t.checkChild(i,"$text"),r=t.getLimitElement(e),a=t.getLimitElement(i);if(r===a){if(s&&o)return null;if(BW(e,i,t)){const d=e.nodeAfter&&t.isSelectable(e.nodeAfter)?null:t.getNearestSelectionRange(e,"forward"),m=i.nodeBefore&&t.isSelectable(i.nodeBefore)?null:t.getNearestSelectionRange(i,"backward"),g=d?d.start:e,p=m?m.end:i;return new I(g,p)}}const l=r&&!r.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const u=e.nodeAfter&&i.nodeBefore&&e.nodeAfter.parent===i.nodeBefore.parent,d=l&&(!u||!K0(e.nodeAfter,t)),f=c&&(!u||!K0(i.nodeBefore,t));let m=e,g=i;return d&&(m=M._createBefore(G0(r,t))),f&&(g=M._createAfter(G0(a,t))),new I(m,g)}return null}function G0(n,t){let e=n,i=e;for(;t.isLimit(i)&&i.parent;)e=i,i=i.parent;return e}function BW(n,t,e){const i=n.nodeAfter&&!e.isLimit(n.nodeAfter)||e.checkChild(n,"$text"),s=t.nodeBefore&&!e.isLimit(t.nodeBefore)||e.checkChild(t,"$text");return i||s}function MW(n){const t=[...n],e=new Set;let i=1;for(;i<t.length;){const o=t[i],r=t.slice(0,i);for(const[a,l]of r.entries())if(!e.has(a)){if(o.isEqual(l))e.add(a);else if(o.isIntersecting(l)){e.add(a),e.add(i);const c=o.getJoined(l);t.push(c)}}i++}return t.filter((o,r)=>!e.has(r))}function K0(n,t){return n&&t.isSelectable(n)}class OW extends Ve(){constructor(e,i){super();h(this,"model");h(this,"view");h(this,"mapper");h(this,"downcastDispatcher");this.model=e,this.view=new TU(i),this.mapper=new x5,this.downcastDispatcher=new S5({mapper:this.mapper,schema:e.schema});const s=this.model.document,o=s.selection,r=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(s,"change",()=>{this.view.change(a=>{this.downcastDispatcher.convertChanges(s.differ,r,a),this.downcastDispatcher.convertSelection(o,r,a)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",_W(this.model,this.mapper)),this.listenTo(this.view.document,"beforeinput",NW(this.mapper,this.model.schema,this.view),{priority:"high"}),this.downcastDispatcher.on("insert:$text",R5(),{priority:"lowest"}),this.downcastDispatcher.on("insert",L5(),{priority:"lowest"}),this.downcastDispatcher.on("remove",$U(),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",UU()),this.downcastDispatcher.on("selection",HU(),{priority:"low"}),this.downcastDispatcher.on("selection",zU(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(a=>{if(a.rootName=="$graveyard")return null;const l=new m5(this.view.document,a.name);return l.rootName=a.rootName,this.mapper.bindElements(a,l),l})}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const i=typeof e=="string"?e:e.name,s=this.model.markers.get(i);if(!s)throw new C("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:i});this.model.change(()=>{this.model.markers._refresh(s)})}reconvertItem(e){this.model.change(()=>{this.model.document.differ._refreshItem(e)})}}function NW(n,t,e){return(i,s)=>{if(!(e.document.isComposing&&!ue.isAndroid))for(let o=0;o<s.targetRanges.length;o++){const r=s.targetRanges[o],a=n.toModelRange(r),l=q5(a,t);!l||l.isEqual(a)||(s.targetRanges[o]=n.toViewRange(l))}}}class Xa{constructor(){h(this,"_consumables",new Map)}add(t,e){let i;if(t.is("$text")||t.is("documentFragment")){this._consumables.set(t,!0);return}this._consumables.has(t)?i=this._consumables.get(t):(i=new FW(t),this._consumables.set(t,i)),i.add(e)}test(t,e){const i=this._consumables.get(t);return i===void 0?null:t.is("$text")||t.is("documentFragment")?i:i.test(e)}consume(t,e){return this.test(t,e)?(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!1):this._consumables.get(t).consume(e),!0):!1}revert(t,e){const i=this._consumables.get(t);i!==void 0&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):i.revert(e))}static consumablesFromElement(t){const e={element:t,name:!0,attributes:[],classes:[],styles:[]},i=t.getAttributeKeys();for(const r of i)r=="style"||r=="class"||e.attributes.push(r);const s=t.getClassNames();for(const r of s)e.classes.push(r);const o=t.getStyleNames();for(const r of o)e.styles.push(r);return e}static createFrom(t,e){if(e||(e=new Xa),t.is("$text"))return e.add(t),e;t.is("element")&&e.add(t,Xa.consumablesFromElement(t)),t.is("documentFragment")&&e.add(t);for(const i of t.getChildren())e=Xa.createFrom(i,e);return e}}const Fc=["attributes","classes","styles"];class FW{constructor(t){h(this,"element");h(this,"_canConsumeName");h(this,"_consumables");this.element=t,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(t){t.name&&(this._canConsumeName=!0);for(const e of Fc)e in t&&this._add(e,t[e])}test(t){if(t.name&&!this._canConsumeName)return this._canConsumeName;for(const e of Fc)if(e in t){const i=this._test(e,t[e]);if(i!==!0)return i}return!0}consume(t){t.name&&(this._canConsumeName=!1);for(const e of Fc)e in t&&this._consume(e,t[e])}revert(t){t.name&&(this._canConsumeName=!0);for(const e of Fc)e in t&&this._revert(e,t[e])}_add(t,e){const i=Pe(e),s=this._consumables[t];for(const o of i){if(t==="attributes"&&(o==="class"||o==="style"))throw new C("viewconsumable-invalid-attribute",this);if(s.set(o,!0),t==="styles")for(const r of this.element.document.stylesProcessor.getRelatedStyles(o))s.set(r,!0)}}_test(t,e){const i=Pe(e),s=this._consumables[t];for(const o of i)if(t==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles",a=this._test(r,[...this._consumables[r].keys()]);if(a!==!0)return a}else{const r=s.get(o);if(r===void 0)return null;if(!r)return!1}return!0}_consume(t,e){const i=Pe(e),s=this._consumables[t];for(const o of i)if(t==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles";this._consume(r,[...this._consumables[r].keys()])}else if(s.set(o,!1),t=="styles")for(const r of this.element.document.stylesProcessor.getRelatedStyles(o))s.set(r,!1)}_revert(t,e){const i=Pe(e),s=this._consumables[t];for(const o of i)if(t==="attributes"&&(o==="class"||o==="style")){const r=o=="class"?"classes":"styles";this._revert(r,[...this._consumables[r].keys()])}else s.get(o)===!1&&s.set(o,!0)}}class DW extends Ve(){constructor(){super();h(this,"_sourceDefinitions",{});h(this,"_attributeProperties",{});h(this,"_compiledDefinitions");this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,i)=>{i[0]=new vo(i[0])},{priority:"highest"}),this.on("checkChild",(e,i)=>{i[0]=new vo(i[0]),i[1]=this.getDefinition(i[1])},{priority:"highest"})}register(e,i){if(this._sourceDefinitions[e])throw new C("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},i)],this._clearCache()}extend(e,i){if(!this._sourceDefinitions[e])throw new C("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},i)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let i;return typeof e=="string"?i=e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?i="$text":i=e.name,this.getDefinitions()[i]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const i=this.getDefinition(e);return!!(i&&i.isBlock)}isLimit(e){const i=this.getDefinition(e);return i?!!(i.isLimit||i.isObject):!1}isObject(e){const i=this.getDefinition(e);return i?!!(i.isObject||i.isLimit&&i.isSelectable&&i.isContent):!1}isInline(e){const i=this.getDefinition(e);return!!(i&&i.isInline)}isSelectable(e){const i=this.getDefinition(e);return i?!!(i.isSelectable||i.isObject):!1}isContent(e){const i=this.getDefinition(e);return i?!!(i.isContent||i.isObject):!1}checkChild(e,i){return i?this._checkContextMatch(i,e):!1}checkAttribute(e,i){const s=this.getDefinition(e.last);return s?s.allowAttributes.includes(i):!1}checkMerge(e,i){if(e instanceof M){const s=e.nodeBefore,o=e.nodeAfter;if(!(s instanceof Je))throw new C("schema-check-merge-no-element-before",this);if(!(o instanceof Je))throw new C("schema-check-merge-no-element-after",this);return this.checkMerge(s,o)}for(const s of i.getChildren())if(!this.checkChild(e,s))return!1;return!0}addChildCheck(e){this.on("checkChild",(i,[s,o])=>{if(!o)return;const r=e(s,o);typeof r=="boolean"&&(i.stop(),i.return=r)},{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",(i,[s,o])=>{const r=e(s,o);typeof r=="boolean"&&(i.stop(),i.return=r)},{priority:"high"})}setAttributeProperties(e,i){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),i)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let i;for(e instanceof M?i=e.parent:i=(e instanceof I?[e]:Array.from(e.getRanges())).reduce((o,r)=>{const a=r.getCommonAncestor();return o?o.getCommonAncestor(a,{includeSelf:!0}):a},null);!this.isLimit(i)&&i.parent;)i=i.parent;return i}checkAttributeInSelection(e,i){if(e.isCollapsed){const o=[...e.getFirstPosition().getAncestors(),new He("",e.getAttributes())];return this.checkAttribute(o,i)}else{const s=e.getRanges();for(const o of s)for(const r of o)if(this.checkAttribute(r.item,i))return!0}return!1}*getValidRanges(e,i){e=tq(e);for(const s of e)yield*this._getValidRangesForRange(s,i)}getNearestSelectionRange(e,i="both"){if(e.root.rootName=="$graveyard")return null;if(this.checkChild(e,"$text"))return new I(e);let s,o;const r=e.getAncestors().reverse().find(a=>this.isLimit(a))||e.root;(i=="both"||i=="backward")&&(s=new ji({boundaries:I._createIn(r),startPosition:e,direction:"backward"})),(i=="both"||i=="forward")&&(o=new ji({boundaries:I._createIn(r),startPosition:e}));for(const a of eq(s,o)){const l=a.walker==s?"elementEnd":"elementStart",c=a.value;if(c.type==l&&this.isObject(c.item))return I._createOn(c.item);if(this.checkChild(c.nextPosition,"$text"))return new I(c.nextPosition)}return null}findAllowedParent(e,i){let s=e.parent;for(;s;){if(this.checkChild(s,i))return s;if(this.isLimit(s))return null;s=s.parent}return null}setAllowedAttributes(e,i,s){const o=s.model;for(const[r,a]of Object.entries(i))o.schema.checkAttribute(e,r)&&s.setAttribute(r,a,e)}removeDisallowedAttributes(e,i){for(const s of e)if(s.is("$text"))Z0(this,s,i);else{const r=I._createIn(s).getPositions();for(const a of r){const l=a.nodeBefore||a.parent;Z0(this,l,i)}}}getAttributesWithProperty(e,i,s){const o={};for(const[r,a]of e.getAttributes()){const l=this.getAttributeProperties(r);l[i]!==void 0&&(s===void 0||s===l[i])&&(o[r]=a)}return o}createContext(e){return new vo(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},i=this._sourceDefinitions,s=Object.keys(i);for(const r of s)e[r]=$W(i[r],r);const o=Object.values(e);for(const r of o)HW(e,r),zW(e,r),UW(e,r),WW(e,r);for(const r of o)qW(e,r);for(const r of o)jW(e,r);for(const r of o)GW(e,r);for(const r of o)ZW(e,r);for(const r of o)JW(e,r);this._compiledDefinitions=KW(e)}_checkContextMatch(e,i,s=i.length-1){const o=i.getItem(s);if(e.allowIn.includes(o.name)){if(s==0)return!0;{const r=this.getDefinition(o);return this._checkContextMatch(r,i,s-1)}}else return!1}*_getValidRangesForRange(e,i){let s=e.start,o=e.start;for(const r of e.getItems({shallow:!0}))r.is("element")&&(yield*this._getValidRangesForRange(I._createIn(r),i)),this.checkAttribute(r,i)||(s.isEqual(o)||(yield new I(s,o)),s=M._createAfter(r)),o=M._createAfter(r);s.isEqual(o)||(yield new I(s,o))}findOptimalInsertionRange(e,i){const s=e.getSelectedElement();if(s&&this.isObject(s)&&!this.isInline(s))return i=="before"||i=="after"?new I(M._createAt(s,i)):I._createOn(s);const o=Ye(e.getSelectedBlocks());if(!o)return new I(e.focus);if(o.isEmpty)return new I(M._createAt(o,0));const r=M._createAfter(o);return e.focus.isTouching(r)?new I(r):new I(M._createBefore(o))}}class vo{constructor(t){h(this,"_items");if(t instanceof vo)return t;let e;typeof t=="string"?e=[t]:Array.isArray(t)?e=t:e=t.getAncestors({includeSelf:!0}),this._items=e.map(QW)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(t){const e=new vo([t]);return e._items=[...this._items,...e._items],e}getItem(t){return this._items[t]}*getNames(){yield*this._items.map(t=>t.name)}endsWith(t){return Array.from(this.getNames()).join(" ").endsWith(t)}startsWith(t){return Array.from(this.getNames()).join(" ").startsWith(t)}}function $W(n,t){const e={name:t,allowIn:new Set,allowChildren:new Set,disallowIn:new Set,disallowChildren:new Set,allowContentOf:new Set,allowWhere:new Set,allowAttributes:new Set,disallowAttributes:new Set,allowAttributesOf:new Set,inheritTypesFrom:new Set};return YW(n,e),wi(n,e,"allowIn"),wi(n,e,"allowChildren"),wi(n,e,"disallowIn"),wi(n,e,"disallowChildren"),wi(n,e,"allowContentOf"),wi(n,e,"allowWhere"),wi(n,e,"allowAttributes"),wi(n,e,"disallowAttributes"),wi(n,e,"allowAttributesOf"),wi(n,e,"inheritTypesFrom"),XW(n,e),e}function HW(n,t){for(const e of t.allowIn){const i=n[e];i?i.allowChildren.add(t.name):t.allowIn.delete(e)}}function zW(n,t){for(const e of t.allowChildren){const i=n[e];i?i.allowIn.add(t.name):t.allowChildren.delete(e)}}function UW(n,t){for(const e of t.disallowIn){const i=n[e];i?i.disallowChildren.add(t.name):t.disallowIn.delete(e)}}function WW(n,t){for(const e of t.disallowChildren){const i=n[e];i?i.disallowIn.add(t.name):t.disallowChildren.delete(e)}}function qW(n,t){for(const e of t.disallowChildren)t.allowChildren.delete(e);for(const e of t.disallowIn)t.allowIn.delete(e);for(const e of t.disallowAttributes)t.allowAttributes.delete(e)}function jW(n,t){for(const e of t.allowContentOf){const i=n[e];i&&(i.disallowChildren.forEach(s=>{t.allowChildren.has(s)||(t.disallowChildren.add(s),n[s].disallowIn.add(t.name))}),i.allowChildren.forEach(s=>{t.disallowChildren.has(s)||(t.allowChildren.add(s),n[s].allowIn.add(t.name))}))}}function GW(n,t){for(const e of t.allowWhere){const i=n[e];i&&(i.disallowIn.forEach(s=>{t.allowIn.has(s)||(t.disallowIn.add(s),n[s].disallowChildren.add(t.name))}),i.allowIn.forEach(s=>{t.disallowIn.has(s)||(t.allowIn.add(s),n[s].allowChildren.add(t.name))}))}}function KW(n){const t={};for(const e of Object.values(n))t[e.name]={name:e.name,isBlock:!!e.isBlock,isContent:!!e.isContent,isInline:!!e.isInline,isLimit:!!e.isLimit,isObject:!!e.isObject,isSelectable:!!e.isSelectable,allowIn:Array.from(e.allowIn).filter(i=>!!n[i]),allowChildren:Array.from(e.allowChildren).filter(i=>!!n[i]),allowAttributes:Array.from(e.allowAttributes)};return t}function ZW(n,t){for(const e of t.allowAttributesOf){const i=n[e];if(!i)return;i.allowAttributes.forEach(s=>{t.disallowAttributes.has(s)||t.allowAttributes.add(s)})}}function JW(n,t){for(const e of t.inheritTypesFrom){const i=n[e];if(i){const s=Object.keys(i).filter(o=>o.startsWith("is"));for(const o of s)o in t||(t[o]=i[o])}}}function YW(n,t){for(const e of n){const i=Object.keys(e).filter(s=>s.startsWith("is"));for(const s of i)t[s]=!!e[s]}}function wi(n,t,e){for(const i of n){let s=i[e];typeof s=="string"&&(s=[s]),Array.isArray(s)&&s.forEach(o=>t[e].add(o))}}function XW(n,t){for(const e of n){const i=e.inheritAllFrom;i&&(t.allowContentOf.add(i),t.allowWhere.add(i),t.allowAttributesOf.add(i),t.inheritTypesFrom.add(i))}}function QW(n){return typeof n=="string"||n.is("documentFragment")?{name:typeof n=="string"?n:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:n.is("element")?n.name:"$text",*getAttributeKeys(){yield*n.getAttributeKeys()},getAttribute(t){return n.getAttribute(t)}}}function*eq(n,t){let e=!1;for(;!e;){if(e=!0,n){const i=n.next();i.done||(e=!1,yield{walker:n,value:i.value})}if(t){const i=t.next();i.done||(e=!1,yield{walker:t,value:i.value})}}}function*tq(n){for(const t of n)yield*t.getMinimalFlatRanges()}function Z0(n,t,e){for(const i of t.getAttributeKeys())n.checkAttribute(t,i)||e.removeAttribute(i,t)}class nq extends De(){constructor(e){super();h(this,"conversionApi");h(this,"_splitParts",new Map);h(this,"_cursorParents",new Map);h(this,"_modelCursor",null);h(this,"_emptyElementsToKeep",new Set);this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(i,s)=>this._convertItem(i,s),convertChildren:(i,s)=>this._convertChildren(i,s),safeInsert:(i,s)=>this._safeInsert(i,s),updateConversionResult:(i,s)=>this._updateConversionResult(i,s),splitToAllowedParent:(i,s)=>this._splitToAllowedParent(i,s),getSplitParts:i=>this._getSplitParts(i),keepEmptyElement:i=>this._keepEmptyElement(i)}}convert(e,i,s=["$root"]){this.fire("viewCleanup",e),this._modelCursor=sq(s,i),this.conversionApi.writer=i,this.conversionApi.consumable=Xa.createFrom(e),this.conversionApi.store={};const{modelRange:o}=this._convertItem(e,this._modelCursor),r=i.createDocumentFragment();if(o){this._removeEmptyElements();for(const a of Array.from(this._modelCursor.parent.getChildren()))i.append(a,r);r.markers=iq(r,i)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,r}_convertItem(e,i){const s={viewItem:e,modelCursor:i,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,s,this.conversionApi):e.is("$text")?this.fire("text",s,this.conversionApi):this.fire("documentFragment",s,this.conversionApi),s.modelRange&&!(s.modelRange instanceof I))throw new C("view-conversion-dispatcher-incorrect-result",this);return{modelRange:s.modelRange,modelCursor:s.modelCursor}}_convertChildren(e,i){let s=i.is("position")?i:M._createAt(i,0);const o=new I(s);for(const r of Array.from(e.getChildren())){const a=this._convertItem(r,s);a.modelRange instanceof I&&(o.end=a.modelRange.end,s=a.modelCursor)}return{modelRange:o,modelCursor:s}}_safeInsert(e,i){const s=this._splitToAllowedParent(e,i);return s?(this.conversionApi.writer.insert(e,s.position),!0):!1}_updateConversionResult(e,i){const s=this._getSplitParts(e),o=this.conversionApi.writer;i.modelRange||(i.modelRange=o.createRange(o.createPositionBefore(e),o.createPositionAfter(s[s.length-1])));const r=this._cursorParents.get(e);r?i.modelCursor=o.createPositionAt(r,0):i.modelCursor=i.modelRange.end}_splitToAllowedParent(e,i){const{schema:s,writer:o}=this.conversionApi;let r=s.findAllowedParent(i,e);if(r){if(r===i.parent)return{position:i};this._modelCursor.parent.getAncestors().includes(r)&&(r=null)}if(!r)return $5(i,e,s)?{position:H5(i,o)}:null;const a=this.conversionApi.writer.split(i,r),l=[];for(const u of a.range.getWalker())if(u.type=="elementEnd")l.push(u.item);else{const d=l.pop(),f=u.item;this._registerSplitPair(d,f)}const c=a.range.end.parent;return this._cursorParents.set(e,c),{position:a.position,cursorParent:c}}_registerSplitPair(e,i){this._splitParts.has(e)||this._splitParts.set(e,[e]);const s=this._splitParts.get(e);this._splitParts.set(i,s),s.push(i)}_getSplitParts(e){let i;return this._splitParts.has(e)?i=this._splitParts.get(e):i=[e],i}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){let e=!1;for(const i of this._splitParts.keys())i.isEmpty&&!this._emptyElementsToKeep.has(i)&&(this.conversionApi.writer.remove(i),this._splitParts.delete(i),e=!0);e&&this._removeEmptyElements()}}function iq(n,t){const e=new Set,i=new Map,s=I._createIn(n).getItems();for(const o of s)o.is("element","$marker")&&e.add(o);for(const o of e){const r=o.getAttribute("data-name"),a=t.createPositionBefore(o);i.has(r)?i.get(r).end=a.clone():i.set(r,new I(a.clone())),t.remove(o)}return i}function sq(n,t){let e;for(const i of new vo(n)){const s={};for(const r of i.getAttributeKeys())s[r]=i.getAttribute(r);const o=t.createElement(i.name,s);e&&t.insert(o,e),e=M._createAt(o,0)}return e}class oq{getHtml(t){const i=j.document.implementation.createHTMLDocument("").createElement("div");return i.appendChild(t),i.innerHTML}}class Sb{constructor(t){h(this,"domParser");h(this,"domConverter");h(this,"htmlWriter");h(this,"skipComments",!0);this.domParser=new DOMParser,this.domConverter=new Ih(t,{renderingMode:"data"}),this.htmlWriter=new oq}toData(t){const e=this.domConverter.viewToDom(t);return this.htmlWriter.getHtml(e)}toView(t){const e=this._toDom(t);return this.domConverter.domToView(e,{skipComments:this.skipComments})}registerRawContentMatcher(t){this.domConverter.registerRawContentMatcher(t)}useFillerType(t){this.domConverter.blockFillerMode=t=="marked"?"markedNbsp":"nbsp"}_toDom(t){t.match(/<(?:html|body|head|meta)(?:\s[^>]*)?>/i)||(t=`<body>${t}</body>`);const e=this.domParser.parseFromString(t,"text/html"),i=e.createDocumentFragment(),s=e.body.childNodes;for(;s.length>0;)i.appendChild(s[0]);return i}}class rq extends De(){constructor(e,i){super();h(this,"model");h(this,"mapper");h(this,"downcastDispatcher");h(this,"upcastDispatcher");h(this,"viewDocument");h(this,"stylesProcessor");h(this,"htmlProcessor");h(this,"processor");h(this,"_viewWriter");this.model=e,this.mapper=new x5,this.downcastDispatcher=new S5({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",R5(),{priority:"lowest"}),this.downcastDispatcher.on("insert",L5(),{priority:"lowest"}),this.upcastDispatcher=new nq({schema:e.schema}),this.viewDocument=new xh(i),this.stylesProcessor=i,this.htmlProcessor=new Sb(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new b5(this.viewDocument),this.upcastDispatcher.on("text",wW(),{priority:"lowest"}),this.upcastDispatcher.on("element",q0(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",q0(),{priority:"lowest"}),Ve().prototype.decorate.call(this,"init"),Ve().prototype.decorate.call(this,"set"),Ve().prototype.decorate.call(this,"get"),Ve().prototype.decorate.call(this,"toView"),Ve().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},D5)},{priority:"lowest"})}get(e={}){const{rootName:i="main",trim:s="empty"}=e;if(!this._checkIfRootsExists([i]))throw new C("datacontroller-get-non-existent-root",this);const o=this.model.document.getRoot(i);return o.isAttached()||Te("datacontroller-get-detached-root",this),s==="empty"&&!this.model.hasContent(o,{ignoreWhitespaces:!0})?"":this.stringify(o,e)}stringify(e,i={}){const s=this.toView(e,i);return this.processor.toData(s)}toView(e,i={}){const s=this.viewDocument,o=this._viewWriter;this.mapper.clearBindings();const r=I._createIn(e),a=new _o(s);this.mapper.bindElements(e,a);const l=e.is("documentFragment")?e.markers:aq(e);return this.downcastDispatcher.convert(r,l,o,i),a}init(e){if(this.model.document.version)throw new C("datacontroller-init-document-not-empty",this);let i={};if(typeof e=="string"?i.main=e:i=e,!this._checkIfRootsExists(Object.keys(i)))throw new C("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},s=>{for(const o of Object.keys(i)){const r=this.model.document.getRoot(o);s.insert(this.parse(i[o],r),r,0)}}),Promise.resolve()}set(e,i={}){let s={};if(typeof e=="string"?s.main=e:s=e,!this._checkIfRootsExists(Object.keys(s)))throw new C("datacontroller-set-non-existent-root",this);this.model.enqueueChange(i.batchType||{},o=>{o.setSelection(null),o.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const r of Object.keys(s)){const a=this.model.document.getRoot(r);o.remove(o.createRangeIn(a)),o.insert(this.parse(s[r],a),a,0)}})}parse(e,i="$root"){const s=this.processor.toView(e);return this.toModel(s,i)}toModel(e,i="$root"){return this.model.change(s=>this.upcastDispatcher.convert(e,s,i))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const i of e)if(!this.model.document.getRoot(i))return!1;return!0}}function aq(n){const t=[],e=n.root.document;if(!e)return new Map;const i=I._createIn(n);for(const s of e.model.markers){const o=s.getRange(),r=o.isCollapsed,a=o.start.isEqual(i.start)||o.end.isEqual(i.end);if(r&&a)t.push([s.name,o]);else{const l=i.getIntersection(o);l&&t.push([s.name,l])}}return t.sort(([s,o],[r,a])=>{if(o.end.compareWith(a.start)!=="after")return 1;if(o.start.compareWith(a.end)!=="before")return-1;switch(o.start.compareWith(a.start)){case"before":return 1;case"after":return-1;default:switch(o.end.compareWith(a.end)){case"before":return 1;case"after":return-1;default:return r.localeCompare(s)}}}),new Map(t)}class lq{constructor(t,e){h(this,"_helpers",new Map);h(this,"_downcast");h(this,"_upcast");this._downcast=Pe(t),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=Pe(e),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(t,e){const i=this._downcast.includes(e);if(!this._upcast.includes(e)&&!i)throw new C("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:t,dispatchers:[e],isDowncast:i})}for(t){if(!this._helpers.has(t))throw new C("conversion-for-unknown-group",this);return this._helpers.get(t)}elementToElement(t){this.for("downcast").elementToElement(t);for(const{model:e,view:i}of _f(t))this.for("upcast").elementToElement({model:e,view:i,converterPriority:t.converterPriority})}attributeToElement(t){this.for("downcast").attributeToElement(t);for(const{model:e,view:i}of _f(t))this.for("upcast").elementToAttribute({view:i,model:e,converterPriority:t.converterPriority})}attributeToAttribute(t){this.for("downcast").attributeToAttribute(t);for(const{model:e,view:i}of _f(t))this.for("upcast").attributeToAttribute({view:i,model:e})}_createConversionHelpers({name:t,dispatchers:e,isDowncast:i}){if(this._helpers.has(t))throw new C("conversion-group-exists",this);const s=i?new DU(e):new bW(e);this._helpers.set(t,s)}}function*_f(n){if(n.model.values)for(const t of n.model.values){const e={key:n.model.key,value:t},i=n.view[t],s=n.upcastAlso?n.upcastAlso[t]:void 0;yield*J0(e,i,s)}else yield*J0(n.model,n.view,n.upcastAlso)}function*J0(n,t,e){if(yield{model:n,view:t},e)for(const i of Pe(e))yield{model:n,view:i}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class $n{constructor(t){h(this,"baseVersion");h(this,"isDocumentOperation");h(this,"batch");this.baseVersion=t,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const t=Object.assign({},this);return t.__className=this.constructor.className,delete t.batch,delete t.isDocumentOperation,t}static get className(){return"Operation"}static fromJSON(t,e){return new this(t.baseVersion)}}function Ib(n,t){const e=G5(t),i=e.reduce((r,a)=>r+a.offsetSize,0),s=n.parent;El(n);const o=n.index;return s._insertChild(o,e),Tl(s,o+e.length),Tl(s,o),new I(n,n.getShiftedBy(i))}function j5(n){if(!n.isFlat)throw new C("operation-utils-remove-range-not-flat",this);const t=n.start.parent;El(n.start),El(n.end);const e=t._removeChildren(n.start.index,n.end.index-n.start.index);return Tl(t,n.start.index),e}function kl(n,t){if(!n.isFlat)throw new C("operation-utils-move-range-not-flat",this);const e=j5(n);return t=t._getTransformedByDeletion(n.start,n.end.offset-n.start.offset),Ib(t,e)}function cq(n,t,e){El(n.start),El(n.end);for(const i of n.getItems({shallow:!0})){const s=i.is("$textProxy")?i.textNode:i;e!==null?s._setAttribute(t,e):s._removeAttribute(t),Tl(s.parent,s.index)}Tl(n.end.parent,n.end.index)}function G5(n){const t=[];function e(i){if(typeof i=="string")t.push(new He(i));else if(i instanceof li)t.push(new He(i.data,i.getAttributes()));else if(i instanceof Uo)t.push(i);else if(Dn(i))for(const s of i)e(s)}e(n);for(let i=1;i<t.length;i++){const s=t[i],o=t[i-1];s instanceof He&&o instanceof He&&K5(s,o)&&(t.splice(i-1,2,new He(o.data+s.data,o.getAttributes())),i--)}return t}function Tl(n,t){const e=n.getChild(t-1),i=n.getChild(t);if(e&&i&&e.is("$text")&&i.is("$text")&&K5(e,i)){const s=new He(e.data+i.data,e.getAttributes());n._removeChildren(t-1,2),n._insertChild(t-1,s)}}function El(n){const t=n.textNode,e=n.parent;if(t){const i=n.offset-t.startOffset,s=t.index;e._removeChildren(s,1);const o=new He(t.data.substr(0,i),t.getAttributes()),r=new He(t.data.substr(i),t.getAttributes());e._insertChild(s,[o,r])}}function K5(n,t){const e=n.getAttributes(),i=t.getAttributes();for(const s of e){if(s[1]!==t.getAttribute(s[0]))return!1;i.next()}return i.next().done}class Ie extends $n{constructor(e,i,s,o){super(o);h(this,"sourcePosition");h(this,"howMany");h(this,"targetPosition");this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=i,this.targetPosition=s.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[I._createFromPositionAndShift(this.sourcePosition,this.howMany),I._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new Ie(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new Ie(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,i=this.targetPosition.parent,s=this.sourcePosition.offset,o=this.targetPosition.offset;if(s+this.howMany>e.maxOffset)throw new C("move-operation-nodes-do-not-exist",this);if(e===i&&s<o&&o<s+this.howMany)throw new C("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&$t(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const r=this.sourcePosition.path.length-1;if(this.targetPosition.path[r]>=s&&this.targetPosition.path[r]<s+this.howMany)throw new C("move-operation-node-into-itself",this)}}_execute(){kl(I._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,i){const s=M.fromJSON(e.sourcePosition,i),o=M.fromJSON(e.targetPosition,i);return new this(s,e.howMany,o,e.baseVersion)}}class Vt extends $n{constructor(e,i,s){super(s);h(this,"position");h(this,"nodes");h(this,"shouldReceiveAttributes");this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new Ja(G5(i)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const e=new Ja([...this.nodes].map(s=>s._clone(!0))),i=new Vt(this.position,e,this.baseVersion);return i.shouldReceiveAttributes=this.shouldReceiveAttributes,i}getReversed(){const e=this.position.root.document.graveyard,i=new M(e,[0]);return new Ie(this.position,this.nodes.maxOffset,i,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new C("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new Ja([...e].map(i=>i._clone(!0))),Ib(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,i){const s=[];for(const r of e.nodes)r.name?s.push(Je.fromJSON(r)):s.push(He.fromJSON(r));const o=new Vt(M.fromJSON(e.position,i),s,e.baseVersion);return o.shouldReceiveAttributes=e.shouldReceiveAttributes,o}}class ze extends $n{constructor(e,i,s,o,r){super(r);h(this,"splitPosition");h(this,"howMany");h(this,"insertionPosition");h(this,"graveyardPosition");this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=i,this.insertionPosition=s,this.graveyardPosition=o?o.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new M(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new I(this.splitPosition,e)}get affectedSelectable(){const e=[I._createFromPositionAndShift(this.splitPosition,0),I._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(I._createFromPositionAndShift(this.graveyardPosition,0)),e}clone(){return new ze(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,i=new M(e,[0]);return new lt(this.moveTargetPosition,this.howMany,this.splitPosition,i,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,i=this.splitPosition.offset;if(!e||e.maxOffset<i)throw new C("split-operation-position-invalid",this);if(e.parent){if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new C("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new C("split-operation-graveyard-position-invalid",this)}else throw new C("split-operation-split-in-root",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)kl(I._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const s=e._clone();Ib(this.insertionPosition,s)}const i=new I(M._createAt(e,this.splitPosition.offset),M._createAt(e,e.maxOffset));kl(i,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const i=e.path.slice(0,-1);return i[i.length-1]++,new M(e.root,i,"toPrevious")}static fromJSON(e,i){const s=M.fromJSON(e.splitPosition,i),o=M.fromJSON(e.insertionPosition,i),r=e.graveyardPosition?M.fromJSON(e.graveyardPosition,i):null;return new this(s,e.howMany,o,r,e.baseVersion)}}class lt extends $n{constructor(e,i,s,o,r){super(r);h(this,"sourcePosition");h(this,"howMany");h(this,"targetPosition");h(this,"graveyardPosition");this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=i,this.targetPosition=s.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=o.clone()}get type(){return"merge"}get deletionPosition(){return new M(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new I(this.sourcePosition,e)}get affectedSelectable(){const e=this.sourcePosition.parent;return[I._createOn(e),I._createFromPositionAndShift(this.targetPosition,0),I._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new lt(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),i=this.sourcePosition.path.slice(0,-1),s=new M(this.sourcePosition.root,i)._getTransformedByMergeOperation(this);return new ze(e,this.howMany,s,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,i=this.targetPosition.parent;if(e.parent)if(i.parent){if(this.howMany!=e.maxOffset)throw new C("merge-operation-how-many-invalid",this)}else throw new C("merge-operation-target-position-invalid",this);else throw new C("merge-operation-source-position-invalid",this)}_execute(){const e=this.sourcePosition.parent,i=I._createIn(e);kl(i,this.targetPosition),kl(I._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,i){const s=M.fromJSON(e.sourcePosition,i),o=M.fromJSON(e.targetPosition,i),r=M.fromJSON(e.graveyardPosition,i);return new this(s,e.howMany,o,r,e.baseVersion)}}class gn extends $n{constructor(e,i,s,o,r,a){super(a);h(this,"name");h(this,"oldRange");h(this,"newRange");h(this,"affectsData");h(this,"_markers");this.name=e,this.oldRange=i?i.clone():null,this.newRange=s?s.clone():null,this.affectsData=r,this._markers=o}get type(){return"marker"}get affectedSelectable(){const e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push(...this.newRange.getDifference(this.oldRange)):e.push(this.newRange.clone())),e}clone(){return new gn(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new gn(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,i){return new gn(e.name,e.oldRange?I.fromJSON(e.oldRange,i):null,e.newRange?I.fromJSON(e.newRange,i):null,i.model.markers,e.affectsData,e.baseVersion)}}class mt extends $n{constructor(e,i,s,o,r){super(r);h(this,"range");h(this,"key");h(this,"oldValue");h(this,"newValue");this.range=e.clone(),this.key=i,this.oldValue=s===void 0?null:s,this.newValue=o===void 0?null:o}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new mt(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new mt(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new C("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!Ds(e.getAttribute(this.key),this.oldValue))throw new C("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&e.hasAttribute(this.key))throw new C("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){Ds(this.oldValue,this.newValue)||cq(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,i){return new mt(I.fromJSON(e.range,i),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Ct extends $n{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new Ct(this.baseVersion)}getReversed(){return new Ct(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}class pn extends $n{constructor(e,i,s,o){super(o);h(this,"position");h(this,"oldName");h(this,"newName");this.position=e,this.position.stickiness="toNext",this.oldName=i,this.newName=s}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new pn(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new pn(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(e instanceof Je){if(e.name!==this.oldName)throw new C("rename-operation-wrong-name",this)}else throw new C("rename-operation-wrong-position",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,i){return new pn(M.fromJSON(e.position,i),e.oldName,e.newName,e.baseVersion)}}class Ji extends $n{constructor(e,i,s,o,r){super(r);h(this,"root");h(this,"key");h(this,"oldValue");h(this,"newValue");this.root=e,this.key=i,this.oldValue=s===void 0?null:s,this.newValue=o===void 0?null:o}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new Ji(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Ji(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new C("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new C("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new C("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,i){if(!i.getRoot(e.root))throw new C("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new Ji(i.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}class Ei extends $n{constructor(e,i,s,o,r){super(r);h(this,"rootName");h(this,"elementName");h(this,"isAdd");h(this,"_document");if(this.rootName=e,this.elementName=i,this.isAdd=s,this._document=o,!this._document.getRoot(this.rootName)){const a=this._document.createRoot(this.elementName,this.rootName);a._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new Ei(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new Ei(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const e=super.toJSON();return delete e._document,e}static get className(){return"RootOperation"}static fromJSON(e,i){return new Ei(e.rootName,e.elementName,e.isAdd,i,e.baseVersion)}}const ni={};ni[mt.className]=mt;ni[Vt.className]=Vt;ni[gn.className]=gn;ni[Ie.className]=Ie;ni[Ct.className]=Ct;ni[$n.className]=$n;ni[pn.className]=pn;ni[Ji.className]=Ji;ni[Ei.className]=Ei;ni[ze.className]=ze;ni[lt.className]=lt;class uq{static fromJSON(t,e){return ni[t.__className].fromJSON(t,e)}}const zm=new Map;function xe(n,t,e){let i=zm.get(n);i||(i=new Map,zm.set(n,i)),i.set(t,e)}function dq(n,t){const e=zm.get(n);return e&&e.has(t)?e.get(t):hq}function hq(n){return[n]}function Y0(n,t,e={}){const i=dq(n.constructor,t.constructor);try{return n=n.clone(),i(n,t,e)}catch(s){throw s}}function fq(n,t,e){n=n.slice(),t=t.slice();const i=new mq(e.document,e.useRelations,e.forceWeakRemove);i.setOriginalOperations(n),i.setOriginalOperations(t);const s=i.originalOperations;if(n.length==0||t.length==0)return{operationsA:n,operationsB:t,originalOperations:s};const o=new WeakMap;for(const l of n)o.set(l,0);const r={nextBaseVersionA:n[n.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:n.length,originalOperationsBCount:t.length};let a=0;for(;a<n.length;){const l=n[a],c=o.get(l);if(c==t.length){a++;continue}const u=t[c],d=Y0(l,u,i.getContext(l,u,!0)),f=Y0(u,l,i.getContext(u,l,!1));i.updateRelation(l,u),i.setOriginalOperations(d,l),i.setOriginalOperations(f,u);for(const m of d)o.set(m,c+f.length);n.splice(a,1,...d),t.splice(c,1,...f)}return X0(n,r.nextBaseVersionB),X0(t,r.nextBaseVersionA),{operationsA:n,operationsB:t,originalOperations:s}}class mq{constructor(t,e,i=!1){h(this,"originalOperations");h(this,"_history");h(this,"_useRelations");h(this,"_forceWeakRemove");h(this,"_relations");this.originalOperations=new Map,this._history=t.history,this._useRelations=e,this._forceWeakRemove=!!i,this._relations=new Map}setOriginalOperations(t,e=null){const i=e?this.originalOperations.get(e):null;for(const s of t)this.originalOperations.set(s,i||s)}updateRelation(t,e){if(t instanceof Ie)e instanceof lt?t.targetPosition.isEqual(e.sourcePosition)||e.movedRange.containsPosition(t.targetPosition)?this._setRelation(t,e,"insertAtSource"):t.targetPosition.isEqual(e.deletionPosition)?this._setRelation(t,e,"insertBetween"):t.targetPosition.isAfter(e.sourcePosition)&&this._setRelation(t,e,"moveTargetAfter"):e instanceof Ie&&(t.targetPosition.isEqual(e.sourcePosition)||t.targetPosition.isBefore(e.sourcePosition)?this._setRelation(t,e,"insertBefore"):this._setRelation(t,e,"insertAfter"));else if(t instanceof ze){if(e instanceof lt)t.splitPosition.isBefore(e.sourcePosition)&&this._setRelation(t,e,"splitBefore");else if(e instanceof Ie)if(t.splitPosition.isEqual(e.sourcePosition)||t.splitPosition.isBefore(e.sourcePosition))this._setRelation(t,e,"splitBefore");else{const i=I._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.splitPosition.hasSameParentAs(e.sourcePosition)&&i.containsPosition(t.splitPosition)){const s=i.end.offset-t.splitPosition.offset,o=t.splitPosition.offset-i.start.offset;this._setRelation(t,e,{howMany:s,offset:o})}}}else if(t instanceof lt)e instanceof lt?(t.targetPosition.isEqual(e.sourcePosition)||this._setRelation(t,e,"mergeTargetNotMoved"),t.sourcePosition.isEqual(e.targetPosition)&&this._setRelation(t,e,"mergeSourceNotMoved"),t.sourcePosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeSameElement")):e instanceof ze?t.sourcePosition.isEqual(e.splitPosition)&&this._setRelation(t,e,"splitAtSource"):e instanceof Ie&&e.howMany>0&&(t.sourcePosition.isEqual(e.sourcePosition.getShiftedBy(e.howMany))&&this._setRelation(t,e,"mergeSourceAffected"),t.targetPosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeTargetWasBefore"));else if(t instanceof gn){const i=t.newRange;if(!i)return;if(e instanceof Ie){const s=I._createFromPositionAndShift(e.sourcePosition,e.howMany),o=s.containsPosition(i.start)||s.start.isEqual(i.start),r=s.containsPosition(i.end)||s.end.isEqual(i.end);(o||r)&&!s.containsRange(i)&&this._setRelation(t,e,{side:o?"left":"right",path:o?i.start.path.slice():i.end.path.slice()})}else if(e instanceof lt){const s=i.start.isEqual(e.targetPosition),o=i.start.isEqual(e.deletionPosition),r=i.end.isEqual(e.deletionPosition),a=i.end.isEqual(e.sourcePosition);(s||o||r||a)&&this._setRelation(t,e,{wasInLeftElement:s,wasStartBeforeMergedElement:o,wasEndBeforeMergedElement:r,wasInRightElement:a})}}}getContext(t,e,i){return{aIsStrong:i,aWasUndone:this._wasUndone(t),bWasUndone:this._wasUndone(e),abRelation:this._useRelations?this._getRelation(t,e):null,baRelation:this._useRelations?this._getRelation(e,t):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(t){const e=this.originalOperations.get(t);return e.wasUndone||this._history.isUndoneOperation(e)}_getRelation(t,e){const i=this.originalOperations.get(e),s=this._history.getUndoneOperation(i);if(!s)return null;const o=this.originalOperations.get(t),r=this._relations.get(o);return r&&r.get(s)||null}_setRelation(t,e,i){const s=this.originalOperations.get(t),o=this.originalOperations.get(e);let r=this._relations.get(s);r||(r=new Map,this._relations.set(s,r)),r.set(o,i)}}function X0(n,t){for(const e of n)e.baseVersion=t++}xe(mt,mt,(n,t,e)=>{if(n.key===t.key&&n.range.start.hasSameParentAs(t.range.start)){const i=n.range.getDifference(t.range).map(o=>new mt(o,n.key,n.oldValue,n.newValue,0)),s=n.range.getIntersection(t.range);return s&&e.aIsStrong&&i.push(new mt(s,t.key,t.newValue,n.newValue,0)),i.length==0?[new Ct(0)]:i}else return[n]});xe(mt,Vt,(n,t)=>{if(n.range.start.hasSameParentAs(t.position)&&n.range.containsPosition(t.position)){const i=n.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map(s=>new mt(s,n.key,n.oldValue,n.newValue,n.baseVersion));if(t.shouldReceiveAttributes){const s=Z5(t,n.key,n.oldValue);s&&i.unshift(s)}return i}return n.range=n.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[n]});function Z5(n,t,e){const s=n.nodes.getNode(0).getAttribute(t);if(s==e)return null;const o=new I(n.position,n.position.getShiftedBy(n.howMany));return new mt(o,t,s,e,0)}xe(mt,lt,(n,t)=>{const e=[];n.range.start.hasSameParentAs(t.deletionPosition)&&(n.range.containsPosition(t.deletionPosition)||n.range.start.isEqual(t.deletionPosition))&&e.push(I._createFromPositionAndShift(t.graveyardPosition,1));const i=n.range._getTransformedByMergeOperation(t);return i.isCollapsed||e.push(i),e.map(s=>new mt(s,n.key,n.oldValue,n.newValue,n.baseVersion))});xe(mt,Ie,(n,t)=>gq(n.range,t).map(i=>new mt(i,n.key,n.oldValue,n.newValue,n.baseVersion)));function gq(n,t){const e=I._createFromPositionAndShift(t.sourcePosition,t.howMany);let i=null,s=[];e.containsRange(n,!0)?i=n:n.start.hasSameParentAs(e.start)?(s=n.getDifference(e),i=n.getIntersection(e)):s=[n];const o=[];for(let r of s){r=r._getTransformedByDeletion(t.sourcePosition,t.howMany);const a=t.getMovedRangeStart(),l=r.start.hasSameParentAs(a),c=r._getTransformedByInsertion(a,t.howMany,l);o.push(...c)}return i&&o.push(i._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),o}xe(mt,ze,(n,t)=>{if(n.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||n.range.end.offset++,[n];if(n.range.start.hasSameParentAs(t.splitPosition)&&n.range.containsPosition(t.splitPosition)){const e=n.clone();return e.range=new I(t.moveTargetPosition.clone(),n.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),n.range.end=t.splitPosition.clone(),n.range.end.stickiness="toPrevious",[n,e]}return n.range=n.range._getTransformedBySplitOperation(t),[n]});xe(Vt,mt,(n,t)=>{const e=[n];if(n.shouldReceiveAttributes&&n.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(n.position)){const i=Z5(n,t.key,t.newValue);i&&e.push(i)}return e});xe(Vt,Vt,(n,t,e)=>n.position.isEqual(t.position)&&e.aIsStrong?[n]:(n.position=n.position._getTransformedByInsertOperation(t),[n]));xe(Vt,Ie,(n,t)=>(n.position=n.position._getTransformedByMoveOperation(t),[n]));xe(Vt,ze,(n,t)=>(n.position=n.position._getTransformedBySplitOperation(t),[n]));xe(Vt,lt,(n,t)=>(n.position=n.position._getTransformedByMergeOperation(t),[n]));xe(gn,Vt,(n,t)=>(n.oldRange&&(n.oldRange=n.oldRange._getTransformedByInsertOperation(t)[0]),n.newRange&&(n.newRange=n.newRange._getTransformedByInsertOperation(t)[0]),[n]));xe(gn,gn,(n,t,e)=>{if(n.name==t.name)if(e.aIsStrong)n.oldRange=t.newRange?t.newRange.clone():null;else return[new Ct(0)];return[n]});xe(gn,lt,(n,t)=>(n.oldRange&&(n.oldRange=n.oldRange._getTransformedByMergeOperation(t)),n.newRange&&(n.newRange=n.newRange._getTransformedByMergeOperation(t)),[n]));xe(gn,Ie,(n,t,e)=>{if(n.oldRange&&(n.oldRange=I._createFromRanges(n.oldRange._getTransformedByMoveOperation(t))),n.newRange){if(e.abRelation){const i=I._createFromRanges(n.newRange._getTransformedByMoveOperation(t));if(e.abRelation.side=="left"&&t.targetPosition.isEqual(n.newRange.start))return n.newRange.end=i.end,n.newRange.start.path=e.abRelation.path,[n];if(e.abRelation.side=="right"&&t.targetPosition.isEqual(n.newRange.end))return n.newRange.start=i.start,n.newRange.end.path=e.abRelation.path,[n]}n.newRange=I._createFromRanges(n.newRange._getTransformedByMoveOperation(t))}return[n]});xe(gn,ze,(n,t,e)=>{if(n.oldRange&&(n.oldRange=n.oldRange._getTransformedBySplitOperation(t)),n.newRange){if(e.abRelation){const i=n.newRange._getTransformedBySplitOperation(t);return n.newRange.start.isEqual(t.splitPosition)&&e.abRelation.wasStartBeforeMergedElement?n.newRange.start=M._createAt(t.insertionPosition):n.newRange.start.isEqual(t.splitPosition)&&!e.abRelation.wasInLeftElement&&(n.newRange.start=M._createAt(t.moveTargetPosition)),n.newRange.end.isEqual(t.splitPosition)&&e.abRelation.wasInRightElement?n.newRange.end=M._createAt(t.moveTargetPosition):n.newRange.end.isEqual(t.splitPosition)&&e.abRelation.wasEndBeforeMergedElement?n.newRange.end=M._createAt(t.insertionPosition):n.newRange.end=i.end,[n]}n.newRange=n.newRange._getTransformedBySplitOperation(t)}return[n]});xe(lt,Vt,(n,t)=>(n.sourcePosition.hasSameParentAs(t.position)&&(n.howMany+=t.howMany),n.sourcePosition=n.sourcePosition._getTransformedByInsertOperation(t),n.targetPosition=n.targetPosition._getTransformedByInsertOperation(t),[n]));xe(lt,lt,(n,t,e)=>{if(n.sourcePosition.isEqual(t.sourcePosition)&&n.targetPosition.isEqual(t.targetPosition))if(e.bWasUndone){const i=t.graveyardPosition.path.slice();return i.push(0),n.sourcePosition=new M(t.graveyardPosition.root,i),n.howMany=0,[n]}else return[new Ct(0)];if(n.sourcePosition.isEqual(t.sourcePosition)&&!n.targetPosition.isEqual(t.targetPosition)&&!e.bWasUndone&&e.abRelation!="splitAtSource"){const i=n.targetPosition.root.rootName=="$graveyard",s=t.targetPosition.root.rootName=="$graveyard";if(s&&!i||!(i&&!s)&&e.aIsStrong){const l=t.targetPosition._getTransformedByMergeOperation(t),c=n.targetPosition._getTransformedByMergeOperation(t);return[new Ie(l,n.howMany,c,0)]}else return[new Ct(0)]}return n.sourcePosition.hasSameParentAs(t.targetPosition)&&(n.howMany+=t.howMany),n.sourcePosition=n.sourcePosition._getTransformedByMergeOperation(t),n.targetPosition=n.targetPosition._getTransformedByMergeOperation(t),(!n.graveyardPosition.isEqual(t.graveyardPosition)||!e.aIsStrong)&&(n.graveyardPosition=n.graveyardPosition._getTransformedByMergeOperation(t)),[n]});xe(lt,Ie,(n,t,e)=>{const i=I._createFromPositionAndShift(t.sourcePosition,t.howMany);return t.type=="remove"&&!e.bWasUndone&&!e.forceWeakRemove&&n.deletionPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(n.sourcePosition)?[new Ct(0)]:(t.sourcePosition.getShiftedBy(t.howMany).isEqual(n.sourcePosition)?n.sourcePosition.stickiness="toNone":t.targetPosition.isEqual(n.sourcePosition)&&e.abRelation=="mergeSourceAffected"?n.sourcePosition.stickiness="toNext":t.sourcePosition.isEqual(n.targetPosition)?(n.targetPosition.stickiness="toNone",n.howMany-=t.howMany):t.targetPosition.isEqual(n.targetPosition)&&e.abRelation=="mergeTargetWasBefore"?(n.targetPosition.stickiness="toPrevious",n.howMany+=t.howMany):(n.sourcePosition.hasSameParentAs(t.targetPosition)&&(n.howMany+=t.howMany),n.sourcePosition.hasSameParentAs(t.sourcePosition)&&(n.howMany-=t.howMany)),n.sourcePosition=n.sourcePosition._getTransformedByMoveOperation(t),n.targetPosition=n.targetPosition._getTransformedByMoveOperation(t),n.sourcePosition.stickiness="toPrevious",n.targetPosition.stickiness="toNext",n.graveyardPosition.isEqual(t.targetPosition)||(n.graveyardPosition=n.graveyardPosition._getTransformedByMoveOperation(t)),[n])});xe(lt,ze,(n,t,e)=>{if(t.graveyardPosition&&(n.graveyardPosition=n.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),n.deletionPosition.isEqual(t.graveyardPosition)&&(n.howMany=t.howMany)),n.targetPosition.isEqual(t.splitPosition)){const i=t.howMany!=0,s=t.graveyardPosition&&n.deletionPosition.isEqual(t.graveyardPosition);if(i||s||e.abRelation=="mergeTargetNotMoved")return n.sourcePosition=n.sourcePosition._getTransformedBySplitOperation(t),[n]}if(n.sourcePosition.isEqual(t.splitPosition)){if(e.abRelation=="mergeSourceNotMoved")return n.howMany=0,n.targetPosition=n.targetPosition._getTransformedBySplitOperation(t),[n];if(e.abRelation=="mergeSameElement"||n.sourcePosition.offset>0)return n.sourcePosition=t.moveTargetPosition.clone(),n.targetPosition=n.targetPosition._getTransformedBySplitOperation(t),[n]}return n.sourcePosition.hasSameParentAs(t.splitPosition)&&(n.howMany=t.splitPosition.offset),n.sourcePosition=n.sourcePosition._getTransformedBySplitOperation(t),n.targetPosition=n.targetPosition._getTransformedBySplitOperation(t),[n]});xe(Ie,Vt,(n,t)=>{const i=I._createFromPositionAndShift(n.sourcePosition,n.howMany)._getTransformedByInsertOperation(t,!1)[0];return n.sourcePosition=i.start,n.howMany=i.end.offset-i.start.offset,n.targetPosition.isEqual(t.position)||(n.targetPosition=n.targetPosition._getTransformedByInsertOperation(t)),[n]});xe(Ie,Ie,(n,t,e)=>{const i=I._createFromPositionAndShift(n.sourcePosition,n.howMany),s=I._createFromPositionAndShift(t.sourcePosition,t.howMany);let o=e.aIsStrong,r=!e.aIsStrong;e.abRelation=="insertBefore"||e.baRelation=="insertAfter"?r=!0:(e.abRelation=="insertAfter"||e.baRelation=="insertBefore")&&(r=!1);let a;if(n.targetPosition.isEqual(t.targetPosition)&&r?a=n.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):a=n.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),Q0(n,t)&&Q0(t,n))return[t.getReversed()];if(i.containsPosition(t.targetPosition)&&i.containsRange(s,!0))return i.start=i.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),i.end=i.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),vr([i],a);if(s.containsPosition(n.targetPosition)&&s.containsRange(i,!0))return i.start=i.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),i.end=i.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),vr([i],a);const u=$t(n.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if(u=="prefix"||u=="extension")return i.start=i.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),i.end=i.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),vr([i],a);n.type=="remove"&&t.type!="remove"&&!e.aWasUndone&&!e.forceWeakRemove?o=!0:n.type!="remove"&&t.type=="remove"&&!e.bWasUndone&&!e.forceWeakRemove&&(o=!1);const d=[],f=i.getDifference(s);for(const g of f){g.start=g.start._getTransformedByDeletion(t.sourcePosition,t.howMany),g.end=g.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const p=$t(g.start.getParentPath(),t.getMovedRangeStart().getParentPath())=="same",w=g._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,p);d.push(...w)}const m=i.getIntersection(s);return m!==null&&o&&(m.start=m.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),m.end=m.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),d.length===0?d.push(m):d.length==1?s.start.isBefore(i.start)||s.start.isEqual(i.start)?d.unshift(m):d.push(m):d.splice(1,0,m)),d.length===0?[new Ct(n.baseVersion)]:vr(d,a)});xe(Ie,ze,(n,t,e)=>{let i=n.targetPosition.clone();(!n.targetPosition.isEqual(t.insertionPosition)||!t.graveyardPosition||e.abRelation=="moveTargetAfter")&&(i=n.targetPosition._getTransformedBySplitOperation(t));const s=I._createFromPositionAndShift(n.sourcePosition,n.howMany);if(s.end.isEqual(t.insertionPosition))return t.graveyardPosition||n.howMany++,n.targetPosition=i,[n];if(s.start.hasSameParentAs(t.splitPosition)&&s.containsPosition(t.splitPosition)){let a=new I(t.splitPosition,s.end);a=a._getTransformedBySplitOperation(t);const l=[new I(s.start,t.splitPosition),a];return vr(l,i)}n.targetPosition.isEqual(t.splitPosition)&&e.abRelation=="insertAtSource"&&(i=t.moveTargetPosition),n.targetPosition.isEqual(t.insertionPosition)&&e.abRelation=="insertBetween"&&(i=n.targetPosition);const r=[s._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const a=s.start.isEqual(t.graveyardPosition)||s.containsPosition(t.graveyardPosition);n.howMany>1&&a&&!e.aWasUndone&&r.push(I._createFromPositionAndShift(t.insertionPosition,1))}return vr(r,i)});xe(Ie,lt,(n,t,e)=>{const i=I._createFromPositionAndShift(n.sourcePosition,n.howMany);if(t.deletionPosition.hasSameParentAs(n.sourcePosition)&&i.containsPosition(t.sourcePosition)){if(n.type=="remove"&&!e.forceWeakRemove){if(!e.aWasUndone){const r=[];let a=t.graveyardPosition.clone(),l=t.targetPosition._getTransformedByMergeOperation(t);n.howMany>1&&(r.push(new Ie(n.sourcePosition,n.howMany-1,n.targetPosition,0)),a=a._getTransformedByMove(n.sourcePosition,n.targetPosition,n.howMany-1),l=l._getTransformedByMove(n.sourcePosition,n.targetPosition,n.howMany-1));const c=t.deletionPosition._getCombined(n.sourcePosition,n.targetPosition),u=new Ie(a,1,c,0),d=u.getMovedRangeStart().path.slice();d.push(0);const f=new M(u.targetPosition.root,d);l=l._getTransformedByMove(a,c,1);const m=new Ie(l,t.howMany,f,0);return r.push(u),r.push(m),r}}else if(n.howMany==1)return e.bWasUndone?(n.sourcePosition=t.graveyardPosition.clone(),n.targetPosition=n.targetPosition._getTransformedByMergeOperation(t),[n]):[new Ct(0)]}const o=I._createFromPositionAndShift(n.sourcePosition,n.howMany)._getTransformedByMergeOperation(t);return n.sourcePosition=o.start,n.howMany=o.end.offset-o.start.offset,n.targetPosition=n.targetPosition._getTransformedByMergeOperation(t),[n]});xe(pn,Vt,(n,t)=>(n.position=n.position._getTransformedByInsertOperation(t),[n]));xe(pn,lt,(n,t)=>n.position.isEqual(t.deletionPosition)?(n.position=t.graveyardPosition.clone(),n.position.stickiness="toNext",[n]):(n.position=n.position._getTransformedByMergeOperation(t),[n]));xe(pn,Ie,(n,t)=>(n.position=n.position._getTransformedByMoveOperation(t),[n]));xe(pn,pn,(n,t,e)=>{if(n.position.isEqual(t.position))if(e.aIsStrong)n.oldName=t.newName;else return[new Ct(0)];return[n]});xe(pn,ze,(n,t)=>{const e=n.position.path,i=t.splitPosition.getParentPath();if($t(e,i)=="same"&&!t.graveyardPosition){const s=new pn(n.position.getShiftedBy(1),n.oldName,n.newName,0);return[n,s]}return n.position=n.position._getTransformedBySplitOperation(t),[n]});xe(Ji,Ji,(n,t,e)=>{if(n.root===t.root&&n.key===t.key){if(!e.aIsStrong||n.newValue===t.newValue)return[new Ct(0)];n.oldValue=t.newValue}return[n]});xe(Ei,Ei,(n,t)=>n.rootName===t.rootName&&n.isAdd===t.isAdd?[new Ct(0)]:[n]);xe(ze,Vt,(n,t)=>(n.splitPosition.hasSameParentAs(t.position)&&n.splitPosition.offset<t.position.offset&&(n.howMany+=t.howMany),n.splitPosition=n.splitPosition._getTransformedByInsertOperation(t),n.insertionPosition=n.insertionPosition._getTransformedByInsertOperation(t),[n]));xe(ze,lt,(n,t,e)=>{if(!n.graveyardPosition&&!e.bWasUndone&&n.splitPosition.hasSameParentAs(t.sourcePosition)){const i=t.graveyardPosition.path.slice();i.push(0);const s=new M(t.graveyardPosition.root,i),o=ze.getInsertionPosition(new M(t.graveyardPosition.root,i)),r=new ze(s,0,o,null,0);return n.splitPosition=n.splitPosition._getTransformedByMergeOperation(t),n.insertionPosition=ze.getInsertionPosition(n.splitPosition),n.graveyardPosition=r.insertionPosition.clone(),n.graveyardPosition.stickiness="toNext",[r,n]}return n.splitPosition.hasSameParentAs(t.deletionPosition)&&!n.splitPosition.isAfter(t.deletionPosition)&&n.howMany--,n.splitPosition.hasSameParentAs(t.targetPosition)&&(n.howMany+=t.howMany),n.splitPosition=n.splitPosition._getTransformedByMergeOperation(t),n.insertionPosition=ze.getInsertionPosition(n.splitPosition),n.graveyardPosition&&(n.graveyardPosition=n.graveyardPosition._getTransformedByMergeOperation(t)),[n]});xe(ze,Ie,(n,t,e)=>{const i=I._createFromPositionAndShift(t.sourcePosition,t.howMany);if(n.graveyardPosition){const o=i.start.isEqual(n.graveyardPosition)||i.containsPosition(n.graveyardPosition);if(!e.bWasUndone&&o){const r=n.splitPosition._getTransformedByMoveOperation(t),a=n.graveyardPosition._getTransformedByMoveOperation(t),l=a.path.slice();l.push(0);const c=new M(a.root,l);return[new Ie(r,n.howMany,c,0)]}n.graveyardPosition=n.graveyardPosition._getTransformedByMoveOperation(t)}const s=n.splitPosition.isEqual(t.targetPosition);if(s&&(e.baRelation=="insertAtSource"||e.abRelation=="splitBefore"))return n.howMany+=t.howMany,n.splitPosition=n.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),n.insertionPosition=ze.getInsertionPosition(n.splitPosition),[n];if(s&&e.abRelation&&e.abRelation.howMany){const{howMany:o,offset:r}=e.abRelation;return n.howMany+=o,n.splitPosition=n.splitPosition.getShiftedBy(r),[n]}if(n.splitPosition.hasSameParentAs(t.sourcePosition)&&i.containsPosition(n.splitPosition)){const o=t.howMany-(n.splitPosition.offset-t.sourcePosition.offset);return n.howMany-=o,n.splitPosition.hasSameParentAs(t.targetPosition)&&n.splitPosition.offset<t.targetPosition.offset&&(n.howMany+=t.howMany),n.splitPosition=t.sourcePosition.clone(),n.insertionPosition=ze.getInsertionPosition(n.splitPosition),[n]}return t.sourcePosition.isEqual(t.targetPosition)||(n.splitPosition.hasSameParentAs(t.sourcePosition)&&n.splitPosition.offset<=t.sourcePosition.offset&&(n.howMany-=t.howMany),n.splitPosition.hasSameParentAs(t.targetPosition)&&n.splitPosition.offset<t.targetPosition.offset&&(n.howMany+=t.howMany)),n.splitPosition.stickiness="toNone",n.splitPosition=n.splitPosition._getTransformedByMoveOperation(t),n.splitPosition.stickiness="toNext",n.graveyardPosition?n.insertionPosition=n.insertionPosition._getTransformedByMoveOperation(t):n.insertionPosition=ze.getInsertionPosition(n.splitPosition),[n]});xe(ze,ze,(n,t,e)=>{if(n.splitPosition.isEqual(t.splitPosition)){if(!n.graveyardPosition&&!t.graveyardPosition)return[new Ct(0)];if(n.graveyardPosition&&t.graveyardPosition&&n.graveyardPosition.isEqual(t.graveyardPosition))return[new Ct(0)];if(e.abRelation=="splitBefore")return n.howMany=0,n.graveyardPosition=n.graveyardPosition._getTransformedBySplitOperation(t),[n]}if(n.graveyardPosition&&t.graveyardPosition&&n.graveyardPosition.isEqual(t.graveyardPosition)){const i=n.splitPosition.root.rootName=="$graveyard",s=t.splitPosition.root.rootName=="$graveyard";if(s&&!i||!(i&&!s)&&e.aIsStrong){const l=[];return t.howMany&&l.push(new Ie(t.moveTargetPosition,t.howMany,t.splitPosition,0)),n.howMany&&l.push(new Ie(n.splitPosition,n.howMany,n.moveTargetPosition,0)),l}else return[new Ct(0)]}if(n.graveyardPosition&&(n.graveyardPosition=n.graveyardPosition._getTransformedBySplitOperation(t)),n.splitPosition.isEqual(t.insertionPosition)&&e.abRelation=="splitBefore")return n.howMany++,[n];if(t.splitPosition.isEqual(n.insertionPosition)&&e.baRelation=="splitBefore"){const i=t.insertionPosition.path.slice();i.push(0);const s=new M(t.insertionPosition.root,i),o=new Ie(n.insertionPosition,1,s,0);return[n,o]}return n.splitPosition.hasSameParentAs(t.splitPosition)&&n.splitPosition.offset<t.splitPosition.offset&&(n.howMany-=t.howMany),n.splitPosition=n.splitPosition._getTransformedBySplitOperation(t),n.insertionPosition=ze.getInsertionPosition(n.splitPosition),[n]});function Q0(n,t){return n.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)===null}function vr(n,t){const e=[];for(let i=0;i<n.length;i++){const s=n[i],o=new Ie(s.start,s.end.offset-s.start.offset,t,0);e.push(o);for(let r=i+1;r<n.length;r++)n[r]=n[r]._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)[0];t=t._getTransformedByMove(o.sourcePosition,o.targetPosition,o.howMany)}return e}class bt extends De(M){constructor(t,e,i="toNone"){if(super(t,e,i),!this.root.is("rootElement"))throw new C("model-liveposition-root-not-rootelement",t);pq.call(this)}detach(){this.stopListening()}toPosition(){return new M(this.root,this.path.slice(),this.stickiness)}static fromPosition(t,e){return new this(t.root,t.path.slice(),e||t.stickiness)}}bt.prototype.is=function(n){return n==="livePosition"||n==="model:livePosition"||n=="position"||n==="model:position"};function pq(){this.listenTo(this.root.document.model,"applyOperation",(n,t)=>{const e=t[0];e.isDocumentOperation&&bq.call(this,e)},{priority:"low"})}function bq(n){const t=this.getTransformedByOperation(n);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}class tr{constructor(t={}){h(this,"operations");h(this,"isUndoable");h(this,"isLocal");h(this,"isUndo");h(this,"isTyping");typeof t=="string"&&(t=t==="transparent"?{isUndoable:!1}:{},Te("batch-constructor-deprecated-string-type"));const{isUndoable:e=!0,isLocal:i=!0,isUndo:s=!1,isTyping:o=!1}=t;this.operations=[],this.isUndoable=e,this.isLocal=i,this.isUndo=s,this.isTyping=o}get type(){return Te("batch-type-deprecated"),"default"}get baseVersion(){for(const t of this.operations)if(t.baseVersion!==null)return t.baseVersion;return null}addOperation(t){return t.batch=this,this.operations.push(t),t}}const rl=class rl{constructor(t){h(this,"_markerCollection");h(this,"_changesInElement",new Map);h(this,"_elementsSnapshots",new Map);h(this,"_elementChildrenSnapshots",new Map);h(this,"_elementState",new Map);h(this,"_changedMarkers",new Map);h(this,"_changedRoots",new Map);h(this,"_changeCount",0);h(this,"_cachedChanges",null);h(this,"_cachedChangesWithGraveyard",null);h(this,"_refreshedItems",new Set);this._markerCollection=t}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(t){const e=t;switch(e.type){case"insert":{if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const i of e.range.getItems({shallow:!0}))this._isInInsertedElement(i.parent)||this._markAttribute(i);break}case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const i=this._isInInsertedElement(e.sourcePosition.parent),s=this._isInInsertedElement(e.targetPosition.parent);i||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),s||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);const o=I._createFromPositionAndShift(e.sourcePosition,e.howMany);for(const r of o.getItems({shallow:!0}))this._setElementState(r,"move");break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const i=I._createFromPositionAndShift(e.position,1);for(const s of this._markerCollection.getMarkersIntersectingRange(i)){const o=s.getData();this.bufferMarkerChange(s.name,o,o)}this._setElementState(e.position.nodeAfter,"rename");break}case"split":{const i=e.splitPosition.parent;if(!this._isInInsertedElement(i)){this._markRemove(i,e.splitPosition.offset,e.howMany);const s=I._createFromPositionAndShift(e.splitPosition,e.howMany);for(const o of s.getItems({shallow:!0}))this._setElementState(o,"move")}this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&(this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1),this._setElementState(e.graveyardPosition.nodeAfter,"move"));break}case"merge":{const i=e.sourcePosition.parent;this._isInInsertedElement(i.parent)||this._markRemove(i.parent,i.startOffset,1);const s=e.graveyardPosition.parent;this._markInsert(s,e.graveyardPosition.offset,1),this._setElementState(i,"move");const o=e.targetPosition.parent;if(!this._isInInsertedElement(o)){this._markInsert(o,e.targetPosition.offset,i.maxOffset);const r=I._createFromPositionAndShift(e.sourcePosition,e.howMany);for(const a of r.getItems({shallow:!0}))this._setElementState(a,"move")}break}case"detachRoot":case"addRoot":{const i=e.affectedSelectable;if(!i._isLoaded||i.isAttached()==e.isAdd)return;this._bufferRootStateChange(e.rootName,e.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!e.root._isLoaded)return;const i=e.root.rootName;this._bufferRootAttributeChange(i,e.key,e.oldValue,e.newValue);break}}this._cachedChanges=null}bufferMarkerChange(t,e,i){e.range&&e.range.root.is("rootElement")&&!e.range.root._isLoaded&&(e.range=null),i.range&&i.range.root.is("rootElement")&&!i.range.root._isLoaded&&(i.range=null);let s=this._changedMarkers.get(t);s?s.newMarkerData=i:(s={newMarkerData:i,oldMarkerData:e},this._changedMarkers.set(t,s)),s.oldMarkerData.range==null&&i.range==null&&this._changedMarkers.delete(t)}getMarkersToRemove(){const t=[];for(const[e,i]of this._changedMarkers)i.oldMarkerData.range!=null&&t.push({name:e,range:i.oldMarkerData.range});return t}getMarkersToAdd(){const t=[];for(const[e,i]of this._changedMarkers)i.newMarkerData.range!=null&&t.push({name:e,range:i.newMarkerData.range});return t}getChangedMarkers(){return Array.from(this._changedMarkers).map(([t,e])=>({name:t,data:{oldRange:e.oldMarkerData.range,newRange:e.newMarkerData.range}}))}hasDataChanges(){if(this.getChanges().length||this._changedRoots.size>0)return!0;for(const{newMarkerData:t,oldMarkerData:e}of this._changedMarkers.values()){if(t.affectsData!==e.affectsData)return!0;if(t.affectsData){const i=t.range&&!e.range,s=!t.range&&e.range,o=t.range&&e.range&&!t.range.isEqual(e.range);if(i||s||o)return!0}}return!1}getChanges(t={}){if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let e=[];for(const i of this._changesInElement.keys()){const s=this._changesInElement.get(i).sort((u,d)=>u.offset===d.offset?u.type!=d.type?u.type=="remove"?-1:1:0:u.offset<d.offset?-1:1),o=this._elementChildrenSnapshots.get(i),r=t_(i.getChildren()),a=wq(o.length,s);let l=0,c=0;for(const u of a)if(u==="i"){const d=this._getDiffActionForNode(r[l].node,"insert"),f=this._elementsSnapshots.get(r[l].node),m=this._getInsertDiff(i,l,d,r[l],f);e.push(m),l++}else if(u==="r"){const d=this._getDiffActionForNode(o[c].node,"remove"),f=this._getRemoveDiff(i,l,d,o[c]);e.push(f),c++}else if(u==="a"){const d=o[c].attributes,f=r[l].attributes;let m;if(r[l].name=="$text")m=new I(M._createAt(i,l),M._createAt(i,l+1));else{const p=i.offsetToIndex(l);m=new I(M._createAt(i,l),M._createAt(i.getChild(p),0))}const g=this._getAttributesDiff(m,d,f);e.push(...g),l++,c++}else l++,c++}e.sort((i,s)=>i.position.root!=s.position.root?i.position.root.rootName<s.position.root.rootName?-1:1:i.position.isEqual(s.position)?i.changeCount-s.changeCount:i.position.isBefore(s.position)?-1:1);for(let i=1,s=0;i<e.length;i++){const o=e[s],r=e[i],a=o.type=="remove"&&r.type=="remove"&&o.name=="$text"&&r.name=="$text"&&o.position.isEqual(r.position),l=o.type=="insert"&&r.type=="insert"&&o.name=="$text"&&r.name=="$text"&&o.position.parent==r.position.parent&&o.position.offset+o.length==r.position.offset,c=o.type=="attribute"&&r.type=="attribute"&&o.position.parent==r.position.parent&&o.range.isFlat&&r.range.isFlat&&o.position.offset+o.length==r.position.offset&&o.attributeKey==r.attributeKey&&o.attributeOldValue==r.attributeOldValue&&o.attributeNewValue==r.attributeNewValue;a||l||c?(o.length++,c&&(o.range.end=o.range.end.getShiftedBy(1)),e[i]=null):s=i}e=e.filter(i=>i);for(const i of e)delete i.changeCount,i.type=="attribute"&&(delete i.position,delete i.length);return this._changeCount=0,this._cachedChangesWithGraveyard=e,this._cachedChanges=e.filter(_q),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(t=>{const e={...t};return e.state!==void 0&&delete e.attributes,e})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementChildrenSnapshots.clear(),this._elementsSnapshots.clear(),this._elementState.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems.clear(),this._cachedChanges=null}_refreshItem(t){if(this._isInInsertedElement(t.parent))return;this._markRemove(t.parent,t.startOffset,t.offsetSize),this._markInsert(t.parent,t.startOffset,t.offsetSize),this._refreshedItems.add(t),this._setElementState(t,"refresh");const e=I._createOn(t);for(const i of this._markerCollection.getMarkersIntersectingRange(e)){const s=i.getData();this.bufferMarkerChange(i.name,s,s)}this._cachedChanges=null}_bufferRootLoad(t){if(t.isAttached()){this._bufferRootStateChange(t.rootName,!0),this._markInsert(t,0,t.maxOffset);for(const e of t.getAttributeKeys())this._bufferRootAttributeChange(t.rootName,e,null,t.getAttribute(e));for(const e of this._markerCollection)if(e.getRange().root==t){const i=e.getData();this.bufferMarkerChange(e.name,{...i,range:null},i)}}}_bufferRootStateChange(t,e){if(!this._changedRoots.has(t)){this._changedRoots.set(t,{name:t,state:e?"attached":"detached"});return}const i=this._changedRoots.get(t);i.state!==void 0?(delete i.state,i.attributes===void 0&&this._changedRoots.delete(t)):i.state=e?"attached":"detached"}_bufferRootAttributeChange(t,e,i,s){const o=this._changedRoots.get(t)||{name:t},r=o.attributes||{};if(r[e]){const a=r[e];s===a.oldValue?delete r[e]:a.newValue=s}else r[e]={oldValue:i,newValue:s};Object.entries(r).length===0?(delete o.attributes,o.state===void 0&&this._changedRoots.delete(t)):(o.attributes=r,this._changedRoots.set(t,o))}_markInsert(t,e,i){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const s={type:"insert",offset:e,howMany:i,count:this._changeCount++};this._markChange(t,s)}_markRemove(t,e,i){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const s={type:"remove",offset:e,howMany:i,count:this._changeCount++};this._markChange(t,s),this._removeAllNestedChanges(t,e,i)}_markAttribute(t){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const e={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,e)}_markChange(t,e){this._makeSnapshots(t);const i=this._getChangesForElement(t);this._handleChange(e,i),i.push(e);for(let s=0;s<i.length;s++)i[s].howMany<1&&(i.splice(s,1),s--)}_setElementState(t,e){if(!t.is("element"))return;const i=rl._statesPriority.indexOf(this._elementState.get(t));rl._statesPriority.indexOf(e)>i&&this._elementState.set(t,e)}_getDiffActionForNode(t,e){if(!t.is("element")||!this._elementsSnapshots.has(t))return e;const i=this._elementState.get(t);return!i||i=="move"?e:i}_getChangesForElement(t){let e;return this._changesInElement.has(t)?e=this._changesInElement.get(t):(e=[],this._changesInElement.set(t,e)),e}_makeSnapshots(t){if(this._elementChildrenSnapshots.has(t))return;const e=t_(t.getChildren());this._elementChildrenSnapshots.set(t,e);for(const i of e)this._elementsSnapshots.set(i.node,i)}_handleChange(t,e){t.nodesToHandle=t.howMany;for(const i of e){const s=t.offset+t.howMany,o=i.offset+i.howMany;if(t.type=="insert"&&(i.type=="insert"&&(t.offset<=i.offset?i.offset+=t.howMany:t.offset<o&&(i.howMany+=t.nodesToHandle,t.nodesToHandle=0)),i.type=="remove"&&t.offset<i.offset&&(i.offset+=t.howMany),i.type=="attribute")){if(t.offset<=i.offset)i.offset+=t.howMany;else if(t.offset<o){const r=i.howMany;i.howMany=t.offset-i.offset,e.unshift({type:"attribute",offset:s,howMany:r-i.howMany,count:this._changeCount++})}}if(t.type=="remove"){if(i.type=="insert"){if(s<=i.offset)i.offset-=t.howMany;else if(s<=o)if(t.offset<i.offset){const r=s-i.offset;i.offset=t.offset,i.howMany-=r,t.nodesToHandle-=r}else i.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=i.offset)t.nodesToHandle-=i.howMany,i.howMany=0;else if(t.offset<o){const r=o-t.offset;i.howMany-=r,t.nodesToHandle-=r}}if(i.type=="remove"&&(s<=i.offset?i.offset-=t.howMany:t.offset<i.offset&&(t.nodesToHandle+=i.howMany,i.howMany=0)),i.type=="attribute"){if(s<=i.offset)i.offset-=t.howMany;else if(t.offset<i.offset){const r=s-i.offset;i.offset=t.offset,i.howMany-=r}else if(t.offset<o)if(s<=o){const r=i.howMany;i.howMany=t.offset-i.offset;const a=r-i.howMany-t.nodesToHandle;e.unshift({type:"attribute",offset:t.offset,howMany:a,count:this._changeCount++})}else i.howMany-=o-t.offset}}if(t.type=="attribute"){if(i.type=="insert")if(t.offset<i.offset&&s>i.offset){if(s>o){const r={type:"attribute",offset:o,howMany:s-o,count:this._changeCount++};this._handleChange(r,e),e.push(r)}t.nodesToHandle=i.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=i.offset&&t.offset<o&&(s>o?(t.nodesToHandle=s-o,t.offset=o):t.nodesToHandle=0);if(i.type=="remove"&&t.offset<i.offset&&s>i.offset){const r={type:"attribute",offset:i.offset,howMany:s-i.offset,count:this._changeCount++};this._handleChange(r,e),e.push(r),t.nodesToHandle=i.offset-t.offset,t.howMany=t.nodesToHandle}i.type=="attribute"&&(t.offset>=i.offset&&s<=o?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=i.offset&&s>=o&&(i.howMany=0))}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}_getInsertDiff(t,e,i,s,o){const r={type:"insert",position:M._createAt(t,e),name:s.name,attributes:new Map(s.attributes),length:1,changeCount:this._changeCount++,action:i};return i!="insert"&&o&&(r.before={name:o.name,attributes:new Map(o.attributes)}),r}_getRemoveDiff(t,e,i,s){return{type:"remove",action:i,position:M._createAt(t,e),name:s.name,attributes:new Map(s.attributes),length:1,changeCount:this._changeCount++}}_getAttributesDiff(t,e,i){const s=[];i=new Map(i);for(const[o,r]of e){const a=i.has(o)?i.get(o):null;a!==r&&s.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:o,attributeOldValue:r,attributeNewValue:a,changeCount:this._changeCount++}),i.delete(o)}for(const[o,r]of i)s.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:o,attributeOldValue:null,attributeNewValue:r,changeCount:this._changeCount++});return s}_isInInsertedElement(t){const e=t.parent;if(!e)return!1;const i=this._changesInElement.get(e),s=t.startOffset;if(i){for(const o of i)if(o.type=="insert"&&s>=o.offset&&s<o.offset+o.howMany)return!0}return this._isInInsertedElement(e)}_removeAllNestedChanges(t,e,i){const s=new I(M._createAt(t,e),M._createAt(t,e+i));for(const o of s.getItems({shallow:!0}))o.is("element")&&(this._changesInElement.delete(o),this._removeAllNestedChanges(o,0,o.maxOffset))}};h(rl,"_statesPriority",[void 0,"refresh","rename","move"]);let Um=rl;function e_(n){return{node:n,name:n.is("$text")?"$text":n.name,attributes:new Map(n.getAttributes())}}function t_(n){const t=[];for(const e of n)if(e.is("$text"))for(let i=0;i<e.data.length;++i)t.push(e_(e));else t.push(e_(e));return t}function wq(n,t){const e=[];let i=0,s=0;for(const o of t){if(o.offset>i){for(let r=0;r<o.offset-i;r++)e.push("e");s+=o.offset-i}if(o.type=="insert"){for(let r=0;r<o.howMany;r++)e.push("i");i=o.offset+o.howMany}else if(o.type=="remove"){for(let r=0;r<o.howMany;r++)e.push("r");i=o.offset,s+=o.howMany}else e.push(..."a".repeat(o.howMany).split("")),i=o.offset+o.howMany,s+=o.howMany}if(s<n)for(let o=0;o<n-s-i;o++)e.push("e");return e}function _q(n){const t="position"in n&&n.position.root.rootName=="$graveyard",e="range"in n&&n.range.root.rootName=="$graveyard";return!t&&!e}class vq{constructor(){h(this,"_operations",[]);h(this,"_undoPairs",new Map);h(this,"_undoneOperations",new Set);h(this,"_baseVersionToOperationIndex",new Map);h(this,"_version",0);h(this,"_gaps",new Map)}get version(){return this._version}set version(t){this._operations.length&&t>this._version+1&&this._gaps.set(this._version,t),this._version=t}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(t){if(t.baseVersion!==this.version)throw new C("model-document-history-addoperation-incorrect-version",this,{operation:t,historyVersion:this.version});this._operations.push(t),this._version++,this._baseVersionToOperationIndex.set(t.baseVersion,this._operations.length-1)}getOperations(t,e=this.version){if(!this._operations.length)return[];const i=this._operations[0];t===void 0&&(t=i.baseVersion);let s=e-1;for(const[a,l]of this._gaps)t>a&&t<l&&(t=l),s>a&&s<l&&(s=a-1);if(s<i.baseVersion||t>this.lastOperation.baseVersion)return[];let o=this._baseVersionToOperationIndex.get(t);o===void 0&&(o=0);let r=this._baseVersionToOperationIndex.get(s);return r===void 0&&(r=this._operations.length-1),this._operations.slice(o,r+1)}getOperation(t){const e=this._baseVersionToOperationIndex.get(t);if(e!==void 0)return this._operations[e]}setOperationAsUndone(t,e){this._undoPairs.set(e,t),this._undoneOperations.add(t)}isUndoingOperation(t){return this._undoPairs.has(t)}isUndoneOperation(t){return this._undoneOperations.has(t)}getUndoneOperation(t){return this._undoPairs.get(t)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}}class Qu extends Je{constructor(e,i,s="main"){super(i);h(this,"rootName");h(this,"_document");h(this,"_isAttached",!0);h(this,"_isLoaded",!0);this._document=e,this.rootName=s}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}}Qu.prototype.is=function(n,t){return t?t===this.name&&(n==="rootElement"||n==="model:rootElement"||n==="element"||n==="model:element"):n==="rootElement"||n==="model:rootElement"||n==="element"||n==="model:element"||n==="node"||n==="model:node"};const n_="$graveyard";class yq extends De(){constructor(e){super();h(this,"model");h(this,"history");h(this,"selection");h(this,"roots");h(this,"differ");h(this,"isReadOnly");h(this,"_postFixers");h(this,"_hasSelectionChangedFromTheLastChangeBlock");this.model=e,this.history=new vq,this.selection=new fi(this),this.roots=new rn({idProperty:"rootName"}),this.differ=new Um(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",n_),this.listenTo(e,"applyOperation",(i,s)=>{const o=s[0];o.isDocumentOperation&&this.differ.bufferOperation(o)},{priority:"high"}),this.listenTo(e,"applyOperation",(i,s)=>{const o=s[0];o.isDocumentOperation&&this.history.addOperation(o)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(i,s,o,r,a)=>{const l={...s.getData(),range:r};this.differ.bufferMarkerChange(s.name,a,l),o===null&&s.on("change",(c,u)=>{const d=s.getData();this.differ.bufferMarkerChange(s.name,{...d,range:u},d)})}),this.registerPostFixer(i=>{let s=!1;for(const o of this.roots)!o.isAttached()&&!o.isEmpty&&(i.remove(i.createRangeIn(o)),s=!0);for(const o of this.model.markers)o.getRange().root.isAttached()||(i.removeMarker(o),s=!0);return s})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(n_)}createRoot(e="$root",i="main"){if(this.roots.get(i))throw new C("model-document-createroot-name-exists",this,{name:i});const s=new Qu(this,e,i);return this.roots.add(s),s}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(i=>i.rootName)}getRoots(e=!1){return this.roots.filter(i=>i!=this.graveyard&&(e||i.isAttached())&&i._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=ah(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),i=this.model,s=i.schema,o=i.createPositionFromPath(e,[0]);return s.getNearestSelectionRange(o)||i.createRange(o)}_validateSelectionRange(e){return i_(e.start)&&i_(e.end)}_callPostFixers(e){let i=!1;do for(const s of this._postFixers)if(this.selection.refresh(),i=s(e),i)break;while(i)}}function i_(n){const t=n.textNode;if(t){const e=t.data,i=n.offset-t.startOffset;return!wb(e,i)&&!_b(e,i)}return!0}class Cq extends De(){constructor(){super(...arguments);h(this,"_markers",new Map)}[Symbol.iterator](){return this._markers.values()}has(e){const i=e instanceof hr?e.name:e;return this._markers.has(i)}get(e){return this._markers.get(e)||null}_set(e,i,s=!1,o=!1){const r=e instanceof hr?e.name:e;if(r.includes(","))throw new C("markercollection-incorrect-marker-name",this);const a=this._markers.get(r);if(a){const u=a.getData(),d=a.getRange();let f=!1;return d.isEqual(i)||(a._attachLiveRange(hn.fromRange(i)),f=!0),s!=a.managedUsingOperations&&(a._managedUsingOperations=s,f=!0),typeof o=="boolean"&&o!=a.affectsData&&(a._affectsData=o,f=!0),f&&this.fire(`update:${r}`,a,d,i,u),a}const l=hn.fromRange(i),c=new hr(r,l,s,o);return this._markers.set(r,c),this.fire(`update:${r}`,c,null,i,{...c.getData(),range:null}),c}_remove(e){const i=e instanceof hr?e.name:e,s=this._markers.get(i);return s?(this._markers.delete(i),this.fire(`update:${i}`,s,s.getRange(),null,s.getData()),this._destroyMarker(s),!0):!1}_refresh(e){const i=e instanceof hr?e.name:e,s=this._markers.get(i);if(!s)throw new C("markercollection-refresh-marker-not-exists",this);const o=s.getRange();this.fire(`update:${i}`,s,o,o,s.getData())}*getMarkersAtPosition(e){for(const i of this)i.getRange().containsPosition(e)&&(yield i)}*getMarkersIntersectingRange(e){for(const i of this)i.getRange().getIntersection(e)!==null&&(yield i)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const i of this._markers.values())i.name.startsWith(e+":")&&(yield i)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}class hr extends De(Ys){constructor(e,i,s,o){super();h(this,"name");h(this,"_managedUsingOperations");h(this,"_affectsData");h(this,"_liveRange");this.name=e,this._liveRange=this._attachLiveRange(i),this._managedUsingOperations=s,this._affectsData=o}get managedUsingOperations(){if(!this._liveRange)throw new C("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new C("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new C("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new C("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new C("marker-destroyed",this);return this._liveRange.toRange()}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}hr.prototype.is=function(n){return n==="marker"||n==="model:marker"};class kq extends $n{constructor(e,i){super(null);h(this,"sourcePosition");h(this,"howMany");this.sourcePosition=e.clone(),this.howMany=i}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new C("detach-operation-on-document-node",this)}_execute(){j5(I._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class Wi extends Ys{constructor(e){super();h(this,"markers",new Map);h(this,"_children",new Ja);e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let i=this;for(const s of e)i=i.getChild(i.offsetToIndex(s));return i}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const i of this._children)e.push(i.toJSON());return e}static fromJSON(e){const i=[];for(const s of e)s.name?i.push(Je.fromJSON(s)):i.push(He.fromJSON(s));return new Wi(i)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,i){const s=Tq(i);for(const o of s)o.parent!==null&&o._remove(),o.parent=this;this._children._insertNodes(e,s)}_removeChildren(e,i=1){const s=this._children._removeNodes(e,i);for(const o of s)o.parent=null;return s}}Wi.prototype.is=function(n){return n==="documentFragment"||n==="model:documentFragment"};function Tq(n){return typeof n=="string"?[new He(n)]:(Dn(n)||(n=[n]),Array.from(n).map(t=>typeof t=="string"?new He(t):t instanceof li?new He(t.data,t.getAttributes()):t))}class Eq{constructor(t,e){h(this,"model");h(this,"batch");this.model=t,this.batch=e}createText(t,e){return new He(t,e)}createElement(t,e){return new Je(t,e)}createDocumentFragment(){return new Wi}cloneElement(t,e=!0){return t._clone(e)}insert(t,e,i=0){if(this._assertWriterUsedCorrectly(),t instanceof He&&t.data=="")return;const s=M._createAt(e,i);if(t.parent)if(r_(t.root,s.root)){this.move(I._createOn(t),s);return}else{if(t.root.document)throw new C("model-writer-insert-forbidden-move",this);this.remove(t)}const o=s.root.document?s.root.document.version:null,r=new Vt(s,t,o);if(t instanceof He&&(r.shouldReceiveAttributes=!0),this.batch.addOperation(r),this.model.applyOperation(r),t instanceof Wi)for(const[a,l]of t.markers){const c=M._createAt(l.root,0),d={range:new I(l.start._getCombined(c,s),l.end._getCombined(c,s)),usingOperation:!0,affectsData:!0};this.model.markers.has(a)?this.updateMarker(a,d):this.addMarker(a,d)}}insertText(t,e,i,s){e instanceof Wi||e instanceof Je||e instanceof M?this.insert(this.createText(t),e,i):this.insert(this.createText(t,e),i,s)}insertElement(t,e,i,s){e instanceof Wi||e instanceof Je||e instanceof M?this.insert(this.createElement(t),e,i):this.insert(this.createElement(t,e),i,s)}append(t,e){this.insert(t,e,"end")}appendText(t,e,i){e instanceof Wi||e instanceof Je?this.insert(this.createText(t),e,"end"):this.insert(this.createText(t,e),i,"end")}appendElement(t,e,i){e instanceof Wi||e instanceof Je?this.insert(this.createElement(t),e,"end"):this.insert(this.createElement(t,e),i,"end")}setAttribute(t,e,i){if(this._assertWriterUsedCorrectly(),i instanceof I){const s=i.getMinimalFlatRanges();for(const o of s)s_(this,t,e,o)}else o_(this,t,e,i)}setAttributes(t,e){for(const[i,s]of Ii(t))this.setAttribute(i,s,e)}removeAttribute(t,e){if(this._assertWriterUsedCorrectly(),e instanceof I){const i=e.getMinimalFlatRanges();for(const s of i)s_(this,t,null,s)}else o_(this,t,null,e)}clearAttributes(t){this._assertWriterUsedCorrectly();const e=i=>{for(const s of i.getAttributeKeys())this.removeAttribute(s,i)};if(!(t instanceof I))e(t);else for(const i of t.getItems())e(i)}move(t,e,i){if(this._assertWriterUsedCorrectly(),!(t instanceof I))throw new C("writer-move-invalid-range",this);if(!t.isFlat)throw new C("writer-move-range-not-flat",this);const s=M._createAt(e,i);if(s.isEqual(t.start))return;if(this._addOperationForAffectedMarkers("move",t),!r_(t.root,s.root))throw new C("writer-move-different-document",this);const o=t.root.document?t.root.document.version:null,r=new Ie(t.start,t.end.offset-t.start.offset,s,o);this.batch.addOperation(r),this.model.applyOperation(r)}remove(t){this._assertWriterUsedCorrectly();const i=(t instanceof I?t:I._createOn(t)).getMinimalFlatRanges().reverse();for(const s of i)this._addOperationForAffectedMarkers("move",s),Aq(s.start,s.end.offset-s.start.offset,this.batch,this.model)}merge(t){this._assertWriterUsedCorrectly();const e=t.nodeBefore,i=t.nodeAfter;if(this._addOperationForAffectedMarkers("merge",t),!(e instanceof Je))throw new C("writer-merge-no-element-before",this);if(!(i instanceof Je))throw new C("writer-merge-no-element-after",this);t.root.document?this._merge(t):this._mergeDetached(t)}createPositionFromPath(t,e,i){return this.model.createPositionFromPath(t,e,i)}createPositionAt(t,e){return this.model.createPositionAt(t,e)}createPositionAfter(t){return this.model.createPositionAfter(t)}createPositionBefore(t){return this.model.createPositionBefore(t)}createRange(t,e){return this.model.createRange(t,e)}createRangeIn(t){return this.model.createRangeIn(t)}createRangeOn(t){return this.model.createRangeOn(t)}createSelection(...t){return this.model.createSelection(...t)}_mergeDetached(t){const e=t.nodeBefore,i=t.nodeAfter;this.move(I._createIn(i),M._createAt(e,"end")),this.remove(i)}_merge(t){const e=M._createAt(t.nodeBefore,"end"),i=M._createAt(t.nodeAfter,0),s=t.root.document.graveyard,o=new M(s,[0]),r=t.root.document.version,a=new lt(i,t.nodeAfter.maxOffset,e,o,r);this.batch.addOperation(a),this.model.applyOperation(a)}rename(t,e){if(this._assertWriterUsedCorrectly(),!(t instanceof Je))throw new C("writer-rename-not-element-instance",this);const i=t.root.document?t.root.document.version:null,s=new pn(M._createBefore(t),t.name,e,i);this.batch.addOperation(s),this.model.applyOperation(s)}split(t,e){this._assertWriterUsedCorrectly();let i=t.parent;if(!i.parent)throw new C("writer-split-element-no-parent",this);if(e||(e=i.parent),!t.parent.getAncestors({includeSelf:!0}).includes(e))throw new C("writer-split-invalid-limit-element",this);let s,o;do{const r=i.root.document?i.root.document.version:null,a=i.maxOffset-t.offset,l=ze.getInsertionPosition(t),c=new ze(t,a,l,null,r);this.batch.addOperation(c),this.model.applyOperation(c),!s&&!o&&(s=i,o=t.parent.nextSibling),t=this.createPositionAfter(t.parent),i=t.parent}while(i!==e);return{position:t,range:new I(M._createAt(s,"end"),M._createAt(o,0))}}wrap(t,e){if(this._assertWriterUsedCorrectly(),!t.isFlat)throw new C("writer-wrap-range-not-flat",this);const i=e instanceof Je?e:new Je(e);if(i.childCount>0)throw new C("writer-wrap-element-not-empty",this);if(i.parent!==null)throw new C("writer-wrap-element-attached",this);this.insert(i,t.start);const s=new I(t.start.getShiftedBy(1),t.end.getShiftedBy(1));this.move(s,M._createAt(i,0))}unwrap(t){if(this._assertWriterUsedCorrectly(),t.parent===null)throw new C("writer-unwrap-element-no-parent",this);this.move(I._createIn(t),this.createPositionAfter(t)),this.remove(t)}addMarker(t,e){if(this._assertWriterUsedCorrectly(),!e||typeof e.usingOperation!="boolean")throw new C("writer-addmarker-no-usingoperation",this);const i=e.usingOperation,s=e.range,o=e.affectsData===void 0?!1:e.affectsData;if(this.model.markers.has(t))throw new C("writer-addmarker-marker-exists",this);if(!s)throw new C("writer-addmarker-no-range",this);return i?(Ca(this,t,null,s,o),this.model.markers.get(t)):this.model.markers._set(t,s,i,o)}updateMarker(t,e){this._assertWriterUsedCorrectly();const i=typeof t=="string"?t:t.name,s=this.model.markers.get(i);if(!s)throw new C("writer-updatemarker-marker-not-exists",this);if(!e){Te("writer-updatemarker-reconvert-using-editingcontroller",{markerName:i}),this.model.markers._refresh(s);return}const o=typeof e.usingOperation=="boolean",r=typeof e.affectsData=="boolean",a=r?e.affectsData:s.affectsData;if(!o&&!e.range&&!r)throw new C("writer-updatemarker-wrong-options",this);const l=s.getRange(),c=e.range?e.range:l;if(o&&e.usingOperation!==s.managedUsingOperations){e.usingOperation?Ca(this,i,null,c,a):(Ca(this,i,l,null,a),this.model.markers._set(i,c,void 0,a));return}s.managedUsingOperations?Ca(this,i,l,c,a):this.model.markers._set(i,c,void 0,a)}removeMarker(t){this._assertWriterUsedCorrectly();const e=typeof t=="string"?t:t.name;if(!this.model.markers.has(e))throw new C("writer-removemarker-no-marker",this);const i=this.model.markers.get(e);if(!i.managedUsingOperations){this.model.markers._remove(e);return}const s=i.getRange();Ca(this,e,s,null,i.affectsData)}addRoot(t,e="$root"){this._assertWriterUsedCorrectly();const i=this.model.document.getRoot(t);if(i&&i.isAttached())throw new C("writer-addroot-root-exists",this);const s=this.model.document,o=new Ei(t,e,!0,s,s.version);return this.batch.addOperation(o),this.model.applyOperation(o),this.model.document.getRoot(t)}detachRoot(t){this._assertWriterUsedCorrectly();const e=typeof t=="string"?this.model.document.getRoot(t):t;if(!e||!e.isAttached())throw new C("writer-detachroot-no-root",this);for(const o of this.model.markers)o.getRange().root===e&&this.removeMarker(o);for(const o of e.getAttributeKeys())this.removeAttribute(o,e);this.remove(this.createRangeIn(e));const i=this.model.document,s=new Ei(e.rootName,e.name,!1,i,i.version);this.batch.addOperation(s),this.model.applyOperation(s)}setSelection(...t){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...t)}setSelectionFocus(t,e){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(t,e)}setSelectionAttribute(t,e){if(this._assertWriterUsedCorrectly(),typeof t=="string")this._setSelectionAttribute(t,e);else for(const[i,s]of Ii(t))this._setSelectionAttribute(i,s)}removeSelectionAttribute(t){if(this._assertWriterUsedCorrectly(),typeof t=="string")this._removeSelectionAttribute(t);else for(const e of t)this._removeSelectionAttribute(e)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(t){this.model.document.selection._restoreGravity(t)}_setSelectionAttribute(t,e){const i=this.model.document.selection;if(i.isCollapsed&&i.anchor.parent.isEmpty){const s=fi._getStoreAttributeKey(t);this.setAttribute(s,e,i.anchor.parent)}i._setAttribute(t,e)}_removeSelectionAttribute(t){const e=this.model.document.selection;if(e.isCollapsed&&e.anchor.parent.isEmpty){const i=fi._getStoreAttributeKey(t);this.removeAttribute(i,e.anchor.parent)}e._removeAttribute(t)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new C("writer-incorrect-use",this)}_addOperationForAffectedMarkers(t,e){for(const i of this.model.markers){if(!i.managedUsingOperations)continue;const s=i.getRange();let o=!1;if(t==="move"){const r=e;o=r.containsPosition(s.start)||r.start.isEqual(s.start)||r.containsPosition(s.end)||r.end.isEqual(s.end)}else{const r=e,a=r.nodeBefore,l=r.nodeAfter,c=s.start.parent==a&&s.start.isAtEnd,u=s.end.parent==l&&s.end.offset==0,d=s.end.nodeAfter==l,f=s.start.nodeAfter==l;o=c||u||d||f}o&&this.updateMarker(i.name,{range:s})}}}function s_(n,t,e,i){const s=n.model,o=s.document;let r=i.start,a,l,c;for(const d of i.getWalker({shallow:!0}))c=d.item.getAttribute(t),a&&l!=c&&(l!=e&&u(),r=a),a=d.nextPosition,l=c;a instanceof M&&a!=r&&l!=e&&u();function u(){const d=new I(r,a),f=d.root.document?o.version:null,m=new mt(d,t,l,e,f);n.batch.addOperation(m),s.applyOperation(m)}}function o_(n,t,e,i){const s=n.model,o=s.document,r=i.getAttribute(t);let a,l;if(r!=e){if(i.root===i){const u=i.document?o.version:null;l=new Ji(i,t,r,e,u)}else{a=new I(M._createBefore(i),n.createPositionAfter(i));const u=a.root.document?o.version:null;l=new mt(a,t,r,e,u)}n.batch.addOperation(l),s.applyOperation(l)}}function Ca(n,t,e,i,s){const o=n.model,r=o.document,a=new gn(t,e,i,o.markers,!!s,r.version);n.batch.addOperation(a),o.applyOperation(a)}function Aq(n,t,e,i){let s;if(n.root.document){const o=i.document,r=new M(o.graveyard,[0]);s=new Ie(n,t,r,o.version)}else s=new kq(n,t);e.addOperation(s),i.applyOperation(s)}function r_(n,t){return n===t||n instanceof Qu&&t instanceof Qu}function xq(n,t,e={}){if(t.isCollapsed)return;const i=t.getFirstRange();if(i.root.rootName=="$graveyard")return;const s=n.schema;n.change(o=>{if(!e.doNotResetEntireContent&&Oq(s,t)){Mq(o,t);return}const r={};if(!e.doNotAutoparagraph){const c=t.getSelectedElement();c&&Object.assign(r,s.getAttributesWithProperty(c,"copyOnReplace",!0))}const[a,l]=Sq(i);a.isTouching(l)||o.remove(o.createRange(a,l)),e.leaveUnmerged||(Pq(o,a,l),s.removeDisallowedAttributes(a.parent.getChildren(),o)),Q5(o,t,a),!e.doNotAutoparagraph&&Vq(s,a)&&X5(o,a,t,r),a.detach(),l.detach()})}function Sq(n){const t=n.root.document.model,e=n.start;let i=n.end;if(t.hasContent(n,{ignoreMarkers:!0})){const s=Iq(i);if(s&&i.isTouching(t.createPositionAt(s,0))){const o=t.createSelection(n);t.modifySelection(o,{direction:"backward"});const r=o.getLastPosition(),a=t.createRange(r,i);t.hasContent(a,{ignoreMarkers:!0})||(i=r)}}return[bt.fromPosition(e,"toPrevious"),bt.fromPosition(i,"toNext")]}function Iq(n){const t=n.parent,e=t.root.document.model.schema,i=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const s of i){if(e.isLimit(s))return null;if(e.isBlock(s))return s}}function Pq(n,t,e){const i=n.model;if(!Pb(n.model.schema,t,e))return;const[s,o]=Lq(t,e);!s||!o||(!i.hasContent(s,{ignoreMarkers:!0})&&i.hasContent(o,{ignoreMarkers:!0})?Y5(n,t,e,s.parent):J5(n,t,e,s.parent))}function J5(n,t,e,i){const s=t.parent,o=e.parent;if(!(s==i||o==i)){for(t=n.createPositionAfter(s),e=n.createPositionBefore(o),e.isEqual(t)||n.insert(o,t),n.merge(t);e.parent.isEmpty;){const r=e.parent;e=n.createPositionBefore(r),n.remove(r)}Pb(n.model.schema,t,e)&&J5(n,t,e,i)}}function Y5(n,t,e,i){const s=t.parent,o=e.parent;if(!(s==i||o==i)){for(t=n.createPositionAfter(s),e=n.createPositionBefore(o),e.isEqual(t)||n.insert(s,e);t.parent.isEmpty;){const r=t.parent;t=n.createPositionBefore(r),n.remove(r)}e=n.createPositionBefore(o),Rq(n,e),Pb(n.model.schema,t,e)&&Y5(n,t,e,i)}}function Rq(n,t){const e=t.nodeBefore,i=t.nodeAfter;e.name!=i.name&&n.rename(e,i.name),n.clearAttributes(e),n.setAttributes(Object.fromEntries(i.getAttributes()),e),n.merge(t)}function Pb(n,t,e){const i=t.parent,s=e.parent;return i==s||n.isLimit(i)||n.isLimit(s)?!1:Bq(t,e,n)}function Lq(n,t){const e=n.getAncestors(),i=t.getAncestors();let s=0;for(;e[s]&&e[s]==i[s];)s++;return[e[s],i[s]]}function Vq(n,t){const e=n.checkChild(t,"$text"),i=n.checkChild(t,"paragraph");return!e&&i}function Bq(n,t,e){const i=new I(n,t);for(const s of i.getWalker())if(e.isLimit(s.item))return!1;return!0}function X5(n,t,e,i={}){const s=n.createElement("paragraph");n.model.schema.setAllowedAttributes(s,i,n),n.insert(s,t),Q5(n,e,n.createPositionAt(s,0))}function Mq(n,t){const e=n.model.schema.getLimitElement(t);n.remove(n.createRangeIn(e)),X5(n,n.createPositionAt(e,0),t)}function Oq(n,t){const e=n.getLimitElement(t);if(!t.containsEntireContent(e))return!1;const i=t.getFirstRange();return i.start.parent==i.end.parent?!1:n.checkChild(e,"paragraph")}function Q5(n,t,e){t instanceof fi?n.setSelection(e):t.setTo(e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Nq(n,t){return n.change(e=>{const i=e.createDocumentFragment(),s=t.getFirstRange();if(!s||s.isCollapsed)return i;const o=s.start.root,r=s.start.getCommonPath(s.end),a=o.getNodeByPath(r);let l;s.start.parent==s.end.parent?l=s:l=e.createRange(e.createPositionAt(a,s.start.path[r.length]),e.createPositionAt(a,s.end.path[r.length]+1));const c=l.end.offset-l.start.offset;for(const u of l.getItems({shallow:!0}))u.is("$textProxy")?e.appendText(u.data,u.getAttributes(),i):e.append(e.cloneElement(u,!0),i);if(l!=s){const u=s._getTransformedByMove(l.start,e.createPositionAt(i,0),c)[0],d=e.createRange(e.createPositionAt(i,0),u.start),f=e.createRange(u.end,e.createPositionAt(i,"end"));a_(f,e),a_(d,e)}return i})}function a_(n,t){const e=[];Array.from(n.getItems({direction:"backward"})).map(i=>t.createRangeOn(i)).filter(i=>(i.start.isAfter(n.start)||i.start.isEqual(n.start))&&(i.end.isBefore(n.end)||i.end.isEqual(n.end))).forEach(i=>{e.push(i.start.parent),t.remove(i)}),e.forEach(i=>{let s=i;for(;s.parent&&s.isEmpty;){const o=t.createRangeOn(s);s=s.parent,t.remove(o)}})}function Fq(n,t,e){return n.change(i=>{const s=e||n.document.selection;s.isCollapsed||n.deleteContent(s,{doNotAutoparagraph:!0});const o=new Dq(n,i,s.anchor),r=[];let a;if(t.is("documentFragment")){if(t.markers.size){const u=[];for(const[d,f]of t.markers){const{start:m,end:g}=f,p=m.isEqual(g);u.push({position:m,name:d,isCollapsed:p},{position:g,name:d,isCollapsed:p})}u.sort(({position:d},{position:f})=>d.isBefore(f)?1:-1);for(const{position:d,name:f,isCollapsed:m}of u){let g=null,p=null;const w=d.parent===t&&d.isAtStart,v=d.parent===t&&d.isAtEnd;!w&&!v?(g=i.createElement("$marker"),i.insert(g,d)):m&&(p=w?"start":"end"),r.push({name:f,element:g,collapsed:p})}}a=t.getChildren()}else a=[t];o.handleNodes(a);let l=o.getSelectionRange();if(t.is("documentFragment")&&r.length){const u=l?hn.fromRange(l):null,d={};for(let f=r.length-1;f>=0;f--){const{name:m,element:g,collapsed:p}=r[f],w=!d[m];if(w&&(d[m]=[]),g){const v=i.createPositionAt(g,"before");d[m].push(v),i.remove(g)}else{const v=o.getAffectedRange();if(!v){p&&d[m].push(o.position);continue}p?d[m].push(v[p]):d[m].push(w?v.start:v.end)}}for(const[f,[m,g]]of Object.entries(d))m&&g&&m.root===g.root&&m.root.document&&!i.model.markers.has(f)&&i.addMarker(f,{usingOperation:!0,affectsData:!0,range:new I(m,g)});u&&(l=u.toRange(),u.detach())}/* istanbul ignore else -- @preserve */l&&(s instanceof fi?i.setSelection(l):s.setTo(l));const c=o.getAffectedRange()||n.createRange(s.anchor);return o.destroy(),c})}class Dq{constructor(t,e,i){h(this,"model");h(this,"writer");h(this,"position");h(this,"canMergeWith");h(this,"schema");h(this,"_documentFragment");h(this,"_documentFragmentPosition");h(this,"_firstNode",null);h(this,"_lastNode",null);h(this,"_lastAutoParagraph",null);h(this,"_filterAttributesOf",[]);h(this,"_affectedStart",null);h(this,"_affectedEnd",null);h(this,"_nodeToSelect",null);this.model=t,this.writer=e,this.position=i,this.canMergeWith=new Set([this.position.parent]),this.schema=t.schema,this._documentFragment=e.createDocumentFragment(),this._documentFragmentPosition=e.createPositionAt(this._documentFragment,0)}handleNodes(t){for(const e of Array.from(t))this._handleNode(e);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(t){const e=this.writer.createPositionAfter(this._lastNode),i=this.writer.createPositionAfter(t);if(i.isAfter(e)){this._lastNode=t;/* istanbul ignore if -- @preserve */if(this.position.parent!=t||!this.position.isAtEnd)throw new C("insertcontent-invalid-insertion-position",this);this.position=i,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?I._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new I(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(t){if(this.schema.isObject(t)){this._handleObject(t);return}let e=this._checkAndAutoParagraphToAllowedPosition(t);if(!e&&(e=this._checkAndSplitToAllowedPosition(t),!e)){this._handleDisallowedNode(t);return}this._appendToFragment(t),this._firstNode||(this._firstNode=t),this._lastNode=t}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const t=bt.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=t.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=t.toPosition(),t.detach()}_handleObject(t){this._checkAndSplitToAllowedPosition(t)?this._appendToFragment(t):this._tryAutoparagraphing(t)}_handleDisallowedNode(t){t.is("element")?this.handleNodes(t.getChildren()):this._tryAutoparagraphing(t)}_appendToFragment(t){/* istanbul ignore if -- @preserve */if(!this.schema.checkChild(this.position,t))throw new C("insertcontent-wrong-position",this,{node:t,position:this.position});this.writer.insert(t,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(t.offsetSize),this.schema.isObject(t)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=t:this._nodeToSelect=null,this._filterAttributesOf.push(t)}_setAffectedBoundaries(t){this._affectedStart||(this._affectedStart=bt.fromPosition(t,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(t))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=bt.fromPosition(t,"toNext"))}_mergeOnLeft(){const t=this._firstNode;if(!(t instanceof Je)||!this._canMergeLeft(t))return;const e=bt._createBefore(t);e.stickiness="toNext";const i=bt.fromPosition(this.position,"toNext");this._affectedStart.isEqual(e)&&(this._affectedStart.detach(),this._affectedStart=bt._createAt(e.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=e.nodeBefore,this._lastNode=e.nodeBefore),this.writer.merge(e),e.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=bt._createAt(e.nodeBefore,"end","toNext")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),e.detach()}_mergeOnRight(){const t=this._lastNode;if(!(t instanceof Je)||!this._canMergeRight(t))return;const e=bt._createAfter(t);e.stickiness="toNext";/* istanbul ignore if -- @preserve */if(!this.position.isEqual(e))throw new C("insertcontent-invalid-insertion-position",this);this.position=M._createAt(e.nodeBefore,"end");const i=bt.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(e)&&(this._affectedEnd.detach(),this._affectedEnd=bt._createAt(e.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=e.nodeBefore,this._lastNode=e.nodeBefore),this.writer.merge(e),e.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=bt._createAt(e.nodeBefore,0,"toPrevious")),this.position=i.toPosition(),i.detach(),this._filterAttributesOf.push(this.position.parent),e.detach()}_canMergeLeft(t){const e=t.previousSibling;return e instanceof Je&&this.canMergeWith.has(e)&&this.model.schema.checkMerge(e,t)}_canMergeRight(t){const e=t.nextSibling;return e instanceof Je&&this.canMergeWith.has(e)&&this.model.schema.checkMerge(t,e)}_tryAutoparagraphing(t){const e=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,e)&&this.schema.checkChild(e,t)&&(e._appendChild(t),this._handleNode(e))}_checkAndAutoParagraphToAllowedPosition(t){if(this.schema.checkChild(this.position.parent,t))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",t))return!1;this._insertPartialFragment();const e=this.writer.createElement("paragraph");return this.writer.insert(e,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=e,this.position=this.writer.createPositionAt(e,0),!0}_checkAndSplitToAllowedPosition(t){const e=this._getAllowedIn(this.position.parent,t);if(!e)return!1;for(e!=this.position.parent&&this._insertPartialFragment();e!=this.position.parent;)if(this.position.isAtStart){const i=this.position.parent;this.position=this.writer.createPositionBefore(i),i.isEmpty&&i.parent===e&&this.writer.remove(i)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const i=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=i,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(t,e){return this.schema.checkChild(t,e)?t:this.schema.isLimit(t)?null:this._getAllowedIn(t.parent,e)}}function $q(n,t,e,i={}){if(!n.schema.isObject(t))throw new C("insertobject-element-not-an-object",n,{object:t});const s=e||n.document.selection;let o=s;i.findOptimalPosition&&n.schema.isBlock(t)&&(o=n.createSelection(n.schema.findOptimalInsertionRange(s,i.findOptimalPosition)));const r=Ye(s.getSelectedBlocks()),a={};return r&&Object.assign(a,n.schema.getAttributesWithProperty(r,"copyOnReplace",!0)),n.change(l=>{o.isCollapsed||n.deleteContent(o,{doNotAutoparagraph:!0});let c=t;const u=o.anchor.parent;!n.schema.checkChild(u,t)&&n.schema.checkChild(u,"paragraph")&&n.schema.checkChild("paragraph",t)&&(c=l.createElement("paragraph"),l.insert(t,c)),n.schema.setAllowedAttributes(c,a,l);const d=n.insertContent(c,o);return d.isCollapsed||i.setSelection&&Hq(l,t,i.setSelection,a),d})}function Hq(n,t,e,i){const s=n.model;if(e=="on"){n.setSelection(t,"on");return}if(e!="after")throw new C("insertobject-invalid-place-parameter-value",s);let o=t.nextSibling;if(s.schema.isInline(t)){n.setSelection(t,"after");return}!(o&&s.schema.checkChild(o,"$text"))&&s.schema.checkChild(t.parent,"paragraph")&&(o=n.createElement("paragraph"),s.schema.setAllowedAttributes(o,i,n),s.insertContent(o,n.createPositionAfter(t))),o&&n.setSelection(o,0)}const zq=' ,.?!:;"-()';function Uq(n,t,e={}){const i=n.schema,s=e.direction!="backward",o=e.unit?e.unit:"character",r=!!e.treatEmojiAsSingleUnit,a=t.focus,l=new ji({boundaries:Gq(a,s),singleCharacters:!0,direction:s?"forward":"backward"}),c={walker:l,schema:i,isForward:s,unit:o,treatEmojiAsSingleUnit:r};let u;for(;u=l.next();){if(u.done)return;const d=Wq(c,u.value);if(d){t instanceof fi?n.change(f=>{f.setSelectionFocus(d)}):t.setFocus(d);return}}}function Wq(n,t){const{isForward:e,walker:i,unit:s,schema:o,treatEmojiAsSingleUnit:r}=n,{type:a,item:l,nextPosition:c}=t;if(a=="text")return n.unit==="word"?jq(i,e):qq(i,s,r);if(a==(e?"elementStart":"elementEnd")){if(o.isSelectable(l))return M._createAt(l,e?"after":"before");if(o.checkChild(c,"$text"))return c}else{if(o.isLimit(l)){i.skip(()=>!0);return}if(o.checkChild(c,"$text"))return c}}function qq(n,t,e){const i=n.position.textNode;if(i){const s=i.data;let o=n.position.offset-i.startOffset;for(;wb(s,o)||t=="character"&&_b(s,o)||e&&h5(s,o);)n.next(),o=n.position.offset-i.startOffset}return n.position}function jq(n,t){let e=n.position.textNode;for(e||(e=t?n.position.nodeAfter:n.position.nodeBefore);e&&e.is("$text");){const i=n.position.offset-e.startOffset;if(Zq(e,i,t))e=t?n.position.nodeAfter:n.position.nodeBefore;else{if(Kq(e.data,i,t))break;n.next()}}return n.position}function Gq(n,t){const e=n.root,i=M._createAt(e,t?"end":0);return t?new I(n,i):new I(i,n)}function Kq(n,t,e){const i=t+(e?0:-1);return zq.includes(n.charAt(i))}function Zq(n,t,e){return t===(e?n.offsetSize:0)}let Jq=class extends Ve(){constructor(){super();h(this,"markers");h(this,"document");h(this,"schema");h(this,"_pendingChanges");h(this,"_currentWriter");this.markers=new Cq,this.document=new yq(this),this.schema=new DW,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,i)=>{i[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck((e,i)=>{if(i.name==="$marker")return!0}),PW(this),this.document.registerPostFixer(D5),this.on("insertContent",(e,[i,s])=>{e.return=Fq(this,i,s)}),this.on("insertObject",(e,[i,s,o])=>{e.return=$q(this,i,s,o)}),this.on("canEditAt",e=>{const i=!this.document.isReadOnly;e.return=i,i||e.stop()})}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new tr,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(i){/* istanbul ignore next -- @preserve */C.rethrowUnexpectedError(i,this)}}enqueueChange(e,i){try{e?typeof e=="function"?(i=e,e=new tr):e instanceof tr||(e=new tr(e)):e=new tr,this._pendingChanges.push({batch:e,callback:i}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(s){/* istanbul ignore next -- @preserve */C.rethrowUnexpectedError(s,this)}}applyOperation(e){e._execute()}insertContent(e,i,s,...o){const r=vf(i,s);return this.fire("insertContent",[e,r,s,...o])}insertObject(e,i,s,o,...r){const a=vf(i,s);return this.fire("insertObject",[e,a,o,o,...r])}deleteContent(e,i){xq(this,e,i)}modifySelection(e,i){Uq(this,e,i)}getSelectedContent(e){return Nq(this,e)}hasContent(e,i={}){const s=e instanceof I?e:I._createIn(e);if(s.isCollapsed)return!1;const{ignoreWhitespaces:o=!1,ignoreMarkers:r=!1}=i;if(!r){for(const a of this.markers.getMarkersIntersectingRange(s))if(a.affectsData)return!0}for(const a of s.getItems())if(this.schema.isContent(a))if(a.is("$textProxy"))if(o){if(a.data.search(/\S/)!==-1)return!0}else return!0;else return!0;return!1}canEditAt(e){const i=vf(e);return this.fire("canEditAt",[i])}createPositionFromPath(e,i,s){return new M(e,i,s)}createPositionAt(e,i){return M._createAt(e,i)}createPositionAfter(e){return M._createAfter(e)}createPositionBefore(e){return M._createBefore(e)}createRange(e,i){return new I(e,i)}createRangeIn(e){return I._createIn(e)}createRangeOn(e){return I._createOn(e)}createSelection(...e){return new In(...e)}createBatch(e){return new tr(e)}createOperationFromJSON(e){return uq.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const i=this._pendingChanges[0].batch;this._currentWriter=new Eq(this,i);const s=this._pendingChanges[0].callback(this._currentWriter);e.push(s),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}};function vf(n,t){if(n)return n instanceof In||n instanceof fi?n:n instanceof Uo?t||t===0?new In(n,t):n.is("rootElement")?new In(n,"in"):new In(n,"on"):new In(n)}class Yq extends fs{constructor(){super(...arguments);h(this,"domEventType","click")}onDomEvent(e){this.fire(e.type,e)}}class Ph extends fs{constructor(){super(...arguments);h(this,"domEventType",["mousedown","mouseup","mouseover","mouseout"])}onDomEvent(e){this.fire(e.type,e)}}class zn{constructor(t){h(this,"document");this.document=t}createDocumentFragment(t){return new _o(this.document,t)}createElement(t,e,i){return new hi(this.document,t,e,i)}createText(t){return new et(this.document,t)}clone(t,e=!1){return t._clone(e)}appendChild(t,e){return e._appendChild(t)}insertChild(t,e,i){return i._insertChild(t,e)}removeChildren(t,e,i){return i._removeChildren(t,e)}remove(t){const e=t.parent;return e?this.removeChildren(e.getChildIndex(t),1,e):[]}replace(t,e){const i=t.parent;if(i){const s=i.getChildIndex(t);return this.removeChildren(s,1,i),this.insertChild(s,e,i),!0}return!1}unwrapElement(t){const e=t.parent;if(e){const i=e.getChildIndex(t);this.remove(t),this.insertChild(i,t.getChildren(),e)}}rename(t,e){const i=new hi(this.document,t,e.getAttributes(),e.getChildren());return this.replace(e,i)?i:null}setAttribute(t,e,i){i._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,i){Rt(t)&&i===void 0?e._setStyle(t):i._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,i){i._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}createPositionAt(t,e){return W._createAt(t,e)}createPositionAfter(t){return W._createAfter(t)}createPositionBefore(t){return W._createBefore(t)}createRange(t,e){return new we(t,e)}createRangeOn(t){return we._createOn(t)}createRangeIn(t){return we._createIn(t)}createSelection(...t){return new Zi(...t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Xq=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,Qq=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,ej=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,tj=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,nj=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,ij=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,sj=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function eI(n){return n.startsWith("#")?Xq.test(n):n.startsWith("rgb")?Qq.test(n)||ej.test(n):n.startsWith("hsl")?tj.test(n)||nj.test(n):sj.has(n.toLowerCase())}const oj=["none","hidden","dotted","dashed","solid","double","groove","ridge","inset","outset"];function rj(n){return oj.includes(n)}const aj=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function Rb(n){return aj.test(n)}const lj=/^[+-]?[0-9]*([.][0-9]+)?%$/;function cj(n){return lj.test(n)}const uj=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function dj(n){return uj.includes(n)}const hj=["center","top","bottom","left","right"];function fj(n){return hj.includes(n)}const mj=["fixed","scroll","local"];function gj(n){return mj.includes(n)}const pj=/^url\(/;function bj(n){return pj.test(n)}function Qa(n=""){if(n==="")return{top:void 0,right:void 0,bottom:void 0,left:void 0};const t=Lb(n),e=t[0],i=t[2]||e,s=t[1]||e,o=t[3]||s;return{top:e,bottom:i,right:s,left:o}}function el(n){return t=>{const{top:e,right:i,bottom:s,left:o}=t,r=[];return[e,i,o,s].every(a=>!!a)?r.push([n,wj(t)]):(e&&r.push([n+"-top",e]),i&&r.push([n+"-right",i]),s&&r.push([n+"-bottom",s]),o&&r.push([n+"-left",o])),r}}function wj({top:n,right:t,bottom:e,left:i}){const s=[];return i!==t?s.push(n,t,e,i):e!==n?s.push(n,t,e):t!==n?s.push(n,t):s.push(n),s.join(" ")}function tI(n){return t=>({path:n,value:Qa(t)})}function Lb(n){const t=n.matchAll(ij);return Array.from(t).map(e=>e[0])}function nI(n){n.setNormalizer("background",_j()),n.setNormalizer("background-color",vj()),n.setReducer("background",yj()),n.setStyleRelation("background",["background-color"])}function _j(){return n=>{const t={},e=Lb(n);for(const i of e)dj(i)?(t.repeat=t.repeat||[],t.repeat.push(i)):fj(i)?(t.position=t.position||[],t.position.push(i)):gj(i)?t.attachment=i:eI(i)?t.color=i:bj(i)&&(t.image=i);return{path:"background",value:t}}}function vj(){return n=>({path:"background.color",value:n})}function yj(){return n=>{const t=[];return t.push(["background-color",n.color]),t}}function iI(n){n.setNormalizer("border",Cj()),n.setNormalizer("border-top",Dc("top")),n.setNormalizer("border-right",Dc("right")),n.setNormalizer("border-bottom",Dc("bottom")),n.setNormalizer("border-left",Dc("left")),n.setNormalizer("border-color",yf("color")),n.setNormalizer("border-width",yf("width")),n.setNormalizer("border-style",yf("style")),n.setNormalizer("border-top-color",Wn("color","top")),n.setNormalizer("border-top-style",Wn("style","top")),n.setNormalizer("border-top-width",Wn("width","top")),n.setNormalizer("border-right-color",Wn("color","right")),n.setNormalizer("border-right-style",Wn("style","right")),n.setNormalizer("border-right-width",Wn("width","right")),n.setNormalizer("border-bottom-color",Wn("color","bottom")),n.setNormalizer("border-bottom-style",Wn("style","bottom")),n.setNormalizer("border-bottom-width",Wn("width","bottom")),n.setNormalizer("border-left-color",Wn("color","left")),n.setNormalizer("border-left-style",Wn("style","left")),n.setNormalizer("border-left-width",Wn("width","left")),n.setExtractor("border-top",$c("top")),n.setExtractor("border-right",$c("right")),n.setExtractor("border-bottom",$c("bottom")),n.setExtractor("border-left",$c("left")),n.setExtractor("border-top-color","border.color.top"),n.setExtractor("border-right-color","border.color.right"),n.setExtractor("border-bottom-color","border.color.bottom"),n.setExtractor("border-left-color","border.color.left"),n.setExtractor("border-top-width","border.width.top"),n.setExtractor("border-right-width","border.width.right"),n.setExtractor("border-bottom-width","border.width.bottom"),n.setExtractor("border-left-width","border.width.left"),n.setExtractor("border-top-style","border.style.top"),n.setExtractor("border-right-style","border.style.right"),n.setExtractor("border-bottom-style","border.style.bottom"),n.setExtractor("border-left-style","border.style.left"),n.setReducer("border-color",el("border-color")),n.setReducer("border-style",el("border-style")),n.setReducer("border-width",el("border-width")),n.setReducer("border-top",Hc("top")),n.setReducer("border-right",Hc("right")),n.setReducer("border-bottom",Hc("bottom")),n.setReducer("border-left",Hc("left")),n.setReducer("border",Tj()),n.setStyleRelation("border",["border-color","border-style","border-width","border-top","border-right","border-bottom","border-left","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style","border-top-width","border-right-width","border-bottom-width","border-left-width"]),n.setStyleRelation("border-color",["border-top-color","border-right-color","border-bottom-color","border-left-color"]),n.setStyleRelation("border-style",["border-top-style","border-right-style","border-bottom-style","border-left-style"]),n.setStyleRelation("border-width",["border-top-width","border-right-width","border-bottom-width","border-left-width"]),n.setStyleRelation("border-top",["border-top-color","border-top-style","border-top-width"]),n.setStyleRelation("border-right",["border-right-color","border-right-style","border-right-width"]),n.setStyleRelation("border-bottom",["border-bottom-color","border-bottom-style","border-bottom-width"]),n.setStyleRelation("border-left",["border-left-color","border-left-style","border-left-width"])}function Cj(){return n=>{const{color:t,style:e,width:i}=sI(n);return{path:"border",value:{color:Qa(t),style:Qa(e),width:Qa(i)}}}}function Dc(n){return t=>{const{color:e,style:i,width:s}=sI(t),o={};return e!==void 0&&(o.color={[n]:e}),i!==void 0&&(o.style={[n]:i}),s!==void 0&&(o.width={[n]:s}),{path:"border",value:o}}}function yf(n){return t=>({path:"border",value:kj(t,n)})}function kj(n,t){return{[t]:Qa(n)}}function Wn(n,t){return e=>({path:"border",value:{[n]:{[t]:e}}})}function $c(n){return(t,e)=>{if(e.border)return La(e.border,n)}}function La(n,t){const e={};return n.width&&n.width[t]&&(e.width=n.width[t]),n.style&&n.style[t]&&(e.style=n.style[t]),n.color&&n.color[t]&&(e.color=n.color[t]),e}function sI(n){const t={},e=Lb(n);for(const i of e)Rb(i)||/thin|medium|thick/.test(i)?t.width=i:rj(i)?t.style=i:t.color=i;return t}function Tj(){return t=>{const e=La(t,"top"),i=La(t,"right"),s=La(t,"bottom"),o=La(t,"left"),r=[e,i,s,o],a={width:n(r,"width"),style:n(r,"style"),color:n(r,"color")},l=fr(a,"all");return l.length?l:[...Object.entries(a).reduce((u,[d,f])=>(f&&(u.push([`border-${d}`,f]),r.forEach(m=>delete m[d])),u),[]),...fr(e,"top"),...fr(i,"right"),...fr(s,"bottom"),...fr(o,"left")]};function n(t,e){return t.map(i=>i[e]).reduce((i,s)=>i==s?i:null)}}function Hc(n){return t=>fr(t,n)}function fr(n,t){const e=[];if(n&&n.width&&e.push("width"),n&&n.style&&e.push("style"),n&&n.color&&e.push("color"),e.length==3){const i=e.map(s=>n[s]).join(" ");return[t=="all"?["border",i]:[`border-${t}`,i]]}return t=="all"?[]:e.map(i=>[`border-${t}-${i}`,n[i]])}function Ej(n){n.setNormalizer("margin",tI("margin")),n.setNormalizer("margin-top",t=>({path:"margin.top",value:t})),n.setNormalizer("margin-right",t=>({path:"margin.right",value:t})),n.setNormalizer("margin-bottom",t=>({path:"margin.bottom",value:t})),n.setNormalizer("margin-left",t=>({path:"margin.left",value:t})),n.setReducer("margin",el("margin")),n.setStyleRelation("margin",["margin-top","margin-right","margin-bottom","margin-left"])}function Aj(n){n.setNormalizer("padding",tI("padding")),n.setNormalizer("padding-top",t=>({path:"padding.top",value:t})),n.setNormalizer("padding-right",t=>({path:"padding.right",value:t})),n.setNormalizer("padding-bottom",t=>({path:"padding.bottom",value:t})),n.setNormalizer("padding-left",t=>({path:"padding.left",value:t})),n.setReducer("padding",el("padding")),n.setStyleRelation("padding",["padding-top","padding-right","padding-bottom","padding-left"])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class oI{constructor(t){h(this,"crashes",[]);h(this,"state","initializing");h(this,"_crashNumberLimit");h(this,"_now",Date.now);h(this,"_minimumNonErrorTimePeriod");h(this,"_boundErrorHandler");h(this,"_listeners");if(this.crashes=[],this._crashNumberLimit=typeof t.crashNumberLimit=="number"?t.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof t.minimumNonErrorTimePeriod=="number"?t.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=e=>{const i="error"in e?e.error:e.reason;i instanceof Error&&this._handleError(i,e)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(t,e){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)}off(t,e){this._listeners[t]=this._listeners[t].filter(i=>i!==e)}_fire(t,...e){const i=this._listeners[t]||[];for(const s of i)s.apply(this,[null,...e])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(t,e){if(this._shouldReactToError(t)){this.crashes.push({message:t.message,stack:t.stack,filename:e instanceof ErrorEvent?e.filename:void 0,lineno:e instanceof ErrorEvent?e.lineno:void 0,colno:e instanceof ErrorEvent?e.colno:void 0,date:this._now()});const i=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:t,causesRestart:i}),i?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(t){return t.is&&t.is("CKEditorError")&&t.context!==void 0&&t.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(t)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const t=this.crashes[this.crashes.length-1].date,e=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(t-e)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Wm(n,t=new Set){const e=[n],i=new Set;let s=0;for(;e.length>s;){const o=e[s++];if(!(i.has(o)||!xj(o)||t.has(o)))if(i.add(o),Symbol.iterator in o)try{for(const r of o)e.push(r)}catch{}else for(const r in o)r!=="defaultValue"&&e.push(o[r])}return i}function xj(n){const t=Object.prototype.toString.call(n),e=typeof n;return!(e==="number"||e==="boolean"||e==="string"||e==="symbol"||e==="function"||t==="[object Date]"||t==="[object RegExp]"||t==="[object Module]"||n===void 0||n===null||n._watchdogExcluded||n instanceof EventTarget||n instanceof Event)}function rI(n,t,e=new Set){if(n===t&&Sj(n))return!0;const i=Wm(n,e),s=Wm(t,e);for(const o of i)if(s.has(o))return!0;return!1}function Sj(n){return typeof n=="object"&&n!==null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class aI extends oI{constructor(e,i={}){super(i);h(this,"_editor",null);h(this,"_lifecyclePromise",null);h(this,"_throttledSave");h(this,"_data");h(this,"_lastDocumentVersion");h(this,"_elementOrData");h(this,"_initUsingData",!0);h(this,"_editables",{});h(this,"_config");h(this,"_excludedProps");this._throttledSave=$s(this._save.bind(this),typeof i.saveInterval=="number"?i.saveInterval:5e3),e&&(this._creator=(s,o)=>e.create(s,o)),this._destructor=s=>s.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},i=[],s=this._config.rootsAttributes||{},o={};for(const[a,l]of Object.entries(this._data.roots))l.isLoaded?(e[a]="",o[a]=s[a]||{}):i.push(a);const r={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:i,rootsAttributes:o,_watchdogInitialData:this._data};return delete r.initialData,r.extraPlugins.push(Ij),this._initUsingData?this.create(e,r,r.context):Xi(this._elementOrData)?this.create(this._elementOrData,r,r.context):this.create(this._editables,r,r.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,i=this._config,s){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData=typeof e=="string"||Object.keys(e).length>0&&typeof Object.values(e)[0]=="string",this._config=this._cloneEditorConfiguration(i)||{},this._config.context=s,this._creator(e,this._config))).then(o=>{this._editor=o,o.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=o.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(i){console.error(i,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,i=e.model.document.roots.filter(l=>l.isAttached()&&l.rootName!="$graveyard"),{plugins:s}=e,o=s.has("CommentsRepository")&&s.get("CommentsRepository"),r=s.has("TrackChanges")&&s.get("TrackChanges"),a={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};i.forEach(l=>{a.roots[l.rootName]={content:JSON.stringify(Array.from(l.getChildren())),attributes:JSON.stringify(Array.from(l.getAttributes())),isLoaded:l._isLoaded}});for(const l of e.model.markers)l._affectsData&&(a.markers[l.name]={rangeJSON:l.getRange().toJSON(),usingOperation:l._managedUsingOperations,affectsData:l._affectsData});return o&&(a.commentThreads=JSON.stringify(o.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),r&&(a.suggestions=JSON.stringify(r.getSuggestions({toJSON:!0,skipNotAttached:!0}))),a}_getEditables(){const e={};for(const i of this.editor.model.document.getRootNames()){const s=this.editor.ui.getEditableElement(i);s&&(e[i]=s)}return e}_isErrorComingFromThisItem(e){return rI(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return Xl(e,(i,s)=>{if(Xi(i)||s==="context")return i})}}class Ij{constructor(t){h(this,"editor");h(this,"_data");this.editor=t,this._data=t.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",t=>{t.stop(),this.editor.model.enqueueChange({isUndoable:!1},e=>{this._restoreCollaborationData(),this._restoreEditorData(e)}),this.editor.data.fire("ready")},{priority:999})}_createNode(t,e){if("name"in e){const i=t.createElement(e.name,e.attributes);if(e.children)for(const s of e.children)i._appendChild(this._createNode(t,s));return i}else return t.createText(e.data,e.attributes)}_restoreEditorData(t){const e=this.editor;Object.entries(this._data.roots).forEach(([i,{content:s,attributes:o}])=>{const r=JSON.parse(s),a=JSON.parse(o),l=e.model.document.getRoot(i);for(const[c,u]of a)t.setAttribute(c,u,l);for(const c of r){const u=this._createNode(t,c);t.insert(u,l,"end")}}),Object.entries(this._data.markers).forEach(([i,s])=>{const{document:o}=e.model,{rangeJSON:{start:r,end:a},...l}=s,c=o.getRoot(r.root),u=t.createPositionFromPath(c,r.path,r.stickiness),d=t.createPositionFromPath(c,a.path,a.stickiness),f=t.createRange(u,d);t.addMarker(i,{range:f,...l})})}_restoreCollaborationData(){const t=JSON.parse(this._data.commentThreads),e=JSON.parse(this._data.suggestions);t.forEach(i=>{const s=this.editor.config.get("collaboration.channelId"),o=this.editor.plugins.get("CommentsRepository");o.hasCommentThread(i.threadId)&&o.getCommentThread(i.threadId).remove(),o.addCommentThread({channelId:s,...i})}),e.forEach(i=>{const s=this.editor.plugins.get("TrackChangesEditing");if(s.hasSuggestion(i.id)){const o=s.getSuggestion(i.id);o.attributes=i.attributes}else s.addSuggestionData(i)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const tl=Symbol("MainQueueId");class Pj extends oI{constructor(e,i={}){super(i);h(this,"_watchdogs",new Map);h(this,"_watchdogConfig");h(this,"_context",null);h(this,"_contextProps",new Set);h(this,"_actionQueues",new Rj);h(this,"_contextConfig");h(this,"_item");this._watchdogConfig=i,this._creator=s=>e.create(s),this._destructor=s=>s.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(tl,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const i=l_(e);return Promise.all(i.map(s=>this._actionQueues.enqueue(s.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let o;if(this._watchdogs.has(s.id))throw new Error(`Item with the given id is already added: '${s.id}'.`);if(s.type==="editor")return o=new aI(null,this._watchdogConfig),o.setCreator(s.creator),o._setExcludedProperties(this._contextProps),s.destructor&&o.setDestructor(s.destructor),this._watchdogs.set(s.id,o),o.on("error",(r,{error:a,causesRestart:l})=>{this._fire("itemError",{itemId:s.id,error:a}),l&&this._actionQueues.enqueue(s.id,()=>new Promise(c=>{const u=()=>{o.off("restart",u),this._fire("itemRestart",{itemId:s.id}),c()};o.on("restart",u)}))}),o.create(s.sourceElementOrData,s.config,this._context);throw new Error(`Not supported item type: '${s.type}'.`)})))}remove(e){const i=l_(e);return Promise.all(i.map(s=>this._actionQueues.enqueue(s,()=>{const o=this._getWatchdog(s);return this._watchdogs.delete(s),o.destroy()})))}destroy(){return this._actionQueues.enqueue(tl,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(tl,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=Wm(this._context),Promise.all(Array.from(this._watchdogs.values()).map(i=>(i._setExcludedProperties(this._contextProps),i.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(i=>i.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const i=this._watchdogs.get(e);if(!i)throw new Error(`Item with the given id was not registered: ${e}.`);return i}_isErrorComingFromThisItem(e){for(const i of this._watchdogs.values())if(i._isErrorComingFromThisItem(e))return!1;return rI(this._context,e.context)}}class Rj{constructor(){h(this,"_onEmptyCallbacks",[]);h(this,"_queues",new Map);h(this,"_activeActions",0)}onEmpty(t){this._onEmptyCallbacks.push(t)}enqueue(t,e){const i=t===tl;this._activeActions++,this._queues.get(t)||this._queues.set(t,Promise.resolve());const o=(i?Promise.all(this._queues.values()):Promise.all([this._queues.get(tl),this._queues.get(t)])).then(e),r=o.catch(()=>{});return this._queues.set(t,r),o.finally(()=>{this._activeActions--,this._queues.get(t)===r&&this._activeActions===0&&this._onEmptyCallbacks.forEach(a=>a())})}}function l_(n){return Array.isArray(n)?n:[n]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class A extends Ve(){constructor(e){super();h(this,"editor");h(this,"_disableStack",new Set);this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",c_,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",c_),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function c_(n){n.return=!1,n.stop()}class ne extends Ve(){constructor(e){super();h(this,"editor");h(this,"_isEnabledBasedOnSelection");h(this,"_affectsData");h(this,"_disableStack");this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",i=>{if(!this.affectsData)return;const s=e.model.document.selection,r=!(s.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(s);(e.isReadOnly||this._isEnabledBasedOnSelection&&!r)&&(i.return=!1,i.stop())},{priority:"highest"}),this.on("execute",i=>{this.isEnabled||i.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",u_,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",u_),this.refresh())}execute(...e){}destroy(){this.stopListening()}}function u_(n){n.return=!1,n.stop()}class d_ extends ne{constructor(){super(...arguments);h(this,"_childCommandsDefinitions",[])}refresh(){}execute(...e){const i=this._getFirstEnabledCommand();return!!i&&i.execute(e)}registerChildCommand(e,i={}){WS(this._childCommandsDefinitions,{command:e,priority:i.priority||"normal"}),e.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){const e=this._childCommandsDefinitions.find(({command:i})=>i.isEnabled);return e&&e.command}}class lI extends De(){constructor(e,i=[],s=[]){super();h(this,"_context");h(this,"_plugins",new Map);h(this,"_availablePlugins");h(this,"_contextPlugins");this._context=e,this._availablePlugins=new Map;for(const o of i)o.pluginName&&this._availablePlugins.set(o.pluginName,o);this._contextPlugins=new Map;for(const[o,r]of s)this._contextPlugins.set(o,r),this._contextPlugins.set(r,o),o.pluginName&&this._availablePlugins.set(o.pluginName,o)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const i=this._plugins.get(e);if(!i){let s=e;throw typeof e=="function"&&(s=e.pluginName||e.name),new C("plugincollection-plugin-not-loaded",this._context,{plugin:s})}return i}has(e){return this._plugins.has(e)}init(e,i=[],s=[]){const o=this,r=this._context;g(e),w(e);const a=e.filter(R=>!f(R,i)),l=[...p(a)];S(l,s);const c=E(l);return x(c,"init").then(()=>x(c,"afterInit")).then(()=>c);function u(R){return typeof R=="function"}function d(R){return u(R)&&!!R.isContextPlugin}function f(R,V){return V.some(P=>P===R||m(R)===P||m(P)===R)}function m(R){return u(R)?R.pluginName||R.name:R}function g(R,V=new Set){R.forEach(P=>{u(P)&&(V.has(P)||(V.add(P),P.pluginName&&!o._availablePlugins.has(P.pluginName)&&o._availablePlugins.set(P.pluginName,P),P.requires&&g(P.requires,V)))})}function p(R,V=new Set){return R.map(P=>u(P)?P:o._availablePlugins.get(P)).reduce((P,B)=>V.has(B)?P:(V.add(B),B.requires&&(w(B.requires,B),p(B.requires,V).forEach(J=>P.add(J))),P.add(B)),new Set)}function w(R,V=null){R.map(P=>u(P)?P:o._availablePlugins.get(P)||P).forEach(P=>{v(P,V),_(P,V),y(P,V)})}function v(R,V){if(!u(R))throw V?new C("plugincollection-soft-required",r,{missingPlugin:R,requiredBy:m(V)}):new C("plugincollection-plugin-not-found",r,{plugin:R})}function _(R,V){if(d(V)&&!d(R))throw new C("plugincollection-context-required",r,{plugin:m(R),requiredBy:m(V)})}function y(R,V){if(V&&f(R,i))throw new C("plugincollection-required",r,{plugin:m(R),requiredBy:m(V)})}function E(R){return R.map(V=>{let P=o._contextPlugins.get(V);return P=P||new V(r),o._add(V,P),P})}function x(R,V){return R.reduce((P,B)=>!B[V]||o._contextPlugins.has(B)?P:P.then(B[V].bind(B)),Promise.resolve())}function S(R,V){for(const P of V){if(typeof P!="function")throw new C("plugincollection-replace-plugin-invalid-type",null,{pluginItem:P});const B=P.pluginName;if(!B)throw new C("plugincollection-replace-plugin-missing-name",null,{pluginItem:P});if(P.requires&&P.requires.length)throw new C("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:B});const J=o._availablePlugins.get(B);if(!J)throw new C("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:B});const H=R.indexOf(J);if(H===-1){if(o._contextPlugins.has(J))return;throw new C("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:B})}if(J.requires&&J.requires.length)throw new C("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:B});R.splice(H,1,P),o._availablePlugins.set(B,P)}}}destroy(){const e=[];for(const[,i]of this)typeof i.destroy=="function"&&!this._contextPlugins.has(i)&&e.push(i.destroy());return Promise.all(e)}_add(e,i){this._plugins.set(e,i);const s=e.pluginName;if(s){if(this._plugins.has(s))throw new C("plugincollection-plugin-name-conflict",null,{pluginName:s,plugin1:this._plugins.get(s).constructor,plugin2:e});this._plugins.set(s,i)}}}class ed{constructor(t){h(this,"config");h(this,"plugins");h(this,"locale");h(this,"t");h(this,"editors");h(this,"_contextOwner",null);const{translations:e,...i}=t||{};this.config=new QS(i,this.constructor.defaultConfig);const s=this.constructor.builtinPlugins;this.config.define("plugins",s),this.plugins=new lI(this,s);const o=this.config.get("language")||{};this.locale=new gz({uiLanguage:typeof o=="string"?o:o.ui,contentLanguage:this.config.get("language.content"),translations:e}),this.t=this.locale.t,this.editors=new rn}initPlugins(){const t=this.config.get("plugins")||[],e=this.config.get("substitutePlugins")||[];for(const i of t.concat(e)){if(typeof i!="function")throw new C("context-initplugins-constructor-only",null,{Plugin:i});if(i.isContextPlugin!==!0)throw new C("context-initplugins-invalid-plugin",null,{Plugin:i})}return this.plugins.init(t,[],e)}destroy(){return Promise.all(Array.from(this.editors,t=>t.destroy())).then(()=>this.plugins.destroy())}_addEditor(t,e){if(this._contextOwner)throw new C("context-addeditor-private-context");this.editors.add(t),e&&(this._contextOwner=t)}_removeEditor(t){return this.editors.has(t)&&this.editors.remove(t),this._contextOwner===t?this.destroy():Promise.resolve()}_getEditorConfig(){const t={};for(const e of this.config.names())["plugins","removePlugins","extraPlugins"].includes(e)||(t[e]=this.config.get(e));return t}static create(t){return new Promise(e=>{const i=new this(t);e(i.initPlugins().then(()=>i))})}}h(ed,"defaultConfig"),h(ed,"builtinPlugins");class Rh extends Ve(){constructor(e){super();h(this,"context");this.context=e}destroy(){this.stopListening()}static get isContextPlugin(){return!0}}class Lj{constructor(){h(this,"_commands");this._commands=new Map}add(t,e){this._commands.set(t,e)}get(t){return this._commands.get(t)}execute(t,...e){const i=this.get(t);if(!i)throw new C("commandcollection-command-not-found",this,{commandName:t});return i.execute(...e)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const t of this.commands())t.destroy()}}class Vj extends tt{constructor(e){super();h(this,"editor");this.editor=e}set(e,i,s={}){if(typeof i=="string"){const o=i;i=(r,a)=>{this.editor.execute(o),a()}}super.set(e,i,s)}}const Cf="contentEditing",h_="common";class Bj{constructor(t){h(this,"keystrokeInfos",new Map);h(this,"_editor");this._editor=t;const e=t.config.get("menuBar.isVisible"),i=t.locale.t;this.addKeystrokeInfoCategory({id:Cf,label:i("Content editing keystrokes"),description:i("These keyboard shortcuts allow for quick access to content editing features.")});const s=[{label:i("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:i("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:i("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:i("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:i("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:i("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];e&&s.push({label:i("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:i("User interface and content navigation keystrokes"),description:i("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:s}]})}addKeystrokeInfoCategory({id:t,label:e,description:i,groups:s}){this.keystrokeInfos.set(t,{id:t,label:e,description:i,groups:new Map}),this.addKeystrokeInfoGroup({categoryId:t,id:h_}),s&&s.forEach(o=>{this.addKeystrokeInfoGroup({categoryId:t,...o})})}addKeystrokeInfoGroup({categoryId:t=Cf,id:e,label:i,keystrokes:s}){const o=this.keystrokeInfos.get(t);if(!o)throw new C("accessibility-unknown-keystroke-info-category",this._editor,{groupId:e,categoryId:t});o.groups.set(e,{id:e,label:i,keystrokes:s||[]})}addKeystrokeInfos({categoryId:t=Cf,groupId:e=h_,keystrokes:i}){if(!this.keystrokeInfos.has(t))throw new C("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:t,keystrokes:i});const s=this.keystrokeInfos.get(t);if(!s.groups.has(e))throw new C("accessibility-unknown-keystroke-info-group",this._editor,{groupId:e,categoryId:t,keystrokes:i});s.groups.get(e).keystrokes.push(...i)}}class mr extends Ve(){constructor(e={}){super();h(this,"accessibility");h(this,"commands");h(this,"config");h(this,"conversion");h(this,"data");h(this,"editing");h(this,"locale");h(this,"model");h(this,"plugins");h(this,"keystrokes");h(this,"t");h(this,"_context");h(this,"_readOnlyLocks");const i=this.constructor,{translations:s,...o}=i.defaultConfig||{},{translations:r=s,...a}=e,l=e.language||o.language;this._context=e.context||new ed({language:l,translations:r}),this._context._addEditor(this,!e.context);const c=Array.from(i.builtinPlugins||[]);this.config=new QS(a,o),this.config.define("plugins",c),this.config.define(this._context._getEditorConfig()),this.plugins=new lI(this,c,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new Lj,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.model=new Jq,this.on("change:isReadOnly",()=>{this.model.document.isReadOnly=this.isReadOnly});const u=new Fz;this.data=new rq(this.model,u),this.editing=new OW(this.model,u),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new lq([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new Vj(this),this.keystrokes.listenTo(this.editing.view.document),this.accessibility=new Bj(this)}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new C("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new C("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),this._readOnlyLocks.size===1&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new C("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),this._readOnlyLocks.size===0&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}setData(e){this.data.set(e)}getData(e){return this.data.get(e)}initPlugins(){const e=this.config,i=e.get("plugins"),s=e.get("removePlugins")||[],o=e.get("extraPlugins")||[],r=e.get("substitutePlugins")||[];return this.plugins.init(i.concat(o),s,r)}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(i=>this.once("ready",i))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(e,...i){try{return this.commands.execute(e,...i)}catch(s){/* istanbul ignore next -- @preserve */C.rethrowUnexpectedError(s,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}}h(mr,"defaultConfig"),h(mr,"builtinPlugins"),h(mr,"Context",ed),h(mr,"EditorWatchdog",aI),h(mr,"ContextWatchdog",Pj);function Mj(n){if(!vn(n.updateSourceElement))throw new C("attachtoform-missing-elementapi-interface",n);const t=n.sourceElement;if(Oj(t)&&t.form){let e;const i=t.form,s=()=>n.updateSourceElement();vn(i.submit)&&(e=i.submit,i.submit=()=>{s(),e.apply(i)}),i.addEventListener("submit",s),n.on("destroy",()=>{i.removeEventListener("submit",s),e&&(i.submit=e)})}}function Oj(n){return!!n&&n.tagName.toLowerCase()==="textarea"}function qm(n){class t extends n{constructor(){super(...arguments);h(this,"sourceElement")}updateSourceElement(s){if(!this.sourceElement)throw new C("editor-missing-sourceelement",this);const o=this.config.get("updateSourceElementOnDestroy"),r=this.sourceElement instanceof HTMLTextAreaElement;if(!o&&!r){b0(this.sourceElement,"");return}const a=typeof s=="string"?s:this.data.get();b0(this.sourceElement,a)}}return t}qm.updateSourceElement=qm(Object).prototype.updateSourceElement;class Hr extends Rh{constructor(){super(...arguments);h(this,"_actions")}static get pluginName(){return"PendingActions"}init(){this.set("hasAny",!1),this._actions=new rn({idProperty:"_id"}),this._actions.delegate("add","remove").to(this)}add(e){if(typeof e!="string")throw new C("pendingactions-add-invalid-message",this);const i=new(Ve());return i.set("message",e),this._actions.add(i),this.hasAny=!0,i}remove(e){this._actions.remove(e),this.hasAny=!!this._actions.length}get first(){return this._actions.get(0)}[Symbol.iterator](){return this._actions[Symbol.iterator]()}}var Nj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',Fj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 16h9a1 1 0 0 1 0 2H2a1 1 0 0 1 0-2z"/><path d="M17 1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14zm0 1.5H3a.5.5 0 0 0-.492.41L2.5 3v9a.5.5 0 0 0 .41.492L3 12.5h14a.5.5 0 0 0 .492-.41L17.5 12V3a.5.5 0 0 0-.41-.492L17 2.5z" fill-opacity=".6"/></svg>',Dj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',$j='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.333 2 .19 2.263a5.899 5.899 0 0 1 1.458.604L14.714 3.4 16.6 5.286l-1.467 1.733c.263.452.468.942.605 1.46L18 8.666v2.666l-2.263.19a5.899 5.899 0 0 1-.604 1.458l1.467 1.733-1.886 1.886-1.733-1.467a5.899 5.899 0 0 1-1.46.605L11.334 18H8.667l-.19-2.263a5.899 5.899 0 0 1-1.458-.604L5.286 16.6 3.4 14.714l1.467-1.733a5.899 5.899 0 0 1-.604-1.458L2 11.333V8.667l2.262-.189a5.899 5.899 0 0 1 .605-1.459L3.4 5.286 5.286 3.4l1.733 1.467a5.899 5.899 0 0 1 1.46-.605L8.666 2h2.666zM10 6.267a3.733 3.733 0 1 0 0 7.466 3.733 3.733 0 0 0 0-7.466z"/></svg>',Hj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 8.665 8.665 0 0 1-.372.008Zm-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414ZM9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Zm4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Z"/></svg>',zj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',Uj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11 1a9 9 0 1 1-8.027 13.075l1.128-1.129A7.502 7.502 0 0 0 18.5 10a7.5 7.5 0 1 0-14.962.759l-.745-.746-.76.76A9 9 0 0 1 11 1z"/><path d="M.475 8.17a.75.75 0 0 1 .978.047l.075.082 1.284 1.643 1.681-1.284a.75.75 0 0 1 .978.057l.073.083a.75.75 0 0 1-.057.978l-.083.073-2.27 1.737a.75.75 0 0 1-.973-.052l-.074-.082-1.741-2.23a.75.75 0 0 1 .13-1.052z"/><path d="M11.5 5v4.999l3.196 3.196-1.06 1.06L10.1 10.72l-.1-.113V5z"/></svg>',Wj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5.085 6.22 2.943 4.078a.75.75 0 1 1 1.06-1.06l2.592 2.59A11.094 11.094 0 0 1 10 5.068c4.738 0 8.578 3.101 8.578 5.083 0 1.197-1.401 2.803-3.555 3.887l1.714 1.713a.75.75 0 0 1-.09 1.138.488.488 0 0 1-.15.084.75.75 0 0 1-.821-.16L6.17 7.304c-.258.11-.51.233-.757.365l6.239 6.24-.006.005.78.78c-.388.094-.78.166-1.174.215l-1.11-1.11h.011L4.55 8.197a7.2 7.2 0 0 0-.665.514l-.112.098 4.897 4.897-.005.006 1.276 1.276a10.164 10.164 0 0 1-1.477-.117l-.479-.479-.009.009-4.863-4.863-.022.031a2.563 2.563 0 0 0-.124.2c-.043.077-.08.158-.108.241a.534.534 0 0 0-.028.133.29.29 0 0 0 .008.072.927.927 0 0 0 .082.226c.067.133.145.26.234.379l3.242 3.365.025.01.59.623c-3.265-.918-5.59-3.155-5.59-4.668 0-1.194 1.448-2.838 3.663-3.93zm7.07.531a4.632 4.632 0 0 1 1.108 5.992l.345.344.046-.018a9.313 9.313 0 0 0 2-1.112c.256-.187.5-.392.727-.613.137-.134.27-.277.392-.431.072-.091.141-.185.203-.286.057-.093.107-.19.148-.292a.72.72 0 0 0 .036-.12.29.29 0 0 0 .008-.072.492.492 0 0 0-.028-.133.999.999 0 0 0-.036-.096 2.165 2.165 0 0 0-.071-.145 2.917 2.917 0 0 0-.125-.2 3.592 3.592 0 0 0-.263-.335 5.444 5.444 0 0 0-.53-.523 7.955 7.955 0 0 0-1.054-.768 9.766 9.766 0 0 0-1.879-.891c-.337-.118-.68-.219-1.027-.301zm-2.85.21-.069.002a.508.508 0 0 0-.254.097.496.496 0 0 0-.104.679.498.498 0 0 0 .326.199l.045.005c.091.003.181.003.272.012a2.45 2.45 0 0 1 2.017 1.513c.024.061.043.125.069.185a.494.494 0 0 0 .45.287h.008a.496.496 0 0 0 .35-.158.482.482 0 0 0 .13-.335.638.638 0 0 0-.048-.219 3.379 3.379 0 0 0-.36-.723 3.438 3.438 0 0 0-2.791-1.543l-.028-.001h-.013z"/></svg>',qj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.035 1C2.446 1 2 1.54 2 2.098V10.5h1.5v-8h13v8H18V2.098C18 1.539 17.48 1 16.9 1H3.035Zm10.453 2.61a1.885 1.885 0 0 0-1.442.736 1.89 1.89 0 0 0 1.011 2.976 1.903 1.903 0 0 0 2.253-1.114 1.887 1.887 0 0 0-1.822-2.598ZM7.463 8.163a.611.611 0 0 0-.432.154L5.071 10.5h5.119L7.88 8.348a.628.628 0 0 0-.417-.185Zm6.236 1.059a.62.62 0 0 0-.42.164L12.07 10.5h2.969l-.92-1.113a.618.618 0 0 0-.42-.165ZM.91 11.5a.91.91 0 0 0-.91.912v6.877c0 .505.405.91.91.91h18.178a.91.91 0 0 0 .912-.91v-6.877a.908.908 0 0 0-.912-.912H.91ZM3.668 13h1.947l2.135 5.7H5.898l-.28-.946H3.601l-.278.945H1.516L3.668 13Zm4.947 0h1.801v4.3h2.7v1.4h-4.5V13h-.001Zm4.5 0h5.4v1.4h-1.798v4.3h-1.701v-4.3h-1.9V13h-.001Zm-8.517 1.457-.614 2.059h1.262l-.648-2.059Z"/></svg>',jj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.68 13.74h-.001l4.209 4.208a1 1 0 1 0 1.414-1.414l-4.267-4.268a6 6 0 1 0-1.355 1.474ZM13 9a4 4 0 1 1-8 0 4 4 0 0 1 8 0Z"/></svg>',Gj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',Kj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>',Zj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.66 9.118a.693.693 0 0 1 .956.032l3.65 3.411 2.422-2.238a.695.695 0 0 1 .945 0L17.5 13.6V2.5h-15v11.1l4.16-4.482ZM17.8 1c.652 0 1.2.47 1.2 1.1v14.362c0 .64-.532 1.038-1.184 1.038H2.184C1.532 17.5 1 17.103 1 16.462V2.1C1 1.47 1.537 1 2.2 1h15.6Zm-5.655 6a2.128 2.128 0 0 1 .157-2.364A2.133 2.133 0 1 1 12.145 7Z"/></svg>',Jj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h9.494a2.97 2.97 0 0 1-.414-.287 2.998 2.998 0 0 1-1.055-2.03 3.003 3.003 0 0 1 .693-2.185l.383-.455-.02.018-3.65-3.41a.695.695 0 0 0-.957-.034L1.5 13.6V2.5h15v5.535a2.97 2.97 0 0 1 1.412.932l.088.105V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.146 2.146 0 0 0-2.049 1.992 2.14 2.14 0 0 0 1.28 2.096 2.13 2.13 0 0 0 2.644-3.11 2.134 2.134 0 0 0-1.875-.978Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/><path d="M15.522 19.1a.79.79 0 0 0 .79-.79v-5.373l2.059 2.455a.79.79 0 1 0 1.211-1.015l-3.352-3.995a.79.79 0 0 0-.995-.179.784.784 0 0 0-.299.221l-3.35 3.99a.79.79 0 1 0 1.21 1.017l1.936-2.306v5.185c0 .436.353.79.79.79Z"/></svg>',Yj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1c-.662 0-1.2.47-1.2 1.1v14.248c0 .64.533 1.152 1.185 1.152h6.623v-7.236L6.617 9.15a.694.694 0 0 0-.957-.033L1.602 13.55V2.553l14.798.003V9.7H18V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.723 2.805a2.094 2.094 0 0 0-1.621.832 2.127 2.127 0 0 0 1.136 3.357 2.13 2.13 0 0 0 2.611-1.506 2.133 2.133 0 0 0-.76-2.244 2.13 2.13 0 0 0-1.366-.44Z"/><path clip-rule="evenodd" d="M19.898 12.369v6.187a.844.844 0 0 1-.844.844h-8.719a.844.844 0 0 1-.843-.844v-7.312a.844.844 0 0 1 .843-.844h2.531a.843.843 0 0 1 .597.248l.838.852h4.75c.223 0 .441.114.6.272a.844.844 0 0 1 .247.597Zm-1.52.654-4.377.02-1.1-1.143H11v6h7.4l-.023-4.877Z"/></svg>',Xj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.201 1C.538 1 0 1.47 0 2.1v14.363c0 .64.534 1.037 1.186 1.037h7.029a5.401 5.401 0 0 1 .615-4.338l.762-1.232-2.975-2.78a.696.696 0 0 0-.957-.033L1.5 13.6V2.5h15v6.023c.449.131.887.32 1.307.573l.058.033c.046.028.09.057.135.086V2.1c0-.63-.547-1.1-1.2-1.1H1.202Zm11.713 2.803a2.15 2.15 0 0 0-1.611.834 2.118 2.118 0 0 0-.438 1.158 2.14 2.14 0 0 0 1.277 2.096 2.132 2.132 0 0 0 2.645-3.11 2.13 2.13 0 0 0-1.873-.978Z"/><path d="M16.63 10.294a3.003 3.003 0 0 0-4.142.887l-.117.177a.647.647 0 0 0-.096.492.664.664 0 0 0 .278.418.7.7 0 0 0 .944-.234 1.741 1.741 0 0 1 2.478-.463 1.869 1.869 0 0 1 .476 2.55.637.637 0 0 0-.071.5.646.646 0 0 0 .309.396.627.627 0 0 0 .869-.19l.027-.041a3.226 3.226 0 0 0-.956-4.492Zm-6.061 3.78-.044.066a3.228 3.228 0 0 0 .82 4.403 3.005 3.005 0 0 0 4.275-.798l.13-.197a.626.626 0 0 0 .092-.475.638.638 0 0 0-.268-.402.713.713 0 0 0-.99.26l-.018.029a1.741 1.741 0 0 1-2.477.461 1.87 1.87 0 0 1-.475-2.55l.029-.047a.647.647 0 0 0 .086-.485.66.66 0 0 0-.275-.408l-.04-.027a.609.609 0 0 0-.845.17Z"/><path d="M15.312 13.925c.24-.36.154-.838-.19-1.067-.346-.23-.82-.124-1.059.236l-1.268 1.907c-.239.36-.153.838.192 1.067.345.23.818.123 1.057-.236l1.268-1.907Z"/></svg>',Qj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.239 13.938-2.88-1.663a.75.75 0 0 1 .75-1.3L9 12.067V4.75a.75.75 0 1 1 1.5 0v7.318l1.89-1.093a.75.75 0 0 1 .75 1.3l-2.879 1.663a.752.752 0 0 1-.511.187.752.752 0 0 1-.511-.187zM4.25 17a.75.75 0 1 1 0-1.5h10.5a.75.75 0 0 1 0 1.5H4.25z"/></svg>',eG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.75 11.875a.752.752 0 0 1 .508.184l2.883 1.666a.75.75 0 0 1-.659 1.344l-.091-.044-1.892-1.093.001 4.318a.75.75 0 1 1-1.5 0v-4.317l-1.89 1.092a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .51-.187zM15.25 9a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM9.75.375a.75.75 0 0 1 .75.75v4.318l1.89-1.093.092-.045a.75.75 0 0 1 .659 1.344l-2.883 1.667a.752.752 0 0 1-.508.184.752.752 0 0 1-.511-.187L6.359 5.65a.75.75 0 0 1 .75-1.299L9 5.442V1.125a.75.75 0 0 1 .75-.75z"/></svg>',tG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m10.261 7.062 2.88 1.663a.75.75 0 0 1-.75 1.3L10.5 8.933v7.317a.75.75 0 1 1-1.5 0V8.932l-1.89 1.093a.75.75 0 0 1-.75-1.3l2.879-1.663a.752.752 0 0 1 .511-.187.752.752 0 0 1 .511.187zM15.25 4a.75.75 0 1 1 0 1.5H4.75a.75.75 0 0 1 0-1.5h10.5z"/></svg>',nG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',iG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',sG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',oG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',rG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',aG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M15.003 7v5.5a1 1 0 0 1-1 1H5.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H6.5V12h6.997V7.5z"/></svg>',lG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',cG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2z"/><path d="M18 7v5.5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1zm-1.505.5H3.504V12h12.991V7.5z"/></svg>',uG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',dG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm11.5 9H18v1.5h-4.5zm0-3H18v1.5h-4.5zm0-3H18v1.5h-4.5zM2 15h16v1.5H2z"/><path d="M12.003 7v5.5a1 1 0 0 1-1 1H2.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H3.5V12h6.997V7.5z"/></svg>',hG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path opacity=".5" d="M2 3h16v1.5H2zm0 12h16v1.5H2zm0-9h5v1.5H2zm0 3h5v1.5H2zm0 3h5v1.5H2z"/><path d="M18.003 7v5.5a1 1 0 0 1-1 1H8.996a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h8.007a1 1 0 0 1 1 1zm-1.506.5H9.5V12h6.997V7.5z"/></svg>',fG='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.5 17v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zm2 0v1h-1v-1h1zM1 15.5v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm-19-2v1H0v-1h1zm19 0v1h-1v-1h1zm0-2v1h-1v-1h1zm-19 0v1H0v-1h1zM14.5 2v1h-1V2h1zm2 0v1h-1V2h1zm2 0v1h-1V2h1zm-8 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm-2 0v1h-1V2h1zm8 0v1h-1V2h1zm-10 0v1h-1V2h1z"/><path d="M18.095 2H1.905C.853 2 0 2.895 0 4v12c0 1.105.853 2 1.905 2h16.19C19.147 18 20 17.105 20 16V4c0-1.105-.853-2-1.905-2zm0 1.5c.263 0 .476.224.476.5v12c0 .276-.213.5-.476.5H1.905a.489.489 0 0 1-.476-.5V4c0-.276.213-.5.476-.5h16.19z"/></svg>',mG='<svg xmlns="http://www.w3.org/2000/svg" xmlns:v="https://vecta.io/nano" viewBox="0 0 20 20"><path d="M.95 1.43a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h.75v6.3H.95a.95.95 0 0 0-.95.95v3.1a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-.65h1.932l1.539-1.5H5v-.95a.95.95 0 0 0-.95-.95H3.2v-6.3h.85A.95.95 0 0 0 5 5.48v-.55h10v.55a.95.95 0 0 0 .95.95h3.1a.95.95 0 0 0 .95-.95v-3.1a.95.95 0 0 0-.95-.95h-3.1a.95.95 0 0 0-.95.95v1.05H5V2.38a.95.95 0 0 0-.95-.95H.95zm.55 3.5v-2h2v2h-2zm0 9.3v2h2v-2h-2zm15-11.3v2h2v-2h-2z"/><path d="M8.139 20.004v-2.388l7.045-7.048 2.391 2.391-7.046 7.046h-2.39zm11.421-9.101a.64.64 0 0 1-.138.206l-1.165 1.168-2.391-2.391 1.167-1.163a.63.63 0 0 1 .206-.138.635.635 0 0 1 .243-.049.63.63 0 0 1 .449.187l1.491 1.488c.059.059.108.129.138.206s.049.16.049.243a.6.6 0 0 1-.049.243z"/></svg>',gG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M13 5.5H2a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2ZM13 7a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-8A.5.5 0 0 1 2 7h11Z"/></svg>',pG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M7 9.5H2a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h5a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2ZM7 11a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-4A.5.5 0 0 1 2 11h5Z"/></svg>',bG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 16.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1ZM1 15v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 13v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 11v1H0v-1h1Zm19 0v1h-1v-1h1ZM1 9v1H0V9h1Zm19 0v1h-1V9h1ZM1 7v1H0V7h1Zm19 0v1h-1V7h1ZM1 5v1H0V5h1Zm19 0v1h-1V5h1Zm0-2v1h-1V3h1ZM1 3v1H0V3h1Zm13.5-1.5v1h-1v-1h1Zm2 0v1h-1v-1h1Zm2 0v1h-1v-1h1Zm-8 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm-2 0v1h-1v-1h1Zm8 0v1h-1v-1h1Zm-10 0v1h-1v-1h1Z"/><path d="M10 7.5H2a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-6a2 2 0 0 0-2-2ZM10 9a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-6A.5.5 0 0 1 2 9h8Z"/></svg>',wG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',_G='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',vG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.423a6.5 6.5 0 0 1 6.056-6.408l.038.67C6.448 5.423 5.354 7.663 5.22 10H9c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574zm8 0a6.5 6.5 0 0 1 6.056-6.408l.038.67c-2.646.739-3.74 2.979-3.873 5.315H17c.552 0 .5.432.5.986v4.511c0 .554-.448.503-1 .503h-5c-.552 0-.5-.449-.5-1.003v-4.574z"/></svg>',yG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',CG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>',kG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',TG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5zM5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"/></svg>',EG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1Z"/></svg>',AG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555Zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13Z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17h-.023Zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254l-1.641 3.813Z"/></svg>',xG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822V4.5ZM14 5V2l3.3 3H14Zm-3.692 12.5c.062.105.133.206.213.303L11.52 19H8v-.876a2.243 2.243 0 0 0 1.82-.624h.488Zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0l2.346-2.815Zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',SG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>',IG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',PG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>',RG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',LG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',VG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.87 12.61a.75.75 0 0 1-.089.976l-.085.07-3.154 2.254 3.412 2.414a.75.75 0 0 1 .237.95l-.057.095a.75.75 0 0 1-.95.237l-.096-.058-4.272-3.022-.003-1.223 4.01-2.867a.75.75 0 0 1 1.047.174zm2.795-.231.095.057 4.011 2.867-.003 1.223-4.272 3.022-.095.058a.75.75 0 0 1-.88-.151l-.07-.086-.058-.095a.75.75 0 0 1 .15-.88l.087-.07 3.412-2.414-3.154-2.253-.085-.071a.75.75 0 0 1 .862-1.207zM16 0a2 2 0 0 1 2 2v9.354l-.663-.492-.837-.001V2a.5.5 0 0 0-.5-.5H2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3.118L7.156 19H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h14zM5.009 15l.003 1H3v-1h2.009zm2.188-2-1.471 1H5v-1h2.197zM10 11v.095L8.668 12H7v-1h3zm4-2v1H7V9h7zm0-2v1H7V7h7zm-4-2v1H5V5h5zM6 3v1H3V3h3z"/></svg>',BG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.627 16.5zm5.873-.196zm0-7.001V8h-13v8.5h4.341c.191.54.457 1.044.785 1.5H2a1.5 1.5 0 0 1-1.5-1.5v-13A1.5 1.5 0 0 1 2 2h4.5a1.5 1.5 0 0 1 1.06.44L9.122 4H16a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 19 8v2.531a6.027 6.027 0 0 0-1.5-1.228zM16 6.5v-1H8.5l-2-2H2v13h1V8a1.5 1.5 0 0 1 1.5-1.5H16z"/><path d="M14.5 19.5a5 5 0 1 1 0-10 5 5 0 0 1 0 10zM15 14v-2h-1v2h-2v1h2v2h1v-2h2v-1h-2z"/></svg>',MG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 9v10h-2v-8h-2V9h4zM4 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H10a1 1 0 0 1-1-1V11H4v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H3a1 1 0 0 1 1 1v4.5z"/></svg>',OG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm16.076 8.343V18.5h-6.252c.067-.626.27-1.22.61-1.78.338-.561 1.006-1.305 2.005-2.232.804-.749 1.297-1.257 1.479-1.523.245-.368.368-.732.368-1.092 0-.398-.107-.703-.32-.917-.214-.214-.51-.32-.886-.32-.372 0-.669.111-.889.336-.22.224-.347.596-.38 1.117l-1.778-.178c.106-.982.438-1.686.997-2.114.558-.427 1.257-.64 2.095-.64.918 0 1.64.247 2.164.742.525.495.787 1.11.787 1.847 0 .419-.075.818-.225 1.197-.15.378-.388.775-.714 1.19-.216.275-.605.67-1.168 1.187-.563.516-.92.859-1.07 1.028a3.11 3.11 0 0 0-.365.495h3.542z"/></svg>',NG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V11H3v4.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1H2a1 1 0 0 1 1 1v4.5zm9.989 7.53 1.726-.209c.055.44.203.777.445 1.01.24.232.533.349.876.349.368 0 .678-.14.93-.42.251-.279.377-.655.377-1.13 0-.448-.12-.803-.362-1.066a1.153 1.153 0 0 0-.882-.393c-.228 0-.501.044-.819.133l.197-1.453c.482.012.85-.092 1.105-.315.253-.222.38-.517.38-.885 0-.313-.093-.563-.279-.75-.186-.185-.434-.278-.743-.278a1.07 1.07 0 0 0-.78.317c-.216.212-.347.52-.394.927l-1.644-.28c.114-.562.287-1.012.517-1.348.231-.337.553-.601.965-.794a3.24 3.24 0 0 1 1.387-.289c.876 0 1.579.28 2.108.838.436.457.653.973.653 1.549 0 .817-.446 1.468-1.339 1.955.533.114.96.37 1.28.768.319.398.478.878.478 1.441 0 .817-.298 1.513-.895 2.088-.596.576-1.339.864-2.228.864-.842 0-1.54-.243-2.094-.727-.555-.485-.876-1.118-.965-1.901z"/></svg>',FG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm13.55 10v-1.873h-3.81v-1.561l4.037-5.91h1.498v5.904h1.156v1.567h-1.156V18.5H17.05zm0-3.44v-3.18l-2.14 3.18h2.14z"/></svg>',DG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm9.578 7.607 1.777-.184c.05.402.201.72.45.955a1.223 1.223 0 0 0 1.81-.101c.258-.303.387-.759.387-1.368 0-.572-.128-1-.384-1.286-.256-.285-.59-.428-1-.428-.512 0-.971.226-1.377.679l-1.448-.21.915-4.843h4.716v1.67H15.56l-.28 1.58a2.697 2.697 0 0 1 1.219-.298 2.68 2.68 0 0 1 2.012.863c.55.576.825 1.323.825 2.241a3.36 3.36 0 0 1-.666 2.05c-.605.821-1.445 1.232-2.52 1.232-.86 0-1.56-.23-2.101-.692-.542-.461-.866-1.081-.971-1.86z"/></svg>',$G='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 8.5h5V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v11.5a1 1 0 0 1-1 1h-.5a1 1 0 0 1-1-1V11h-5v4.5a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h.5a1 1 0 0 1 1 1v4.5zm15.595 2.973-1.726.19c-.043-.355-.153-.617-.33-.787-.178-.169-.409-.253-.692-.253-.377 0-.695.169-.956.507-.26.339-.424 1.043-.492 2.114.445-.525.997-.787 1.657-.787.745 0 1.383.284 1.914.85.531.568.797 1.3.797 2.197 0 .952-.28 1.716-.838 2.291-.559.576-1.276.864-2.152.864-.94 0-1.712-.365-2.317-1.095-.605-.73-.908-1.927-.908-3.59 0-1.705.316-2.935.946-3.688.63-.753 1.45-1.13 2.457-1.13.706 0 1.291.198 1.755.594.463.395.758.97.885 1.723zm-4.043 3.891c0 .58.133 1.028.4 1.343.266.315.57.473.914.473.33 0 .605-.13.825-.388.22-.258.33-.68.33-1.27 0-.604-.118-1.047-.355-1.329a1.115 1.115 0 0 0-.89-.422c-.342 0-.632.134-.869.403s-.355.666-.355 1.19z"/></svg>',HG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>',zG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M17 0a2 2 0 0 1 2 2v7a1 1 0 0 1 1 1v5a1 1 0 0 1-.883.993l-.118.006L19 17a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2l-.001-1.001-.116-.006A1 1 0 0 1 0 15v-5a1 1 0 0 1 .999-1L1 2a2 2 0 0 1 2-2h14zm.499 15.999h-15L2.5 17a.5.5 0 0 0 .5.5h14a.5.5 0 0 0 .5-.5l-.001-1.001zm-3.478-6.013-.014.014H14v.007l-1.525 1.525-1.46-1.46-.015.013V10h-1v5h1v-3.53l1.428 1.43.048.043.131-.129L14 11.421V15h1v-5h-.965l-.014-.014zM2 10H1v5h1v-2h2v2h1v-5H4v2H2v-2zm7 0H6v1h1v4h1v-4h1v-1zm8 0h-1v5h3v-1h-2v-4zm0-8.5H3a.5.5 0 0 0-.5.5l-.001 6.999h15L17.5 2a.5.5 0 0 0-.5-.5zM10 7v1H4V7h6zm3-2v1H4V5h9zm-3-2v1H4V3h6z"/></svg>',UG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',WG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>',qG='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.5v3h4v-3H3Zm0 4v3h4v-3H3Zm0 4v3h4v-3H3Zm5 3h4v-3H8v3Zm5 0h4v-3h-4v3Zm4-4v-3h-4v3h4Zm0-4v-3h-4v3h4Zm1.5 8A1.5 1.5 0 0 1 17 18H3a1.5 1.5 0 0 1-1.5-1.5V3c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13.5Zm-6.5-4v-3H8v3h4Zm0-4v-3H8v3h4Z"/></svg>';const F={bold:kG,cancel:Nj,caption:Fj,check:Dj,cog:$j,colorPalette:Hj,eraser:zj,history:Uj,image:Zj,imageUpload:Jj,imageAssetManager:Yj,imageUrl:Xj,lowVision:Wj,textAlternative:qj,loupe:jj,previousArrow:Gj,nextArrow:Kj,importExport:xG,paragraph:TG,plus:EG,text:AG,alignBottom:Qj,alignMiddle:eG,alignTop:tG,alignLeft:nG,alignCenter:iG,alignRight:sG,alignJustify:oG,objectLeft:dG,objectCenter:aG,objectRight:hG,objectFullWidth:cG,objectInline:uG,objectBlockLeft:rG,objectBlockRight:lG,objectSizeCustom:mG,objectSizeFull:fG,objectSizeLarge:gG,objectSizeSmall:pG,objectSizeMedium:bG,pencil:wG,pilcrow:_G,quote:vG,threeVerticalDots:yG,dragIndicator:CG,redo:SG,undo:IG,bulletedList:PG,numberedList:RG,todoList:LG,codeBlock:VG,browseFiles:BG,heading1:MG,heading2:OG,heading3:NG,heading4:FG,heading5:DG,heading6:$G,horizontalLine:HG,html:zG,indent:UG,outdent:WG,table:qG};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class jG extends Ve(){constructor(){super();h(this,"total");h(this,"_reader");h(this,"_data");const e=new window.FileReader;this._reader=e,this._data=void 0,this.set("loaded",0),e.onprogress=i=>{this.loaded=i.loaded}}get error(){return this._reader.error}get data(){return this._data}read(e){const i=this._reader;return this.total=e.size,new Promise((s,o)=>{i.onload=()=>{const r=i.result;this._data=r,s(r)},i.onerror=()=>{o("error")},i.onabort=()=>{o("aborted")},this._reader.readAsDataURL(e)})}abort(){this._reader.abort()}}class nl extends A{constructor(){super(...arguments);h(this,"loaders",new rn);h(this,"_loadersMap",new Map);h(this,"_pendingAction",null)}static get pluginName(){return"FileRepository"}static get requires(){return[Hr]}init(){this.loaders.on("change",()=>this._updatePendingAction()),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(e,i)=>i?e/i*100:0)}getLoader(e){return this._loadersMap.get(e)||null}createLoader(e){if(!this.createUploadAdapter)return Te("filerepository-no-upload-adapter"),null;const i=new f_(Promise.resolve(e),this.createUploadAdapter);return this.loaders.add(i),this._loadersMap.set(e,i),e instanceof Promise&&i.file.then(s=>{this._loadersMap.set(s,i)}).catch(()=>{}),i.on("change:uploaded",()=>{let s=0;for(const o of this.loaders)s+=o.uploaded;this.uploaded=s}),i.on("change:uploadTotal",()=>{let s=0;for(const o of this.loaders)o.uploadTotal&&(s+=o.uploadTotal);this.uploadTotal=s}),i}destroyLoader(e){const i=e instanceof f_?e:this.getLoader(e);i._destroy(),this.loaders.remove(i),this._loadersMap.forEach((s,o)=>{s===i&&this._loadersMap.delete(o)})}_updatePendingAction(){const e=this.editor.plugins.get(Hr);if(this.loaders.length){if(!this._pendingAction){const i=this.editor.t,s=o=>`${i("Upload in progress")} ${parseInt(o)}%.`;this._pendingAction=e.add(s(this.uploadedPercent)),this._pendingAction.bind("message").to(this,"uploadedPercent",s)}}else e.remove(this._pendingAction),this._pendingAction=null}}class f_ extends Ve(){constructor(e,i){super();h(this,"id");h(this,"_filePromiseWrapper");h(this,"_adapter");h(this,"_reader");this.id=Cn(),this._filePromiseWrapper=this._createFilePromiseWrapper(e),this._adapter=i(this),this._reader=new jG,this.set("status","idle"),this.set("uploaded",0),this.set("uploadTotal",null),this.bind("uploadedPercent").to(this,"uploaded",this,"uploadTotal",(s,o)=>o?s/o*100:0),this.set("uploadResponse",null)}get file(){return this._filePromiseWrapper?this._filePromiseWrapper.promise.then(e=>this._filePromiseWrapper?e:null):Promise.resolve(null)}get data(){return this._reader.data}read(){if(this.status!="idle")throw new C("filerepository-read-wrong-status",this);return this.status="reading",this.file.then(e=>this._reader.read(e)).then(e=>{if(this.status!=="reading")throw this.status;return this.status="idle",e}).catch(e=>{throw e==="aborted"?(this.status="aborted","aborted"):(this.status="error",this._reader.error?this._reader.error:e)})}upload(){if(this.status!="idle")throw new C("filerepository-upload-wrong-status",this);return this.status="uploading",this.file.then(()=>this._adapter.upload()).then(e=>(this.uploadResponse=e,this.status="idle",e)).catch(e=>{throw this.status==="aborted"?"aborted":(this.status="error",e)})}abort(){const e=this.status;this.status="aborted",this._filePromiseWrapper.isFulfilled?e=="reading"?this._reader.abort():e=="uploading"&&this._adapter.abort&&this._adapter.abort():(this._filePromiseWrapper.promise.catch(()=>{}),this._filePromiseWrapper.rejecter("aborted")),this._destroy()}_destroy(){this._filePromiseWrapper=void 0,this._reader=void 0,this._adapter=void 0,this.uploadResponse=void 0}_createFilePromiseWrapper(e){const i={};return i.promise=new Promise((s,o)=>{i.rejecter=o,i.isFulfilled=!1,e.then(r=>{i.isFulfilled=!0,s(r)}).catch(r=>{i.isFulfilled=!0,o(r)})}),i}}function Lh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function cI(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var s=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:function(){return n[i]}})}),e}var uI={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};const m_=Lh(uI);var g_={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function p_(n){var t,e=[],i=1,s;if(typeof n=="string")if(m_[n])e=m_[n].slice(),s="rgb";else if(n==="transparent")i=0,s="rgb",e=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(n)){var o=n.slice(1),r=o.length,a=r<=4;i=1,a?(e=[parseInt(o[0]+o[0],16),parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16)],r===4&&(i=parseInt(o[3]+o[3],16)/255)):(e=[parseInt(o[0]+o[1],16),parseInt(o[2]+o[3],16),parseInt(o[4]+o[5],16)],r===8&&(i=parseInt(o[6]+o[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),s="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(n)){var l=t[1],c=l==="rgb",o=l.replace(/a$/,"");s=o;var r=o==="cmyk"?4:o==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(f,m){if(/%$/.test(f))return m===r?parseFloat(f)/100:o==="rgb"?parseFloat(f)*255/100:parseFloat(f);if(o[m]==="h"){if(/deg$/.test(f))return parseFloat(f);if(g_[f]!==void 0)return g_[f]}return parseFloat(f)}),l===o&&e.push(1),i=c||e[r]===void 0?1:e[r],e=e.slice(0,r)}else n.length>10&&/[0-9](?:\s|\/)/.test(n)&&(e=n.match(/([0-9]+)/g).map(function(u){return parseFloat(u)}),s=n.match(/([a-z])/ig).join("").toLowerCase());else isNaN(n)?Array.isArray(n)||n.length?(e=[n[0],n[1],n[2]],s="rgb",i=n.length===4?n[3]:1):n instanceof Object&&(n.r!=null||n.red!=null||n.R!=null?(s="rgb",e=[n.r||n.red||n.R||0,n.g||n.green||n.G||0,n.b||n.blue||n.B||0]):(s="hsl",e=[n.h||n.hue||n.H||0,n.s||n.saturation||n.S||0,n.l||n.lightness||n.L||n.b||n.brightness]),i=n.a||n.alpha||n.opacity||1,n.opacity!=null&&(i/=100)):(s="rgb",e=[n>>>16,(n&65280)>>>8,n&255]);return{space:s,values:e,alpha:i}}const Al=uI,dI={};for(const n of Object.keys(Al))dI[Al[n]]=n;const Q={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};var hI=Q;for(const n of Object.keys(Q)){if(!("channels"in Q[n]))throw new Error("missing channels property: "+n);if(!("labels"in Q[n]))throw new Error("missing channel labels property: "+n);if(Q[n].labels.length!==Q[n].channels)throw new Error("channel and label counts mismatch: "+n);const{channels:t,labels:e}=Q[n];delete Q[n].channels,delete Q[n].labels,Object.defineProperty(Q[n],"channels",{value:t}),Object.defineProperty(Q[n],"labels",{value:e})}Q.rgb.hsl=function(n){const t=n[0]/255,e=n[1]/255,i=n[2]/255,s=Math.min(t,e,i),o=Math.max(t,e,i),r=o-s;let a,l;o===s?a=0:t===o?a=(e-i)/r:e===o?a=2+(i-t)/r:i===o&&(a=4+(t-e)/r),a=Math.min(a*60,360),a<0&&(a+=360);const c=(s+o)/2;return o===s?l=0:c<=.5?l=r/(o+s):l=r/(2-o-s),[a,l*100,c*100]};Q.rgb.hsv=function(n){let t,e,i,s,o;const r=n[0]/255,a=n[1]/255,l=n[2]/255,c=Math.max(r,a,l),u=c-Math.min(r,a,l),d=function(f){return(c-f)/6/u+1/2};return u===0?(s=0,o=0):(o=u/c,t=d(r),e=d(a),i=d(l),r===c?s=i-e:a===c?s=1/3+t-i:l===c&&(s=2/3+e-t),s<0?s+=1:s>1&&(s-=1)),[s*360,o*100,c*100]};Q.rgb.hwb=function(n){const t=n[0],e=n[1];let i=n[2];const s=Q.rgb.hsl(n)[0],o=1/255*Math.min(t,Math.min(e,i));return i=1-1/255*Math.max(t,Math.max(e,i)),[s,o*100,i*100]};Q.rgb.cmyk=function(n){const t=n[0]/255,e=n[1]/255,i=n[2]/255,s=Math.min(1-t,1-e,1-i),o=(1-t-s)/(1-s)||0,r=(1-e-s)/(1-s)||0,a=(1-i-s)/(1-s)||0;return[o*100,r*100,a*100,s*100]};function GG(n,t){return(n[0]-t[0])**2+(n[1]-t[1])**2+(n[2]-t[2])**2}Q.rgb.keyword=function(n){const t=dI[n];if(t)return t;let e=1/0,i;for(const s of Object.keys(Al)){const o=Al[s],r=GG(n,o);r<e&&(e=r,i=s)}return i};Q.keyword.rgb=function(n){return Al[n]};Q.rgb.xyz=function(n){let t=n[0]/255,e=n[1]/255,i=n[2]/255;t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,e=e>.04045?((e+.055)/1.055)**2.4:e/12.92,i=i>.04045?((i+.055)/1.055)**2.4:i/12.92;const s=t*.4124+e*.3576+i*.1805,o=t*.2126+e*.7152+i*.0722,r=t*.0193+e*.1192+i*.9505;return[s*100,o*100,r*100]};Q.rgb.lab=function(n){const t=Q.rgb.xyz(n);let e=t[0],i=t[1],s=t[2];e/=95.047,i/=100,s/=108.883,e=e>.008856?e**(1/3):7.787*e+16/116,i=i>.008856?i**(1/3):7.787*i+16/116,s=s>.008856?s**(1/3):7.787*s+16/116;const o=116*i-16,r=500*(e-i),a=200*(i-s);return[o,r,a]};Q.hsl.rgb=function(n){const t=n[0]/360,e=n[1]/100,i=n[2]/100;let s,o,r;if(e===0)return r=i*255,[r,r,r];i<.5?s=i*(1+e):s=i+e-i*e;const a=2*i-s,l=[0,0,0];for(let c=0;c<3;c++)o=t+1/3*-(c-1),o<0&&o++,o>1&&o--,6*o<1?r=a+(s-a)*6*o:2*o<1?r=s:3*o<2?r=a+(s-a)*(2/3-o)*6:r=a,l[c]=r*255;return l};Q.hsl.hsv=function(n){const t=n[0];let e=n[1]/100,i=n[2]/100,s=e;const o=Math.max(i,.01);i*=2,e*=i<=1?i:2-i,s*=o<=1?o:2-o;const r=(i+e)/2,a=i===0?2*s/(o+s):2*e/(i+e);return[t,a*100,r*100]};Q.hsv.rgb=function(n){const t=n[0]/60,e=n[1]/100;let i=n[2]/100;const s=Math.floor(t)%6,o=t-Math.floor(t),r=255*i*(1-e),a=255*i*(1-e*o),l=255*i*(1-e*(1-o));switch(i*=255,s){case 0:return[i,l,r];case 1:return[a,i,r];case 2:return[r,i,l];case 3:return[r,a,i];case 4:return[l,r,i];case 5:return[i,r,a]}};Q.hsv.hsl=function(n){const t=n[0],e=n[1]/100,i=n[2]/100,s=Math.max(i,.01);let o,r;r=(2-e)*i;const a=(2-e)*s;return o=e*s,o/=a<=1?a:2-a,o=o||0,r/=2,[t,o*100,r*100]};Q.hwb.rgb=function(n){const t=n[0]/360;let e=n[1]/100,i=n[2]/100;const s=e+i;let o;s>1&&(e/=s,i/=s);const r=Math.floor(6*t),a=1-i;o=6*t-r,r&1&&(o=1-o);const l=e+o*(a-e);let c,u,d;switch(r){default:case 6:case 0:c=a,u=l,d=e;break;case 1:c=l,u=a,d=e;break;case 2:c=e,u=a,d=l;break;case 3:c=e,u=l,d=a;break;case 4:c=l,u=e,d=a;break;case 5:c=a,u=e,d=l;break}return[c*255,u*255,d*255]};Q.cmyk.rgb=function(n){const t=n[0]/100,e=n[1]/100,i=n[2]/100,s=n[3]/100,o=1-Math.min(1,t*(1-s)+s),r=1-Math.min(1,e*(1-s)+s),a=1-Math.min(1,i*(1-s)+s);return[o*255,r*255,a*255]};Q.xyz.rgb=function(n){const t=n[0]/100,e=n[1]/100,i=n[2]/100;let s,o,r;return s=t*3.2406+e*-1.5372+i*-.4986,o=t*-.9689+e*1.8758+i*.0415,r=t*.0557+e*-.204+i*1.057,s=s>.0031308?1.055*s**(1/2.4)-.055:s*12.92,o=o>.0031308?1.055*o**(1/2.4)-.055:o*12.92,r=r>.0031308?1.055*r**(1/2.4)-.055:r*12.92,s=Math.min(Math.max(0,s),1),o=Math.min(Math.max(0,o),1),r=Math.min(Math.max(0,r),1),[s*255,o*255,r*255]};Q.xyz.lab=function(n){let t=n[0],e=n[1],i=n[2];t/=95.047,e/=100,i/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,e=e>.008856?e**(1/3):7.787*e+16/116,i=i>.008856?i**(1/3):7.787*i+16/116;const s=116*e-16,o=500*(t-e),r=200*(e-i);return[s,o,r]};Q.lab.xyz=function(n){const t=n[0],e=n[1],i=n[2];let s,o,r;o=(t+16)/116,s=e/500+o,r=o-i/200;const a=o**3,l=s**3,c=r**3;return o=a>.008856?a:(o-16/116)/7.787,s=l>.008856?l:(s-16/116)/7.787,r=c>.008856?c:(r-16/116)/7.787,s*=95.047,o*=100,r*=108.883,[s,o,r]};Q.lab.lch=function(n){const t=n[0],e=n[1],i=n[2];let s;s=Math.atan2(i,e)*360/2/Math.PI,s<0&&(s+=360);const r=Math.sqrt(e*e+i*i);return[t,r,s]};Q.lch.lab=function(n){const t=n[0],e=n[1],s=n[2]/360*2*Math.PI,o=e*Math.cos(s),r=e*Math.sin(s);return[t,o,r]};Q.rgb.ansi16=function(n,t=null){const[e,i,s]=n;let o=t===null?Q.rgb.hsv(n)[2]:t;if(o=Math.round(o/50),o===0)return 30;let r=30+(Math.round(s/255)<<2|Math.round(i/255)<<1|Math.round(e/255));return o===2&&(r+=60),r};Q.hsv.ansi16=function(n){return Q.rgb.ansi16(Q.hsv.rgb(n),n[2])};Q.rgb.ansi256=function(n){const t=n[0],e=n[1],i=n[2];return t===e&&e===i?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(e/255*5)+Math.round(i/255*5)};Q.ansi16.rgb=function(n){let t=n%10;if(t===0||t===7)return n>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const e=(~~(n>50)+1)*.5,i=(t&1)*e*255,s=(t>>1&1)*e*255,o=(t>>2&1)*e*255;return[i,s,o]};Q.ansi256.rgb=function(n){if(n>=232){const o=(n-232)*10+8;return[o,o,o]}n-=16;let t;const e=Math.floor(n/36)/5*255,i=Math.floor((t=n%36)/6)/5*255,s=t%6/5*255;return[e,i,s]};Q.rgb.hex=function(n){const e=(((Math.round(n[0])&255)<<16)+((Math.round(n[1])&255)<<8)+(Math.round(n[2])&255)).toString(16).toUpperCase();return"000000".substring(e.length)+e};Q.hex.rgb=function(n){const t=n.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let e=t[0];t[0].length===3&&(e=e.split("").map(a=>a+a).join(""));const i=parseInt(e,16),s=i>>16&255,o=i>>8&255,r=i&255;return[s,o,r]};Q.rgb.hcg=function(n){const t=n[0]/255,e=n[1]/255,i=n[2]/255,s=Math.max(Math.max(t,e),i),o=Math.min(Math.min(t,e),i),r=s-o;let a,l;return r<1?a=o/(1-r):a=0,r<=0?l=0:s===t?l=(e-i)/r%6:s===e?l=2+(i-t)/r:l=4+(t-e)/r,l/=6,l%=1,[l*360,r*100,a*100]};Q.hsl.hcg=function(n){const t=n[1]/100,e=n[2]/100,i=e<.5?2*t*e:2*t*(1-e);let s=0;return i<1&&(s=(e-.5*i)/(1-i)),[n[0],i*100,s*100]};Q.hsv.hcg=function(n){const t=n[1]/100,e=n[2]/100,i=t*e;let s=0;return i<1&&(s=(e-i)/(1-i)),[n[0],i*100,s*100]};Q.hcg.rgb=function(n){const t=n[0]/360,e=n[1]/100,i=n[2]/100;if(e===0)return[i*255,i*255,i*255];const s=[0,0,0],o=t%1*6,r=o%1,a=1-r;let l=0;switch(Math.floor(o)){case 0:s[0]=1,s[1]=r,s[2]=0;break;case 1:s[0]=a,s[1]=1,s[2]=0;break;case 2:s[0]=0,s[1]=1,s[2]=r;break;case 3:s[0]=0,s[1]=a,s[2]=1;break;case 4:s[0]=r,s[1]=0,s[2]=1;break;default:s[0]=1,s[1]=0,s[2]=a}return l=(1-e)*i,[(e*s[0]+l)*255,(e*s[1]+l)*255,(e*s[2]+l)*255]};Q.hcg.hsv=function(n){const t=n[1]/100,e=n[2]/100,i=t+e*(1-t);let s=0;return i>0&&(s=t/i),[n[0],s*100,i*100]};Q.hcg.hsl=function(n){const t=n[1]/100,i=n[2]/100*(1-t)+.5*t;let s=0;return i>0&&i<.5?s=t/(2*i):i>=.5&&i<1&&(s=t/(2*(1-i))),[n[0],s*100,i*100]};Q.hcg.hwb=function(n){const t=n[1]/100,e=n[2]/100,i=t+e*(1-t);return[n[0],(i-t)*100,(1-i)*100]};Q.hwb.hcg=function(n){const t=n[1]/100,i=1-n[2]/100,s=i-t;let o=0;return s<1&&(o=(i-s)/(1-s)),[n[0],s*100,o*100]};Q.apple.rgb=function(n){return[n[0]/65535*255,n[1]/65535*255,n[2]/65535*255]};Q.rgb.apple=function(n){return[n[0]/255*65535,n[1]/255*65535,n[2]/255*65535]};Q.gray.rgb=function(n){return[n[0]/100*255,n[0]/100*255,n[0]/100*255]};Q.gray.hsl=function(n){return[0,0,n[0]]};Q.gray.hsv=Q.gray.hsl;Q.gray.hwb=function(n){return[0,100,n[0]]};Q.gray.cmyk=function(n){return[0,0,0,n[0]]};Q.gray.lab=function(n){return[n[0],0,0]};Q.gray.hex=function(n){const t=Math.round(n[0]/100*255)&255,i=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(i.length)+i};Q.rgb.gray=function(n){return[(n[0]+n[1]+n[2])/3/255*100]};const td=hI;function KG(){const n={},t=Object.keys(td);for(let e=t.length,i=0;i<e;i++)n[t[i]]={distance:-1,parent:null};return n}function ZG(n){const t=KG(),e=[n];for(t[n].distance=0;e.length;){const i=e.pop(),s=Object.keys(td[i]);for(let o=s.length,r=0;r<o;r++){const a=s[r],l=t[a];l.distance===-1&&(l.distance=t[i].distance+1,l.parent=i,e.unshift(a))}}return t}function JG(n,t){return function(e){return t(n(e))}}function YG(n,t){const e=[t[n].parent,n];let i=td[t[n].parent][n],s=t[n].parent;for(;t[s].parent;)e.unshift(t[s].parent),i=JG(td[t[s].parent][s],i),s=t[s].parent;return i.conversion=e,i}var XG=function(n){const t=ZG(n),e={},i=Object.keys(t);for(let s=i.length,o=0;o<s;o++){const r=i[o];t[r].parent!==null&&(e[r]=YG(r,t))}return e};const jm=hI,QG=XG,gr={},eK=Object.keys(jm);function tK(n){const t=function(...e){const i=e[0];return i==null?i:(i.length>1&&(e=i),n(e))};return"conversion"in n&&(t.conversion=n.conversion),t}function nK(n){const t=function(...e){const i=e[0];if(i==null)return i;i.length>1&&(e=i);const s=n(e);if(typeof s=="object")for(let o=s.length,r=0;r<o;r++)s[r]=Math.round(s[r]);return s};return"conversion"in n&&(t.conversion=n.conversion),t}eK.forEach(n=>{gr[n]={},Object.defineProperty(gr[n],"channels",{value:jm[n].channels}),Object.defineProperty(gr[n],"labels",{value:jm[n].labels});const t=QG(n);Object.keys(t).forEach(i=>{const s=t[i];gr[n][i]=nK(s),gr[n][i].raw=tK(s)})});var fI=gr;const iK=Lh(fI),mI=KR({__proto__:null,default:iK},[fI]),xl=(n,t=0,e=1)=>n>e?e:n<t?t:n,Ot=(n,t=0,e=Math.pow(10,t))=>Math.round(e*n)/e,sK=n=>cK(Gm(n)),Gm=n=>(n[0]==="#"&&(n=n.substring(1)),n.length<6?{r:parseInt(n[0]+n[0],16),g:parseInt(n[1]+n[1],16),b:parseInt(n[2]+n[2],16),a:n.length===4?Ot(parseInt(n[3]+n[3],16)/255,2):1}:{r:parseInt(n.substring(0,2),16),g:parseInt(n.substring(2,4),16),b:parseInt(n.substring(4,6),16),a:n.length===8?Ot(parseInt(n.substring(6,8),16)/255,2):1}),oK=n=>lK(aK(n)),rK=({h:n,s:t,v:e,a:i})=>{const s=(200-t)*e/100;return{h:Ot(n),s:Ot(s>0&&s<200?t*e/100/(s<=100?s:200-s)*100:0),l:Ot(s/2),a:Ot(i,2)}},Km=n=>{const{h:t,s:e,l:i}=rK(n);return`hsl(${t}, ${e}%, ${i}%)`},aK=({h:n,s:t,v:e,a:i})=>{n=n/360*6,t=t/100,e=e/100;const s=Math.floor(n),o=e*(1-t),r=e*(1-(n-s)*t),a=e*(1-(1-n+s)*t),l=s%6;return{r:Ot([e,r,o,o,a,e][l]*255),g:Ot([a,e,e,r,o,o][l]*255),b:Ot([o,o,a,e,e,r][l]*255),a:Ot(i,2)}},zc=n=>{const t=n.toString(16);return t.length<2?"0"+t:t},lK=({r:n,g:t,b:e,a:i})=>{const s=i<1?zc(Ot(i*255)):"";return"#"+zc(n)+zc(t)+zc(e)+s},cK=({r:n,g:t,b:e,a:i})=>{const s=Math.max(n,t,e),o=s-Math.min(n,t,e),r=o?s===n?(t-e)/o:s===t?2+(e-n)/o:4+(n-t)/o:0;return{h:Ot(60*(r<0?r+6:r)),s:Ot(s?o/s*100:0),v:Ot(s/255*100),a:i}},gI=(n,t)=>{if(n===t)return!0;for(const e in n)if(n[e]!==t[e])return!1;return!0},uK=(n,t)=>n.toLowerCase()===t.toLowerCase()?!0:gI(Gm(n),Gm(t)),b_={},pI=n=>{let t=b_[n];return t||(t=document.createElement("template"),t.innerHTML=n,b_[n]=t),t},Vb=(n,t,e)=>{n.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e}))};let Lr=!1;const Zm=n=>"touches"in n,dK=n=>Lr&&!Zm(n)?!1:(Lr||(Lr=Zm(n)),!0),w_=(n,t)=>{const e=Zm(t)?t.touches[0]:t,i=n.el.getBoundingClientRect();Vb(n.el,"move",n.getMove({x:xl((e.pageX-(i.left+window.pageXOffset))/i.width),y:xl((e.pageY-(i.top+window.pageYOffset))/i.height)}))},hK=(n,t)=>{const e=t.keyCode;e>40||n.xy&&e<37||e<33||(t.preventDefault(),Vb(n.el,"move",n.getMove({x:e===39?.01:e===37?-.01:e===34?.05:e===33?-.05:e===35?1:e===36?-1:0,y:e===40?.01:e===38?-.01:0},!0)))};class bI{constructor(t,e,i,s){const o=pI(`<div role="slider" tabindex="0" part="${e}" ${i}><div part="${e}-pointer"></div></div>`);t.appendChild(o.content.cloneNode(!0));const r=t.querySelector(`[part=${e}]`);r.addEventListener("mousedown",this),r.addEventListener("touchstart",this),r.addEventListener("keydown",this),this.el=r,this.xy=s,this.nodes=[r.firstChild,r]}set dragging(t){const e=t?document.addEventListener:document.removeEventListener;e(Lr?"touchmove":"mousemove",this),e(Lr?"touchend":"mouseup",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t.preventDefault(),!dK(t)||!Lr&&t.button!=0)return;this.el.focus(),w_(this,t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),w_(this,t);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":hK(this,t);break}}style(t){t.forEach((e,i)=>{for(const s in e)this.nodes[i].style.setProperty(s,e[s])})}}class fK extends bI{constructor(t){super(t,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:t}){this.h=t,this.style([{left:`${t/360*100}%`,color:Km({h:t,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${Ot(t)}`)}getMove(t,e){return{h:e?xl(this.h+t.x*360,0,360):360*t.x}}}class mK extends bI{constructor(t){super(t,"saturation",'aria-label="Color"',!0)}update(t){this.hsva=t,this.style([{top:`${100-t.v}%`,left:`${t.s}%`,color:Km(t)},{"background-color":Km({h:t.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${Ot(t.s)}%, Brightness ${Ot(t.v)}%`)}getMove(t,e){return{s:e?xl(this.hsva.s+t.x*100,0,100):t.x*100,v:e?xl(this.hsva.v-t.y*100,0,100):Math.round(100-t.y*100)}}}const gK=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',pK="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",bK="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",Uc=Symbol("same"),kf=Symbol("color"),__=Symbol("hsva"),Tf=Symbol("update"),v_=Symbol("parts"),y_=Symbol("css"),C_=Symbol("sliders");class wK extends HTMLElement{static get observedAttributes(){return["color"]}get[y_](){return[gK,pK,bK]}get[C_](){return[mK,fK]}get color(){return this[kf]}set color(t){if(!this[Uc](t)){const e=this.colorModel.toHsva(t);this[Tf](e),this[kf]=t}}constructor(){super();const t=pI(`<style>${this[y_].join("")}</style>`),e=this.attachShadow({mode:"open"});e.appendChild(t.content.cloneNode(!0)),e.addEventListener("move",this),this[v_]=this[C_].map(i=>new i(e))}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,e,i){const s=this.colorModel.fromAttr(i);this[Uc](s)||(this.color=s)}handleEvent(t){const e=this[__],i={...e,...t.detail};this[Tf](i);let s;!gI(i,e)&&!this[Uc](s=this.colorModel.fromHsva(i))&&(this[kf]=s,Vb(this,"color-changed",{value:s}))}[Uc](t){return this.color&&this.colorModel.equal(t,this.color)}[Tf](t){this[__]=t,this[v_].forEach(e=>e.update(t))}}const _K={defaultColor:"#000",toHsva:sK,fromHsva:({h:n,s:t,v:e})=>oK({h:n,s:t,v:e,a:1}),equal:uK,fromAttr:n=>n};class vK extends wK{get colorModel(){return _K}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mt extends rn{constructor(e=[]){super(e,{idProperty:"viewUid"});h(this,"_parentElement");this.on("add",(i,s,o)=>{this._renderViewIntoCollectionParent(s,o)}),this.on("remove",(i,s)=>{s.element&&this._parentElement&&s.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const i of this)this._renderViewIntoCollectionParent(i)}delegate(...e){if(!e.length||!yK(e))throw new C("ui-viewcollection-delegate-wrong-events",this);return{to:i=>{for(const s of this)for(const o of e)s.delegate(o).to(i);this.on("add",(s,o)=>{for(const r of e)o.delegate(r).to(i)}),this.on("remove",(s,o)=>{for(const r of e)o.stopDelegating(r,i)})}}}_renderViewIntoCollectionParent(e,i){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[i])}remove(e){return super.remove(e)}}function yK(n){return n.every(t=>typeof t=="string")}const CK="http://www.w3.org/1999/xhtml";class bn extends De(){constructor(e){super();h(this,"ns");h(this,"tag");h(this,"text");h(this,"attributes");h(this,"children");h(this,"eventListeners");h(this,"_isRendered");h(this,"_revertData");Object.assign(this,T_(k_(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=x_(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new C("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(i){if(i.children)for(const s of i.children)nd(s)?yield s:Bb(s)&&(yield*e(s))}yield*e(this)}static bind(e,i){return{to(s,o){return new kK({eventNameOrFunction:s,attribute:s,observable:e,emitter:i,callback:o})},if(s,o,r){return new wI({observable:e,emitter:i,attribute:s,valueIfTrue:o,callback:r})}}}static extend(e,i){if(e._isRendered)throw new C("template-extend-render",[this,e]);CI(e,T_(k_(i)))}_renderNode(e){let i;if(e.node?i=this.tag&&this.text:i=this.tag?this.text:!this.text,i)throw new C("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let i=e.node;return i||(i=e.node=document.createElementNS(this.ns||CK,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),i}_renderText(e){let i=e.node;return i?e.revertData.text=i.textContent:i=e.node=document.createTextNode(""),gu(this.text)?this._bindToObservable({schema:this.text,updater:EK(i),data:e}):i.textContent=this.text.join(""),i}_renderAttributes(e){if(!this.attributes)return;const i=e.node,s=e.revertData;for(const o in this.attributes){const r=i.getAttribute(o),a=this.attributes[o];s&&(s.attributes[o]=r);const l=A_(a)?a[0].ns:null;if(gu(a)){const c=A_(a)?a[0].value:a;s&&S_(o)&&c.unshift(r),this._bindToObservable({schema:c,updater:AK(i,o,l),data:e})}else if(o=="style"&&typeof a[0]!="string")this._renderStyleAttribute(a[0],e);else{s&&r&&S_(o)&&a.unshift(r);const c=a.map(u=>u&&(u.value||u)).reduce((u,d)=>u.concat(d),[]).reduce(yI,"");zr(c)||i.setAttributeNS(l,o,c)}}}_renderStyleAttribute(e,i){const s=i.node;for(const o in e){const r=e[o];gu(r)?this._bindToObservable({schema:[r],updater:xK(s,o),data:i}):s.style[o]=r}}_renderElementChildren(e){const i=e.node,s=e.intoFragment?document.createDocumentFragment():i,o=e.isApplying;let r=0;for(const a of this.children)if(Mb(a)){if(!o){a.setParent(i);for(const l of a)s.appendChild(l.element)}}else if(nd(a))o||(a.isRendered||a.render(),s.appendChild(a.element));else if(zs(a))s.appendChild(a);else if(o){const l=e.revertData,c=x_();l.children.push(c),a._renderNode({intoFragment:!1,node:s.childNodes[r++],isApplying:!0,revertData:c})}else s.appendChild(a.render());e.intoFragment&&i.appendChild(s)}_setUpListeners(e){if(this.eventListeners)for(const i in this.eventListeners){const s=this.eventListeners[i].map(o=>{const[r,a]=i.split("@");return o.activateDomEventListener(r,a,e)});e.revertData&&e.revertData.bindings.push(s)}}_bindToObservable({schema:e,updater:i,data:s}){const o=s.revertData;_I(e,i,s);const r=e.filter(a=>!zr(a)).filter(a=>a.observable).map(a=>a.activateAttributeListener(e,i,s));o&&o.bindings.push(r)}_revertTemplateFromNode(e,i){for(const o of i.bindings)for(const r of o)r();if(i.text){e.textContent=i.text;return}const s=e;for(const o in i.attributes){const r=i.attributes[o];r===null?s.removeAttribute(o):s.setAttribute(o,r)}for(let o=0;o<i.children.length;++o)this._revertTemplateFromNode(s.childNodes[o],i.children[o])}}class sc{constructor(t){h(this,"attribute");h(this,"observable");h(this,"emitter");h(this,"callback");this.attribute=t.attribute,this.observable=t.observable,this.emitter=t.emitter,this.callback=t.callback}getValue(t){const e=this.observable[this.attribute];return this.callback?this.callback(e,t):e}activateAttributeListener(t,e,i){const s=()=>_I(t,e,i);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,s),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,s)}}}class kK extends sc{constructor(e){super(e);h(this,"eventNameOrFunction");this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,i,s){const o=(r,a)=>{(!i||a.target.matches(i))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(a):this.observable.fire(this.eventNameOrFunction,a))};return this.emitter.listenTo(s.node,e,o),()=>{this.emitter.stopListening(s.node,e,o)}}}class wI extends sc{constructor(e){super(e);h(this,"valueIfTrue");this.valueIfTrue=e.valueIfTrue}getValue(e){const i=super.getValue(e);return zr(i)?!1:this.valueIfTrue||!0}}function gu(n){return n?(n.value&&(n=n.value),Array.isArray(n)?n.some(gu):n instanceof sc):!1}function TK(n,t){return n.map(e=>e instanceof sc?e.getValue(t):e)}function _I(n,t,{node:e}){const i=TK(n,e);let s;n.length==1&&n[0]instanceof wI?s=i[0]:s=i.reduce(yI,""),zr(s)?t.remove():t.set(s)}function EK(n){return{set(t){n.textContent=t},remove(){n.textContent=""}}}function AK(n,t,e){return{set(i){n.setAttributeNS(e,t,i)},remove(){n.removeAttributeNS(e,t)}}}function xK(n,t){return{set(e){n.style[t]=e},remove(){n.style[t]=null}}}function k_(n){return Xl(n,e=>{if(e&&(e instanceof sc||Bb(e)||nd(e)||Mb(e)))return e})}function T_(n){if(typeof n=="string"?n=PK(n):n.text&&RK(n),n.on&&(n.eventListeners=IK(n.on),delete n.on),!n.text){n.attributes&&SK(n.attributes);const t=[];if(n.children)if(Mb(n.children))t.push(n.children);else for(const e of n.children)Bb(e)||nd(e)||zs(e)?t.push(e):t.push(new bn(e));n.children=t}return n}function SK(n){for(const t in n)n[t].value&&(n[t].value=Pe(n[t].value)),vI(n,t)}function IK(n){for(const t in n)vI(n,t);return n}function PK(n){return{text:[n]}}function RK(n){n.text=Pe(n.text)}function vI(n,t){n[t]=Pe(n[t])}function yI(n,t){return zr(t)?n:zr(n)?t:`${n} ${t}`}function E_(n,t){for(const e in t)n[e]?n[e].push(...t[e]):n[e]=t[e]}function CI(n,t){if(t.attributes&&(n.attributes||(n.attributes={}),E_(n.attributes,t.attributes)),t.eventListeners&&(n.eventListeners||(n.eventListeners={}),E_(n.eventListeners,t.eventListeners)),t.text&&n.text.push(...t.text),t.children&&t.children.length){if(n.children.length!=t.children.length)throw new C("ui-template-extend-children-mismatch",n);let e=0;for(const i of t.children)CI(n.children[e++],i)}}function zr(n){return!n&&n!==0}function nd(n){return n instanceof q}function Bb(n){return n instanceof bn}function Mb(n){return n instanceof Mt}function A_(n){return Ce(n[0])&&n[0].ns}function x_(){return{children:[],bindings:[],attributes:{}}}function S_(n){return n=="class"||n=="style"}class q extends on(Ve()){constructor(e){super();h(this,"element");h(this,"isRendered");h(this,"locale");h(this,"t");h(this,"template");h(this,"_viewCollections");h(this,"_unboundChildren");h(this,"_bindTemplate");this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new rn,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(i,s)=>{s.locale=e,s.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=bn.bind(this,this)}createCollection(e){const i=new Mt(e);return this._viewCollections.add(i),i}registerChild(e){Dn(e)||(e=[e]);for(const i of e)this._unboundChildren.add(i)}deregisterChild(e){Dn(e)||(e=[e]);for(const i of e)this._unboundChildren.remove(i)}setTemplate(e){this.template=new bn(e)}extendTemplate(e){bn.extend(this.template,e)}render(){if(this.isRendered)throw new C("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Wo({emitter:n,activator:t,callback:e,contextElements:i}){n.listenTo(document,"mousedown",(s,o)=>{if(!t())return;const r=typeof o.composedPath=="function"?o.composedPath():[],a=typeof i=="function"?i():i;for(const l of a)if(l.contains(o.target)||r.includes(l))return;e()})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vh(n){class t extends n{disableCssTransitions(){this._isCssTransitionsDisabled=!0}enableCssTransitions(){this._isCssTransitionsDisabled=!1}constructor(...i){super(...i),this.set("_isCssTransitionsDisabled",!1),this.initializeCssTransitionDisablerMixin()}initializeCssTransitionDisablerMixin(){this.extendTemplate({attributes:{class:[this.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}}return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function qo({view:n}){n.listenTo(n.element,"submit",(t,e)=>{e.preventDefault(),n.fire("submit")},{useCapture:!0})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Bh({keystrokeHandler:n,focusTracker:t,gridItems:e,numberOfColumns:i,uiLanguageDirection:s}){const o=typeof i=="number"?()=>i:i;n.set("arrowright",r((c,u)=>s==="rtl"?l(c,u.length):a(c,u.length))),n.set("arrowleft",r((c,u)=>s==="rtl"?a(c,u.length):l(c,u.length))),n.set("arrowup",r((c,u)=>{let d=c-o();return d<0&&(d=c+o()*Math.floor(u.length/o()),d>u.length-1&&(d-=o())),d})),n.set("arrowdown",r((c,u)=>{let d=c+o();return d>u.length-1&&(d=c%o()),d}));function r(c){return u=>{const d=e.find(g=>g.element===t.focusedElement),f=e.getIndex(d),m=c(f,e);e.get(m).focus(),u.stopPropagation(),u.preventDefault()}}function a(c,u){return c===u-1?0:c+1}function l(c,u){return c===0?u-1:c-1}}const Td=class Td extends q{constructor(){super();const t=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",t.if("isVisible","ck-hidden",e=>!e),"ck-reset_all-excluded",t.if("isColorInherited","ck-icon_inherit-color")],viewBox:t.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const e=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),i=e.getAttribute("viewBox");i&&(this.viewBox=i);for(const{name:s,value:o}of Array.from(e.attributes))Td.presentationalAttributeNames.includes(s)&&this.element.setAttribute(s,o);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;e.childNodes.length>0;)this.element.appendChild(e.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(t=>{t.style.fill=this.fillColor})}};h(Td,"presentationalAttributeNames",["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"]);let es=Td;class LK extends q{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const t=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:t.to("style"),id:t.to("id")},children:[{text:t.to("text")}]})}}class te extends q{constructor(e,i=new LK){super(e);h(this,"children");h(this,"labelView");h(this,"iconView");h(this,"keystrokeView");h(this,"_focusDelayed",null);const s=this.bindTemplate,o=Cn();this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${o}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(i),this.iconView=new es,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const r={tag:"button",attributes:{class:["ck","ck-button",s.to("class"),s.if("isEnabled","ck-disabled",a=>!a),s.if("isVisible","ck-hidden",a=>!a),s.to("isOn",a=>a?"ck-on":"ck-off"),s.if("withText","ck-button_with-text"),s.if("withKeystroke","ck-button_with-keystroke")],role:s.to("role"),type:s.to("type",a=>a||"button"),tabindex:s.to("tabindex"),"aria-checked":s.to("ariaChecked"),"aria-label":s.to("ariaLabel"),"aria-labelledby":s.to("ariaLabelledBy"),"aria-disabled":s.if("isEnabled",!0,a=>!a),"aria-pressed":s.to("isOn",a=>this.isToggleable?String(!!a):!1),"data-cke-tooltip-text":s.to("_tooltipString"),"data-cke-tooltip-position":s.to("tooltipPosition")},children:this.children,on:{click:s.to(a=>{this.isEnabled?this.fire("execute"):a.preventDefault()})}};ue.isSafari&&(this._focusDelayed||(this._focusDelayed=bb(()=>this.focus(),0)),r.on.mousedown=s.to(()=>{this._focusDelayed()}),r.on.mouseup=s.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(r)}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new q;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",i=>Ju(i))}]}),e}_getTooltipString(e,i,s){return e?typeof e=="string"?e:(s&&(s=Ju(s)),e instanceof Function?e(i,s):`${i}${s?` (${s})`:""}`):""}}class Ob extends q{constructor(e,i={}){super(e);h(this,"children");h(this,"iconView");const s=this.bindTemplate;this.set("label",i.label||""),this.set("class",i.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",s.to("class")]},children:this.children}),i.icon&&(this.iconView=new es,this.iconView.content=i.icon,this.children.add(this.iconView));const o=new q(e);o.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"],role:"presentation"},children:[{text:s.to("label")}]}),this.children.add(o)}}class Gt extends De(){constructor(e){super();h(this,"focusables");h(this,"focusTracker");h(this,"keystrokeHandler");h(this,"actions");if(this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const i in e.actions){let s=e.actions[i];typeof s=="string"&&(s=[s]);for(const o of s)e.keystrokeHandler.set(o,(r,a)=>{this[i](),a()})}this.on("forwardCycle",()=>this.focusFirst(),{priority:"low"}),this.on("backwardCycle",()=>this.focusLast(),{priority:"low"})}get first(){return this.focusables.find(Ef)||null}get last(){return this.focusables.filter(Ef).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((i,s)=>{const o=i.element===this.focusTracker.focusedElement;return o&&(e=s),o}),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;if(e&&this.focusables.getIndex(e)===this.current){this.fire("forwardCycle");return}e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;if(e&&this.focusables.getIndex(e)===this.current){this.fire("backwardCycle");return}e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}_focus(e,i){e&&this.focusTracker.focusedElement!==e.element&&e.focus(i)}_getDomFocusableItem(e){const i=this.focusables.length;if(!i)return null;const s=this.current;if(s===null)return this[e===1?"first":"last"];let o=this.focusables.get(s),r=(s+i+e)%i;do{const a=this.focusables.get(r);if(Ef(a)){o=a;break}r=(r+i+e)%i}while(r!==s);return o}}function Ef(n){return oc(n)&&Io(n.element)}function oc(n){return"focus"in n&&typeof n.focus=="function"}function VK(n){return oc(n)&&"focusCycler"in n&&n.focusCycler instanceof Gt}function BK(n){class t extends n{constructor(...s){super(...s);h(this,"_onDragBound",this._onDrag.bind(this));h(this,"_onDragEndBound",this._onDragEnd.bind(this));h(this,"_lastDraggingCoordinates",{x:0,y:0});this.on("render",()=>{this._attachListeners()}),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(j.document,"mouseup",this._onDragEndBound),this.listenTo(j.document,"touchend",this._onDragEndBound),this.listenTo(j.document,"mousemove",this._onDragBound),this.listenTo(j.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(j.document,"mouseup",this._onDragEndBound),this.stopListening(j.document,"touchend",this._onDragEndBound),this.stopListening(j.document,"mousemove",this._onDragBound),this.stopListening(j.document,"touchmove",this._onDragBound)}_onDragStart(s,o){if(!this._isHandleElementPressed(o))return;this._attachDragListeners();let r=0,a=0;o instanceof MouseEvent?(r=o.clientX,a=o.clientY):(r=o.touches[0].clientX,a=o.touches[0].clientY),this._lastDraggingCoordinates={x:r,y:a},this.isDragging=!0}_onDrag(s,o){if(!this.isDragging){this._detachDragListeners();return}let r=0,a=0;o instanceof MouseEvent?(r=o.clientX,a=o.clientY):(r=o.touches[0].clientX,a=o.touches[0].clientY),o.preventDefault(),this.fire("drag",{deltaX:Math.round(r-this._lastDraggingCoordinates.x),deltaY:Math.round(a-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:r,y:a}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(s){return this.dragHandleElement?this.dragHandleElement===s.target||s.target instanceof HTMLElement&&this.dragHandleElement.contains(s.target):!1}}return t}class MK extends q{constructor(e){super(e);h(this,"children");h(this,"keystrokes");h(this,"focusCycler");h(this,"_focusTracker");h(this,"_focusables");this.children=this.createCollection(),this.keystrokes=new tt,this._focusTracker=new Ge,this._focusables=new Mt,this.focusCycler=new Gt({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const i of e){const s=new te(this.locale);let o;s.on("execute",()=>i.onExecute()),i.onCreate&&i.onCreate(s);for(o in i)o!="onExecute"&&o!="onCreate"&&s.set(o,i[o]);this.children.add(s)}this._updateFocusCyclableItems()}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach(e=>{this._focusables.add(e),this._focusTracker.add(e.element)})}}class OK extends q{constructor(e){super(e);h(this,"children");this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}}const si={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},I_=ra("px"),Ed=class Ed extends BK(q){constructor(e,{getCurrentDomRoot:i,getViewportOffset:s}){super(e);h(this,"parts");h(this,"headerView");h(this,"closeButtonView");h(this,"actionsView");h(this,"contentView");h(this,"keystrokes");h(this,"focusTracker");h(this,"wasMoved",!1);h(this,"_getCurrentDomRoot");h(this,"_getViewportOffset");h(this,"_focusables");h(this,"_focusCycler");const o=this.bindTemplate,r=e.t;this.set("className",""),this.set("ariaLabel",r("Editor dialog")),this.set("isModal",!1),this.set("position",si.SCREEN_CENTER),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=i,this._getViewportOffset=s,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new tt,this.focusTracker=new Ge,this._focusables=new Mt,this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",o.if("isModal","ck-dialog-overlay__transparent",a=>!a),o.if("_isVisible","ck-hidden",a=>!a)],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",o.to("className")],role:"dialog","aria-label":o.to("ariaLabel"),style:{top:o.to("_top",a=>I_(a)),left:o.to("_left",a=>I_(a)),visibility:o.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",(e,i)=>{this.fire("close",{source:"escKeyPress"}),i()}),this.on("drag",(e,{deltaX:i,deltaY:s})=>{this.wasMoved=!0,this.moveBy(i,s)}),this.listenTo(j.window,"resize",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.listenTo(j.document,"scroll",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.on("change:_isVisible",(e,i,s)=>{s&&(this._isTransparent=!0,setTimeout(()=>{this.updatePosition(),this._isTransparent=!1,this.focus()},10))}),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView?this.headerView.element:null}setupParts({icon:e,title:i,hasCloseButton:s=!0,content:o,actionButtons:r}){i&&(this.headerView=new Ob(this.locale,{icon:e}),s&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=i,this.ariaLabel=i,this.parts.add(this.headerView,0)),o&&(o instanceof q&&(o=[o]),this.contentView=new OK(this.locale),this.contentView.children.addMany(o),this.parts.add(this.contentView)),r&&(this.actionsView=new MK(this.locale),this.actionsView.setButtons(r),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(e,i){const s=this._getViewportRect(),o=this._getDialogRect();e+o.width>s.right&&(e=s.right-o.width),e<s.left&&(e=s.left),i<s.top&&(i=s.top),this._moveTo(e,i)}_moveTo(e,i){this._left=e,this._top=i}moveBy(e,i){this.moveTo(this._left+e,this._top+i)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const e=this._getViewportRect();let i=this.position,s;this._getCurrentDomRoot()?s=this._getVisibleDomRootRect(e):i=si.SCREEN_CENTER;const o=Ed.defaultOffset,r=this._getDialogRect();switch(i){case si.EDITOR_TOP_SIDE:{if(s){const a=this.locale.contentLanguageDirection==="ltr"?s.right-r.width-o:s.left+o;this.moveTo(a,s.top+o)}else this._moveOffScreen();break}case si.EDITOR_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-r.width/2),Math.round(s.top+s.height/2-r.height/2)):this._moveOffScreen();break}case si.SCREEN_CENTER:{this.moveTo(Math.round((e.width-r.width)/2),Math.round((e.height-r.height)/2));break}case si.EDITOR_TOP_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-r.width/2),s.top+o):this._moveOffScreen();break}case si.EDITOR_BOTTOM_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-r.width/2),s.bottom-r.height-o):this._moveOffScreen();break}case si.EDITOR_ABOVE_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-r.width/2),s.top-r.height-o):this._moveOffScreen();break}case si.EDITOR_BELOW_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-r.width/2),s.bottom+o):this._moveOffScreen();break}}}_getVisibleDomRootRect(e){let i=new he(this._getCurrentDomRoot()).getVisible();if(i){if(i=e.getIntersection(i),!i)return null}else return null;return i}_getDialogRect(){return new he(this.element.firstElementChild)}_getViewportRect(){return NK(this._getViewportOffset())}_updateFocusCyclableItems(){const e=[];if(this.contentView)for(const i of this.contentView.children)oc(i)&&e.push(i);this.actionsView&&e.push(this.actionsView),this.closeButtonView&&e.push(this.closeButtonView),e.forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element),VK(i)&&(this.listenTo(i.focusCycler,"forwardCycle",s=>{this._focusCycler.focusNext(),this._focusCycler.next!==this._focusCycler.focusables.get(this._focusCycler.current)&&s.stop()}),this.listenTo(i.focusCycler,"backwardCycle",s=>{this._focusCycler.focusPrevious(),this._focusCycler.previous!==this._focusCycler.focusables.get(this._focusCycler.current)&&s.stop()}))})}_createCloseButton(){const e=new te(this.locale),i=this.locale.t;return e.set({label:i("Close"),tooltip:!0,icon:F.cancel}),e.on("execute",()=>this.fire("close",{source:"closeButton"})),e}};h(Ed,"defaultOffset",15);let Sl=Ed;function NK(n){n=Object.assign({top:0,bottom:0,left:0,right:0},n);const t=new he(j.window);return t.top+=n.top,t.height-=n.top,t.bottom-=n.bottom,t.height-=n.bottom,t.left+=n.left,t.right-=n.right,t.width-=n.left+n.right,t}const vi=class vi extends A{constructor(e){super(e);h(this,"view");h(this,"_onHide");const i=e.t;this._initShowHideListeners(),this._initFocusToggler(),this._initMultiRootIntegration(),this.set("id",null),e.accessibility.addKeystrokeInfos({categoryId:"navigation",keystrokes:[{label:i("Move focus in and out of an active dialog window"),keystroke:"Ctrl+F6",mayRequireFn:!0}]})}static get pluginName(){return"Dialog"}_initShowHideListeners(){this.on("show",(e,i)=>{this._show(i)}),this.on("show",(e,i)=>{i.onShow&&i.onShow(this)},{priority:"low"}),this.on("hide",()=>{vi._visibleDialogPlugin&&vi._visibleDialogPlugin._hide()}),this.on("hide",()=>{this._onHide&&(this._onHide(this),this._onHide=void 0)},{priority:"low"})}_initFocusToggler(){const e=this.editor;e.keystrokes.set("Ctrl+F6",(i,s)=>{!this.isOpen||this.view.isModal||(this.view.focusTracker.isFocused?e.editing.view.focus():this.view.focus(),s())})}_initMultiRootIntegration(){const e=this.editor.model;e.document.on("change:data",()=>{if(!this.view)return;const i=e.document.differ.getChangedRoots();for(const s of i)s.state&&this.view.updatePosition()})}show(e){this.hide(),this.fire(`show:${e.id}`,e)}_show({id:e,icon:i,title:s,hasCloseButton:o=!0,content:r,actionButtons:a,className:l,isModal:c,position:u,onHide:d}){const f=this.editor;this.view=new Sl(f.locale,{getCurrentDomRoot:()=>f.editing.view.getDomRoot(f.model.document.selection.anchor.root.rootName),getViewportOffset:()=>f.ui.viewportOffset});const m=this.view;m.on("close",()=>{this.hide()}),f.ui.view.body.add(m),f.ui.focusTracker.add(m.element),f.keystrokes.listenTo(m.element),u||(u=c?si.SCREEN_CENTER:si.EDITOR_CENTER),m.set({position:u,_isVisible:!0,className:l,isModal:c}),m.setupParts({icon:i,title:s,hasCloseButton:o,content:r,actionButtons:a}),this.id=e,d&&(this._onHide=d),this.isOpen=!0,vi._visibleDialogPlugin=this}hide(){vi._visibleDialogPlugin&&vi._visibleDialogPlugin.fire(`hide:${vi._visibleDialogPlugin.id}`)}_hide(){if(!this.view)return;const e=this.editor,i=this.view;i.contentView&&i.contentView.reset(),e.ui.view.body.remove(i),e.ui.focusTracker.remove(i.element),e.keystrokes.stopListening(i.element),i.destroy(),e.editing.view.focus(),this.id=null,this.isOpen=!1,vi._visibleDialogPlugin=null}};h(vi,"_visibleDialogPlugin");let Il=vi;class pt extends te{constructor(t){super(t),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}class fn extends q{constructor(e){super(e);h(this,"id");this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${Cn()}`;const i=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:i.to("for")},children:[{text:i.to("text")}]})}}class FK extends q{constructor(t,e){super(t);const i=t.t,s=new fn;s.text=i("Help Contents. To close this dialog press ESC."),this.setTemplate({tag:"div",attributes:{class:["ck","ck-accessibility-help-dialog__content"],"aria-labelledby":s.id,role:"document",tabindex:-1},children:[xt(document,"p",{},i("Below, you can find a list of keyboard shortcuts that can be used in the editor.")),...this._createCategories(Array.from(e.values())),s]})}focus(){this.element.focus()}_createCategories(t){return t.map(e=>{const i=[xt(document,"h3",{},e.label),...Array.from(e.groups.values()).map(s=>this._createGroup(s)).flat()];return e.description&&i.splice(1,0,xt(document,"p",{},e.description)),xt(document,"section",{},i)})}_createGroup(t){const e=t.keystrokes.sort((s,o)=>s.label.localeCompare(o.label)).map(s=>this._createGroupRow(s)).flat(),i=[xt(document,"dl",{},e)];return t.label&&i.unshift(xt(document,"h4",{},t.label)),i}_createGroupRow(t){const e=this.locale.t,i=xt(document,"dt"),s=xt(document,"dd"),o=$K(t.keystroke),r=[];for(const a of o)r.push(a.map(DK).join(""));return i.innerHTML=t.label,s.innerHTML=r.join(", ")+(t.mayRequireFn&&ue.isMac?` ${e("(may require <kbd>Fn</kbd>)")}`:""),[i,s]}}function DK(n){return Ju(n).split("+").map(t=>`<kbd>${t}</kbd>`).join("+")}function $K(n){return typeof n=="string"?[[n]]:typeof n[0]=="string"?[n]:n}var P_='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.628a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"/><path d="M8.5 9.125a.3.3 0 0 0-.253-.296L5.11 8.327a.75.75 0 1 1 .388-1.449l4.04.716c.267.072.624.08.893.009l4.066-.724a.75.75 0 1 1 .388 1.45l-3.132.5a.3.3 0 0 0-.253.296v1.357a.3.3 0 0 0 .018.102l1.615 4.438a.75.75 0 0 1-1.41.513l-1.35-3.71a.3.3 0 0 0-.281-.197h-.209a.3.3 0 0 0-.282.198l-1.35 3.711a.75.75 0 0 1-1.41-.513l1.64-4.509a.3.3 0 0 0 .019-.103V9.125Z"/><path clip-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17Zm0 1.5c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Z"/></svg>';class kI extends A{constructor(){super(...arguments);h(this,"contentView",null)}static get requires(){return[Il]}static get pluginName(){return"AccessibilityHelp"}init(){const e=this.editor,i=e.locale.t;e.ui.componentFactory.add("accessibilityHelp",()=>{const s=this._createButton(te);return s.set({tooltip:!0,withText:!1,label:i("Accessibility help")}),s}),e.ui.componentFactory.add("menuBar:accessibilityHelp",()=>{const s=this._createButton(pt);return s.label=i("Accessibility"),s}),e.keystrokes.set("Alt+0",(s,o)=>{this._showDialog(),o()}),this._setupRootLabels()}_createButton(e){const s=this.editor.locale,o=new e(s);return o.set({keystroke:"Alt+0",icon:P_}),o.on("execute",()=>this._showDialog()),o}_setupRootLabels(){const e=this.editor,i=e.editing.view,s=e.t;e.ui.on("ready",()=>{i.change(r=>{for(const a of i.document.roots)o(r,a)}),e.on("addRoot",(r,a)=>{const l=e.editing.view.document.getRoot(a.rootName);i.change(c=>o(c,l))},{priority:"low"})});function o(r,a){const c=`${a.getAttribute("aria-label")}. ${s("Press %0 for help.",[Ju("Alt+0")])}`;r.setAttribute("aria-label",c,a)}}_showDialog(){const e=this.editor,i=e.plugins.get("Dialog"),s=e.locale.t;this.contentView||(this.contentView=new FK(e.locale,e.accessibility.keystrokeInfos)),i.show({id:"accessibilityHelp",className:"ck-accessibility-help-dialog",title:s("Accessibility help"),icon:P_,hasCloseButton:!0,content:this.contentView})}}class HK extends Mt{constructor(e,i=[]){super(i);h(this,"locale");h(this,"_bodyCollectionContainer");this.locale=e}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new bn({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=xt(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&e.childElementCount==0&&e.remove()}}class rc extends te{constructor(e){super(e);h(this,"toggleSwitchView");this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new q;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}class Jm extends te{constructor(e){super(e);h(this,"buttonView");h(this,"_fileInputView");this.buttonView=this,this._fileInputView=new zK(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.on("execute",()=>{this._fileInputView.open()}),this.extendTemplate({attributes:{class:"ck-file-dialog-button"}})}render(){super.render(),this.children.add(this._fileInputView)}}class zK extends q{constructor(t){super(t),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const e=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:e.to("acceptedType"),multiple:e.to("allowMultipleFiles")},on:{change:e.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}var Mh='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';class TI extends q{constructor(e,i){super(e);h(this,"buttonView");h(this,"children");const s=this.bindTemplate;this.set("isCollapsed",!1),this.set("label",""),this.buttonView=this._createButtonView(),this.children=this.createCollection(),this.set("_collapsibleAriaLabelUid",void 0),i&&this.children.addMany(i),this.setTemplate({tag:"div",attributes:{class:["ck","ck-collapsible",s.if("isCollapsed","ck-collapsible_collapsed")]},children:[this.buttonView,{tag:"div",attributes:{class:["ck","ck-collapsible__children"],role:"region",hidden:s.if("isCollapsed","hidden"),"aria-labelledby":s.to("_collapsibleAriaLabelUid")},children:this.children}]})}render(){super.render(),this._collapsibleAriaLabelUid=this.buttonView.labelView.element.id}focus(){this.buttonView.focus()}_createButtonView(){const e=new te(this.locale),i=e.bindTemplate;return e.set({withText:!0,icon:Mh}),e.extendTemplate({attributes:{"aria-expanded":i.to("isOn",s=>String(s))}}),e.bind("label").to(this),e.bind("isOn").to(this,"isCollapsed",s=>!s),e.on("execute",()=>{this.isCollapsed=!this.isCollapsed}),e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function id(n,t){const e=n.t,i={Black:e("Black"),"Dim grey":e("Dim grey"),Grey:e("Grey"),"Light grey":e("Light grey"),White:e("White"),Red:e("Red"),Orange:e("Orange"),Yellow:e("Yellow"),"Light green":e("Light green"),Green:e("Green"),Aquamarine:e("Aquamarine"),Turquoise:e("Turquoise"),"Light blue":e("Light blue"),Blue:e("Blue"),Purple:e("Purple")};return t.map(s=>{const o=i[s.label];return o&&o!=s.label&&(s.label=o),s})}function sd(n){return n.map(UK).filter(t=>!!t)}function UK(n){return typeof n=="string"?{model:n,label:n,hasBorder:!1,view:{name:"span",styles:{color:n}}}:{model:n.color,label:n.label||n.color,hasBorder:n.hasBorder===void 0?!1:n.hasBorder,view:{name:"span",styles:{color:`${n.color}`}}}}var WK='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>';class EI extends te{constructor(t){super(t);const e=this.bindTemplate;this.set("color",void 0),this.set("hasBorder",!1),this.icon=WK,this.extendTemplate({attributes:{style:{backgroundColor:e.to("color",i=>ue.isMediaForcedColors?null:i)},class:["ck","ck-color-grid__tile",e.if("hasBorder","ck-color-selector__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}class R_ extends q{constructor(e,i){super(e);h(this,"columns");h(this,"items");h(this,"focusTracker");h(this,"keystrokes");const s=i&&i.colorDefinitions?i.colorDefinitions:[];this.columns=i&&i.columns?i.columns:5;const o={gridTemplateColumns:`repeat( ${this.columns}, 1fr)`};this.set("selectedColor",void 0),this.items=this.createCollection(),this.focusTracker=new Ge,this.keystrokes=new tt,this.items.on("add",(r,a)=>{a.isOn=a.color===this.selectedColor}),s.forEach(r=>{const a=new EI;a.set({color:r.color,label:r.label,tooltip:!0,hasBorder:r.options.hasBorder}),a.on("execute",()=>{this.fire("execute",{value:r.color,hasBorder:r.options.hasBorder,label:r.label})}),this.items.add(a)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:o}}),this.on("change:selectedColor",(r,a,l)=>{for(const c of this.items)c.isOn=c.color===l})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,i)=>{this.focusTracker.add(i.element)}),this.items.on("remove",(e,i)=>{this.focusTracker.remove(i.element)}),this.keystrokes.listenTo(this.element),Bh({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function AI(n,t){if(!n)return"";const e=xI(n);if(!e)return"";if(e.space===t)return n;if(!KK(e))return"";const s=mI[e.space][t];if(!s)return"";const o=s(e.space==="hex"?e.hexValue:e.values);return GK(o,t)}function qK(n){if(!n)return"";const t=xI(n);return t?t.space==="hex"?t.hexValue:AI(n,"hex"):"#000"}function jK(n,t){customElements.get(n)===void 0&&customElements.define(n,t)}function GK(n,t){switch(t){case"hex":return`#${n}`;case"rgb":return`rgb( ${n[0]}, ${n[1]}, ${n[2]} )`;case"hsl":return`hsl( ${n[0]}, ${n[1]}%, ${n[2]}% )`;case"hwb":return`hwb( ${n[0]}, ${n[1]}, ${n[2]} )`;case"lab":return`lab( ${n[0]}% ${n[1]} ${n[2]} )`;case"lch":return`lch( ${n[0]}% ${n[1]} ${n[2]} )`;default:return""}}function xI(n){if(n.startsWith("#")){const e=p_(n);return{space:"hex",values:e.values,hexValue:n,alpha:e.alpha}}const t=p_(n);return t.space?t:null}function KK(n){return Object.keys(mI).includes(n.space)}class wt extends q{constructor(e,i){super(e);h(this,"fieldView");h(this,"labelView");h(this,"statusView");h(this,"fieldWrapperChildren");const s=`ck-labeled-field-view-${Cn()}`,o=`ck-labeled-field-view-status-${Cn()}`;this.fieldView=i(this,s,o),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(s),this.statusView=this._createStatusView(o),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(a,l)=>a||l);const r=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",r.to("class"),r.if("isEnabled","ck-disabled",a=>!a),r.if("isEmpty","ck-labeled-field-view_empty"),r.if("isFocused","ck-labeled-field-view_focused"),r.if("placeholder","ck-labeled-field-view_placeholder"),r.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const i=new fn(this.locale);return i.for=e,i.bind("text").to(this,"label"),i}_createStatusView(e){const i=new q(this.locale),s=this.bindTemplate;return i.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",s.if("errorText","ck-labeled-field-view__status_error"),s.if("_statusText","ck-hidden",o=>!o)],id:e,role:s.if("errorText","alert")},children:[{text:s.to("_statusText")}]}),i}focus(e){this.fieldView.focus(e)}}class ZK extends q{constructor(e){super(e);h(this,"focusTracker");this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("tabIndex",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.set("ariaLabel",void 0),this.focusTracker=new Ge,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const i=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",i.if("isFocused","ck-input_focused"),i.if("isEmpty","ck-input-text_empty"),i.if("hasError","ck-error")],id:i.to("id"),placeholder:i.to("placeholder"),tabindex:i.to("tabIndex"),readonly:i.to("isReadOnly"),"aria-invalid":i.if("hasError",!0),"aria-describedby":i.to("ariaDescribedById"),"aria-label":i.to("ariaLabel")},on:{input:i.to((...s)=>{this.fire("input",...s),this._updateIsEmpty()}),change:i.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,i,s)=>{this._setDomElementValue(s),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}reset(){this.value=this.element.value="",this._updateIsEmpty()}_updateIsEmpty(){this.isEmpty=JK(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}}function JK(n){return!n.value}class SI extends ZK{constructor(t){super(t),this.set("inputMode","text");const e=this.bindTemplate;this.extendTemplate({attributes:{inputmode:e.to("inputMode")}})}}class II extends SI{constructor(t){super(t),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}}class YK extends SI{constructor(t,{min:e,max:i,step:s}={}){super(t);const o=this.bindTemplate;this.set("min",e),this.set("max",i),this.set("step",s),this.extendTemplate({attributes:{type:"number",class:["ck-input-number"],min:o.to("min"),max:o.to("max"),step:o.to("step")}})}}class XK extends q{constructor(e){super(e);h(this,"children");const i=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",i.to("position",s=>`ck-dropdown__panel_${s}`),i.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:i.to(s=>{s.target.tagName.toLocaleLowerCase()!=="input"&&s.preventDefault()})}})}focus(){if(this.children.length){const e=this.children.first;typeof e.focus=="function"?e.focus():Te("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}}const yr=class yr extends q{constructor(e,i,s){super(e);h(this,"buttonView");h(this,"panelView");h(this,"focusTracker");h(this,"keystrokes");h(this,"listView");h(this,"toolbarView");const o=this.bindTemplate;this.buttonView=i,this.panelView=s,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new tt,this.focusTracker=new Ge,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",o.to("class"),o.if("isEnabled","ck-disabled",r=>!r)],id:o.to("id"),"aria-describedby":o.to("ariaDescribedById")},children:[i,s]}),i.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":o.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.on("change:isOpen",(i,s,o)=>{if(o)if(this.panelPosition==="auto"){const r=yr._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=r?r.name:this._panelPositions[0].name}else this.panelView.position=this.panelPosition}),this.keystrokes.listenTo(this.element);const e=(i,s)=>{this.isOpen&&(this.isOpen=!1,s())};this.keystrokes.set("arrowdown",(i,s)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,s())}),this.keystrokes.set("arrowright",(i,s)=>{this.isOpen&&s()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:i,southEast:s,southWest:o,northEast:r,northWest:a,southMiddleEast:l,southMiddleWest:c,northMiddleEast:u,northMiddleWest:d}=yr.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[s,o,l,c,e,r,a,u,d,i]:[o,s,c,l,e,a,r,d,u,i]}};h(yr,"defaultPanelPositions",{south:(e,i)=>({top:e.bottom,left:e.left-(i.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,i)=>({top:e.bottom,left:e.left-i.width+e.width,name:"sw"}),southMiddleEast:(e,i)=>({top:e.bottom,left:e.left-(i.width-e.width)/4,name:"sme"}),southMiddleWest:(e,i)=>({top:e.bottom,left:e.left-(i.width-e.width)*3/4,name:"smw"}),north:(e,i)=>({top:e.top-i.height,left:e.left-(i.width-e.width)/2,name:"n"}),northEast:(e,i)=>({top:e.top-i.height,left:e.left,name:"ne"}),northWest:(e,i)=>({top:e.top-i.height,left:e.left-i.width+e.width,name:"nw"}),northMiddleEast:(e,i)=>({top:e.top-i.height,left:e.left-(i.width-e.width)/4,name:"nme"}),northMiddleWest:(e,i)=>({top:e.top-i.height,left:e.left-(i.width-e.width)*3/4,name:"nmw"})}),h(yr,"_getOptimalPosition",gb);let Ym=yr;class PI extends te{constructor(e){super(e);h(this,"arrowView");this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",i=>String(i))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new es;return e.content=Mh,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}class RI extends q{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class QK extends q{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function eZ(n){return n.bindTemplate.to(t=>{t.target===n.element&&t.preventDefault()})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Nb(n){if(Array.isArray(n))return{items:n,removeItems:[]};const t={items:[],removeItems:[]};return n?{...t,...n}:t}const tZ={alignLeft:F.alignLeft,bold:F.bold,importExport:F.importExport,paragraph:F.paragraph,plus:F.plus,text:F.text,threeVerticalDots:F.threeVerticalDots,pilcrow:F.pilcrow,dragIndicator:F.dragIndicator};class Ro extends q{constructor(e,i){super(e);h(this,"options");h(this,"items");h(this,"focusTracker");h(this,"keystrokes");h(this,"itemsView");h(this,"children");h(this,"focusables");h(this,"_focusCycler");h(this,"_behavior");const s=this.bindTemplate,o=this.t;this.options=i||{},this.set("ariaLabel",o("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new Ge,this.keystrokes=new tt,this.set("class",void 0),this.set("isCompact",!1),this.itemsView=new nZ(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const r=e.uiLanguageDirection==="rtl";this._focusCycler=new Gt({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[r?"arrowright":"arrowleft","arrowup"],focusNext:[r?"arrowleft":"arrowright","arrowdown"]}});const a=["ck","ck-toolbar",s.to("class"),s.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&a.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:a,role:"toolbar","aria-label":s.to("ariaLabel"),style:{maxWidth:s.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:eZ(this)}}),this._behavior=this.options.shouldGroupWhenFull?new sZ(this):new iZ(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,i)=>{this.focusTracker.add(i.element)}),this.items.on("remove",(e,i)=>{this.focusTracker.remove(i.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,i,s){this.items.addMany(this._buildItemsFromConfig(e,i,s))}_buildItemsFromConfig(e,i,s){const o=Nb(e),r=s||o.removeItems;return this._cleanItemsConfiguration(o.items,i,r).map(l=>Ce(l)?this._createNestedToolbarDropdown(l,i,r):l==="|"?new RI:l==="-"?new QK:i.create(l)).filter(l=>!!l)}_cleanItemsConfiguration(e,i,s){const o=e.filter((r,a,l)=>r==="|"?!0:s.indexOf(r)!==-1?!1:r==="-"?this.options.shouldGroupWhenFull?(Te("toolbarview-line-break-ignored-when-grouping-items",l),!1):!0:!Ce(r)&&!i.has(r)?(Te("toolbarview-item-unavailable",{item:r}),!1):!0);return this._cleanSeparatorsAndLineBreaks(o)}_cleanSeparatorsAndLineBreaks(e){const i=a=>a!=="-"&&a!=="|",s=e.length,o=e.findIndex(i);if(o===-1)return[];const r=s-e.slice().reverse().findIndex(i);return e.slice(o,r).filter((a,l,c)=>i(a)?!0:!(l>0&&c[l-1]===a))}_createNestedToolbarDropdown(e,i,s){let{label:o,icon:r,items:a,tooltip:l=!0,withText:c=!1}=e;if(a=this._cleanItemsConfiguration(a,i,s),!a.length)return null;const u=this.locale,d=Yt(u);return o||Te("toolbarview-nested-toolbar-dropdown-missing-label",e),d.class="ck-toolbar__nested-toolbar-dropdown",d.buttonView.set({label:o,tooltip:l,withText:!!c}),r!==!1?d.buttonView.icon=tZ[r]||r||F.threeVerticalDots:d.buttonView.withText=!0,Oh(d,()=>d.toolbarView._buildItemsFromConfig(a,i,s)),d}}class nZ extends q{constructor(e){super(e);h(this,"children");this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class iZ{constructor(t){const e=t.bindTemplate;t.set("isVertical",!1),t.itemsView.children.bindTo(t.items).using(i=>i),t.focusables.bindTo(t.items).using(i=>oc(i)?i:null),t.extendTemplate({attributes:{class:[e.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class sZ{constructor(t){h(this,"view");h(this,"viewChildren");h(this,"viewFocusables");h(this,"viewItemsView");h(this,"viewFocusTracker");h(this,"viewLocale");h(this,"ungroupedItems");h(this,"groupedItems");h(this,"groupedItemsDropdown");h(this,"resizeObserver",null);h(this,"cachedPadding",null);h(this,"shouldUpdateGroupingOnNextResize",!1);h(this,"viewElement");this.view=t,this.viewChildren=t.children,this.viewFocusables=t.focusables,this.viewItemsView=t.itemsView,this.viewFocusTracker=t.focusTracker,this.viewLocale=t.locale,this.ungroupedItems=t.createCollection(),this.groupedItems=t.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),t.itemsView.children.bindTo(this.ungroupedItems).using(e=>e),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),t.children.on("change",this._updateFocusCyclableItems.bind(this)),t.items.on("change",(e,i)=>{const s=i.index,o=Array.from(i.added);for(const r of i.removed)s>=this.ungroupedItems.length?this.groupedItems.remove(r):this.ungroupedItems.remove(r);for(let r=s;r<s+o.length;r++){const a=o[r-s];r>this.ungroupedItems.length?this.groupedItems.add(a,r-this.ungroupedItems.length):this.ungroupedItems.add(a,r)}this._updateGrouping()}),t.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(t){this.viewElement=t.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(t)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!Io(this.viewElement)){this.shouldUpdateGroupingOnNextResize=!0;return}const t=this.groupedItems.length;let e;for(;this._areItemsOverflowing;)this._groupLastItem(),e=!0;if(!e&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==t&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const t=this.viewElement,e=this.viewLocale.uiLanguageDirection,i=new he(t.lastChild),s=new he(t);if(!this.cachedPadding){const o=j.window.getComputedStyle(t),r=e==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(o[r])}return e==="ltr"?i.right>s.right-this.cachedPadding:i.left<s.left+this.cachedPadding}_enableGroupingOnResize(){let t;this.resizeObserver=new Dr(this.viewElement,e=>{(!t||t!==e.contentRect.width||this.shouldUpdateGroupingOnNextResize)&&(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),t=e.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(t){t.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new RI),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const t=this.viewLocale,e=t.t,i=Yt(t);return i.class="ck-toolbar__grouped-dropdown",i.panelPosition=t.uiLanguageDirection==="ltr"?"sw":"se",Oh(i,this.groupedItems),i.buttonView.set({label:e("Show more items"),tooltip:!0,tooltipPosition:t.uiLanguageDirection==="rtl"?"se":"sw",icon:F.threeVerticalDots}),i}_updateFocusCyclableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(t=>{oc(t)&&this.viewFocusables.add(t)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}class Ur extends q{constructor(e){super(e);h(this,"children");const i=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",i.if("isVisible","ck-hidden",s=>!s)],role:"presentation"},children:this.children})}focus(){this.children.first&&this.children.first.focus()}}class Fb extends q{constructor(t){super(t),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}class pu extends q{constructor(e,i=new fn){super(e);h(this,"labelView");h(this,"items");h(this,"children");const s=this.bindTemplate,o=new Db(e);this.set({label:"",isVisible:!0}),this.labelView=i,this.labelView.bind("text").to(this,"label"),this.children=this.createCollection(),this.children.addMany([this.labelView,o]),o.set({role:"group",ariaLabelledBy:i.id}),o.focusTracker.destroy(),o.keystrokes.destroy(),this.items=o.items,this.setTemplate({tag:"li",attributes:{role:"presentation",class:["ck","ck-list__group",s.if("isVisible","ck-hidden",r=>!r)]},children:this.children})}focus(){if(this.items){const e=this.items.find(i=>!(i instanceof Fb));e&&e.focus()}}}class Db extends q{constructor(e){super(e);h(this,"focusables");h(this,"items");h(this,"focusTracker");h(this,"keystrokes");h(this,"_focusCycler");h(this,"_listItemGroupToChangeListeners",new WeakMap);const i=this.bindTemplate;this.focusables=new Mt,this.items=this.createCollection(),this.focusTracker=new Ge,this.keystrokes=new tt,this._focusCycler=new Gt({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:i.to("role"),"aria-label":i.to("ariaLabel"),"aria-labelledby":i.to("ariaLabelledBy")},children:this.items})}render(){super.render();for(const e of this.items)e instanceof pu?this._registerFocusableItemsGroup(e):e instanceof Ur&&this._registerFocusableListItem(e);this.items.on("change",(e,i)=>{for(const s of i.removed)s instanceof pu?this._deregisterFocusableItemsGroup(s):s instanceof Ur&&this._deregisterFocusableListItem(s);for(const s of Array.from(i.added).reverse())s instanceof pu?this._registerFocusableItemsGroup(s,i.index):this._registerFocusableListItem(s,i.index)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_registerFocusableListItem(e,i){this.focusTracker.add(e.element),this.focusables.add(e,i)}_deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e)}_getOnGroupItemsChangeCallback(e){return(i,s)=>{for(const o of s.removed)this._deregisterFocusableListItem(o);for(const o of Array.from(s.added).reverse())this._registerFocusableListItem(o,this.items.getIndex(e)+s.index)}}_registerFocusableItemsGroup(e,i){Array.from(e.items).forEach((o,r)=>{const a=typeof i<"u"?i+r:void 0;this._registerFocusableListItem(o,a)});const s=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,s),e.items.on("change",s)}_deregisterFocusableItemsGroup(e){for(const i of e.items)this._deregisterFocusableListItem(i);e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners.delete(e)}}class la extends q{constructor(e,i){super(e);h(this,"children");h(this,"actionView");h(this,"arrowView");h(this,"keystrokes");h(this,"focusTracker");const s=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(i),this.arrowView=this._createArrowView(),this.keystrokes=new tt,this.focusTracker=new Ge,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",s.to("class"),s.if("isVisible","ck-hidden",o=>!o),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,i)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),i())}),this.keystrokes.set("arrowleft",(e,i)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),i())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(e){const i=e||new te;return e||i.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),i.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),i.delegate("execute").to(this),i}_createArrowView(){const e=new te,i=e.bindTemplate;return e.icon=Mh,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":i.to("isOn"),"aria-haspopup":!0,"aria-expanded":i.to("isOn",s=>String(s))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}}function Yt(n,t=PI){const e=typeof t=="function"?new t(n):t,i=new XK(n),s=new Ym(n,e,i);return e.bind("isEnabled").to(s),e instanceof la?e.arrowView.bind("isOn").to(s,"isOpen"):e.bind("isOn").to(s,"isOpen"),oZ(s),s}function Oh(n,t,e={}){n.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),n.isOpen?L_(n,t,e):n.once("change:isOpen",()=>L_(n,t,e),{priority:"highest"}),e.enableActiveItemFocusOnDropdownOpen&&$b(n,()=>n.toolbarView.items.find(i=>i.isOn))}function L_(n,t,e){const i=n.locale,s=i.t,o=n.toolbarView=new Ro(i),r=typeof t=="function"?t():t;o.ariaLabel=e.ariaLabel||s("Dropdown toolbar"),e.maxWidth&&(o.maxWidth=e.maxWidth),e.class&&(o.class=e.class),e.isCompact&&(o.isCompact=e.isCompact),e.isVertical&&(o.isVertical=!0),r instanceof Mt?o.items.bindTo(r).using(a=>a):o.items.addMany(r),n.panelView.children.add(o),o.items.delegate("execute").to(n)}function ca(n,t,e={}){n.isOpen?V_(n,t,e):n.once("change:isOpen",()=>V_(n,t,e),{priority:"highest"}),$b(n,()=>n.listView.items.find(i=>i instanceof Ur?i.children.first.isOn:!1))}function V_(n,t,e){const i=n.locale,s=n.listView=new Db(i),o=typeof t=="function"?t():t;s.ariaLabel=e.ariaLabel,s.role=e.role,LI(n,s.items,o,i),n.panelView.children.add(s),s.items.delegate("execute").to(n)}function $b(n,t){n.on("change:isOpen",()=>{if(!n.isOpen)return;const e=t();e&&(typeof e.focus=="function"?e.focus():Te("ui-dropdown-focus-child-on-open-child-missing-focus",{view:e}))},{priority:Pn.low-10})}function oZ(n){rZ(n),aZ(n),lZ(n),cZ(n),uZ(n),dZ(n)}function rZ(n){n.on("render",()=>{Wo({emitter:n,activator:()=>n.isOpen,callback:()=>{n.isOpen=!1},contextElements:()=>[n.element,...n.focusTracker._elements]})})}function aZ(n){n.on("execute",t=>{t.source instanceof rc||(n.isOpen=!1)})}function lZ(n){n.focusTracker.on("change:isFocused",(t,e,i)=>{n.isOpen&&!i&&(n.isOpen=!1)})}function cZ(n){n.keystrokes.set("arrowdown",(t,e)=>{n.isOpen&&(n.panelView.focus(),e())}),n.keystrokes.set("arrowup",(t,e)=>{n.isOpen&&(n.panelView.focusLast(),e())})}function uZ(n){n.on("change:isOpen",(t,e,i)=>{if(i)return;const s=n.panelView.element;s&&s.contains(j.document.activeElement)&&n.buttonView.focus()})}function dZ(n){n.on("change:isOpen",(t,e,i)=>{i&&n.panelView.focus()},{priority:"low"})}function LI(n,t,e,i){t.bindTo(e).using(s=>{if(s.type==="separator")return new Fb(i);if(s.type==="group"){const o=new pu(i);return o.set({label:s.label}),LI(n,o.items,s.items,i),o.items.delegate("execute").to(n),o}else if(s.type==="button"||s.type==="switchbutton"){const o=new Ur(i);let r;return s.type==="button"?(r=new te(i),r.bind("ariaChecked").to(r,"isOn")):r=new rc(i),r.bind(...Object.keys(s.model)).to(s.model),r.delegate("execute").to(o),o.children.add(r),o}return null})}const jn=(n,t,e)=>{const i=new II(n.locale);return i.set({id:t,ariaDescribedById:e}),i.bind("isReadOnly").to(n,"isEnabled",s=>!s),i.bind("hasError").to(n,"errorText",s=>!!s),i.on("input",()=>{n.errorText=null}),n.bind("isEmpty","isFocused","placeholder").to(i),i},VI=(n,t,e)=>{const i=new YK(n.locale);return i.set({id:t,ariaDescribedById:e,inputMode:"numeric"}),i.bind("isReadOnly").to(n,"isEnabled",s=>!s),i.bind("hasError").to(n,"errorText",s=>!!s),i.on("input",()=>{n.errorText=null}),n.bind("isEmpty","isFocused","placeholder").to(i),i},BI=(n,t,e)=>{const i=Yt(n.locale);return i.set({id:t,ariaDescribedById:e}),i.bind("isEnabled").to(n),i},hZ=150;class fZ extends q{constructor(e,i={}){super(e);h(this,"hexInputRow");h(this,"_debounceColorPickerEvent");h(this,"_config");this.set({color:"",_hexColor:""}),this.hexInputRow=this._createInputRow();const s=this.createCollection();i.hideInput||s.add(this.hexInputRow),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker"],tabindex:-1},children:s}),this._config=i,this._debounceColorPickerEvent=Fn(o=>{this.set("color",o),this.fire("colorSelected",{color:this.color})},hZ,{leading:!0}),this.on("set:color",(o,r,a)=>{o.return=AI(a,this._config.format||"hsl")}),this.on("change:color",()=>{this._hexColor=Af(this.color)}),this.on("change:_hexColor",()=>{document.activeElement!==this.picker&&this.picker.setAttribute("color",this._hexColor),Af(this.color)!=Af(this._hexColor)&&(this.color=this._hexColor)})}render(){if(super.render(),jK("hex-color-picker",vK),this.picker=j.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);const e=document.createElement("style");e.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(e)}this.picker.addEventListener("color-changed",e=>{const i=e.detail.value;this._debounceColorPickerEvent(i)})}focus(){/* istanbul ignore next -- @preserve */!this._config.hideInput&&(ue.isGecko||ue.isiOS||ue.isSafari)&&this.hexInputRow.children.get(1).focus(),this.slidersView.first.focus()}_createSlidersView(){const s=[...this.picker.shadowRoot.children].filter(o=>o.getAttribute("role")==="slider").map(o=>new mZ(o));this.slidersView=this.createCollection(),s.forEach(o=>{this.slidersView.add(o)})}_createInputRow(){const e=this._createColorInput();return new pZ(this.locale,e)}_createColorInput(){const e=new wt(this.locale,jn),{t:i}=this.locale;return e.set({label:i("HEX"),class:"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",s=>e.isFocused?e.fieldView.value:s.startsWith("#")?s.substring(1):s),e.fieldView.on("input",()=>{const s=e.fieldView.element.value;if(s){const o=MI(s);o&&this._debounceColorPickerEvent(o)}}),e}isValid(){const{t:e}=this.locale;return this.resetValidationStatus(),this.hexInputRow.getParsedColor()?!0:(this.hexInputRow.inputView.errorText=e('Please enter a valid color (e.g. "ff0000").'),!1)}resetValidationStatus(){this.hexInputRow.inputView.errorText=null}}function Af(n){let t=qK(n);return t||(t="#000"),t.length===4&&(t="#"+[t[1],t[1],t[2],t[2],t[3],t[3]].join("")),t.toLowerCase()}class mZ extends q{constructor(t){super(),this.element=t}focus(){this.element.focus()}}class gZ extends q{constructor(t){super(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__hash-view"]},children:"#"})}}class pZ extends q{constructor(e,i){super(e);h(this,"children");h(this,"inputView");this.inputView=i,this.children=this.createCollection([new gZ,this.inputView]),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__row"]},children:this.children})}getParsedColor(){return MI(this.inputView.fieldView.element.value)}}function MI(n){if(!n)return null;const t=n.trim().replace(/^#/,"");return![3,4,6,8].includes(t.length)||!/^(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})$/.test(t)?null:`#${t}`}class bZ extends Ve(rn){constructor(t){super(t),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",this.length===0)})}add(t,e){return this.find(i=>i.color===t.color)?this:super.add(t,e)}hasColor(t){return!!this.find(e=>e.color===t)}}class wZ extends q{constructor(e,{colors:i,columns:s,removeButtonLabel:o,documentColorsLabel:r,documentColorsCount:a,colorPickerLabel:l,focusTracker:c,focusables:u}){super(e);h(this,"items");h(this,"colorDefinitions");h(this,"focusTracker");h(this,"columns");h(this,"documentColors");h(this,"documentColorsCount");h(this,"staticColorsGrid");h(this,"documentColorsGrid");h(this,"colorPickerButtonView");h(this,"removeColorButtonView");h(this,"_focusables");h(this,"_documentColorsLabel");h(this,"_removeButtonLabel");h(this,"_colorPickerLabel");const d=this.bindTemplate;this.set("isVisible",!0),this.focusTracker=c,this.items=this.createCollection(),this.colorDefinitions=i,this.columns=s,this.documentColors=new bZ,this.documentColorsCount=a,this._focusables=u,this._removeButtonLabel=o,this._colorPickerLabel=l,this._documentColorsLabel=r,this.setTemplate({tag:"div",attributes:{class:["ck-color-grids-fragment",d.if("isVisible","ck-hidden",f=>!f)]},children:this.items}),this.removeColorButtonView=this._createRemoveColorButton(),this.items.add(this.removeColorButtonView)}updateDocumentColors(e,i){const s=e.document,o=this.documentColorsCount;this.documentColors.clear();for(const r of s.getRoots()){const a=e.createRangeIn(r);for(const l of a.getItems())if(l.is("$textProxy")&&l.hasAttribute(i)&&(this._addColorToDocumentColors(l.getAttribute(i)),this.documentColors.length>=o))return}}updateSelectedColors(){const e=this.documentColorsGrid,i=this.staticColorsGrid,s=this.selectedColor;i.selectedColor=s,e&&(e.selectedColor=s)}render(){if(super.render(),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){const e=bn.bind(this.documentColors,this.documentColors),i=new fn(this.locale);i.text=this._documentColorsLabel,i.extendTemplate({attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]}}),this.items.add(i),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker()}focus(){this.removeColorButtonView.focus()}destroy(){super.destroy()}addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView))}_addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid))}_createColorPickerButton(){this.colorPickerButtonView=new te,this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:F.colorPalette,class:"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",()=>{this.fire("colorPicker:show")})}_createRemoveColorButton(){const e=new te;return e.set({withText:!0,icon:F.eraser,label:this._removeButtonLabel}),e.class="ck-color-selector__remove-color",e.on("execute",()=>{this.fire("execute",{value:null,source:"removeColorButton"})}),e.render(),e}_createStaticColorsGrid(){const e=new R_(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",(i,s)=>{this.fire("execute",{value:s.value,source:"staticColorsGrid"})}),e}_createDocumentColorsGrid(){const e=bn.bind(this.documentColors,this.documentColors),i=new R_(this.locale,{columns:this.columns});return i.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),i.items.bindTo(this.documentColors).using(s=>{const o=new EI;return o.set({color:s.color,hasBorder:s.options&&s.options.hasBorder}),s.label&&o.set({label:s.label,tooltip:!0}),o.on("execute",()=>{this.fire("execute",{value:s.color,source:"documentColorsGrid"})}),o}),this.documentColors.on("change:isEmpty",(s,o,r)=>{r&&(i.selectedColor=null)}),i}_addColorToDocumentColors(e){const i=this.colorDefinitions.find(s=>s.color===e);i?this.documentColors.add(Object.assign({},i)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}class _Z extends q{constructor(e,{focusTracker:i,focusables:s,keystrokes:o,colorPickerViewConfig:r}){super(e);h(this,"items");h(this,"colorPickerView");h(this,"saveButtonView");h(this,"cancelButtonView");h(this,"actionBarView");h(this,"focusTracker");h(this,"keystrokes");h(this,"_focusables");h(this,"_colorPickerViewConfig");this.items=this.createCollection(),this.focusTracker=i,this.keystrokes=o,this.set("isVisible",!1),this.set("selectedColor",void 0),this._focusables=s,this._colorPickerViewConfig=r;const a=this.bindTemplate,{saveButtonView:l,cancelButtonView:c}=this._createActionButtons();this.saveButtonView=l,this.cancelButtonView=c,this.actionBarView=this._createActionBarView({saveButtonView:l,cancelButtonView:c}),this.setTemplate({tag:"div",attributes:{class:["ck-color-picker-fragment",a.if("isVisible","ck-hidden",u=>!u)]},children:this.items})}render(){super.render();const e=new fZ(this.locale,{...this._colorPickerViewConfig});this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",(i,s,o)=>{e.color=o}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange()}destroy(){super.destroy()}focus(){this.colorPickerView.focus()}resetValidationStatus(){this.colorPickerView.resetValidationStatus()}_executeOnEnterPress(){this.keystrokes.set("enter",e=>{this.isVisible&&this.focusTracker.focusedElement!==this.cancelButtonView.element&&this.colorPickerView.isValid()&&(this.fire("execute",{value:this.selectedColor}),e.stopPropagation(),e.preventDefault())})}_stopPropagationOnArrowsKeys(){const e=i=>i.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}_addColorPickersElementsToFocusTracker(){for(const i of this.colorPickerView.slidersView)this.focusTracker.add(i.element),this._focusables.add(i);const e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView)}_createActionBarView({saveButtonView:e,cancelButtonView:i}){const s=new q,o=this.createCollection();return o.add(e),o.add(i),s.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector_action-bar"]},children:o}),s}_createActionButtons(){const e=this.locale,i=e.t,s=new te(e),o=new te(e);return s.set({icon:F.check,class:"ck-button-save",type:"button",withText:!1,label:i("Accept")}),o.set({icon:F.cancel,class:"ck-button-cancel",type:"button",withText:!1,label:i("Cancel")}),s.on("execute",()=>{this.colorPickerView.isValid()&&this.fire("execute",{source:"colorPickerSaveButton",value:this.selectedColor})}),o.on("execute",()=>{this.fire("colorPicker:cancel")}),{saveButtonView:s,cancelButtonView:o}}_executeUponColorChange(){this.colorPickerView.on("colorSelected",(e,i)=>{this.fire("execute",{value:i.color,source:"colorPicker"}),this.set("selectedColor",i.color)})}}class vZ extends q{constructor(e,{colors:i,columns:s,removeButtonLabel:o,documentColorsLabel:r,documentColorsCount:a,colorPickerLabel:l,colorPickerViewConfig:c}){super(e);h(this,"focusTracker");h(this,"keystrokes");h(this,"items");h(this,"colorGridsFragmentView");h(this,"colorPickerFragmentView");h(this,"_focusCycler");h(this,"_focusables");h(this,"_colorPickerViewConfig");this.items=this.createCollection(),this.focusTracker=new Ge,this.keystrokes=new tt,this._focusables=new Mt,this._colorPickerViewConfig=c,this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.colorGridsFragmentView=new wZ(e,{colors:i,columns:s,removeButtonLabel:o,documentColorsLabel:r,documentColorsCount:a,colorPickerLabel:l,focusTracker:this.focusTracker,focusables:this._focusables}),this.colorPickerFragmentView=new _Z(e,{focusables:this._focusables,focusTracker:this.focusTracker,keystrokes:this.keystrokes,colorPickerViewConfig:c}),this.set("_isColorGridsFragmentVisible",!0),this.set("_isColorPickerFragmentVisible",!1),this.set("selectedColor",void 0),this.colorGridsFragmentView.bind("isVisible").to(this,"_isColorGridsFragmentVisible"),this.colorPickerFragmentView.bind("isVisible").to(this,"_isColorPickerFragmentVisible"),this.on("change:selectedColor",(u,d,f)=>{this.colorGridsFragmentView.set("selectedColor",f),this.colorPickerFragmentView.set("selectedColor",f)}),this.colorGridsFragmentView.on("change:selectedColor",(u,d,f)=>{this.set("selectedColor",f)}),this.colorPickerFragmentView.on("change:selectedColor",(u,d,f)=>{this.set("selectedColor",f)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector"]},children:this.items})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment()}showColorPickerFragment(){!this.colorPickerFragmentView.colorPickerView||this._isColorPickerFragmentVisible||(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this.colorPickerFragmentView.resetValidationStatus(),this._isColorGridsFragmentVisible=!1)}showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}updateDocumentColors(e,i){this.colorGridsFragmentView.updateDocumentColors(e,i)}updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors()}_appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this))}_appendColorPickerFragment(){this.items.length!==2&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{this.showColorPickerFragment()}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this))}}class yZ{constructor(t){h(this,"editor");h(this,"_components",new Map);this.editor=t}*names(){for(const t of this._components.values())yield t.originalName}add(t,e){this._components.set(xf(t),{callback:e,originalName:t})}create(t){if(!this.has(t))throw new C("componentfactory-item-missing",this,{name:t});return this._components.get(xf(t)).callback(this.editor.locale)}has(t){return this._components.has(xf(t))}}function xf(n){return String(n).toLowerCase()}const B_=ra("px"),CZ={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}},En=class En extends q{constructor(e){super(e);h(this,"content");h(this,"_pinWhenIsVisibleCallback");const i=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",i.to("position",s=>`ck-balloon-panel_${s}`),i.if("isVisible","ck-balloon-panel_visible"),i.if("withArrow","ck-balloon-panel_with-arrow"),i.to("class")],style:{top:i.to("top",B_),left:i.to("left",B_)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const i=En.defaultPositions,s=Object.assign({},{element:this.element,positions:[i.southArrowNorth,i.southArrowNorthMiddleWest,i.southArrowNorthMiddleEast,i.southArrowNorthWest,i.southArrowNorthEast,i.northArrowSouth,i.northArrowSouthMiddleWest,i.northArrowSouthMiddleEast,i.northArrowSouthWest,i.northArrowSouthEast,i.viewportStickyNorth],limiter:j.document.body,fitInViewport:!0},e),o=En._getOptimalPosition(s)||CZ,r=parseInt(o.left),a=parseInt(o.top),l=o.name,c=o.config||{},{withArrow:u=!0}=c;this.top=a,this.left=r,this.position=l,this.withArrow=u}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const i=Xm(e.target),s=e.limiter?Xm(e.limiter):j.document.body;this.listenTo(j.document,"scroll",(o,r)=>{const a=r.target,l=i&&a.contains(i),c=s&&a.contains(s);(l||c||!i||!s)&&this.attachTo(e)},{useCapture:!0}),this.listenTo(j.window,"resize",()=>{this.attachTo(e)})}_stopPinning(){this.stopListening(j.document,"scroll"),this.stopListening(j.window,"resize")}static generatePositions(e={}){const{sideOffset:i=En.arrowSideOffset,heightOffset:s=En.arrowHeightOffset,stickyVerticalOffset:o=En.stickyVerticalOffset,config:r}=e;return{northWestArrowSouthWest:(c,u)=>({top:a(c,u),left:c.left-i,name:"arrow_sw",...r&&{config:r}}),northWestArrowSouthMiddleWest:(c,u)=>({top:a(c,u),left:c.left-u.width*.25-i,name:"arrow_smw",...r&&{config:r}}),northWestArrowSouth:(c,u)=>({top:a(c,u),left:c.left-u.width/2,name:"arrow_s",...r&&{config:r}}),northWestArrowSouthMiddleEast:(c,u)=>({top:a(c,u),left:c.left-u.width*.75+i,name:"arrow_sme",...r&&{config:r}}),northWestArrowSouthEast:(c,u)=>({top:a(c,u),left:c.left-u.width+i,name:"arrow_se",...r&&{config:r}}),northArrowSouthWest:(c,u)=>({top:a(c,u),left:c.left+c.width/2-i,name:"arrow_sw",...r&&{config:r}}),northArrowSouthMiddleWest:(c,u)=>({top:a(c,u),left:c.left+c.width/2-u.width*.25-i,name:"arrow_smw",...r&&{config:r}}),northArrowSouth:(c,u)=>({top:a(c,u),left:c.left+c.width/2-u.width/2,name:"arrow_s",...r&&{config:r}}),northArrowSouthMiddleEast:(c,u)=>({top:a(c,u),left:c.left+c.width/2-u.width*.75+i,name:"arrow_sme",...r&&{config:r}}),northArrowSouthEast:(c,u)=>({top:a(c,u),left:c.left+c.width/2-u.width+i,name:"arrow_se",...r&&{config:r}}),northEastArrowSouthWest:(c,u)=>({top:a(c,u),left:c.right-i,name:"arrow_sw",...r&&{config:r}}),northEastArrowSouthMiddleWest:(c,u)=>({top:a(c,u),left:c.right-u.width*.25-i,name:"arrow_smw",...r&&{config:r}}),northEastArrowSouth:(c,u)=>({top:a(c,u),left:c.right-u.width/2,name:"arrow_s",...r&&{config:r}}),northEastArrowSouthMiddleEast:(c,u)=>({top:a(c,u),left:c.right-u.width*.75+i,name:"arrow_sme",...r&&{config:r}}),northEastArrowSouthEast:(c,u)=>({top:a(c,u),left:c.right-u.width+i,name:"arrow_se",...r&&{config:r}}),southWestArrowNorthWest:c=>({top:l(c),left:c.left-i,name:"arrow_nw",...r&&{config:r}}),southWestArrowNorthMiddleWest:(c,u)=>({top:l(c),left:c.left-u.width*.25-i,name:"arrow_nmw",...r&&{config:r}}),southWestArrowNorth:(c,u)=>({top:l(c),left:c.left-u.width/2,name:"arrow_n",...r&&{config:r}}),southWestArrowNorthMiddleEast:(c,u)=>({top:l(c),left:c.left-u.width*.75+i,name:"arrow_nme",...r&&{config:r}}),southWestArrowNorthEast:(c,u)=>({top:l(c),left:c.left-u.width+i,name:"arrow_ne",...r&&{config:r}}),southArrowNorthWest:c=>({top:l(c),left:c.left+c.width/2-i,name:"arrow_nw",...r&&{config:r}}),southArrowNorthMiddleWest:(c,u)=>({top:l(c),left:c.left+c.width/2-u.width*.25-i,name:"arrow_nmw",...r&&{config:r}}),southArrowNorth:(c,u)=>({top:l(c),left:c.left+c.width/2-u.width/2,name:"arrow_n",...r&&{config:r}}),southArrowNorthMiddleEast:(c,u)=>({top:l(c),left:c.left+c.width/2-u.width*.75+i,name:"arrow_nme",...r&&{config:r}}),southArrowNorthEast:(c,u)=>({top:l(c),left:c.left+c.width/2-u.width+i,name:"arrow_ne",...r&&{config:r}}),southEastArrowNorthWest:c=>({top:l(c),left:c.right-i,name:"arrow_nw",...r&&{config:r}}),southEastArrowNorthMiddleWest:(c,u)=>({top:l(c),left:c.right-u.width*.25-i,name:"arrow_nmw",...r&&{config:r}}),southEastArrowNorth:(c,u)=>({top:l(c),left:c.right-u.width/2,name:"arrow_n",...r&&{config:r}}),southEastArrowNorthMiddleEast:(c,u)=>({top:l(c),left:c.right-u.width*.75+i,name:"arrow_nme",...r&&{config:r}}),southEastArrowNorthEast:(c,u)=>({top:l(c),left:c.right-u.width+i,name:"arrow_ne",...r&&{config:r}}),westArrowEast:(c,u)=>({top:c.top+c.height/2-u.height/2,left:c.left-u.width-s,name:"arrow_e",...r&&{config:r}}),eastArrowWest:(c,u)=>({top:c.top+c.height/2-u.height/2,left:c.right+s,name:"arrow_w",...r&&{config:r}}),viewportStickyNorth:(c,u,d,f)=>{const m=f||d;return!c.getIntersection(m)||m.height-c.height>o?null:{top:m.top+o,left:c.left+c.width/2-u.width/2,name:"arrowless",config:{withArrow:!1,...r}}}};function a(c,u){return c.top-u.height-s}function l(c){return c.bottom+s}}};h(En,"arrowSideOffset",25),h(En,"arrowHeightOffset",10),h(En,"stickyVerticalOffset",20),h(En,"_getOptimalPosition",gb),h(En,"defaultPositions",En.generatePositions());let St=En;function Xm(n){return Xi(n)?n:kh(n)?n.commonAncestorContainer:typeof n=="function"?Xm(n()):null}const M_="ck-tooltip",Tt=class Tt extends on(){constructor(e){super();h(this,"tooltipTextView");h(this,"balloonPanelView");h(this,"_currentElementWithTooltip",null);h(this,"_currentTooltipPosition",null);h(this,"_resizeObserver",null);h(this,"_mutationObserver",null);h(this,"_pinTooltipDebounced");h(this,"_unpinTooltipDebounced");h(this,"_watchdogExcluded");if(Tt._editors.add(e),Tt._instance)return Tt._instance;Tt._instance=this,this.tooltipTextView=new q(e.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new St(e.locale),this.balloonPanelView.class=M_,this.balloonPanelView.content.add(this.tooltipTextView),this._mutationObserver=kZ(()=>{this._updateTooltipPosition()}),this._pinTooltipDebounced=Fn(this._pinTooltip,600),this._unpinTooltipDebounced=Fn(this._unpinTooltip,400),this.listenTo(j.document,"keydown",this._onKeyDown.bind(this),{useCapture:!0}),this.listenTo(j.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(j.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(j.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(j.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(j.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(e){const i=e.ui.view&&e.ui.view.body;Tt._editors.delete(e),this.stopListening(e.ui),i&&i.has(this.balloonPanelView)&&i.remove(this.balloonPanelView),Tt._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),Tt._instance=null)}static getPositioningFunctions(e){const i=Tt.defaultBalloonPositions;return{s:[i.southArrowNorth,i.southArrowNorthEast,i.southArrowNorthWest],n:[i.northArrowSouth],e:[i.eastArrowWest],w:[i.westArrowEast],sw:[i.southArrowNorthEast],se:[i.southArrowNorthWest]}[e]}_onKeyDown(e,i){i.key==="Escape"&&this._currentElementWithTooltip&&(this._unpinTooltip(),i.stopPropagation())}_onEnterOrFocus(e,{target:i}){const s=Sf(i);if(!s){e.name==="focus"&&this._unpinTooltip();return}s!==this._currentElementWithTooltip&&(this._unpinTooltip(),e.name==="focus"&&!s.matches(":hover")?this._pinTooltip(s,If(s)):this._pinTooltipDebounced(s,If(s)))}_onLeaveOrBlur(e,{target:i,relatedTarget:s}){if(e.name==="mouseleave"){if(!Xi(i))return;const o=this.balloonPanelView.element,r=o&&(o===s||o.contains(s)),a=!r&&i===o;if(r){this._unpinTooltipDebounced.cancel();return}if(!a&&this._currentElementWithTooltip&&i!==this._currentElementWithTooltip)return;const l=Sf(i),c=Sf(s);(a||l&&l!==c)&&this._unpinTooltipDebounced()}else{if(this._currentElementWithTooltip&&i!==this._currentElementWithTooltip)return;this._unpinTooltipDebounced()}}_onScroll(e,{target:i}){this._currentElementWithTooltip&&(i.contains(this.balloonPanelView.element)&&i.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(e,{text:i,position:s,cssClass:o}){this._unpinTooltip();const r=Ye(Tt._editors.values()).ui.view.body;r.has(this.balloonPanelView)||r.add(this.balloonPanelView),this.tooltipTextView.text=i,this.balloonPanelView.class=[M_,o].filter(a=>a).join(" "),this.balloonPanelView.pin({target:e,positions:Tt.getPositioningFunctions(s)}),this._resizeObserver=new Dr(e,()=>{Io(e)||this._unpinTooltip()}),this._mutationObserver.attach(e);for(const a of Tt._editors)this.listenTo(a.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=e,this._currentTooltipPosition=s}_unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const e of Tt._editors)this.stopListening(e.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._resizeObserver&&this._resizeObserver.destroy(),this._mutationObserver.detach()}_updateTooltipPosition(){if(!this._currentElementWithTooltip)return;const e=If(this._currentElementWithTooltip);if(!Io(this._currentElementWithTooltip)||!e.text){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:Tt.getPositioningFunctions(e.position)})}};h(Tt,"defaultBalloonPositions",St.generatePositions({heightOffset:5,sideOffset:13})),h(Tt,"_editors",new Set),h(Tt,"_instance",null);let Qm=Tt;function Sf(n){return Xi(n)?n.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function If(n){return{text:n.dataset.ckeTooltipText,position:n.dataset.ckeTooltipPosition||"s",cssClass:n.dataset.ckeTooltipClass||""}}function kZ(n){const t=new MutationObserver(()=>{n()});return{attach(e){t.observe(e,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]})},detach(){t.disconnect()}}}var TZ=`<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>
`;const EZ=53,AZ=10,xZ=50,SZ=350,IZ="Powered by";class PZ extends on(){constructor(e){super();h(this,"editor");h(this,"_balloonView");h(this,"_showBalloonThrottled");h(this,"_lastFocusedEditableElement");this.editor=e,this._balloonView=null,this._lastFocusedEditableElement=null,this._showBalloonThrottled=$s(this._showBalloon.bind(this),50,{leading:!0}),e.on("ready",this._handleEditorReady.bind(this))}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor,i=!!e.config.get("ui.poweredBy.forceVisible");/* istanbul ignore next -- @preserve */!i&&vz(e.config.get("licenseKey"))==="VALID"||e.ui.view&&(e.ui.focusTracker.on("change:isFocused",(s,o,r)=>{this._updateLastFocusedEditableElement(),r?this._showBalloon():this._hideBalloon()}),e.ui.focusTracker.on("change:focusedElement",(s,o,r)=>{this._updateLastFocusedEditableElement(),r&&this._showBalloon()}),e.ui.on("update",()=>{this._showBalloonThrottled()}))}_createBalloonView(){const e=this.editor,i=this._balloonView=new St,s=NI(e),o=new RZ(e.locale,s.label);i.content.add(o),i.set({class:"ck-powered-by-balloon"}),e.ui.view.body.add(i),e.ui.focusTracker.add(i.element),this._balloonView=i}_showBalloon(){if(!this._lastFocusedEditableElement)return;const e=LZ(this.editor,this._lastFocusedEditableElement);e&&(this._balloonView||this._createBalloonView(),this._balloonView.pin(e))}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_updateLastFocusedEditableElement(){const e=this.editor,i=e.ui.focusTracker.isFocused,s=e.ui.focusTracker.focusedElement;if(!i||!s){this._lastFocusedEditableElement=null;return}const o=Array.from(e.ui.getEditableElementsNames()).map(r=>e.ui.getEditableElement(r));o.includes(s)?this._lastFocusedEditableElement=s:this._lastFocusedEditableElement=o[0]}}class RZ extends q{constructor(t,e){super(t);const i=new es,s=this.bindTemplate;i.set({content:TZ,isColorInherited:!1}),i.extendTemplate({attributes:{style:{width:EZ+"px",height:AZ+"px"}}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...e?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[e]}]:[],i],on:{dragstart:s.to(o=>o.preventDefault())}}]})}}function LZ(n,t){const e=NI(n),i=e.side==="right"?VZ(t,e):BZ(t,e);return{target:t,positions:[i]}}function VZ(n,t){return OI(n,t,(e,i)=>e.left+e.width-i.width-t.horizontalOffset)}function BZ(n,t){return OI(n,t,e=>e.left+t.horizontalOffset)}function OI(n,t,e){return(i,s)=>{const o=new he(n);if(o.width<SZ||o.height<xZ)return null;let r;t.position==="inside"?r=o.bottom-s.height:r=o.bottom-s.height/2,r-=t.verticalOffset;const a=e(o,s),c=i.clone().moveTo(a,r).getIntersection(s.clone().moveTo(a,r)).getVisible();return!c||c.getArea()<s.getArea()?null:{top:r,left:a,name:`position_${t.position}-side_${t.side}`,config:{withArrow:!1}}}}function NI(n){const t=n.config.get("ui.poweredBy"),e=t&&t.position||"border";return{position:e,label:IZ,verticalOffset:e==="inside"?5:0,horizontalOffset:5,side:n.locale.contentLanguageDirection==="ltr"?"right":"left",...t}}const O_={POLITE:"polite",ASSERTIVE:"assertive"};class MZ{constructor(t){h(this,"editor");h(this,"view");this.editor=t,t.once("ready",()=>{for(const e of Object.values(O_))this.announce("",e)})}announce(t,e=O_.POLITE){const i=this.editor;if(!i.ui.view)return;this.view||(this.view=new OZ(i.locale),i.ui.view.body.add(this.view));const{politeness:s,isUnsafeHTML:o}=typeof e=="string"?{politeness:e}:e;let r=this.view.regionViews.find(a=>a.politeness===s);r||(r=new NZ(i,s),this.view.regionViews.add(r)),r.announce({announcement:t,isUnsafeHTML:o})}}class OZ extends q{constructor(e){super(e);h(this,"regionViews");this.regionViews=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-aria-live-announcer"]},children:this.regionViews})}}class NZ extends q{constructor(e,i){super(e.locale);h(this,"politeness");h(this,"_domConverter");h(this,"_pruneAnnouncementsInterval");this.setTemplate({tag:"div",attributes:{role:"region","aria-live":i,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{class:["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",()=>{this._pruneAnnouncementsInterval!==null&&(clearInterval(this._pruneAnnouncementsInterval),this._pruneAnnouncementsInterval=null)}),this.politeness=i,this._domConverter=e.data.htmlProcessor.domConverter,this._pruneAnnouncementsInterval=setInterval(()=>{this.element&&this._listElement.firstChild&&this._listElement.firstChild.remove()},5e3)}announce({announcement:e,isUnsafeHTML:i}){if(!e.trim().length)return;const s=document.createElement("li");i?this._domConverter.setContentOf(s,e):s.innerText=e,this._listElement.appendChild(s)}get _listElement(){return this.element.querySelector("ul")}}class FZ extends Ve(){constructor(e){super();h(this,"editor");h(this,"componentFactory");h(this,"focusTracker");h(this,"tooltipManager");h(this,"poweredBy");h(this,"ariaLiveAnnouncer");h(this,"isReady",!1);h(this,"_editableElementsMap",new Map);h(this,"_focusableToolbarDefinitions",[]);const i=e.editing.view;this.editor=e,this.componentFactory=new yZ(e),this.focusTracker=new Ge,this.tooltipManager=new Qm(e),this.poweredBy=new PZ(e),this.ariaLiveAnnouncer=new MZ(e),this.set("viewportOffset",this._readViewportOffsetFromConfig()),this.once("ready",()=>{this.isReady=!0}),this.listenTo(i.document,"layoutChanged",this.update.bind(this)),this.listenTo(i,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[]}setEditableElement(e,i){this._editableElementsMap.set(e,i),i.ckeditorInstance||(i.ckeditorInstance=this.editor),this.focusTracker.add(i);const s=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(i)};this.isReady?s():this.once("ready",s)}removeEditableElement(e){const i=this._editableElementsMap.get(e);i&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(i),this.focusTracker.remove(i),i.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,i={}){e.isRendered?(this.focusTracker.add(e.element),this.editor.keystrokes.listenTo(e.element)):e.once("render",()=>{this.focusTracker.add(e.element),this.editor.keystrokes.listenTo(e.element)}),this._focusableToolbarDefinitions.push({toolbarView:e,options:i})}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const e=this.editor,i=e.config.get("ui.viewportOffset");if(i)return i;const s=e.config.get("toolbar.viewportTopOffset");return s?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:s}):{top:0}}_initFocusTracking(){const e=this.editor,i=e.editing.view;let s,o;e.keystrokes.set("Alt+F10",(r,a)=>{const l=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(l)&&!Array.from(i.domRoots.values()).includes(l)&&(s=l);const c=this._getCurrentFocusedToolbarDefinition();(!c||!o)&&(o=this._getFocusableCandidateToolbarDefinitions());for(let u=0;u<o.length;u++){const d=o.shift();if(o.push(d),d!==c&&this._focusFocusableCandidateToolbar(d)){c&&c.options.afterBlur&&c.options.afterBlur();break}}a()}),e.keystrokes.set("Esc",(r,a)=>{const l=this._getCurrentFocusedToolbarDefinition();l&&(s?(s.focus(),s=null):e.editing.view.focus(),l.options.afterBlur&&l.options.afterBlur(),a())})}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const i of this._focusableToolbarDefinitions){const{toolbarView:s,options:o}=i;(Io(s.element)||o.beforeFocus)&&e.push(i)}return e.sort((i,s)=>N_(i)-N_(s)),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:i,options:{beforeFocus:s}}=e;return s&&s(),Io(i.element)?(i.focus(),!0):!1}_handleScrollToTheSelection(e,i){const s={top:0,bottom:0,left:0,right:0,...this.viewportOffset};i.viewportOffset.top+=s.top,i.viewportOffset.bottom+=s.bottom,i.viewportOffset.left+=s.left,i.viewportOffset.right+=s.right}}function N_(n){const{toolbarView:t,options:e}=n;let i=10;return Io(t.element)&&i--,e.isContextual&&i--,i}class DZ extends q{constructor(e){super(e);h(this,"body");this.body=new HK(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}class $Z extends DZ{constructor(e){super(e);h(this,"top");h(this,"main");h(this,"_voiceLabelView");this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,i=new fn;return i.text=e("Rich Text Editor"),i.extendTemplate({attributes:{class:"ck-voice-label"}}),i}}class HZ extends q{constructor(e,i,s){super(e);h(this,"name",null);h(this,"_editingView");h(this,"_editableElement");h(this,"_hasExternalElement");this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=s,this._hasExternalElement=!!this._editableElement,this._editingView=i}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?s(this):i(this);function i(o){e.change(r=>{const a=e.document.getRoot(o.name);r.addClass(o.isFocused?"ck-focused":"ck-blurred",a),r.removeClass(o.isFocused?"ck-blurred":"ck-focused",a)})}function s(o){e.once("change:isRenderingInProgress",(r,a,l)=>{l?s(o):i(o)})}}}class zZ extends HZ{constructor(e,i,s,o={}){super(e,i,s);h(this,"_generateLabel");const r=e.t;this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}}),this._generateLabel=o.label||(()=>r("Editor editing area: %0",this.name))}render(){super.render();const e=this._editingView;e.change(i=>{const s=e.document.getRoot(this.name);i.setAttribute("aria-label",this._generateLabel(this),s)})}}class F_ extends Rh{static get pluginName(){return"Notification"}init(){this.on("show:warning",(t,e)=>{window.alert(e.message)},{priority:"lowest"})}showSuccess(t,e={}){this._showNotification({message:t,type:"success",namespace:e.namespace,title:e.title})}showInfo(t,e={}){this._showNotification({message:t,type:"info",namespace:e.namespace,title:e.title})}showWarning(t,e={}){this._showNotification({message:t,type:"warning",namespace:e.namespace,title:e.title})}_showNotification(t){const e=t.namespace?`show:${t.type}:${t.namespace}`:`show:${t.type}`;this.fire(e,{message:t.message,type:t.type,title:t.title||""})}}class Wr extends Ve(){constructor(t,e){super(),e&&Nr(this,e),t&&this.set(t)}}const Wc=ra("px");class mi extends A{constructor(e){super(e);h(this,"positionLimiter");h(this,"visibleStack");h(this,"_viewToStack",new Map);h(this,"_idToStack",new Map);h(this,"_view",null);h(this,"_rotatorView",null);h(this,"_fakePanelsView",null);this.positionLimiter=()=>{const i=this.editor.editing.view,o=i.document.selection.editableElement;return o?i.domConverter.mapViewToDom(o.root):null},this.set("visibleView",null),this.set("_numberOfStacks",0),this.set("_singleViewMode",!1)}static get pluginName(){return"ContextualBalloon"}destroy(){super.destroy(),this._view&&this._view.destroy(),this._rotatorView&&this._rotatorView.destroy(),this._fakePanelsView&&this._fakePanelsView.destroy()}get view(){return this._view||this._createPanelView(),this._view}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this._view||this._createPanelView(),this.hasView(e.view))throw new C("contextualballoon-add-view-exist",[this,e]);const i=e.stackId||"main";if(!this._idToStack.has(i)){this._idToStack.set(i,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(i)),this._numberOfStacks=this._idToStack.size,(!this._visibleStack||e.singleViewMode)&&this.showStack(i);return}const s=this._idToStack.get(i);e.singleViewMode&&this.showStack(i),s.set(e.view,e),this._viewToStack.set(e.view,s),s===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new C("contextualballoon-remove-view-not-exist",[this,e]);const i=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(i.size===1?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(i.values())[i.size-2])),i.size===1?(this._idToStack.delete(this._getStackId(i)),this._numberOfStacks=this._idToStack.size):i.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const i=this._idToStack.get(e);if(!i)throw new C("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==i&&this._showView(Array.from(i.values()).pop())}_createPanelView(){this._view=new St(this.editor.locale),this.editor.ui.view.body.add(this._view),this.editor.ui.focusTracker.add(this._view.element),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find(s=>s[1]===e)[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let i=e.indexOf(this._visibleStack)+1;e[i]||(i=0),this.showStack(this._getStackId(e[i]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let i=e.indexOf(this._visibleStack)-1;e[i]||(i=e.length-1),this.showStack(this._getStackId(e[i]))}_createRotatorView(){const e=new UZ(this.editor.locale),i=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(s,o)=>!o&&s>1),e.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(s,o)=>{if(o<2)return"";const r=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return i("%0 of %1",[r,o])}),e.buttonNextView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),e.buttonPrevView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),e}_createFakePanelsView(){const e=new WZ(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(i,s)=>!s&&i>=2?Math.min(i-1,2):0),e.listenTo(this.view,"change:top",()=>e.updatePosition()),e.listenTo(this.view,"change:left",()=>e.updatePosition()),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:i="",withArrow:s=!0,singleViewMode:o=!1}){this.view.class=i,this.view.withArrow=s,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),o&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:this.editor.ui.viewportOffset})),e}}class UZ extends q{constructor(e){super(e);h(this,"focusTracker");h(this,"buttonPrevView");h(this,"buttonNextView");h(this,"content");const i=e.t,s=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new Ge,this.buttonPrevView=this._createButtonView(i("Previous"),F.previousArrow),this.buttonNextView=this._createButtonView(i("Next"),F.nextArrow),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",s.to("isNavigationVisible",o=>o?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:s.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,i){const s=new te(this.locale);return s.set({label:e,icon:i,tooltip:!0}),s}}class WZ extends q{constructor(e,i){super(e);h(this,"content");h(this,"_balloonPanelView");const s=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=i,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",s.to("numberOfPanels",o=>o?"":"ck-hidden")],style:{top:s.to("top",Wc),left:s.to("left",Wc),width:s.to("width",Wc),height:s.to("height",Wc)}},children:this.content}),this.on("change:numberOfPanels",(o,r,a,l)=>{a>l?this._addPanels(a-l):this._removePanels(l-a),this.updatePosition()})}_addPanels(e){for(;e--;){const i=new q;i.setTemplate({tag:"div"}),this.content.add(i),this.registerChild(i)}}_removePanels(e){for(;e--;){const i=this.content.last;this.content.remove(i),this.deregisterChild(i),i.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:i}=this._balloonPanelView,{width:s,height:o}=new he(this._balloonPanelView.element);Object.assign(this,{top:e,left:i,width:s,height:o})}}}const nr=ra("px");class qZ extends q{constructor(e){super(e);h(this,"content");h(this,"contentPanelElement");h(this,"_contentPanelPlaceholder");const i=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new bn({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:i.to("isSticky",s=>s?"block":"none"),height:i.to("isSticky",s=>s?nr(this._contentPanelRect.height):null)}}}).render(),this.contentPanelElement=new bn({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",i.if("isSticky","ck-sticky-panel__content_sticky"),i.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:i.to("isSticky",s=>s?nr(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:i.to("_stickyTopOffset",s=>s&&nr(s)),bottom:i.to("_stickyBottomOffset",s=>s&&nr(s)),marginLeft:i.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this.contentPanelElement]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(j.document,"scroll",()=>{this.checkIfShouldBeSticky()},{useCapture:!0}),this.listenTo(this,"change:isActive",()=>{this.checkIfShouldBeSticky()})}checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive){this._unstick();return}const e=new he(this.limiterElement);let i=e.getVisible();if(i){const s=new he(j.window);s.top+=this.viewportTopOffset,s.height-=this.viewportTopOffset,i=i.getIntersection(s)}if(i&&e.top<i.top){const s=i.top;if(s+this._contentPanelRect.height+this.limiterBottomOffset>i.bottom){const o=Math.max(e.bottom-i.bottom,0)+this.limiterBottomOffset;e.bottom-o>e.top+this._contentPanelRect.height?this._stickToBottomOfLimiter(o):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(s):this._unstick()}else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=nr(-j.window.scrollX)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=nr(-j.window.scrollX)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new he(this.contentPanelElement)}}const jZ=ra("px");class GZ extends A{constructor(e){super(e);h(this,"toolbarView");h(this,"focusTracker");h(this,"_balloonConfig");h(this,"_resizeObserver",null);h(this,"_balloon");h(this,"_fireSelectionChangeDebounced");this._balloonConfig=Nb(e.config.get("balloonToolbar")),this.toolbarView=this._createToolbarView(),this.focusTracker=new Ge,e.ui.once("ready",()=>{this.focusTracker.add(e.ui.getEditableElement()),this.focusTracker.add(this.toolbarView.element)}),e.ui.addToolbar(this.toolbarView,{beforeFocus:()=>this.show(!0),afterBlur:()=>this.hide(),isContextual:!0}),this._balloon=e.plugins.get(mi),this._fireSelectionChangeDebounced=Fn(()=>this.fire("_selectionChangeDebounced"),200),this.decorate("show")}static get pluginName(){return"BalloonToolbar"}static get requires(){return[mi]}init(){const e=this.editor,i=e.model.document.selection;this.listenTo(this.focusTracker,"change:isFocused",(s,o,r)=>{const a=this._balloon.visibleView===this.toolbarView;!r&&a?this.hide():r&&this.show()}),this.listenTo(i,"change:range",(s,o)=>{(o.directChange||i.isCollapsed)&&this.hide(),this._fireSelectionChangeDebounced()}),this.listenTo(this,"_selectionChangeDebounced",()=>{this.editor.editing.view.document.isFocused&&this.show()}),this._balloonConfig.shouldNotGroupWhenFull||this.listenTo(e,"ready",()=>{const s=e.ui.view.editable.element;this._resizeObserver=new Dr(s,o=>{this.toolbarView.maxWidth=jZ(o.contentRect.width*.9)})}),this.listenTo(this.toolbarView,"groupedItemsUpdate",()=>{this._updatePosition()}),e.ui.once("ready",()=>{this.toolbarView.fillFromConfig(this._balloonConfig,this.editor.ui.componentFactory)})}_createToolbarView(){const e=this.editor.locale.t,i=!this._balloonConfig.shouldNotGroupWhenFull,s=new Ro(this.editor.locale,{shouldGroupWhenFull:i,isFloating:!0});return s.ariaLabel=e("Editor contextual toolbar"),s.render(),s}show(e=!1){const i=this.editor,s=i.model.document.selection,o=i.model.schema;this._balloon.hasView(this.toolbarView)||s.isCollapsed&&!e||KZ(s,o)||Array.from(this.toolbarView.items).every(r=>r.isEnabled!==void 0&&!r.isEnabled)||(this.listenTo(this.editor.ui,"update",()=>{this._updatePosition()}),this._balloon.add({view:this.toolbarView,position:this._getBalloonPositionData(),balloonClassName:"ck-toolbar-container"}))}hide(){this._balloon.hasView(this.toolbarView)&&(this.stopListening(this.editor.ui,"update"),this._balloon.remove(this.toolbarView))}_getBalloonPositionData(){const i=this.editor.editing.view,s=i.document,o=s.selection,r=s.selection.isBackward;return{target:()=>{const a=r?o.getFirstRange():o.getLastRange(),l=he.getDomRangeRects(i.domConverter.viewRangeToDom(a));return r?l[0]:(l.length>1&&l[l.length-1].width===0&&l.pop(),l[l.length-1])},positions:this._getBalloonPositions(r)}}_updatePosition(){this._balloon.updatePosition(this._getBalloonPositionData())}destroy(){super.destroy(),this.stopListening(),this._fireSelectionChangeDebounced.cancel(),this.toolbarView.destroy(),this.focusTracker.destroy(),this._resizeObserver&&this._resizeObserver.destroy()}_getBalloonPositions(e){const s=ue.isSafari&&ue.isiOS?St.generatePositions({heightOffset:Math.max(St.arrowHeightOffset,Math.round(20/j.window.visualViewport.scale))}):St.defaultPositions;return e?[s.northWestArrowSouth,s.northWestArrowSouthWest,s.northWestArrowSouthEast,s.northWestArrowSouthMiddleEast,s.northWestArrowSouthMiddleWest,s.southWestArrowNorth,s.southWestArrowNorthWest,s.southWestArrowNorthEast,s.southWestArrowNorthMiddleWest,s.southWestArrowNorthMiddleEast]:[s.southEastArrowNorth,s.southEastArrowNorthEast,s.southEastArrowNorthWest,s.southEastArrowNorthMiddleEast,s.southEastArrowNorthMiddleWest,s.northEastArrowSouth,s.northEastArrowSouthEast,s.northEastArrowSouthWest,s.northEastArrowSouthMiddleEast,s.northEastArrowSouthMiddleWest]}}function KZ(n,t){return n.rangeCount===1?!1:[...n.getRanges()].every(e=>{const i=e.getContainedElement();return i&&t.isSelectable(i)})}class ZZ extends te{constructor(e){super(e);h(this,"arrowView");const i=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",s=>String(s)),"data-cke-tooltip-disabled":i.to("isOn")},on:{mouseenter:i.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new es;return e.content=Mh,e.extendTemplate({attributes:{class:"ck-menu-bar__menu__button__arrow"}}),e}}class ua extends Ur{constructor(t,e){super(t);const i=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item"]},on:{mouseenter:i.to("mouseenter")}}),this.delegate("mouseenter").to(e)}}const qc=5,ka={toggleMenusAndFocusItemsOnHover(n){n.on("menu:mouseenter",t=>{if(n.isOpen){for(const e of n.menus){const i=t.path[0],s=i instanceof ua&&i.children.first===e;e.isOpen=(t.path.includes(e)||s)&&e.isEnabled}t.source.focus()}})},focusCycleMenusOnArrows(n){const t=n.locale.uiLanguageDirection==="rtl";n.on("menu:arrowright",i=>{e(i.source,t?-1:1)}),n.on("menu:arrowleft",i=>{e(i.source,t?1:-1)});function e(i,s){const o=n.children.getIndex(i),r=i.isOpen,a=n.children.length,l=n.children.get((o+a+s)%a);i.isOpen=!1,r&&(l.isOpen=!0),l.buttonView.focus()}},closeMenusWhenTheBarCloses(n){n.on("change:isOpen",()=>{n.isOpen||n.menus.forEach(t=>{t.isOpen=!1})})},closeMenuWhenAnotherOnTheSameLevelOpens(n){n.on("menu:change:isOpen",(t,e,i)=>{i&&n.menus.filter(s=>t.source.parentMenuView===s.parentMenuView&&t.source!==s&&s.isOpen).forEach(s=>{s.isOpen=!1})})},closeOnClickOutside(n){Wo({emitter:n,activator:()=>n.isOpen,callback:()=>n.close(),contextElements:()=>n.children.map(t=>t.element)})}},oo={openAndFocusPanelOnArrowDownKey(n){n.keystrokes.set("arrowdown",(t,e)=>{n.focusTracker.focusedElement===n.buttonView.element&&(n.isOpen||(n.isOpen=!0),n.panelView.focus(),e())})},openOnArrowRightKey(n){const t=n.locale.uiLanguageDirection==="rtl"?"arrowleft":"arrowright";n.keystrokes.set(t,(e,i)=>{n.focusTracker.focusedElement!==n.buttonView.element||!n.isEnabled||(n.isOpen||(n.isOpen=!0),n.panelView.focus(),i())})},openOnButtonClick(n){n.buttonView.on("execute",()=>{n.isOpen=!0,n.panelView.focus()})},toggleOnButtonClick(n){n.buttonView.on("execute",()=>{n.isOpen=!n.isOpen,n.isOpen&&n.panelView.focus()})},closeOnArrowLeftKey(n){const t=n.locale.uiLanguageDirection==="rtl"?"arrowright":"arrowleft";n.keystrokes.set(t,(e,i)=>{n.isOpen&&(n.isOpen=!1,n.focus(),i())})},closeOnEscKey(n){n.keystrokes.set("esc",(t,e)=>{n.isOpen&&(n.isOpen=!1,n.focus(),e())})},closeOnParentClose(n){n.parentMenuView.on("change:isOpen",(t,e,i)=>{!i&&t.source===n.parentMenuView&&(n.isOpen=!1)})}},JZ={southEast:n=>({top:n.bottom,left:n.left,name:"se"}),southWest:(n,t)=>({top:n.bottom,left:n.left-t.width+n.width,name:"sw"}),northEast:(n,t)=>({top:n.top-t.height,left:n.left,name:"ne"}),northWest:(n,t)=>({top:n.top-t.height,left:n.left-t.width+n.width,name:"nw"}),eastSouth:n=>({top:n.top,left:n.right-qc,name:"es"}),eastNorth:(n,t)=>({top:n.top-t.height,left:n.right-qc,name:"en"}),westSouth:(n,t)=>({top:n.top,left:n.left-t.width+qc,name:"ws"}),westNorth:(n,t)=>({top:n.top-t.height,left:n.left-t.width+qc,name:"wn"})},YZ=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:insertImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable"]},{groupId:"insertInline",items:["menuBar:link","menuBar:comment"]},{groupId:"insertMinorWidgets",items:["menuBar:mediaEmbed","menuBar:insertTemplate","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:multiLevelList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function XZ(n){let t;return!("items"in n)||!n.items?t={items:kn(YZ),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0,...n}:t={items:n.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1,...n},t}function QZ({normalizedConfig:n,locale:t,componentFactory:e}){const i=kn(n);return eJ(n,i),tJ(n,i),nJ(n,i,e),FI(n,i),iJ(i,t),i}function eJ(n,t){const e=t.removeItems,i=[];t.items=t.items.filter(({menuId:s})=>e.includes(s)?(i.push(s),!1):!0),da(t.items,s=>{s.groups=s.groups.filter(({groupId:o})=>e.includes(o)?(i.push(o),!1):!0);for(const o of s.groups)o.items=o.items.filter(r=>{const a=DI(r);return e.includes(a)?(i.push(a),!1):!0})});for(const s of e)i.includes(s)||Te("menu-bar-item-could-not-be-removed",{menuBarConfig:n,itemName:s})}function tJ(n,t){const e=t.addItems,i=[];for(const s of e){const o=rJ(s.position),r=aJ(s.position);if(sJ(s))if(!r)o==="start"?(t.items.unshift(s.menu),i.push(s)):o==="end"&&(t.items.push(s.menu),i.push(s));else{const a=t.items.findIndex(l=>l.menuId===r);a!=-1?o==="before"?(t.items.splice(a,0,s.menu),i.push(s)):o==="after"&&(t.items.splice(a+1,0,s.menu),i.push(s)):D_(t,s.menu,r,o)&&i.push(s)}else oJ(s)?da(t.items,a=>{if(a.menuId===r)o==="start"?(a.groups.unshift(s.group),i.push(s)):o==="end"&&(a.groups.push(s.group),i.push(s));else{const l=a.groups.findIndex(c=>c.groupId===r);l!==-1&&(o==="before"?(a.groups.splice(l,0,s.group),i.push(s)):o==="after"&&(a.groups.splice(l+1,0,s.group),i.push(s)))}}):D_(t,s.item,r,o)&&i.push(s)}for(const s of e)i.includes(s)||Te("menu-bar-item-could-not-be-added",{menuBarConfig:n,addedItemConfig:s})}function D_(n,t,e,i){let s=!1;return da(n.items,o=>{for(const{groupId:r,items:a}of o.groups){if(s)return;if(r===e)i==="start"?(a.unshift(t),s=!0):i==="end"&&(a.push(t),s=!0);else{const l=a.findIndex(c=>DI(c)===e);l!==-1&&(i==="before"?(a.splice(l,0,t),s=!0):i==="after"&&(a.splice(l+1,0,t),s=!0))}}}),s}function nJ(n,t,e){da(t.items,i=>{for(const s of i.groups)s.items=s.items.filter(o=>{const r=typeof o=="string"&&!e.has(o);return r&&!t.isUsingDefaultConfig&&Te("menu-bar-item-unavailable",{menuBarConfig:n,parentMenuConfig:kn(i),componentName:o}),!r})})}function FI(n,t){const e=t.isUsingDefaultConfig;let i=!1;if(t.items=t.items.filter(s=>s.groups.length?!0:(Pf(n,s,e),!1)),!t.items.length){Pf(n,n,e);return}da(t.items,s=>{s.groups=s.groups.filter(o=>o.items.length?!0:(i=!0,!1));for(const o of s.groups)o.items=o.items.filter(r=>$I(r)&&!r.groups.length?(Pf(n,r,e),i=!0,!1):!0)}),i&&FI(n,t)}function Pf(n,t,e){e||Te("menu-bar-menu-empty",{menuBarConfig:n,emptyMenuConfig:t})}function iJ(n,t){const e=t.t,i={File:e({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:e({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:e({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:e({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:e({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:e({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:e({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:e({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:e({string:"Font",id:"MENU_BAR_MENU_FONT"})};da(n.items,s=>{s.label in i&&(s.label=i[s.label])})}function da(n,t){if(Array.isArray(n))for(const i of n)e(i);function e(i){t(i);for(const s of i.groups)for(const o of s.items)$I(o)&&e(o)}}function sJ(n){return typeof n=="object"&&"menu"in n}function oJ(n){return typeof n=="object"&&"group"in n}function rJ(n){return n.startsWith("start")?"start":n.startsWith("end")?"end":n.startsWith("after")?"after":"before"}function aJ(n){const t=n.match(/^[^:]+:(.+)/);return t?t[1]:null}function DI(n){return typeof n=="string"?n:n.menuId}function $I(n){return typeof n=="object"&&"menuId"in n}function lJ(n,t){const e=t.element;n.ui.focusTracker.add(e),n.keystrokes.listenTo(e);const i=XZ(n.config.get("menuBar")||{});t.fillFromConfig(i,n.ui.componentFactory),n.keystrokes.set("Esc",(s,o)=>{e.contains(n.ui.focusTracker.focusedElement)&&(n.editing.view.focus(),o())}),n.keystrokes.set("Alt+F9",(s,o)=>{e.contains(n.ui.focusTracker.focusedElement)||(t.focus(),o())})}class cJ extends q{constructor(e){super(e);h(this,"children");const i=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-menu-bar__menu__panel",i.to("position",s=>`ck-menu-bar__menu__panel_position_${s}`),i.if("isVisible","ck-hidden",s=>!s)],tabindex:"-1"},children:this.children,on:{selectstart:i.to(s=>{s.target.tagName.toLocaleLowerCase()!=="input"&&s.preventDefault()})}})}focus(e=1){this.children.length&&(e===1?this.children.first.focus():this.children.last.focus())}}const Ad=class Ad extends q{constructor(e){super(e);h(this,"buttonView");h(this,"panelView");h(this,"focusTracker");h(this,"keystrokes");const i=this.bindTemplate;this.buttonView=new ZZ(e),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.panelView=new cJ(e),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new tt,this.focusTracker=new Ge,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("panelPosition","w"),this.set("class",void 0),this.set("parentMenuView",null),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar__menu",i.to("class"),i.if("isEnabled","ck-disabled",s=>!s),i.if("parentMenuView","ck-menu-bar__menu_top-level",s=>!s)]},children:[this.buttonView,this.panelView]})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),oo.closeOnEscKey(this),this._repositionPanelOnOpen()}_attachBehaviors(){this.parentMenuView?(oo.openOnButtonClick(this),oo.openOnArrowRightKey(this),oo.closeOnArrowLeftKey(this),oo.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),oo.openAndFocusPanelOnArrowDownKey(this),oo.toggleOnButtonClick(this))}_propagateArrowKeystrokeEvents(){this.keystrokes.set("arrowright",(e,i)=>{this.fire("arrowright"),i()}),this.keystrokes.set("arrowleft",(e,i)=>{this.fire("arrowleft"),i()})}_repositionPanelOnOpen(){this.on("change:isOpen",(e,i,s)=>{if(!s)return;const o=Ad._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=o?o.name:this._panelPositions[0].name})}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:e,southWest:i,northEast:s,northWest:o,westSouth:r,eastSouth:a,westNorth:l,eastNorth:c}=JZ;return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?[a,c,r,l]:[e,i,s,o]:this.parentMenuView?[r,l,a,c]:[i,e,o,s]}};h(Ad,"_getOptimalPosition",gb);let ui=Ad;class qr extends Db{constructor(t){super(t),this.role="menu"}}class HI extends Jm{constructor(t){super(t),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}const $_=["mouseenter","arrowleft","arrowright","change:isOpen"];class uJ extends q{constructor(e){super(e);h(this,"children");h(this,"menus",[]);const i=e.t;this.set("isOpen",!1),this._setupIsOpenUpdater(),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar"],"aria-label":i("Editor menu bar"),role:"menubar"},children:this.children})}fillFromConfig(e,i){const s=this.locale,r=QZ({normalizedConfig:e,locale:s,componentFactory:i}).items.map(a=>this._createMenu({componentFactory:i,menuDefinition:a}));this.children.addMany(r)}render(){super.render(),ka.toggleMenusAndFocusItemsOnHover(this),ka.closeMenusWhenTheBarCloses(this),ka.closeMenuWhenAnotherOnTheSameLevelOpens(this),ka.focusCycleMenusOnArrows(this),ka.closeOnClickOutside(this)}focus(){this.children.first&&this.children.first.focus()}close(){for(const e of this.children)e.isOpen=!1}registerMenu(e,i=null){i?(e.delegate(...$_).to(i),e.parentMenuView=i):e.delegate(...$_).to(this,s=>"menu:"+s),e._attachBehaviors(),this.menus.push(e)}_createMenu({componentFactory:e,menuDefinition:i,parentMenuView:s}){const o=this.locale,r=new ui(o);return this.registerMenu(r,s),r.buttonView.set({label:i.label}),r.once("change:isOpen",()=>{const a=new qr(o);a.ariaLabel=i.label,r.panelView.children.add(a),a.items.addMany(this._createMenuItems({menuDefinition:i,parentMenuView:r,componentFactory:e}))}),r}_createMenuItems({menuDefinition:e,parentMenuView:i,componentFactory:s}){const o=this.locale,r=[];for(const a of e.groups){for(const l of a.items){const c=new ua(o,i);if(Ce(l))c.children.add(this._createMenu({componentFactory:s,menuDefinition:l,parentMenuView:i}));else{const u=this._createMenuItemContentFromFactory({componentName:l,componentFactory:s,parentMenuView:i});if(!u)continue;c.children.add(u)}r.push(c)}a!==e.groups[e.groups.length-1]&&r.push(new Fb(o))}return r}_createMenuItemContentFromFactory({componentName:e,parentMenuView:i,componentFactory:s}){const o=s.create(e);return o instanceof ui||o instanceof pt||o instanceof HI?(this._registerMenuTree(o,i),o.on("execute",()=>{this.close()}),o):(Te("menu-bar-component-unsupported",{componentName:e,componentView:o}),null)}_registerMenuTree(e,i){if(!(e instanceof ui)){e.delegate("mouseenter").to(i);return}this.registerMenu(e,i);const s=e.panelView.children.filter(r=>r instanceof qr)[0];if(!s){e.delegate("mouseenter").to(i);return}const o=s.items.filter(r=>r instanceof Ur);for(const r of o)this._registerMenuTree(r.children.get(0),e)}_setupIsOpenUpdater(){let e;this.on("menu:change:isOpen",(i,s,o)=>{clearTimeout(e),o?this.isOpen=!0:e=setTimeout(()=>{this.isOpen=Array.from(this.children).some(r=>r.isOpen)},0)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Hb=["left","right","center","justify"];function zI(n){return Hb.includes(n)}function UI(n,t){return t.contentLanguageDirection=="rtl"?n==="right":n==="left"}function WI(n){const t=n.map(i=>{let s;return typeof i=="string"?s={name:i}:s=i,s}).filter(i=>{const s=Hb.includes(i.name);return s||Te("alignment-config-name-not-recognized",{option:i}),s}),e=t.filter(i=>!!i.className).length;if(e&&e<t.length)throw new C("alignment-config-classnames-are-missing",{configuredOptions:n});return t.forEach((i,s,o)=>{const r=o.slice(s+1);if(r.some(l=>l.name==i.name))throw new C("alignment-config-name-already-defined",{option:i,configuredOptions:n});if(i.className&&r.some(c=>c.className==i.className))throw new C("alignment-config-classname-already-defined",{option:i,configuredOptions:n})}),t}const zb="alignment";class dJ extends ne{refresh(){const e=this.editor.locale,i=Ye(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!i&&this._canBeAligned(i),this.isEnabled&&i.hasAttribute("alignment")?this.value=i.getAttribute("alignment"):this.value=e.contentLanguageDirection==="rtl"?"right":"left"}execute(t={}){const e=this.editor,i=e.locale,s=e.model,o=s.document,r=t.value;s.change(a=>{const l=Array.from(o.selection.getSelectedBlocks()).filter(d=>this._canBeAligned(d)),c=l[0].getAttribute("alignment");UI(r,i)||c===r||!r?hJ(l,a):fJ(l,a,r)})}_canBeAligned(t){return this.editor.model.schema.checkAttribute(t,zb)}}function hJ(n,t){for(const e of n)t.removeAttribute(zb,e)}function fJ(n,t,e){for(const i of n)t.setAttribute(zb,e,i)}class mJ extends A{static get pluginName(){return"AlignmentEditing"}constructor(t){super(t),t.config.define("alignment",{options:Hb.map(e=>({name:e}))})}init(){const t=this.editor,e=t.locale,i=t.model.schema,o=WI(t.config.get("alignment.options")).filter(c=>zI(c.name)&&!UI(c.name,e)),r=o.some(c=>!!c.className);i.extend("$block",{allowAttributes:"alignment"}),t.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),r?t.conversion.attributeToAttribute(wJ(o)):t.conversion.for("downcast").attributeToAttribute(gJ(o));const a=pJ(o);for(const c of a)t.conversion.for("upcast").attributeToAttribute(c);const l=bJ(o);for(const c of l)t.conversion.for("upcast").attributeToAttribute(c);t.commands.add("alignment",new dJ(t))}}function gJ(n){const t={};for(const{name:i}of n)t[i]={key:"style",value:{"text-align":i}};return{model:{key:"alignment",values:n.map(i=>i.name)},view:t}}function pJ(n){const t=[];for(const{name:e}of n)t.push({view:{key:"style",value:{"text-align":e}},model:{key:"alignment",value:e}});return t}function bJ(n){const t=[];for(const{name:e}of n)t.push({view:{key:"align",value:e},model:{key:"alignment",value:e}});return t}function wJ(n){const t={};for(const i of n)t[i.name]={key:"class",value:i.className};return{model:{key:"alignment",values:n.map(i=>i.name)},view:t}}const Ta=new Map([["left",F.alignLeft],["right",F.alignRight],["center",F.alignCenter],["justify",F.alignJustify]]);class _J extends A{get localizedOptionTitles(){const t=this.editor.t;return{left:t("Align left"),right:t("Align right"),center:t("Align center"),justify:t("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const t=this.editor,e=WI(t.config.get("alignment.options"));e.map(i=>i.name).filter(zI).forEach(i=>this._addButton(i)),this._addToolbarDropdown(e),this._addMenuBarMenu(e)}_addButton(t){this.editor.ui.componentFactory.add(`alignment:${t}`,i=>this._createButton(i,t))}_createButton(t,e,i={}){const s=this.editor,o=s.commands.get("alignment"),r=new te(t);return r.set({label:this.localizedOptionTitles[e],icon:Ta.get(e),tooltip:!0,isToggleable:!0,...i}),r.bind("isEnabled").to(o),r.bind("isOn").to(o,"value",a=>a===e),this.listenTo(r,"execute",()=>{s.execute("alignment",{value:e}),s.editing.view.focus()}),r}_addToolbarDropdown(t){const e=this.editor;e.ui.componentFactory.add("alignment",s=>{const o=Yt(s),r=s.uiLanguageDirection==="rtl"?"w":"e",a=s.t;Oh(o,()=>t.map(u=>this._createButton(s,u.name,{tooltipPosition:r})),{enableActiveItemFocusOnDropdownOpen:!0,isVertical:!0,ariaLabel:a("Text alignment toolbar")}),o.buttonView.set({label:a("Text alignment"),tooltip:!0}),o.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const l=s.contentLanguageDirection==="rtl"?Ta.get("right"):Ta.get("left"),c=e.commands.get("alignment");return o.buttonView.bind("icon").to(c,"value",u=>Ta.get(u)||l),o.bind("isEnabled").to(c,"isEnabled"),this.listenTo(o,"execute",()=>{e.editing.view.focus()}),o})}_addMenuBarMenu(t){const e=this.editor;e.ui.componentFactory.add("menuBar:alignment",i=>{const s=e.commands.get("alignment"),o=i.t,r=new ui(i),a=new qr(i);r.bind("isEnabled").to(s),a.set({ariaLabel:o("Text alignment"),role:"menu"}),r.buttonView.set({label:o("Text alignment")});for(const l of t){const c=new ua(i,r),u=new pt(i);u.extendTemplate({attributes:{"aria-checked":u.bindTemplate.to("isOn")}}),u.delegate("execute").to(r),u.set({label:this.localizedOptionTitles[l.name],icon:Ta.get(l.name)}),u.on("execute",()=>{e.execute("alignment",{value:l.name}),e.editing.view.focus()}),u.bind("isOn").to(s,"value",d=>d===l.name),u.bind("isEnabled").to(s,"isEnabled"),c.children.add(u),a.items.add(c)}return r.panelView.children.add(a),r})}}class vJ extends A{static get requires(){return[mJ,_J]}static get pluginName(){return"Alignment"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class qI{constructor(t,e=20){h(this,"model");h(this,"limit");h(this,"_isLocked");h(this,"_size");h(this,"_batch",null);h(this,"_changeCallback");h(this,"_selectionChangeCallback");this.model=t,this._size=0,this.limit=e,this._isLocked=!1,this._changeCallback=(i,s)=>{s.isLocal&&s.isUndoable&&s!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(t){this._size+=t,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(t=!1){(!this.isLocked||t)&&(this._batch=null,this._size=0)}}class yJ extends ne{constructor(e,i){super(e);h(this,"_buffer");this._buffer=new qI(e.model,i),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const i=this.editor.model,s=i.document,o=e.text||"",r=o.length;let a=s.selection;if(e.selection?a=e.selection:e.range&&(a=i.createSelection(e.range)),!i.canEditAt(a))return;const l=e.resultRange;i.enqueueChange(this._buffer.batch,c=>{this._buffer.lock();const u=Array.from(s.selection.getAttributes());i.deleteContent(a),o&&i.insertContent(c.createText(o,u),a),l?c.setSelection(l):a.is("documentSelection")||c.setSelection(a),this._buffer.unlock(),this._buffer.input(r)})}}const H_=["insertText","insertReplacementText"];class CJ extends Oi{constructor(e){super(e);h(this,"focusObserver");this.focusObserver=e.getObserver(Xu),ue.isAndroid&&H_.push("insertCompositionText");const i=e.document;i.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;const{data:r,targetRanges:a,inputType:l,domEvent:c}=o;if(!H_.includes(l))return;this.focusObserver.flush();const u=new Qi(i,"insertText");i.fire(u,new $r(e,c,{text:r,selection:e.createSelection(a)})),u.stop.called&&s.stop()}),i.on("compositionend",(s,{data:o,domEvent:r})=>{!this.isEnabled||ue.isAndroid||o&&i.fire("insertText",new $r(e,r,{text:o,selection:i.selection}))},{priority:"lowest"})}observe(){}stopObserving(){}}class jI extends A{static get pluginName(){return"Input"}init(){const t=this.editor,e=t.model,i=t.editing.view,s=e.document.selection;i.addObserver(CJ);const o=new yJ(t,t.config.get("typing.undoStep")||20);t.commands.add("insertText",o),t.commands.add("input",o),this.listenTo(i.document,"insertText",(r,a)=>{i.document.isComposing||a.preventDefault();const{text:l,selection:c,resultRange:u}=a,d=Array.from(c.getRanges()).map(g=>t.editing.mapper.toModelRange(g));let f=l;if(ue.isAndroid){const g=Array.from(d[0].getItems()).reduce((p,w)=>p+(w.is("$textProxy")?w.data:""),"");g&&(g.length<=f.length?f.startsWith(g)&&(f=f.substring(g.length),d[0].start=d[0].start.getShiftedBy(g.length)):g.startsWith(f)&&(d[0].start=d[0].start.getShiftedBy(f.length),f=""))}const m={text:f,selection:e.createSelection(d)};u&&(m.resultRange=t.editing.mapper.toModelRange(u)),t.execute("insertText",m),i.scrollToTheSelection()}),ue.isAndroid?this.listenTo(i.document,"keydown",(r,a)=>{s.isCollapsed||a.keyCode!=229||!i.document.isComposing||z_(e,o)}):this.listenTo(i.document,"compositionstart",()=>{s.isCollapsed||z_(e,o)})}}function z_(n,t){if(!t.isEnabled)return;const e=t.buffer;e.lock(),n.enqueueChange(e.batch,()=>{n.deleteContent(n.document.selection)}),e.unlock()}class U_ extends ne{constructor(e,i){super(e);h(this,"direction");h(this,"_buffer");this.direction=i,this._buffer=new qI(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const i=this.editor.model,s=i.document;i.enqueueChange(this._buffer.batch,o=>{this._buffer.lock();const r=o.createSelection(e.selection||s.selection);if(!i.canEditAt(r))return;const a=e.sequence||1,l=r.isCollapsed;if(r.isCollapsed&&i.modifySelection(r,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(a)){this._replaceEntireContentWithParagraph(o);return}if(this._shouldReplaceFirstBlockWithParagraph(r,a)){this.editor.execute("paragraph",{selection:r});return}if(r.isCollapsed)return;let c=0;r.getFirstRange().getMinimalFlatRanges().forEach(u=>{c+=Vm(u.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),i.deleteContent(r,{doNotResetEntireContent:l,direction:this.direction}),this._buffer.input(c),o.setSelection(r),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const i=this.editor.model,o=i.document.selection,r=i.schema.getLimitElement(o);if(!(o.isCollapsed&&o.containsEntireContent(r))||!i.schema.checkChild(r,"paragraph"))return!1;const l=r.getChild(0);return!(l&&l.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const i=this.editor.model,o=i.document.selection,r=i.schema.getLimitElement(o),a=e.createElement("paragraph");e.remove(e.createRangeIn(r)),e.insert(a,r),e.setSelection(a,0)}_shouldReplaceFirstBlockWithParagraph(e,i){const s=this.editor.model;if(i>1||this.direction!="backward"||!e.isCollapsed)return!1;const o=e.getFirstPosition(),r=s.schema.getLimitElement(o),a=r.getChild(0);return!(o.parent!=a||!e.containsEntireContent(a)||!s.schema.checkChild(r,"paragraph")||a.name=="paragraph")}}const kJ="character",W_="word",TJ="codePoint",As="selection",pr="backward",Va="forward",GI={deleteContent:{unit:As,direction:pr},deleteContentBackward:{unit:TJ,direction:pr},deleteWordBackward:{unit:W_,direction:pr},deleteHardLineBackward:{unit:As,direction:pr},deleteSoftLineBackward:{unit:As,direction:pr},deleteContentForward:{unit:kJ,direction:Va},deleteWordForward:{unit:W_,direction:Va},deleteHardLineForward:{unit:As,direction:Va},deleteSoftLineForward:{unit:As,direction:Va}};class EJ extends Oi{constructor(t){super(t);const e=t.document;let i=0;e.on("keydown",()=>{i++}),e.on("keyup",()=>{i=0}),e.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;const{targetRanges:r,domEvent:a,inputType:l}=o,c=GI[l];if(!c)return;const u={direction:c.direction,unit:c.unit,sequence:i};u.unit==As&&(u.selectionToRemove=t.createSelection(r[0])),l==="deleteContentBackward"&&(ue.isAndroid&&(u.sequence=1),xJ(r)&&(u.unit=As,u.selectionToRemove=t.createSelection(r)));const d=new aa(e,"delete",r[0]);e.fire(d,new $r(t,a,u)),d.stop.called&&s.stop()}),ue.isBlink&&AJ(this)}observe(){}stopObserving(){}}function AJ(n){const t=n.view,e=t.document;let i=null,s=!1;e.on("keydown",(a,{keyCode:l})=>{i=l,s=!1}),e.on("keyup",(a,{keyCode:l,domEvent:c})=>{const u=e.selection,d=n.isEnabled&&l==i&&o(l)&&!u.isCollapsed&&!s;if(i=null,d){const f=u.getFirstRange(),m=new aa(e,"delete",f),g={unit:As,direction:r(l),selectionToRemove:u};e.fire(m,new $r(t,c,g))}}),e.on("beforeinput",(a,{inputType:l})=>{const c=GI[l];o(i)&&c&&c.direction==r(i)&&(s=!0)},{priority:"high"}),e.on("beforeinput",(a,{inputType:l,data:c})=>{i==_e.delete&&l=="insertText"&&c==""&&a.stop()},{priority:"high"});function o(a){return a==_e.backspace||a==_e.delete}function r(a){return a==_e.backspace?pr:Va}}function xJ(n){if(n.length!=1||n[0].isCollapsed)return!1;const t=n[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let e=0;for(const{nextPosition:i,item:s}of t){if(i.parent.is("$text")){const o=i.parent.data,r=i.offset;if(wb(o,r)||_b(o,r)||h5(o,r))continue;e++}else(s.is("containerElement")||s.is("emptyElement"))&&e++;if(e>1)return!0}return!1}class Pi extends A{constructor(){super(...arguments);h(this,"_undoOnBackspace")}static get pluginName(){return"Delete"}init(){const e=this.editor,i=e.editing.view,s=i.document,o=e.model.document;i.addObserver(EJ),this._undoOnBackspace=!1;const r=new U_(e,"forward");e.commands.add("deleteForward",r),e.commands.add("forwardDelete",r),e.commands.add("delete",new U_(e,"backward")),this.listenTo(s,"delete",(a,l)=>{s.isComposing||l.preventDefault();const{direction:c,sequence:u,selectionToRemove:d,unit:f}=l,m=c==="forward"?"deleteForward":"delete",g={sequence:u};if(f=="selection"){const p=Array.from(d.getRanges()).map(w=>e.editing.mapper.toModelRange(w));g.selection=e.model.createSelection(p)}else g.unit=f;e.execute(m,g),i.scrollToTheSelection()},{priority:"low"}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(s,"delete",(a,l)=>{this._undoOnBackspace&&l.direction=="backward"&&l.sequence==1&&l.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),l.preventDefault(),a.stop())},{context:"$capture"}),this.listenTo(o,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}class SJ extends A{static get requires(){return[jI,Pi]}static get pluginName(){return"Typing"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function KI(n,t){let e=n.start;return{text:Array.from(n.getWalker({ignoreElementEnd:!1})).reduce((s,{item:o})=>o.is("$text")||o.is("$textProxy")?s+o.data:(e=t.createPositionAfter(o),""),""),range:t.createRange(e,n.end)}}class ZI extends Ve(){constructor(e,i){super();h(this,"model");h(this,"testCallback");h(this,"_hasMatch");this.model=e,this.testCallback=i,this._hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))}),this._startListening()}get hasMatch(){return this._hasMatch}_startListening(){const i=this.model.document;this.listenTo(i.selection,"change:range",(s,{directChange:o})=>{if(o){if(!i.selection.isCollapsed){this.hasMatch&&(this.fire("unmatched"),this._hasMatch=!1);return}this._evaluateTextBeforeSelection("selection")}}),this.listenTo(i,"change:data",(s,o)=>{o.isUndo||!o.isLocal||this._evaluateTextBeforeSelection("data",{batch:o})})}_evaluateTextBeforeSelection(e,i={}){const s=this.model,r=s.document.selection,a=s.createRange(s.createPositionAt(r.focus.parent,0),r.focus),{text:l,range:c}=KI(a,s),u=this.testCallback(l);if(!u&&this.hasMatch&&this.fire("unmatched"),this._hasMatch=!!u,u){const d=Object.assign(i,{text:l,range:c});typeof u=="object"&&Object.assign(d,u),this.fire(`matched:${e}`,d)}}}class od extends A{constructor(e){super(e);h(this,"attributes");h(this,"_overrideUid");h(this,"_isNextGravityRestorationSkipped",!1);this.attributes=new Set,this._overrideUid=null}static get pluginName(){return"TwoStepCaretMovement"}init(){const e=this.editor,i=e.model,s=e.editing.view,o=e.locale,r=i.document.selection;this.listenTo(s.document,"arrowKey",(a,l)=>{if(!r.isCollapsed||l.shiftKey||l.altKey||l.ctrlKey)return;const c=l.keyCode==_e.arrowright,u=l.keyCode==_e.arrowleft;if(!c&&!u)return;const d=o.contentLanguageDirection;let f=!1;d==="ltr"&&c||d==="rtl"&&u?f=this._handleForwardMovement(l):f=this._handleBackwardMovement(l),f===!0&&a.stop()},{context:"$text",priority:"highest"}),this.listenTo(r,"change:range",(a,l)=>{if(this._isNextGravityRestorationSkipped){this._isNextGravityRestorationSkipped=!1;return}this._isGravityOverridden&&(!l.directChange&&qn(r.getFirstPosition(),this.attributes)||this._restoreGravity())}),this._enableClickingAfterNode(),this._enableInsertContentSelectionAttributesFixer(),this._handleDeleteContentAfterNode()}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const i=this.attributes,s=this.editor.model,o=s.document.selection,r=o.getFirstPosition();return this._isGravityOverridden||r.isAtStart&&Di(o,i)?!1:qn(r,i)?(Aa(e),Di(o,i)&&qn(r,i,!0)?Ea(s,i):this._overrideGravity(),!0):!1}_handleBackwardMovement(e){const i=this.attributes,s=this.editor.model,o=s.document.selection,r=o.getFirstPosition();return this._isGravityOverridden?(Aa(e),this._restoreGravity(),qn(r,i,!0)?Ea(s,i):jc(s,i,r),!0):r.isAtStart?Di(o,i)?(Aa(e),jc(s,i,r),!0):!1:!Di(o,i)&&qn(r,i,!0)?(Aa(e),jc(s,i,r),!0):q_(r,i)?r.isAtEnd&&!Di(o,i)&&qn(r,i)?(Aa(e),jc(s,i,r),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):!1}_enableClickingAfterNode(){const e=this.editor,i=e.model,s=i.document.selection,o=e.editing.view.document;e.editing.view.addObserver(Ph);let r=!1;this.listenTo(o,"mousedown",()=>{r=!0}),this.listenTo(o,"selectionChange",()=>{const a=this.attributes;if(!r||(r=!1,!s.isCollapsed)||!Di(s,a))return;const l=s.getFirstPosition();qn(l,a)&&(l.isAtStart||qn(l,a,!0)?Ea(i,a):this._isGravityOverridden||this._overrideGravity())})}_enableInsertContentSelectionAttributesFixer(){const i=this.editor.model,s=i.document.selection,o=this.attributes;this.listenTo(i,"insertContent",()=>{const r=s.getFirstPosition();Di(s,o)&&qn(r,o)&&Ea(i,o)},{priority:"low"})}_handleDeleteContentAfterNode(){const e=this.editor,i=e.model,s=i.document.selection,o=e.editing.view;let r=!1,a=!1;this.listenTo(o.document,"delete",(l,c)=>{r=c.direction==="backward"},{priority:"high"}),this.listenTo(i,"deleteContent",()=>{if(!r)return;const l=s.getFirstPosition();a=Di(s,this.attributes)&&!q_(l,this.attributes)},{priority:"high"}),this.listenTo(i,"deleteContent",()=>{r&&(r=!1,!a&&e.model.enqueueChange(()=>{const l=s.getFirstPosition();Di(s,this.attributes)&&qn(l,this.attributes)&&(l.isAtStart||qn(l,this.attributes,!0)?Ea(i,this.attributes):this._isGravityOverridden||this._overrideGravity())}))},{priority:"low"})}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function Di(n,t){for(const e of t)if(n.hasAttribute(e))return!0;return!1}function jc(n,t,e){const i=e.nodeBefore;n.change(s=>{if(i){const o=[],r=n.schema.isObject(i)&&n.schema.isInline(i);for(const[a,l]of i.getAttributes())n.schema.checkAttribute("$text",a)&&(!r||n.schema.getAttributeProperties(a).copyFromObject!==!1)&&o.push([a,l]);s.setSelectionAttribute(o)}else s.removeSelectionAttribute(t)})}function Ea(n,t){n.change(e=>{e.removeSelectionAttribute(t)})}function Aa(n){n.preventDefault()}function q_(n,t){const e=n.getShiftedBy(-1);return qn(e,t)}function qn(n,t,e=!1){const{nodeBefore:i,nodeAfter:s}=n;for(const o of t){const r=i?i.getAttribute(o):void 0,a=s?s.getAttribute(o):void 0;if(!(e&&(r===void 0||a===void 0))&&a!==r)return!0}return!1}const j_={copyright:{from:"(c)",to:"©"},registeredTrademark:{from:"(r)",to:"®"},trademark:{from:"(tm)",to:"™"},oneHalf:{from:/(^|[^/a-z0-9])(1\/2)([^/a-z0-9])$/i,to:[null,"½",null]},oneThird:{from:/(^|[^/a-z0-9])(1\/3)([^/a-z0-9])$/i,to:[null,"⅓",null]},twoThirds:{from:/(^|[^/a-z0-9])(2\/3)([^/a-z0-9])$/i,to:[null,"⅔",null]},oneForth:{from:/(^|[^/a-z0-9])(1\/4)([^/a-z0-9])$/i,to:[null,"¼",null]},threeQuarters:{from:/(^|[^/a-z0-9])(3\/4)([^/a-z0-9])$/i,to:[null,"¾",null]},lessThanOrEqual:{from:"<=",to:"≤"},greaterThanOrEqual:{from:">=",to:"≥"},notEqual:{from:"!=",to:"≠"},arrowLeft:{from:"<-",to:"←"},arrowRight:{from:"->",to:"→"},horizontalEllipsis:{from:"...",to:"…"},enDash:{from:/(^| )(--)( )$/,to:[null,"–",null]},emDash:{from:/(^| )(---)( )$/,to:[null,"—",null]},quotesPrimary:{from:ir('"'),to:[null,"“",null,"”"]},quotesSecondary:{from:ir("'"),to:[null,"‘",null,"’"]},quotesPrimaryEnGb:{from:ir("'"),to:[null,"‘",null,"’"]},quotesSecondaryEnGb:{from:ir('"'),to:[null,"“",null,"”"]},quotesPrimaryPl:{from:ir('"'),to:[null,"„",null,"”"]},quotesSecondaryPl:{from:ir("'"),to:[null,"‚",null,"’"]}},G_={symbols:["copyright","registeredTrademark","trademark"],mathematical:["oneHalf","oneThird","twoThirds","oneForth","threeQuarters","lessThanOrEqual","greaterThanOrEqual","notEqual","arrowLeft","arrowRight"],typography:["horizontalEllipsis","enDash","emDash"],quotes:["quotesPrimary","quotesSecondary"]},IJ=["symbols","mathematical","typography","quotes"];class PJ extends A{static get requires(){return["Delete","Input"]}static get pluginName(){return"TextTransformation"}constructor(t){super(t),t.config.define("typing",{transformations:{include:IJ}})}init(){const e=this.editor.model.document.selection;e.on("change:range",()=>{this.isEnabled=!e.anchor.parent.is("element","codeBlock")}),this._enableTransformationWatchers()}_enableTransformationWatchers(){const t=this.editor,e=t.model,i=t.plugins.get("Delete"),s=BJ(t.config.get("typing.transformations")),o=a=>{for(const l of s)if(l.from.test(a))return{normalizedTransformation:l}},r=new ZI(t.model,o);r.on("matched:data",(a,l)=>{if(!l.batch.isTyping)return;const{from:c,to:u}=l.normalizedTransformation,d=c.exec(l.text),f=u(d.slice(1)),m=l.range;let g=d.index;e.enqueueChange(p=>{for(let w=1;w<d.length;w++){const v=d[w],_=f[w-1];if(_==null){g+=v.length;continue}const y=m.start.getShiftedBy(g),E=e.createRange(y,y.getShiftedBy(v.length)),x=VJ(y);e.insertContent(p.createText(_,x),E),g+=_.length}e.enqueueChange(()=>{i.requestUndoOnBackspace()})})}),r.bind("isEnabled").to(this)}}function RJ(n){return typeof n=="string"?new RegExp(`(${Op(n)})$`):n}function LJ(n){return typeof n=="string"?()=>[n]:n instanceof Array?()=>n:n}function VJ(n){return(n.textNode?n.textNode:n.nodeAfter).getAttributes()}function ir(n){return new RegExp(`(^|\\s)(${n})([^${n}]*)(${n})$`)}function BJ(n){const t=n.extra||[],e=n.remove||[],i=o=>!e.includes(o),s=n.include.concat(t).filter(i);return MJ(s).filter(i).map(o=>typeof o=="string"&&j_[o]?j_[o]:o).filter(o=>typeof o=="object").map(o=>({from:RJ(o.from),to:LJ(o.to)}))}function MJ(n){const t=new Set;for(const e of n)if(typeof e=="string"&&G_[e])for(const i of G_[e])t.add(i);else t.add(e);return Array.from(t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ac(n,t,e,i){return i.createRange(eg(n,t,e,!0,i),eg(n,t,e,!1,i))}function eg(n,t,e,i,s){let o=n.textNode||(i?n.nodeBefore:n.nodeAfter),r=null;for(;o&&o.getAttribute(t)==e;)r=o,o=i?o.previousSibling:o.nextSibling;return r?s.createPositionAt(r,i?"before":"after"):n}function JI(n,t,e,i){const s=n.editing.view,o=new Set;s.document.registerPostFixer(r=>{const a=n.model.document.selection;let l=!1;if(a.hasAttribute(t)){const c=ac(a.getFirstPosition(),t,a.getAttribute(t),n.model),u=n.editing.mapper.toViewRange(c);for(const d of u.getItems())d.is("element",e)&&!d.hasClass(i)&&(r.addClass(i,d),o.add(d),l=!0)}return l}),n.conversion.for("editingDowncast").add(r=>{r.on("insert",a,{priority:"highest"}),r.on("remove",a,{priority:"highest"}),r.on("attribute",a,{priority:"highest"}),r.on("selection",a,{priority:"highest"});function a(){s.change(l=>{for(const c of o.values())l.removeClass(i,c),o.delete(c)})}})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ws(n,t,e,i){let s,o=null;typeof i=="function"?s=i:(o=n.commands.get(i),s=()=>{n.execute(i)}),n.model.document.on("change:data",(r,a)=>{if(o&&!o.isEnabled||!t.isEnabled)return;const l=Ye(n.model.document.selection.getRanges());if(!l.isCollapsed||a.isUndo||!a.isLocal)return;const c=Array.from(n.model.document.differ.getChanges()),u=c[0];if(c.length!=1||u.type!=="insert"||u.name!="$text"||u.length!=1)return;const d=u.position.parent;if(d.is("element","codeBlock")||d.is("element","listItem")&&typeof i!="function"&&!["numberedList","bulletedList","todoList"].includes(i)||o&&o.value===!0)return;const f=d.getChild(0),m=n.model.createRangeOn(f);if(!m.containsRange(l)&&!l.end.isEqual(m.end))return;const g=e.exec(f.data.substr(0,l.end.offset));g&&n.model.enqueueChange(p=>{const w=p.createPositionAt(d,0),v=p.createPositionAt(d,g[0].length),_=new hn(w,v);if(s({match:g})!==!1){p.remove(_);const E=n.model.document.selection.getFirstRange(),x=p.createRangeIn(d);d.isEmpty&&!x.isEqual(E)&&!x.containsRange(E,!0)&&p.remove(d)}_.detach(),n.model.enqueueChange(()=>{n.plugins.get("Delete").requestUndoOnBackspace()})})})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function sr(n,t,e,i){let s,o;e instanceof RegExp?s=e:o=e,o=o||(r=>{let a;const l=[],c=[];for(;(a=s.exec(r))!==null&&!(a&&a.length<4);){let{index:u,"1":d,"2":f,"3":m}=a;const g=d+f+m;u+=a[0].length-g.length;const p=[u,u+d.length],w=[u+d.length+f.length,u+d.length+f.length+m.length];l.push(p),l.push(w),c.push([u+d.length,u+d.length+f.length])}return{remove:l,format:c}}),n.model.document.on("change:data",(r,a)=>{if(a.isUndo||!a.isLocal||!t.isEnabled)return;const l=n.model,c=l.document.selection;if(!c.isCollapsed)return;const u=Array.from(l.document.differ.getChanges()),d=u[0];if(u.length!=1||d.type!=="insert"||d.name!="$text"||d.length!=1)return;const f=c.focus,m=f.parent,{text:g,range:p}=OJ(l.createRange(l.createPositionAt(m,0),f),l),w=o(g),v=K_(p.start,w.format,l),_=K_(p.start,w.remove,l);v.length&&_.length&&l.enqueueChange(y=>{if(i(y,v)!==!1){for(const x of _.reverse())y.remove(x);l.enqueueChange(()=>{n.plugins.get("Delete").requestUndoOnBackspace()})}})})}function K_(n,t,e){return t.filter(i=>i[0]!==void 0&&i[1]!==void 0).map(i=>e.createRange(n.getShiftedBy(i[0]),n.getShiftedBy(i[1])))}function OJ(n,t){let e=n.start;return{text:Array.from(n.getItems()).reduce((s,o)=>!(o.is("$text")||o.is("$textProxy"))||o.getAttribute("code")?(e=t.createPositionAfter(o),""):s+o.data,""),range:t.createRange(e,n.end)}}class NJ extends A{static get requires(){return[Pi]}static get pluginName(){return"Autoformat"}afterInit(){const t=this.editor,e=this.editor.t;this._addListAutoformats(),this._addBasicStylesAutoformats(),this._addHeadingAutoformats(),this._addBlockQuoteAutoformats(),this._addCodeBlockAutoformats(),this._addHorizontalLineAutoformats(),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Revert autoformatting action"),keystroke:"Backspace"}]})}_addListAutoformats(){const t=this.editor.commands;t.get("bulletedList")&&ws(this.editor,this,/^[*-]\s$/,"bulletedList"),t.get("numberedList")&&ws(this.editor,this,/^1[.|)]\s$/,"numberedList"),t.get("todoList")&&ws(this.editor,this,/^\[\s?\]\s$/,"todoList"),t.get("checkTodoList")&&ws(this.editor,this,/^\[\s?x\s?\]\s$/,()=>{this.editor.execute("todoList"),this.editor.execute("checkTodoList")})}_addBasicStylesAutoformats(){const t=this.editor.commands;if(t.get("bold")){const e=Gc(this.editor,"bold");sr(this.editor,this,/(?:^|\s)(\*\*)([^*]+)(\*\*)$/g,e),sr(this.editor,this,/(?:^|\s)(__)([^_]+)(__)$/g,e)}if(t.get("italic")){const e=Gc(this.editor,"italic");sr(this.editor,this,/(?:^|\s)(\*)([^*_]+)(\*)$/g,e),sr(this.editor,this,/(?:^|\s)(_)([^_]+)(_)$/g,e)}if(t.get("code")){const e=Gc(this.editor,"code");sr(this.editor,this,/(`)([^`]+)(`)$/g,e)}if(t.get("strikethrough")){const e=Gc(this.editor,"strikethrough");sr(this.editor,this,/(~~)([^~]+)(~~)$/g,e)}}_addHeadingAutoformats(){const t=this.editor.commands.get("heading");t&&t.modelElements.filter(e=>e.match(/^heading[1-6]$/)).forEach(e=>{const i=e[7],s=new RegExp(`^(#{${i}})\\s$`);ws(this.editor,this,s,()=>{if(!t.isEnabled||t.value===e)return!1;this.editor.execute("heading",{value:e})})})}_addBlockQuoteAutoformats(){this.editor.commands.get("blockQuote")&&ws(this.editor,this,/^>\s$/,"blockQuote")}_addCodeBlockAutoformats(){const t=this.editor,e=t.model.document.selection;t.commands.get("codeBlock")&&ws(t,this,/^```$/,()=>{if(e.getFirstPosition().parent.is("element","listItem"))return!1;this.editor.execute("codeBlock",{usePreviousLanguageChoice:!0})})}_addHorizontalLineAutoformats(){this.editor.commands.get("horizontalLine")&&ws(this.editor,this,/^---$/,"horizontalLine")}}function Gc(n,t){return(e,i)=>{if(!n.commands.get(t).isEnabled)return!1;const o=n.model.schema.getValidRanges(i,t);for(const r of o)e.setAttribute(t,!0,r);e.removeSelectionAttribute(t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class FJ extends A{constructor(e){super(e);h(this,"adapter");h(this,"_debouncedSave");h(this,"_lastDocumentVersion");h(this,"_savePromise");h(this,"_domEmitter");h(this,"_config");h(this,"_pendingActions");h(this,"_makeImmediateSave");h(this,"_action",null);const i=e.config.get("autosave")||{},s=i.waitingTime||1e3;this.set("state","synchronized"),this._debouncedSave=Fn(this._save.bind(this),s),this._lastDocumentVersion=e.model.document.version,this._savePromise=null,this._domEmitter=new(on()),this._config=i,this._pendingActions=e.plugins.get(Hr),this._makeImmediateSave=!1}static get pluginName(){return"Autosave"}static get requires(){return[Hr]}init(){const e=this.editor,i=e.model.document;this.listenTo(e,"ready",()=>{this.listenTo(i,"change:data",(s,o)=>{this._saveCallbacks.length&&o.isLocal&&(this.state==="synchronized"&&(this.state="waiting",this._setPendingAction()),this.state==="waiting"&&this._debouncedSave())})}),this.listenTo(e,"destroy",()=>this._flush(),{priority:"highest"});/* istanbul ignore next -- @preserve */this._domEmitter.listenTo(window,"beforeunload",(s,o)=>{this._pendingActions.hasAny&&(o.returnValue=this._pendingActions.first.message)})}destroy(){this._domEmitter.stopListening(),super.destroy()}save(){return this._debouncedSave.cancel(),this._save()}_flush(){this._debouncedSave.flush()}_save(){return this._savePromise?(this._makeImmediateSave=this.editor.model.document.version>this._lastDocumentVersion,this._savePromise):(this._setPendingAction(),this.state="saving",this._lastDocumentVersion=this.editor.model.document.version,this._savePromise=Promise.resolve().then(()=>Promise.all(this._saveCallbacks.map(e=>e(this.editor)))).finally(()=>{this._savePromise=null}).then(()=>{if(this._makeImmediateSave)return this._makeImmediateSave=!1,this._save();this.editor.model.document.version>this._lastDocumentVersion?(this.state="waiting",this._debouncedSave()):(this.state="synchronized",this._pendingActions.remove(this._action),this._action=null)}).catch(e=>{throw this.state="error",this.state="saving",this._debouncedSave(),e}),this._savePromise)}_setPendingAction(){const e=this.editor.t;this._action||(this._action=this._pendingActions.add(e("Saving changes")))}get _saveCallbacks(){const e=[];return this.adapter&&this.adapter.save&&e.push(this.adapter.save),this._config.save&&e.push(this._config.save),e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ub extends ne{constructor(e,i){super(e);h(this,"attributeKey");this.attributeKey=i}refresh(){const e=this.editor.model,i=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(i.selection,this.attributeKey)}execute(e={}){const i=this.editor.model,o=i.document.selection,r=e.forceValue===void 0?!this.value:e.forceValue;i.change(a=>{if(o.isCollapsed)r?a.setSelectionAttribute(this.attributeKey,!0):a.removeSelectionAttribute(this.attributeKey);else{const l=i.schema.getValidRanges(o.getRanges(),this.attributeKey);for(const c of l)r?a.setAttribute(this.attributeKey,r,c):a.removeAttribute(this.attributeKey,c)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,i=e.schema,s=e.document.selection;if(s.isCollapsed)return s.hasAttribute(this.attributeKey);for(const o of s.getRanges())for(const r of o.getItems())if(i.checkAttribute(r,this.attributeKey))return r.hasAttribute(this.attributeKey);return!1}}const or="bold";class DJ extends A{static get pluginName(){return"BoldEditing"}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:or}),t.model.schema.setAttributeProperties(or,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:or,view:"strong",upcastAlso:["b",i=>{const s=i.getStyle("font-weight");return s&&(s=="bold"||Number(s)>=600)?{name:!0,styles:["font-weight"]}:null}]}),t.commands.add(or,new Ub(t,or)),t.keystrokes.set("CTRL+B",or),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Bold text"),keystroke:"CTRL+B"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Wb({editor:n,commandName:t,plugin:e,icon:i,label:s,keystroke:o}){return r=>{const a=n.commands.get(t),l=new r(n.locale);return l.set({label:s,icon:i,keystroke:o,isToggleable:!0}),l.bind("isEnabled").to(a,"isEnabled"),e.listenTo(l,"execute",()=>{n.execute(t),n.editing.view.focus()}),l}}const Kc="bold";class $J extends A{static get pluginName(){return"BoldUI"}init(){const t=this.editor,e=t.locale.t,i=t.commands.get(Kc),s=Wb({editor:t,commandName:Kc,plugin:this,icon:F.bold,label:e("Bold"),keystroke:"CTRL+B"});t.ui.componentFactory.add(Kc,()=>{const o=s(te);return o.set({tooltip:!0}),o.bind("isOn").to(i,"value"),o}),t.ui.componentFactory.add("menuBar:"+Kc,()=>s(pt))}}class HJ extends A{static get requires(){return[DJ,$J]}static get pluginName(){return"Bold"}}const ro="code",zJ="ck-code_selected";class UJ extends A{static get pluginName(){return"CodeEditing"}static get requires(){return[od]}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:ro}),t.model.schema.setAttributeProperties(ro,{isFormatting:!0,copyOnEnter:!1}),t.conversion.attributeToElement({model:ro,view:"code",upcastAlso:{styles:{"word-wrap":"break-word"}}}),t.commands.add(ro,new Ub(t,ro)),t.plugins.get(od).registerAttribute(ro),JI(t,ro,"code",zJ),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Move out of an inline code style"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}}var WJ='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>';const Zc="code";class qJ extends A{static get pluginName(){return"CodeUI"}init(){const t=this.editor,e=t.locale.t,i=Wb({editor:t,commandName:Zc,plugin:this,icon:WJ,label:e("Code")});t.ui.componentFactory.add(Zc,()=>{const s=i(te),o=t.commands.get(Zc);return s.set({tooltip:!0}),s.bind("isOn").to(o,"value"),s}),t.ui.componentFactory.add("menuBar:"+Zc,()=>i(pt))}}class jJ extends A{static get requires(){return[UJ,qJ]}static get pluginName(){return"Code"}}const rr="italic";class GJ extends A{static get pluginName(){return"ItalicEditing"}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:rr}),t.model.schema.setAttributeProperties(rr,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:rr,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),t.commands.add(rr,new Ub(t,rr)),t.keystrokes.set("CTRL+I",rr),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Italic text"),keystroke:"CTRL+I"}]})}}var KJ='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';const Jc="italic";class ZJ extends A{static get pluginName(){return"ItalicUI"}init(){const t=this.editor,e=t.commands.get(Jc),i=t.locale.t,s=Wb({editor:t,commandName:Jc,plugin:this,icon:KJ,keystroke:"CTRL+I",label:i("Italic")});t.ui.componentFactory.add(Jc,()=>{const o=s(te);return o.set({tooltip:!0}),o.bind("isOn").to(e,"value"),o}),t.ui.componentFactory.add("menuBar:"+Jc,()=>s(pt))}}class JJ extends A{static get requires(){return[GJ,ZJ]}static get pluginName(){return"Italic"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function*YI(n,t){for(const e of t)e&&n.getAttributeProperties(e[0]).copyOnEnter&&(yield e)}class YJ extends ne{execute(){this.editor.model.change(t=>{this.enterBlock(t),this.fire("afterExecute",{writer:t})})}enterBlock(t){const e=this.editor.model,i=e.document.selection,s=e.schema,o=i.isCollapsed,r=i.getFirstRange(),a=r.start.parent,l=r.end.parent;if(s.isLimit(a)||s.isLimit(l))return!o&&a==l&&e.deleteContent(i),!1;if(o){const c=YI(t.model.schema,i.getAttributes());return Z_(t,r.start),t.setSelectionAttribute(c),!0}else{const c=!(r.start.isAtStart&&r.end.isAtEnd),u=a==l;if(e.deleteContent(i,{leaveUnmerged:c}),c){if(u)return Z_(t,i.focus),!0;t.setSelection(l,0)}}return!1}}function Z_(n,t){n.split(t),n.setSelection(t.parent.nextSibling,0)}const XJ={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class XI extends Oi{constructor(t){super(t);const e=this.document;let i=!1;e.on("keydown",(s,o)=>{i=o.shiftKey}),e.on("beforeinput",(s,o)=>{if(!this.isEnabled)return;let r=o.inputType;ue.isSafari&&i&&r=="insertParagraph"&&(r="insertLineBreak");const a=o.domEvent,l=XJ[r];if(!l)return;const c=new aa(e,"enter",o.targetRanges[0]);e.fire(c,new $r(t,a,{isSoft:l.isSoft})),c.stop.called&&s.stop()})}observe(){}stopObserving(){}}class lc extends A{static get pluginName(){return"Enter"}init(){const t=this.editor,e=t.editing.view,i=e.document,s=this.editor.t;e.addObserver(XI),t.commands.add("enter",new YJ(t)),this.listenTo(i,"enter",(o,r)=>{i.isComposing||r.preventDefault(),!r.isSoft&&(t.execute("enter"),e.scrollToTheSelection())},{priority:"low"}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:s("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]})}}class QJ extends ne{execute(){const t=this.editor.model,e=t.document;t.change(i=>{tY(t,i,e.selection),this.fire("afterExecute",{writer:i})})}refresh(){const t=this.editor.model,e=t.document;this.isEnabled=eY(t.schema,e.selection)}}function eY(n,t){if(t.rangeCount>1)return!1;const e=t.anchor;if(!e||!n.checkChild(e,"softBreak"))return!1;const i=t.getFirstRange(),s=i.start.parent,o=i.end.parent;return!((tg(s,n)||tg(o,n))&&s!==o)}function tY(n,t,e){const i=e.isCollapsed,s=e.getFirstRange(),o=s.start.parent,r=s.end.parent,a=o==r;if(i){const l=YI(n.schema,e.getAttributes());J_(n,t,s.end),t.removeSelectionAttribute(e.getAttributeKeys()),t.setSelectionAttribute(l)}else{const l=!(s.start.isAtStart&&s.end.isAtEnd);n.deleteContent(e,{leaveUnmerged:l}),a?J_(n,t,e.focus):l&&t.setSelection(r,0)}}function J_(n,t,e){const i=t.createElement("softBreak");n.insertContent(i,e),t.setSelection(i,"after")}function tg(n,t){return n.is("rootElement")?!1:t.isLimit(n)||tg(n.parent,t)}class QI extends A{static get pluginName(){return"ShiftEnter"}init(){const t=this.editor,e=t.model.schema,i=t.conversion,s=t.editing.view,o=s.document,r=this.editor.t;e.register("softBreak",{allowWhere:"$text",isInline:!0}),i.for("upcast").elementToElement({model:"softBreak",view:"br"}),i.for("downcast").elementToElement({model:"softBreak",view:(a,{writer:l})=>l.createEmptyElement("br")}),s.addObserver(XI),t.commands.add("shiftEnter",new QJ(t)),this.listenTo(o,"enter",(a,l)=>{o.isComposing||l.preventDefault(),l.isSoft&&(t.execute("shiftEnter"),s.scrollToTheSelection())},{priority:"low"}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:r("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nY extends ne{refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(t={}){const e=this.editor.model,i=e.schema,s=e.document.selection,o=Array.from(s.getSelectedBlocks()),r=t.forceValue===void 0?!this.value:t.forceValue;e.change(a=>{if(!r)this._removeQuote(a,o.filter(Yc));else{const l=o.filter(c=>Yc(c)||X_(i,c));this._applyQuote(a,l)}})}_getValue(){const t=this.editor.model.document.selection,e=Ye(t.getSelectedBlocks());return!!(e&&Yc(e))}_checkEnabled(){if(this.value)return!0;const t=this.editor.model.document.selection,e=this.editor.model.schema,i=Ye(t.getSelectedBlocks());return i?X_(e,i):!1}_removeQuote(t,e){Y_(t,e).reverse().forEach(i=>{if(i.start.isAtStart&&i.end.isAtEnd){t.unwrap(i.start.parent);return}if(i.start.isAtStart){const o=t.createPositionBefore(i.start.parent);t.move(i,o);return}i.end.isAtEnd||t.split(i.end);const s=t.createPositionAfter(i.end.parent);t.move(i,s)})}_applyQuote(t,e){const i=[];Y_(t,e).reverse().forEach(s=>{let o=Yc(s.start);o||(o=t.createElement("blockQuote"),t.wrap(s,o)),i.push(o)}),i.reverse().reduce((s,o)=>s.nextSibling==o?(t.merge(t.createPositionAfter(s)),s):o)}}function Yc(n){return n.parent.name=="blockQuote"?n.parent:null}function Y_(n,t){let e,i=0;const s=[];for(;i<t.length;){const o=t[i],r=t[i+1];e||(e=n.createPositionBefore(o)),(!r||o.nextSibling!=r)&&(s.push(n.createRange(e,n.createPositionAfter(o))),e=null),i++}return s}function X_(n,t){const e=n.checkChild(t.parent,"blockQuote"),i=n.checkChild(["$root","blockQuote"],t);return e&&i}class iY extends A{static get pluginName(){return"BlockQuoteEditing"}static get requires(){return[lc,Pi]}init(){const t=this.editor,e=t.model.schema;t.commands.add("blockQuote",new nY(t)),e.register("blockQuote",{inheritAllFrom:"$container"}),t.conversion.elementToElement({model:"blockQuote",view:"blockquote"}),t.model.document.registerPostFixer(r=>{const a=t.model.document.differ.getChanges();for(const l of a)if(l.type=="insert"){const c=l.position.nodeAfter;if(!c)continue;if(c.is("element","blockQuote")&&c.isEmpty)return r.remove(c),!0;if(c.is("element","blockQuote")&&!e.checkChild(l.position,c))return r.unwrap(c),!0;if(c.is("element")){const u=r.createRangeIn(c);for(const d of u.getItems())if(d.is("element","blockQuote")&&!e.checkChild(r.createPositionBefore(d),d))return r.unwrap(d),!0}}else if(l.type=="remove"){const c=l.position.parent;if(c.is("element","blockQuote")&&c.isEmpty)return r.remove(c),!0}return!1});const i=this.editor.editing.view.document,s=t.model.document.selection,o=t.commands.get("blockQuote");this.listenTo(i,"enter",(r,a)=>{if(!s.isCollapsed||!o.value)return;s.getLastPosition().parent.isEmpty&&(t.execute("blockQuote"),t.editing.view.scrollToTheSelection(),a.preventDefault(),r.stop())},{context:"blockquote"}),this.listenTo(i,"delete",(r,a)=>{if(a.direction!="backward"||!s.isCollapsed||!o.value)return;const l=s.getLastPosition().parent;l.isEmpty&&!l.previousSibling&&(t.execute("blockQuote"),t.editing.view.scrollToTheSelection(),a.preventDefault(),r.stop())},{context:"blockquote"})}}class sY extends A{static get pluginName(){return"BlockQuoteUI"}init(){const t=this.editor,e=t.commands.get("blockQuote");t.ui.componentFactory.add("blockQuote",()=>{const i=this._createButton(te);return i.set({tooltip:!0}),i.bind("isOn").to(e,"value"),i}),t.ui.componentFactory.add("menuBar:blockQuote",()=>this._createButton(pt))}_createButton(t){const e=this.editor,i=e.locale,s=e.commands.get("blockQuote"),o=new t(e.locale),r=i.t;return o.set({label:r("Block quote"),icon:F.quote,isToggleable:!0}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("blockQuote"),e.editing.view.focus()}),o}}class oY extends A{static get requires(){return[iY,sY]}static get pluginName(){return"BlockQuote"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rY extends De(){constructor(){super(...arguments);h(this,"_stack",[])}add(e,i){const s=this._stack,o=s[0];this._insertDescriptor(e);const r=s[0];o!==r&&!Rf(o,r)&&this.fire("change:top",{oldDescriptor:o,newDescriptor:r,writer:i})}remove(e,i){const s=this._stack,o=s[0];this._removeDescriptor(e);const r=s[0];o!==r&&!Rf(o,r)&&this.fire("change:top",{oldDescriptor:o,newDescriptor:r,writer:i})}_insertDescriptor(e){const i=this._stack,s=i.findIndex(r=>r.id===e.id);if(Rf(e,i[s]))return;s>-1&&i.splice(s,1);let o=0;for(;i[o]&&aY(i[o],e);)o++;i.splice(o,0,e)}_removeDescriptor(e){const i=this._stack,s=i.findIndex(o=>o.id===e);s>-1&&i.splice(s,1)}}function Rf(n,t){return n&&t&&n.priority==t.priority&&rd(n.classes)==rd(t.classes)}function aY(n,t){return n.priority>t.priority?!0:n.priority<t.priority?!1:rd(n.classes)>rd(t.classes)}function rd(n){return Array.isArray(n)?n.sort().join(","):n}var lY='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';const cY="ck-widget",Q_="ck-widget_selected";function ht(n){return n.is("element")?!!n.getCustomProperty("widget"):!1}function Xs(n,t,e={}){if(!n.is("containerElement"))throw new C("widget-to-widget-wrong-element-type",null,{element:n});return t.setAttribute("contenteditable","false",n),t.addClass(cY,n),t.setCustomProperty("widget",!0,n),n.getFillerOffset=mY,t.setCustomProperty("widgetLabel",[],n),e.label&&hY(n,e.label),e.hasSelectionHandle&&gY(n,t),eP(n,t),n}function uY(n,t,e){if(t.classes&&e.addClass(Pe(t.classes),n),t.attributes)for(const i in t.attributes)e.setAttribute(i,t.attributes[i],n)}function dY(n,t,e){if(t.classes&&e.removeClass(Pe(t.classes),n),t.attributes)for(const i in t.attributes)e.removeAttribute(i,n)}function eP(n,t,e=uY,i=dY){const s=new rY;s.on("change:top",(a,l)=>{l.oldDescriptor&&i(n,l.oldDescriptor,l.writer),l.newDescriptor&&e(n,l.newDescriptor,l.writer)});const o=(a,l,c)=>s.add(l,c),r=(a,l,c)=>s.remove(l,c);t.setCustomProperty("addHighlight",o,n),t.setCustomProperty("removeHighlight",r,n)}function hY(n,t){n.getCustomProperty("widgetLabel").push(t)}function fY(n){return n.getCustomProperty("widgetLabel").reduce((e,i)=>typeof i=="function"?e?e+". "+i():i():e?e+". "+i:i,"")}function qb(n,t,e={}){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],n),t.setAttribute("role","textbox",n),t.setAttribute("tabindex","-1",n),e.label&&t.setAttribute("aria-label",e.label,n),t.setAttribute("contenteditable",n.isReadOnly?"false":"true",n),n.on("change:isReadOnly",(i,s,o)=>{t.setAttribute("contenteditable",o?"false":"true",n)}),n.on("change:isFocused",(i,s,o)=>{o?t.addClass("ck-editor__nested-editable_focused",n):t.removeClass("ck-editor__nested-editable_focused",n)}),eP(n,t),n}function cc(n,t){const e=n.getSelectedElement();if(e){const i=ys(n);if(i)return t.createRange(t.createPositionAt(e,i))}return t.schema.findOptimalInsertionRange(n)}function mY(){return null}function gY(n,t){const e=t.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(i){const s=this.toDomElement(i),o=new es;return o.set("content",lY),o.render(),s.appendChild(o.element),s});t.insert(t.createPositionAt(n,0),e),t.addClass(["ck-widget_with-selection-handle"],n)}function jb(n){const t=a=>{const{width:l,paddingLeft:c,paddingRight:u}=a.ownerDocument.defaultView.getComputedStyle(a);return parseFloat(l)-(parseFloat(c)||0)-(parseFloat(u)||0)},e=n.parentElement;if(!e)return 0;let i=t(e);const s=5;let o=0,r=e;for(;isNaN(i);){if(r=r.parentElement,++o>s)return 0;i=t(r)}return i}function pY(n,t=new he(n)){const e=jb(n);return e?t.width/e*100:0}const zi="widget-type-around";function ao(n,t,e){return!!n&&ht(n)&&!e.isInline(t)}function bY(n){return n.closest(".ck-widget__type-around__button")}function wY(n){return n.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function _Y(n,t){const e=n.closest(".ck-widget");return t.mapDomToView(e)}function ys(n){return n.getAttribute(zi)}var vY='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>';const tP=["before","after"],yY=new DOMParser().parseFromString(vY,"image/svg+xml").firstChild,ev="ck-widget__type-around_disabled";class CY extends A{constructor(){super(...arguments);h(this,"_currentFakeCaretModelElement",null)}static get pluginName(){return"WidgetTypeAround"}static get requires(){return[lc,Pi]}init(){const e=this.editor,i=e.editing.view;this.on("change:isEnabled",(s,o,r)=>{i.change(a=>{for(const l of i.document.roots)r?a.removeClass(ev,l):a.addClass(ev,l)}),r||e.model.change(a=>{a.removeSelectionAttribute(zi)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,i){const s=this.editor,o=s.editing.view,r=s.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);s.execute("insertParagraph",{position:s.model.createPositionAt(e,i),attributes:r}),o.focus(),o.scrollToTheSelection()}_listenToIfEnabled(e,i,s,o){this.listenTo(e,i,(...r)=>{this.isEnabled&&s(...r)},o)}_insertParagraphAccordingToFakeCaretPosition(){const s=this.editor.model.document.selection,o=ys(s);if(!o)return!1;const r=s.getSelectedElement();return this._insertParagraph(r,o),!0}_enableTypeAroundUIInjection(){const e=this.editor,i=e.model.schema,s=e.locale.t,o={before:s("Insert paragraph before block"),after:s("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(r,a,l)=>{const c=l.mapper.toViewElement(a.item);c&&ao(c,a.item,i)&&(kY(l.writer,o,c),c.getCustomProperty("widgetLabel").push(()=>this.isEnabled?s("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,i=e.model,s=i.document.selection,o=i.schema,r=e.editing.view;this._listenToIfEnabled(r.document,"arrowKey",(l,c)=>{this._handleArrowKeyPress(l,c)},{context:[ht,"$text"],priority:"high"}),this._listenToIfEnabled(s,"change:range",(l,c)=>{c.directChange&&e.model.change(u=>{u.removeSelectionAttribute(zi)})}),this._listenToIfEnabled(i.document,"change:data",()=>{const l=s.getSelectedElement();if(l){const c=e.editing.mapper.toViewElement(l);if(ao(c,l,o))return}e.model.change(c=>{c.removeSelectionAttribute(zi)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(l,c,u)=>{const d=u.writer;if(this._currentFakeCaretModelElement){const p=u.mapper.toViewElement(this._currentFakeCaretModelElement);p&&(d.removeClass(tP.map(a),p),this._currentFakeCaretModelElement=null)}const f=c.selection.getSelectedElement();if(!f)return;const m=u.mapper.toViewElement(f);if(!ao(m,f,o))return;const g=ys(c.selection);g&&(d.addClass(a(g),m),this._currentFakeCaretModelElement=f)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(l,c,u)=>{u||e.model.change(d=>{d.removeSelectionAttribute(zi)})});function a(l){return`ck-widget_type-around_show-fake-caret_${l}`}}_handleArrowKeyPress(e,i){const s=this.editor,o=s.model,r=o.document.selection,a=o.schema,l=s.editing.view,c=i.keyCode,u=az(c,s.locale.contentLanguageDirection),d=l.document.selection.getSelectedElement(),f=s.editing.mapper.toModelElement(d);let m;ao(d,f,a)?m=this._handleArrowKeyPressOnSelectedWidget(u):r.isCollapsed?m=this._handleArrowKeyPressWhenSelectionNextToAWidget(u):i.shiftKey||(m=this._handleArrowKeyPressWhenNonCollapsedSelection(u)),m&&(i.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const s=this.editor.model,o=s.document.selection,r=ys(o);return s.change(a=>{if(r){if(!(r===(e?"after":"before")))return a.removeSelectionAttribute(zi),!0}else return a.setSelectionAttribute(zi,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const i=this.editor,s=i.model,o=s.schema,r=i.plugins.get("Widget"),a=r._getObjectElementNextToSelection(e),l=i.editing.mapper.toViewElement(a);return ao(l,a,o)?(s.change(c=>{r._setSelectionOverElement(a),c.setSelectionAttribute(zi,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const i=this.editor,s=i.model,o=s.schema,r=i.editing.mapper,a=s.document.selection,l=e?a.getLastPosition().nodeBefore:a.getFirstPosition().nodeAfter,c=r.toViewElement(l);return ao(c,l,o)?(s.change(u=>{u.setSelection(l,"on"),u.setSelectionAttribute(zi,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,i=e.editing.view;this._listenToIfEnabled(i.document,"mousedown",(s,o)=>{const r=bY(o.domTarget);if(!r)return;const a=wY(r),l=_Y(r,i.domConverter),c=e.editing.mapper.toModelElement(l);this._insertParagraph(c,a),o.preventDefault(),s.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,i=e.model.document.selection,s=e.editing.view;this._listenToIfEnabled(s.document,"enter",(o,r)=>{if(o.eventPhase!="atTarget")return;const a=i.getSelectedElement(),l=e.editing.mapper.toViewElement(a),c=e.model.schema;let u;this._insertParagraphAccordingToFakeCaretPosition()?u=!0:ao(l,a,c)&&(this._insertParagraph(a,r.isSoft?"before":"after"),u=!0),u&&(r.preventDefault(),o.stop())},{context:ht})}_enableInsertingParagraphsOnTypingKeystroke(){const i=this.editor.editing.view.document;this._listenToIfEnabled(i,"insertText",(s,o)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(o.selection=i.selection)},{priority:"high"}),ue.isAndroid?this._listenToIfEnabled(i,"keydown",(s,o)=>{o.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(i,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,i=e.editing.view,s=e.model,o=s.schema;this._listenToIfEnabled(i.document,"delete",(r,a)=>{if(r.eventPhase!="atTarget")return;const l=ys(s.document.selection);if(!l)return;const c=a.direction,u=s.document.selection.getSelectedElement(),d=l==="before",f=c=="forward";if(d===f)e.execute("delete",{selection:s.createSelection(u,"on")});else{const g=o.getNearestSelectionRange(s.createPositionAt(u,l),c);if(g)if(!g.isCollapsed)s.change(p=>{p.setSelection(g),e.execute(f?"deleteForward":"delete")});else{const p=s.createSelection(g.start);if(s.modifySelection(p,{direction:c}),!p.focus.isEqual(g.start))s.change(w=>{w.setSelection(g),e.execute(f?"deleteForward":"delete")});else{const w=AY(o,g.start.parent);s.deleteContent(s.createSelection(w,"on"),{doNotAutoparagraph:!0})}}}a.preventDefault(),r.stop()},{context:ht})}_enableInsertContentIntegration(){const e=this.editor,i=this.editor.model,s=i.document.selection;this._listenToIfEnabled(e.model,"insertContent",(o,[r,a])=>{if(a&&!a.is("documentSelection"))return;const l=ys(s);if(l)return o.stop(),i.change(c=>{const u=s.getSelectedElement(),d=i.createPositionAt(u,l),f=c.createSelection(d),m=i.insertContent(r,f);return c.setSelection(f),m})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,s=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(o,r)=>{const[,a,l={}]=r;if(a&&!a.is("documentSelection"))return;const c=ys(s);c&&(l.findOptimalPosition=c,r[3]=l)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,s=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(o,[r])=>{if(r&&!r.is("documentSelection"))return;ys(s)&&o.stop()},{priority:"high"})}}function kY(n,t,e){const i=n.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(s){const o=this.toDomElement(s);return TY(o,t),EY(o),o});n.insert(n.createPositionAt(e,"end"),i)}function TY(n,t){for(const e of tP){const i=new bn({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${e}`],title:t[e],"aria-hidden":"true"},children:[n.ownerDocument.importNode(yY,!0)]});n.appendChild(i.render())}}function EY(n){const t=new bn({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});n.appendChild(t.render())}function AY(n,t){let e=t;for(const i of t.getAncestors({parentFirst:!0})){if(i.childCount>1||n.isLimit(i))break;e=i}return e}function xY(n){const t=n.model;return(e,i)=>{const s=i.keyCode==_e.arrowup,o=i.keyCode==_e.arrowdown,r=i.shiftKey,a=t.document.selection;if(!s&&!o)return;const l=o;if(r&&PY(a,l))return;const c=SY(n,a,l);if(c){if(c.isCollapsed){if(a.isCollapsed)return;if(r)return}(c.isCollapsed||IY(n,c,l))&&(t.change(u=>{const d=l?c.end:c.start;if(r){const f=t.createSelection(a.anchor);f.setFocus(d),u.setSelection(f)}else u.setSelection(d)}),e.stop(),i.preventDefault(),i.stopPropagation())}}}function SY(n,t,e){const i=n.model;if(e){const s=t.isCollapsed?t.focus:t.getLastPosition(),o=tv(i,s,"forward");if(!o)return null;const r=i.createRange(s,o),a=nv(i.schema,r,"backward");return a?i.createRange(s,a):null}else{const s=t.isCollapsed?t.focus:t.getFirstPosition(),o=tv(i,s,"backward");if(!o)return null;const r=i.createRange(o,s),a=nv(i.schema,r,"forward");return a?i.createRange(a,s):null}}function tv(n,t,e){const i=n.schema,s=n.createRangeIn(t.root),o=e=="forward"?"elementStart":"elementEnd";for(const{previousPosition:r,item:a,type:l}of s.getWalker({startPosition:t,direction:e})){if(i.isLimit(a)&&!i.isInline(a))return r;if(l==o&&i.isBlock(a))return null}return null}function nv(n,t,e){const i=e=="backward"?t.end:t.start;if(n.checkChild(i,"$text"))return i;for(const{nextPosition:s}of t.getWalker({direction:e}))if(n.checkChild(s,"$text"))return s;return null}function IY(n,t,e){const i=n.model,s=n.view.domConverter;if(e){const c=i.createSelection(t.start);i.modifySelection(c),!c.focus.isAtEnd&&!t.start.isEqual(c.focus)&&(t=i.createRange(c.focus,t.end))}const o=n.mapper.toViewRange(t),r=s.viewRangeToDom(o),a=he.getDomRangeRects(r);let l;for(const c of a){if(l===void 0){l=Math.round(c.bottom);continue}if(Math.round(c.top)>=l)return!1;l=Math.max(l,Math.round(c.bottom))}return!0}function PY(n,t){return!n.isCollapsed&&n.isBackward==t}class ms extends A{constructor(){super(...arguments);h(this,"_previouslySelected",new Set)}static get pluginName(){return"Widget"}static get requires(){return[CY,Pi]}init(){const e=this.editor,i=e.editing.view,s=i.document,o=e.t;this.editor.editing.downcastDispatcher.on("selection",(r,a,l)=>{const c=l.writer,u=a.selection;if(u.isCollapsed)return;const d=u.getSelectedElement();if(!d)return;const f=e.editing.mapper.toViewElement(d);ht(f)&&l.consumable.consume(u,"selection")&&c.setSelection(c.createRangeOn(f),{fake:!0,label:fY(f)})}),this.editor.editing.downcastDispatcher.on("selection",(r,a,l)=>{this._clearPreviouslySelectedWidgets(l.writer);const c=l.writer,u=c.document.selection;let d=null;for(const f of u.getRanges())for(const m of f){const g=m.item;ht(g)&&!LY(g,d)&&(c.addClass(Q_,g),this._previouslySelected.add(g),d=g)}},{priority:"low"}),i.addObserver(Ph),this.listenTo(s,"mousedown",(...r)=>this._onMousedown(...r)),this.listenTo(s,"arrowKey",(...r)=>{this._handleSelectionChangeOnArrowKeyPress(...r)},{context:[ht,"$text"]}),this.listenTo(s,"arrowKey",(...r)=>{this._preventDefaultOnArrowKeyPress(...r)},{context:"$root"}),this.listenTo(s,"arrowKey",xY(this.editor.editing),{context:"$text"}),this.listenTo(s,"delete",(r,a)=>{this._handleDelete(a.direction=="forward")&&(a.preventDefault(),r.stop())},{context:"$root"}),this.listenTo(s,"tab",(r,a)=>{r.eventPhase=="atTarget"&&(a.shiftKey||this._selectFirstNestedEditable()&&(a.preventDefault(),r.stop()))},{context:ht,priority:"low"}),this.listenTo(s,"tab",(r,a)=>{a.shiftKey&&this._selectAncestorWidget()&&(a.preventDefault(),r.stop())},{priority:"low"}),this.listenTo(s,"keydown",(r,a)=>{a.keystroke==_e.esc&&this._selectAncestorWidget()&&(a.preventDefault(),r.stop())},{priority:"low"}),e.accessibility.addKeystrokeInfoGroup({id:"widget",label:o("Keystrokes that can be used when a widget is selected (for example: image, table, etc.)"),keystrokes:[{label:o("Move focus from an editable area back to the parent widget"),keystroke:"Esc"},{label:o("Insert a new paragraph directly after a widget"),keystroke:"Enter"},{label:o("Insert a new paragraph directly before a widget"),keystroke:"Shift+Enter"},{label:o("Move the caret to allow typing directly before a widget"),keystroke:[["arrowup"],["arrowleft"]]},{label:o("Move the caret to allow typing directly after a widget"),keystroke:[["arrowdown"],["arrowright"]]}]})}_onMousedown(e,i){const s=this.editor,o=s.editing.view,r=o.document;let a=i.target;if(i.domEvent.detail>=3){this._selectBlockContent(a)&&i.preventDefault();return}if(RY(a)||!ht(a)&&(a=a.findAncestor(ht),!a))return;ue.isAndroid&&i.preventDefault(),r.isFocused||o.focus();const l=s.editing.mapper.toModelElement(a);this._setSelectionOverElement(l)}_selectBlockContent(e){const i=this.editor,s=i.model,o=i.editing.mapper,r=s.schema,a=o.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),l=VY(o.toModelElement(a),s.schema);return l?(s.change(c=>{const u=r.isLimit(l)?null:BY(c.createPositionAfter(l),r),d=c.createPositionAt(l,0),f=u?c.createPositionAt(u,0):c.createPositionAt(l,"end");c.setSelection(c.createRange(d,f))}),!0):!1}_handleSelectionChangeOnArrowKeyPress(e,i){const s=i.keyCode,o=this.editor.model,r=o.schema,a=o.document.selection,l=a.getSelectedElement(),c=Eh(s,this.editor.locale.contentLanguageDirection),u=c=="down"||c=="right",d=c=="up"||c=="down";if(l&&r.isObject(l)){const m=u?a.getLastPosition():a.getFirstPosition(),g=r.getNearestSelectionRange(m,u?"forward":"backward");g&&(o.change(p=>{p.setSelection(g)}),i.preventDefault(),e.stop());return}if(!a.isCollapsed&&!i.shiftKey){const m=a.getFirstPosition(),g=a.getLastPosition(),p=m.nodeAfter,w=g.nodeBefore;(p&&r.isObject(p)||w&&r.isObject(w))&&(o.change(v=>{v.setSelection(u?g:m)}),i.preventDefault(),e.stop());return}if(!a.isCollapsed)return;const f=this._getObjectElementNextToSelection(u);if(f&&r.isObject(f)){if(r.isInline(f)&&d)return;this._setSelectionOverElement(f),i.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,i){const s=this.editor.model,o=s.schema,r=s.document.selection.getSelectedElement();r&&o.isObject(r)&&(i.preventDefault(),e.stop())}_handleDelete(e){const s=this.editor.model.document.selection;if(!this.editor.model.canEditAt(s)||!s.isCollapsed)return;const o=this._getObjectElementNextToSelection(e);if(o)return this.editor.model.change(r=>{let a=s.anchor.parent;for(;a.isEmpty;){const l=a;a=l.parent,r.remove(l)}this._setSelectionOverElement(o)}),!0}_setSelectionOverElement(e){this.editor.model.change(i=>{i.setSelection(i.createRangeOn(e))})}_getObjectElementNextToSelection(e){const i=this.editor.model,s=i.schema,o=i.document.selection,r=i.createSelection(o);if(i.modifySelection(r,{direction:e?"forward":"backward"}),r.isEqual(o))return null;const a=e?r.focus.nodeBefore:r.focus.nodeAfter;return a&&s.isObject(a)?a:null}_clearPreviouslySelectedWidgets(e){for(const i of this._previouslySelected)e.removeClass(Q_,i);this._previouslySelected.clear()}_selectFirstNestedEditable(){const e=this.editor,s=this.editor.editing.view.document;for(const o of s.selection.getFirstRange().getItems())if(o.is("editableElement")){const r=e.editing.mapper.toModelElement(o);/* istanbul ignore next -- @preserve */if(!r)continue;const a=e.model.createPositionAt(r,0),l=e.model.schema.getNearestSelectionRange(a,"forward");return e.model.change(c=>{c.setSelection(l)}),!0}return!1}_selectAncestorWidget(){const e=this.editor,i=e.editing.mapper,o=e.editing.view.document.selection.getFirstPosition().parent,a=(o.is("$text")?o.parent:o).findAncestor(ht);if(!a)return!1;const l=i.toModelElement(a);/* istanbul ignore next -- @preserve */return l?(e.model.change(c=>{c.setSelection(l,"on")}),!0):!1}}function RY(n){let t=n;for(;t;){if(t.is("editableElement")&&!t.is("rootElement"))return!0;if(ht(t))return!1;t=t.parent}return!1}function LY(n,t){return t?Array.from(n.getAncestors()).includes(t):!1}function VY(n,t){for(const e of n.getAncestors({includeSelf:!0,parentFirst:!0})){if(t.checkChild(e,"$text"))return e;if(t.isLimit(e)&&!t.isObject(e))break}return null}function BY(n,t){const e=new ji({startPosition:n});for(const{item:i}of e){if(t.isLimit(i)||!i.is("element"))return null;if(t.checkChild(i,"$text"))return i}return null}class ad extends A{constructor(){super(...arguments);h(this,"_toolbarDefinitions",new Map);h(this,"_balloon")}static get requires(){return[mi]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const i=e.plugins.get("BalloonToolbar");this.listenTo(i,"show",s=>{MY(e.editing.view.document.selection)&&s.stop()},{priority:"high"})}this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:i,items:s,getRelatedElement:o,balloonClassName:r="ck-toolbar-container"}){if(!s.length){Te("widget-toolbar-no-items",{toolbarId:e});return}const a=this.editor,l=a.t,c=new Ro(a.locale);if(c.ariaLabel=i||l("Widget toolbar"),this._toolbarDefinitions.has(e))throw new C("widget-toolbar-duplicated",this,{toolbarId:e});const u={view:c,getRelatedElement:o,balloonClassName:r,itemsConfig:s,initialized:!1};a.ui.addToolbar(c,{isContextual:!0,beforeFocus:()=>{const d=o(a.editing.view.document.selection);d&&this._showToolbar(u,d)},afterBlur:()=>{this._hideToolbar(u)}}),this._toolbarDefinitions.set(e,u)}_updateToolbarsVisibility(){let e=0,i=null,s=null;for(const o of this._toolbarDefinitions.values()){const r=o.getRelatedElement(this.editor.editing.view.document.selection);if(!this.isEnabled||!r)this._isToolbarInBalloon(o)&&this._hideToolbar(o);else if(!this.editor.ui.focusTracker.isFocused)this._isToolbarVisible(o)&&this._hideToolbar(o);else{const a=r.getAncestors().length;a>e&&(e=a,i=r,s=o)}}s&&this._showToolbar(s,i)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,i){this._isToolbarVisible(e)?iv(this.editor,i):this._isToolbarInBalloon(e)||(e.initialized||(e.initialized=!0,e.view.fillFromConfig(e.itemsConfig,this.editor.ui.componentFactory)),this._balloon.add({view:e.view,position:nP(this.editor,i),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const s of this._toolbarDefinitions.values())if(this._isToolbarVisible(s)){const o=s.getRelatedElement(this.editor.editing.view.document.selection);iv(this.editor,o)}}))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function iv(n,t){const e=n.plugins.get("ContextualBalloon"),i=nP(n,t);e.updatePosition(i)}function nP(n,t){const e=n.editing.view,i=St.defaultPositions;return{target:e.domConverter.mapViewToDom(t),positions:[i.northArrowSouth,i.northArrowSouthWest,i.northArrowSouthEast,i.southArrowNorth,i.southArrowNorthWest,i.southArrowNorthEast,i.viewportStickyNorth]}}function MY(n){const t=n.getSelectedElement();return!!(t&&ht(t))}class OY extends Ve(){constructor(e){super();h(this,"_referenceCoordinates");h(this,"_options");h(this,"_originalWidth");h(this,"_originalHeight");h(this,"_originalWidthPercents");h(this,"_aspectRatio");this.set("activeHandlePosition",null),this.set("proposedWidthPercents",null),this.set("proposedWidth",null),this.set("proposedHeight",null),this.set("proposedHandleHostWidth",null),this.set("proposedHandleHostHeight",null),this._options=e,this._referenceCoordinates=null}get originalWidth(){return this._originalWidth}get originalHeight(){return this._originalHeight}get originalWidthPercents(){return this._originalWidthPercents}get aspectRatio(){return this._aspectRatio}begin(e,i,s){const o=new he(i);this.activeHandlePosition=DY(e),this._referenceCoordinates=NY(i,$Y(this.activeHandlePosition)),this._originalWidth=o.width,this._originalHeight=o.height,this._aspectRatio=o.width/o.height;const r=s.style.width;r&&r.match(/^\d+(\.\d*)?%$/)?this._originalWidthPercents=parseFloat(r):this._originalWidthPercents=pY(s,o)}update(e){this.proposedWidth=e.width,this.proposedHeight=e.height,this.proposedWidthPercents=e.widthPercents,this.proposedHandleHostWidth=e.handleHostWidth,this.proposedHandleHostHeight=e.handleHostHeight}}function NY(n,t){const e=new he(n),i=t.split("-"),s={x:i[1]=="right"?e.right:e.left,y:i[0]=="bottom"?e.bottom:e.top};return s.x+=n.ownerDocument.defaultView.scrollX,s.y+=n.ownerDocument.defaultView.scrollY,s}function FY(n){return`ck-widget__resizer__handle-${n}`}function DY(n){const t=["top-left","top-right","bottom-right","bottom-left"];for(const e of t)if(n.classList.contains(FY(e)))return e}function $Y(n){const t=n.split("-"),e={top:"bottom",bottom:"top",left:"right",right:"left"};return`${e[t[0]]}-${e[t[1]]}`}class HY extends q{constructor(){super();const t=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-size-view",t.to("_viewPosition",e=>e?`ck-orientation-${e}`:"")],style:{display:t.if("_isVisible","none",e=>!e)}},children:[{text:t.to("_label")}]})}_bindToState(t,e){this.bind("_isVisible").to(e,"proposedWidth",e,"proposedHeight",(i,s)=>i!==null&&s!==null),this.bind("_label").to(e,"proposedHandleHostWidth",e,"proposedHandleHostHeight",e,"proposedWidthPercents",(i,s,o)=>t.unit==="px"?`${i}×${s}`:`${o}%`),this.bind("_viewPosition").to(e,"activeHandlePosition",e,"proposedHandleHostWidth",e,"proposedHandleHostHeight",(i,s,o)=>s<50||o<50?"above-center":i)}_dismiss(){this.unbind(),this._isVisible=!1}}class sv extends Ve(){constructor(e){super();h(this,"_state");h(this,"_sizeView");h(this,"_options");h(this,"_viewResizerWrapper",null);h(this,"_initialViewWidth");this._options=e,this.set("isEnabled",!0),this.set("isSelected",!1),this.bind("isVisible").to(this,"isEnabled",this,"isSelected",(i,s)=>i&&s),this.decorate("begin"),this.decorate("cancel"),this.decorate("commit"),this.decorate("updateSize"),this.on("commit",i=>{!this.state.proposedWidth&&!this.state.proposedWidthPercents&&(this._cleanup(),i.stop())},{priority:"high"})}get state(){return this._state}show(){this._options.editor.editing.view.change(i=>{i.removeClass("ck-hidden",this._viewResizerWrapper)})}hide(){this._options.editor.editing.view.change(i=>{i.addClass("ck-hidden",this._viewResizerWrapper)})}attach(){const e=this,i=this._options.viewElement;this._options.editor.editing.view.change(o=>{const r=o.createUIElement("div",{class:"ck ck-reset_all ck-widget__resizer"},function(a){const l=this.toDomElement(a);return e._appendHandles(l),e._appendSizeUI(l),l});o.insert(o.createPositionAt(i,"end"),r),o.addClass("ck-widget_with-resizer",i),this._viewResizerWrapper=r,this.isVisible||this.hide()}),this.on("change:isVisible",()=>{this.isVisible?(this.show(),this.redraw()):this.hide()})}begin(e){this._state=new OY(this._options),this._sizeView._bindToState(this._options,this.state),this._initialViewWidth=this._options.viewElement.getStyle("width"),this.state.begin(e,this._getHandleHost(),this._getResizeHost())}updateSize(e){const i=this._proposeNewSize(e);this._options.editor.editing.view.change(u=>{const d=this._options.unit||"%",f=(d==="%"?i.widthPercents:i.width)+d;u.setStyle("width",f,this._options.viewElement)});const o=this._getHandleHost(),r=new he(o),a=Math.round(r.width),l=Math.round(r.height),c=new he(o);i.width=Math.round(c.width),i.height=Math.round(c.height),this.redraw(r),this.state.update({...i,handleHostWidth:a,handleHostHeight:l})}commit(){const e=this._options.unit||"%",i=(e==="%"?this.state.proposedWidthPercents:this.state.proposedWidth)+e;this._options.editor.editing.view.change(()=>{this._cleanup(),this._options.onCommit(i)})}cancel(){this._cleanup()}destroy(){this.cancel()}redraw(e){const i=this._domResizerWrapper;if(!WY(i))return;const s=i.parentElement,o=this._getHandleHost(),r=this._viewResizerWrapper,a=[r.getStyle("width"),r.getStyle("height"),r.getStyle("left"),r.getStyle("top")];let l;if(s.isSameNode(o)){const c=e||new he(o);l=[c.width+"px",c.height+"px",void 0,void 0]}else l=[o.offsetWidth+"px",o.offsetHeight+"px",o.offsetLeft+"px",o.offsetTop+"px"];$t(a,l)!=="same"&&this._options.editor.editing.view.change(c=>{c.setStyle({width:l[0],height:l[1],left:l[2],top:l[3]},r)})}containsHandle(e){return this._domResizerWrapper.contains(e)}static isResizeHandle(e){return e.classList.contains("ck-widget__resizer__handle")}_cleanup(){this._sizeView._dismiss(),this._options.editor.editing.view.change(i=>{i.setStyle("width",this._initialViewWidth,this._options.viewElement)})}_proposeNewSize(e){const i=this.state,s=UY(e),o=this._options.isCentered?this._options.isCentered(this):!0,r={x:i._referenceCoordinates.x-(s.x+i.originalWidth),y:s.y-i.originalHeight-i._referenceCoordinates.y};o&&i.activeHandlePosition.endsWith("-right")&&(r.x=s.x-(i._referenceCoordinates.x+i.originalWidth)),o&&(r.x*=2);let a=Math.abs(i.originalWidth+r.x),l=Math.abs(i.originalHeight+r.y);return(a/i.aspectRatio>l?"width":"height")=="width"?l=a/i.aspectRatio:a=l*i.aspectRatio,{width:Math.round(a),height:Math.round(l),widthPercents:Math.min(Math.round(i.originalWidthPercents/i.originalWidth*a*100)/100,100)}}_getResizeHost(){const e=this._domResizerWrapper.parentElement;return this._options.getResizeHost(e)}_getHandleHost(){const e=this._domResizerWrapper.parentElement;return this._options.getHandleHost(e)}get _domResizerWrapper(){return this._options.editor.editing.view.domConverter.mapViewToDom(this._viewResizerWrapper)}_appendHandles(e){const i=["top-left","top-right","bottom-right","bottom-left"];for(const s of i)e.appendChild(new bn({tag:"div",attributes:{class:`ck-widget__resizer__handle ${zY(s)}`}}).render())}_appendSizeUI(e){this._sizeView=new HY,this._sizeView.render(),e.appendChild(this._sizeView.element)}}function zY(n){return`ck-widget__resizer__handle-${n}`}function UY(n){return{x:n.pageX,y:n.pageY}}function WY(n){return n&&n.ownerDocument&&n.ownerDocument.contains(n)}class Lf extends A{constructor(){super(...arguments);h(this,"_resizers",new Map);h(this,"_observer");h(this,"_redrawSelectedResizerThrottled")}static get pluginName(){return"WidgetResize"}init(){const e=this.editor.editing,i=j.window.document;this.set("selectedResizer",null),this.set("_activeResizer",null),e.view.addObserver(Ph),this._observer=new(on()),this.listenTo(e.view.document,"mousedown",this._mouseDownListener.bind(this),{priority:"high"}),this._observer.listenTo(i,"mousemove",this._mouseMoveListener.bind(this)),this._observer.listenTo(i,"mouseup",this._mouseUpListener.bind(this)),this._redrawSelectedResizerThrottled=$s(()=>this.redrawSelectedResizer(),200),this.editor.ui.on("update",this._redrawSelectedResizerThrottled),this.editor.model.document.on("change",()=>{for(const[o,r]of this._resizers)o.isAttached()||(this._resizers.delete(o),r.destroy())},{priority:"lowest"}),this._observer.listenTo(j.window,"resize",this._redrawSelectedResizerThrottled);const s=this.editor.editing.view.document.selection;s.on("change",()=>{const o=s.getSelectedElement(),r=this.getResizerByViewElement(o)||null;r?this.select(r):this.deselect()})}redrawSelectedResizer(){this.selectedResizer&&this.selectedResizer.isVisible&&this.selectedResizer.redraw()}destroy(){super.destroy(),this._observer.stopListening();for(const e of this._resizers.values())e.destroy();this._redrawSelectedResizerThrottled.cancel()}select(e){this.deselect(),this.selectedResizer=e,this.selectedResizer.isSelected=!0}deselect(){this.selectedResizer&&(this.selectedResizer.isSelected=!1),this.selectedResizer=null}attachTo(e){const i=new sv(e),s=this.editor.plugins;if(i.attach(),s.has("WidgetToolbarRepository")){const a=s.get("WidgetToolbarRepository");i.on("begin",()=>{a.forceDisabled("resize")},{priority:"lowest"}),i.on("cancel",()=>{a.clearForceDisabled("resize")},{priority:"highest"}),i.on("commit",()=>{a.clearForceDisabled("resize")},{priority:"highest"})}this._resizers.set(e.viewElement,i);const r=this.editor.editing.view.document.selection.getSelectedElement();return this.getResizerByViewElement(r)==i&&this.select(i),i}getResizerByViewElement(e){return this._resizers.get(e)}_getResizerByHandle(e){for(const i of this._resizers.values())if(i.containsHandle(e))return i}_mouseDownListener(e,i){const s=i.domTarget;sv.isResizeHandle(s)&&(this._activeResizer=this._getResizerByHandle(s)||null,this._activeResizer&&(this._activeResizer.begin(s),e.stop(),i.preventDefault()))}_mouseMoveListener(e,i){this._activeResizer&&this._activeResizer.updateSize(i)}_mouseUpListener(){this._activeResizer&&(this._activeResizer.commit(),this._activeResizer=null)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Pl extends fs{constructor(e){super(e);h(this,"domEventType",["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"]);const i=this.document;this.listenTo(i,"paste",s("clipboardInput"),{priority:"low"}),this.listenTo(i,"drop",s("clipboardInput"),{priority:"low"}),this.listenTo(i,"dragover",s("dragging"),{priority:"low"});function s(o){return(r,a)=>{a.preventDefault();const l=a.dropRange?[a.dropRange]:null,c=new Qi(i,o);i.fire(c,{dataTransfer:a.dataTransfer,method:r.name,targetRanges:l,target:a.target,domEvent:a.domEvent}),c.stop.called&&a.stopPropagation()}}}onDomEvent(e){const i="clipboardData"in e?e.clipboardData:e.dataTransfer,s=e.type=="drop"||e.type=="paste",o={dataTransfer:new T5(i,{cacheFiles:s})};(e.type=="drop"||e.type=="dragover")&&(o.dropRange=qY(this.view,e)),this.fire(e.type,e,o)}}function qY(n,t){const e=t.target.ownerDocument,i=t.clientX,s=t.clientY;let o;return e.caretRangeFromPoint&&e.caretRangeFromPoint(i,s)?o=e.caretRangeFromPoint(i,s):t.rangeParent&&(o=e.createRange(),o.setStart(t.rangeParent,t.rangeOffset),o.collapse(!0)),o?n.domConverter.domRangeToView(o):null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function jY(n){return n=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(n.includes("</p><p>")||n.includes("<br>"))&&(n=`<p>${n}</p>`),n}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function GY(n){return n.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>e.length==1?" ":e).replace(/<!--[\s\S]*?-->/g,"")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const ov=["figcaption","li"],rv=["ol","ul"];function iP(n){if(n.is("$text")||n.is("$textProxy"))return n.data;if(n.is("element","img")&&n.hasAttribute("alt"))return n.getAttribute("alt");if(n.is("element","br"))return`
`;let t="",e=null;for(const i of n.getChildren())t+=KY(i,e)+iP(i),e=i;return t}function KY(n,t){return t?n.is("element","li")&&!n.isEmpty&&n.getChild(0).is("containerElement")||rv.includes(n.name)&&rv.includes(t.name)?`

`:!n.is("containerElement")&&!t.is("containerElement")?"":ov.includes(n.name)||ov.includes(t.name)?`
`:`

`:""}class il extends A{constructor(){super(...arguments);h(this,"_markersToCopy",new Map)}static get pluginName(){return"ClipboardMarkersUtils"}_registerMarkerToCopy(e,i){this._markersToCopy.set(e,i)}_copySelectedFragmentWithMarkers(e,i,s=o=>o.model.getSelectedContent(o.model.document.selection)){return this.editor.model.change(o=>{const r=o.model.document.selection;o.setSelection(i);const a=this._insertFakeMarkersIntoSelection(o,o.model.document.selection,e),l=s(o),c=this._removeFakeMarkersInsideElement(o,l);for(const[u,d]of Object.entries(a)){c[u]||(c[u]=o.createRangeIn(l));for(const f of d)o.remove(f)}l.markers.clear();for(const[u,d]of Object.entries(c))l.markers.set(u,d);return o.setSelection(r),l})}_pasteMarkersIntoTransformedElement(e,i){const s=this._getPasteMarkersFromRangeMap(e);return this.editor.model.change(o=>{const r=this._insertFakeMarkersElements(o,s),a=i(o),l=this._removeFakeMarkersInsideElement(o,a);for(const c of Object.values(r).flat())o.remove(c);for(const[c,u]of Object.entries(l))o.model.markers.has(c)||o.addMarker(c,{usingOperation:!0,affectsData:!0,range:u});return a})}_pasteFragmentWithMarkers(e){const i=this._getPasteMarkersFromRangeMap(e.markers);e.markers.clear();for(const s of i)e.markers.set(s.name,s.range);return this.editor.model.insertContent(e)}_forceMarkersCopy(e,i,s={allowedActions:"all",copyPartiallySelected:!0,duplicateOnPaste:!0}){const o=this._markersToCopy.get(e);this._markersToCopy.set(e,s),i(),o?this._markersToCopy.set(e,o):this._markersToCopy.delete(e)}_isMarkerCopyable(e,i){const s=this._getMarkerClipboardConfig(e);if(!s)return!1;if(!i)return!0;const{allowedActions:o}=s;return o==="all"||o.includes(i)}_hasMarkerConfiguration(e){return!!this._getMarkerClipboardConfig(e)}_getMarkerClipboardConfig(e){const[i]=e.split(":");return this._markersToCopy.get(i)||null}_insertFakeMarkersIntoSelection(e,i,s){const o=this._getCopyableMarkersFromSelection(e,i,s);return this._insertFakeMarkersElements(e,o)}_getCopyableMarkersFromSelection(e,i,s){const o=Array.from(i.getRanges()),r=new Set(o.flatMap(l=>Array.from(e.model.markers.getMarkersIntersectingRange(l)))),a=l=>{if(!this._isMarkerCopyable(l.name,s))return!1;const{copyPartiallySelected:u}=this._getMarkerClipboardConfig(l.name);if(!u){const d=l.getRange();return o.some(f=>f.containsRange(d,!0))}return!0};return Array.from(r).filter(a).map(l=>({name:s==="dragstart"?this._getUniqueMarkerName(l.name):l.name,range:l.getRange()}))}_getPasteMarkersFromRangeMap(e,i=null){const{model:s}=this.editor;return(e instanceof Map?Array.from(e.entries()):Object.entries(e)).flatMap(([r,a])=>{if(!this._hasMarkerConfiguration(r))return[{name:r,range:a}];if(this._isMarkerCopyable(r,i)){const l=this._getMarkerClipboardConfig(r),c=s.markers.has(r)&&s.markers.get(r).getRange().root.rootName==="$graveyard";return(l.duplicateOnPaste||c)&&(r=this._getUniqueMarkerName(r)),[{name:r,range:a}]}return[]})}_insertFakeMarkersElements(e,i){const s={},o=i.flatMap(r=>{const{start:a,end:l}=r.range;return[{position:a,marker:r,type:"start"},{position:l,marker:r,type:"end"}]}).sort(({position:r},{position:a})=>r.isBefore(a)?1:-1);for(const{position:r,marker:a,type:l}of o){const c=e.createElement("$marker",{"data-name":a.name,"data-type":l});s[a.name]||(s[a.name]=[]),s[a.name].push(c),e.insert(c,r)}return s}_removeFakeMarkersInsideElement(e,i){const o=this._getAllFakeMarkersFromElement(e,i).reduce((r,a)=>{const l=a.markerElement&&e.createPositionBefore(a.markerElement);let c=r[a.name],u=!1;return c&&c.start&&c.end&&(this._getMarkerClipboardConfig(a.name).duplicateOnPaste?r[this._getUniqueMarkerName(a.name)]=r[a.name]:u=!0,c=null),u||(r[a.name]={...c,[a.type]:l}),a.markerElement&&e.remove(a.markerElement),r},{});return Kp(o,r=>new I(r.start||e.createPositionFromPath(i,[0]),r.end||e.createPositionAt(i,"end")))}_getAllFakeMarkersFromElement(e,i){const s=Array.from(e.createRangeIn(i)).flatMap(({item:a})=>{if(!a.is("element","$marker"))return[];const l=a.getAttribute("data-name"),c=a.getAttribute("data-type");return[{markerElement:a,name:l,type:c}]}),o=[],r=[];for(const a of s)a.type==="end"&&(s.some(c=>c.name===a.name&&c.type==="start")||o.push({markerElement:null,name:a.name,type:"start"})),a.type==="start"&&(s.some(c=>c.name===a.name&&c.type==="end")||r.unshift({markerElement:null,name:a.name,type:"end"}));return[...o,...s,...r]}_getUniqueMarkerName(e){const i=e.split(":"),s=Cn().substring(1,6);return i.length===3?`${i.slice(0,2).join(":")}:${s}`:`${i.join(":")}:${s}`}}class Hn extends A{static get pluginName(){return"ClipboardPipeline"}static get requires(){return[il]}init(){this.editor.editing.view.addObserver(Pl),this._setupPasteDrop(),this._setupCopyCut()}_fireOutputTransformationEvent(t,e,i){const s=this.editor.plugins.get("ClipboardMarkersUtils");this.editor.model.enqueueChange({isUndoable:i==="cut"},()=>{const o=s._copySelectedFragmentWithMarkers(i,e);this.fire("outputTransformation",{dataTransfer:t,content:o,method:i})})}_setupPasteDrop(){const t=this.editor,e=t.model,i=t.editing.view,s=i.document,o=this.editor.plugins.get("ClipboardMarkersUtils");this.listenTo(s,"clipboardInput",(r,a)=>{a.method=="paste"&&!t.model.canEditAt(t.model.document.selection)&&r.stop()},{priority:"highest"}),this.listenTo(s,"clipboardInput",(r,a)=>{const l=a.dataTransfer;let c;if(a.content)c=a.content;else{let d="";l.getData("text/html")?d=GY(l.getData("text/html")):l.getData("text/plain")&&(d=jY(l.getData("text/plain"))),c=this.editor.data.htmlProcessor.toView(d)}const u=new Qi(this,"inputTransformation");this.fire(u,{content:c,dataTransfer:l,targetRanges:a.targetRanges,method:a.method}),u.stop.called&&r.stop(),i.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(r,a)=>{if(a.content.isEmpty)return;const c=this.editor.data.toModel(a.content,"$clipboardHolder");c.childCount!=0&&(r.stop(),e.change(()=>{this.fire("contentInsertion",{content:c,method:a.method,dataTransfer:a.dataTransfer,targetRanges:a.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(r,a)=>{a.resultRange=o._pasteFragmentWithMarkers(a.content)},{priority:"low"})}_setupCopyCut(){const t=this.editor,e=t.model.document,s=t.editing.view.document,o=(r,a)=>{const l=a.dataTransfer;a.preventDefault(),this._fireOutputTransformationEvent(l,e.selection,r.name)};this.listenTo(s,"copy",o,{priority:"low"}),this.listenTo(s,"cut",(r,a)=>{t.model.canEditAt(t.model.document.selection)?o(r,a):a.preventDefault()},{priority:"low"}),this.listenTo(this,"outputTransformation",(r,a)=>{const l=t.data.toView(a.content);s.fire("clipboardOutput",{dataTransfer:a.dataTransfer,content:l,method:a.method})},{priority:"low"}),this.listenTo(s,"clipboardOutput",(r,a)=>{a.content.isEmpty||(a.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(a.content)),a.dataTransfer.setData("text/plain",iP(a.content))),a.method=="cut"&&t.model.deleteContent(e.selection)},{priority:"low"})}}const Vf=ra("px");class ZY extends q{constructor(){super();const t=this.bindTemplate;this.set({isVisible:!1,left:null,top:null,width:null}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-clipboard-drop-target-line",t.if("isVisible","ck-hidden",e=>!e)],style:{left:t.to("left",e=>Vf(e)),top:t.to("top",e=>Vf(e)),width:t.to("width",e=>Vf(e))}}})}}class Xc extends A{constructor(){super(...arguments);h(this,"removeDropMarkerDelayed",bb(()=>this.removeDropMarker(),40));h(this,"_updateDropMarkerThrottled",$s(e=>this._updateDropMarker(e),40));h(this,"_reconvertMarkerThrottled",$s(()=>{this.editor.model.markers.has("drop-target")&&this.editor.editing.reconvertMarker("drop-target")},0));h(this,"_dropTargetLineView",new ZY);h(this,"_domEmitter",new(on()));h(this,"_scrollables",new Map)}static get pluginName(){return"DragDropTarget"}init(){this._setupDropMarker()}destroy(){this._domEmitter.stopListening();for(const{resizeObserver:e}of this._scrollables.values())e.destroy();return this._updateDropMarkerThrottled.cancel(),this.removeDropMarkerDelayed.cancel(),this._reconvertMarkerThrottled.cancel(),super.destroy()}updateDropMarker(e,i,s,o,r,a){this.removeDropMarkerDelayed.cancel();const l=av(this.editor,e,i,s,o,r,a);/* istanbul ignore next -- @preserve */if(l){if(a&&a.containsRange(l))return this.removeDropMarker();this._updateDropMarkerThrottled(l)}}getFinalDropRange(e,i,s,o,r,a){const l=av(this.editor,e,i,s,o,r,a);return this.removeDropMarker(),l}removeDropMarker(){const e=this.editor.model;this.removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),this._dropTargetLineView.isVisible=!1,e.markers.has("drop-target")&&e.change(i=>{i.removeMarker("drop-target")})}_setupDropMarker(){const e=this.editor;e.ui.view.body.add(this._dropTargetLineView),e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(i,{writer:s})=>{if(e.model.schema.checkChild(i.markerRange.start,"$text"))return this._dropTargetLineView.isVisible=!1,this._createDropTargetPosition(s);i.markerRange.isCollapsed?this._updateDropTargetLine(i.markerRange):this._dropTargetLineView.isVisible=!1}})}_updateDropMarker(e){const i=this.editor,s=i.model.markers;i.model.change(o=>{s.has("drop-target")?s.get("drop-target").getRange().isEqual(e)||o.updateMarker("drop-target",{range:e}):o.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})})}_createDropTargetPosition(e){return e.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(i){const s=this.toDomElement(i);return s.append("⁠",i.createElement("span"),"⁠"),s})}_updateDropTargetLine(e){const i=this.editor.editing,s=e.start.nodeBefore,o=e.start.nodeAfter,r=e.start.parent,a=s?i.mapper.toViewElement(s):null,l=a?i.view.domConverter.mapViewToDom(a):null,c=o?i.mapper.toViewElement(o):null,u=c?i.view.domConverter.mapViewToDom(c):null,d=i.mapper.toViewElement(r);if(!d)return;const f=i.view.domConverter.mapViewToDom(d),m=this._getScrollableRect(d),{scrollX:g,scrollY:p}=j.window,w=l?new he(l):null,v=u?new he(u):null,_=new he(f).excludeScrollbarsAndBorders(),y=w?w.bottom:_.top,E=v?v.top:_.bottom,x=j.window.getComputedStyle(f),S=y<=E?(y+E)/2:E;if(m.top<S&&S<m.bottom){const R=_.left+parseFloat(x.paddingLeft),V=_.right-parseFloat(x.paddingRight),P=Math.max(R+g,m.left),B=Math.min(V+g,m.right);this._dropTargetLineView.set({isVisible:!0,left:P,top:S+p,width:B-P})}else this._dropTargetLineView.isVisible=!1}_getScrollableRect(e){const i=e.root.rootName;let s;if(this._scrollables.has(i))s=this._scrollables.get(i).domElement;else{const o=this.editor.editing.view.domConverter.mapViewToDom(e);s=YY(o),this._domEmitter.listenTo(s,"scroll",this._reconvertMarkerThrottled,{usePassive:!0});const r=new Dr(s,this._reconvertMarkerThrottled);this._scrollables.set(i,{domElement:s,resizeObserver:r})}return new he(s).excludeScrollbarsAndBorders()}}function av(n,t,e,i,s,o,r){const a=n.model,l=n.editing.mapper;let u=lv(n,t);for(;u;){if(!o){if(a.schema.checkChild(u,"$text")){if(e){const d=e[0].start,f=l.toModelPosition(d);if(!r||Array.from(r.getItems()).every(g=>a.schema.checkChild(f,g))){if(a.schema.checkChild(f,"$text"))return a.createRange(f);if(d)return Qc(n,lv(n,d.parent),i,s)}}}else if(a.schema.isInline(u))return Qc(n,u,i,s)}if(a.schema.isBlock(u))return Qc(n,u,i,s);if(a.schema.checkChild(u,"$block")){const d=Array.from(u.getChildren()).filter(g=>g.is("element")&&!JY(n,g));let f=0,m=d.length;if(m==0)return a.createRange(a.createPositionAt(u,"end"));for(;f<m-1;){const g=Math.floor((f+m)/2);sP(n,d[g],i,s)=="before"?m=g:f=g}return Qc(n,d[f],i,s)}u=u.parent}return null}function JY(n,t){const e=n.editing.mapper,i=n.editing.view.domConverter,s=e.toViewElement(t);if(!s)return!0;const o=i.mapViewToDom(s);return j.window.getComputedStyle(o).float!="none"}function Qc(n,t,e,i){const s=n.model;return s.createRange(s.createPositionAt(t,sP(n,t,e,i)))}function sP(n,t,e,i){const s=n.editing.mapper,o=n.editing.view.domConverter,r=s.toViewElement(t),a=o.mapViewToDom(r),l=new he(a);return n.model.schema.isInline(t)?e<(l.left+l.right)/2?"before":"after":i<(l.top+l.bottom)/2?"before":"after"}function lv(n,t){const e=n.editing.mapper,i=n.editing.view,s=e.toModelElement(t);if(s)return s;const o=i.createPositionBefore(t),r=e.findMappedViewAncestor(o);return e.toModelElement(r)}function YY(n){let t=n;do{t=t.parentElement;const e=j.window.getComputedStyle(t).overflowY;if(e=="auto"||e=="scroll")break}while(t.tagName!="BODY");return t}class XY extends A{constructor(){super(...arguments);h(this,"_isBlockDragging",!1);h(this,"_domEmitter",new(on()))}static get pluginName(){return"DragDropBlockToolbar"}init(){const e=this.editor;if(this.listenTo(e,"change:isReadOnly",(i,s,o)=>{o?(this.forceDisabled("readOnlyMode"),this._isBlockDragging=!1):this.clearForceDisabled("readOnlyMode")}),ue.isAndroid&&this.forceDisabled("noAndroidSupport"),e.plugins.has("BlockToolbar")){const s=e.plugins.get("BlockToolbar").buttonView.element;this._domEmitter.listenTo(s,"dragstart",(o,r)=>this._handleBlockDragStart(r)),this._domEmitter.listenTo(j.document,"dragover",(o,r)=>this._handleBlockDragging(r)),this._domEmitter.listenTo(j.document,"drop",(o,r)=>this._handleBlockDragging(r)),this._domEmitter.listenTo(j.document,"dragend",()=>this._handleBlockDragEnd(),{useCapture:!0}),this.isEnabled&&s.setAttribute("draggable","true"),this.on("change:isEnabled",(o,r,a)=>{s.setAttribute("draggable",a?"true":"false")})}}destroy(){return this._domEmitter.stopListening(),super.destroy()}_handleBlockDragStart(e){if(!this.isEnabled)return;const i=this.editor.model,s=i.document.selection,o=this.editor.editing.view,r=Array.from(s.getSelectedBlocks()),a=i.createRange(i.createPositionBefore(r[0]),i.createPositionAfter(r[r.length-1]));i.change(l=>l.setSelection(a)),this._isBlockDragging=!0,o.focus(),o.getObserver(Pl).onDomEvent(e)}_handleBlockDragging(e){if(!this.isEnabled||!this._isBlockDragging)return;const i=e.clientX+(this.editor.locale.contentLanguageDirection=="ltr"?100:-100),s=e.clientY,o=document.elementFromPoint(i,s),r=this.editor.editing.view;!o||!o.closest(".ck-editor__editable")||r.getObserver(Pl).onDomEvent({...e,type:e.type,dataTransfer:e.dataTransfer,target:o,clientX:i,clientY:s,preventDefault:()=>e.preventDefault(),stopPropagation:()=>e.stopPropagation()})}_handleBlockDragEnd(){this._isBlockDragging=!1}}class QY extends A{constructor(){super(...arguments);h(this,"_draggedRange");h(this,"_draggingUid");h(this,"_draggableElement");h(this,"_clearDraggableAttributesDelayed",bb(()=>this._clearDraggableAttributes(),40));h(this,"_blockMode",!1);h(this,"_domEmitter",new(on()));h(this,"_previewContainer")}static get pluginName(){return"DragDrop"}static get requires(){return[Hn,ms,Xc,XY]}init(){const e=this.editor,i=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,i.addObserver(Pl),i.addObserver(Ph),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",(s,o,r)=>{r?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(s,o,r)=>{r||this._finalizeDragging(!1)}),ue.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._previewContainer&&this._previewContainer.remove(),this._domEmitter.stopListening(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,i=e.model,s=e.editing.view,o=s.document,r=e.plugins.get(Xc);this.listenTo(o,"dragstart",(a,l)=>{if(l.target&&l.target.is("editableElement")){l.preventDefault();return}if(this._prepareDraggedRange(l.target),!this._draggedRange){l.preventDefault();return}this._draggingUid=Cn(),l.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",l.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const c=i.createSelection(this._draggedRange.toRange());this.editor.plugins.get("ClipboardPipeline")._fireOutputTransformationEvent(l.dataTransfer,c,"dragstart");const{dataTransfer:d,domTarget:f,domEvent:m}=l,{clientX:g}=m;this._updatePreview({dataTransfer:d,domTarget:f,clientX:g}),l.stopPropagation(),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(o,"dragend",(a,l)=>{this._finalizeDragging(!l.dataTransfer.isCanceled&&l.dataTransfer.dropEffect=="move")},{priority:"low"}),this._domEmitter.listenTo(j.document,"dragend",()=>{this._blockMode=!1},{useCapture:!0}),this.listenTo(o,"dragenter",()=>{this.isEnabled&&s.focus()}),this.listenTo(o,"dragleave",()=>{r.removeDropMarkerDelayed()}),this.listenTo(o,"dragging",(a,l)=>{if(!this.isEnabled){l.dataTransfer.dropEffect="none";return}const{clientX:c,clientY:u}=l.domEvent;r.updateDropMarker(l.target,l.targetRanges,c,u,this._blockMode,this._draggedRange),this._draggedRange||(l.dataTransfer.dropEffect="copy"),ue.isGecko||(l.dataTransfer.effectAllowed=="copy"?l.dataTransfer.dropEffect="copy":["all","copyMove"].includes(l.dataTransfer.effectAllowed)&&(l.dataTransfer.dropEffect="move")),a.stop()},{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,s=e.editing.view.document,o=e.plugins.get(Xc);this.listenTo(s,"clipboardInput",(r,a)=>{if(a.method!="drop")return;const{clientX:l,clientY:c}=a.domEvent,u=o.getFinalDropRange(a.target,a.targetRanges,l,c,this._blockMode,this._draggedRange);if(!u){this._finalizeDragging(!1),r.stop();return}if(this._draggedRange&&this._draggingUid!=a.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),cv(a.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(u,!0)){this._finalizeDragging(!1),r.stop();return}a.targetRanges=[e.editing.mapper.toViewRange(u)]},{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(Hn);e.on("contentInsertion",(i,s)=>{if(!this.isEnabled||s.method!=="drop")return;const o=s.targetRanges.map(r=>this.editor.editing.mapper.toModelRange(r));this.editor.model.change(r=>r.setSelection(o))},{priority:"high"}),e.on("contentInsertion",(i,s)=>{if(!this.isEnabled||s.method!=="drop")return;const o=cv(s.dataTransfer)=="move",r=!s.resultRange||!s.resultRange.isCollapsed;this._finalizeDragging(r&&o)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,i=e.editing.view,s=i.document;this.listenTo(s,"mousedown",(o,r)=>{if(ue.isAndroid||!r)return;this._clearDraggableAttributesDelayed.cancel();let a=uv(r.target);if(ue.isBlink&&!e.isReadOnly&&!a&&!s.selection.isCollapsed){const l=s.selection.getSelectedElement();(!l||!ht(l))&&(a=s.selection.editableElement)}a&&(i.change(l=>{l.setAttribute("draggable","true",a)}),this._draggableElement=e.editing.mapper.toModelElement(a))}),this.listenTo(s,"mouseup",()=>{ue.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change(i=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&i.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_finalizeDragging(e){const i=this.editor,s=i.model;i.plugins.get(Xc).removeDropMarker(),this._clearDraggableAttributes(),i.plugins.has("WidgetToolbarRepository")&&i.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._previewContainer&&(this._previewContainer.remove(),this._previewContainer=void 0),this._draggedRange&&(e&&this.isEnabled&&s.change(r=>{const a=s.createSelection(this._draggedRange);s.deleteContent(a,{doNotAutoparagraph:!0});const l=a.getFirstPosition().parent;l.isEmpty&&!s.schema.checkChild(l,"$text")&&s.schema.checkChild(l,"paragraph")&&r.insertElement("paragraph",l,0)}),this._draggedRange.detach(),this._draggedRange=null)}_prepareDraggedRange(e){const i=this.editor,s=i.model,o=s.document.selection,r=e?uv(e):null;if(r){const u=i.editing.mapper.toModelElement(r);this._draggedRange=hn.fromRange(s.createRangeOn(u)),this._blockMode=s.schema.isBlock(u),i.plugins.has("WidgetToolbarRepository")&&i.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop");return}if(o.isCollapsed&&!o.getFirstPosition().parent.isEmpty)return;const a=Array.from(o.getSelectedBlocks()),l=o.getFirstRange();if(a.length==0){this._draggedRange=hn.fromRange(l);return}const c=oP(s,a);if(a.length>1)this._draggedRange=hn.fromRange(c),this._blockMode=!0;else if(a.length==1){const u=l.start.isTouching(c.start)&&l.end.isTouching(c.end);this._draggedRange=hn.fromRange(u?c:l),this._blockMode=u}s.change(u=>u.setSelection(this._draggedRange.toRange()))}_updatePreview({dataTransfer:e,domTarget:i,clientX:s}){const o=this.editor.editing.view,r=o.document.selection.editableElement,a=o.domConverter.mapViewToDom(r),l=j.window.getComputedStyle(a);this._previewContainer?this._previewContainer.firstElementChild&&this._previewContainer.removeChild(this._previewContainer.firstElementChild):(this._previewContainer=xt(j.document,"div",{style:"position: fixed; left: -999999px;"}),j.document.body.appendChild(this._previewContainer));const c=new he(a);if(a.contains(i))return;const u=parseFloat(l.paddingLeft),d=xt(j.document,"div");d.className="ck ck-content",d.style.width=l.width,d.style.paddingLeft=`${c.left-s+u}px`,ue.isiOS&&(d.style.backgroundColor="white"),d.innerHTML=e.getData("text/html"),e.setDragImage(d,0,0),this._previewContainer.appendChild(d)}}function cv(n){return ue.isGecko?n.dropEffect:["all","copyMove"].includes(n.effectAllowed)?"move":"copy"}function uv(n){if(n.is("editableElement"))return null;if(n.hasClass("ck-widget__selection-handle"))return n.findAncestor(ht);if(ht(n))return n;const t=n.findAncestor(e=>ht(e)||e.is("editableElement"));return ht(t)?t:null}function oP(n,t){const e=t[0],i=t[t.length-1],s=e.getCommonAncestor(i),o=n.createPositionBefore(e),r=n.createPositionAfter(i);if(s&&s.is("element")&&!n.schema.isLimit(s)){const a=n.createRangeOn(s),l=o.isTouching(a.start),c=r.isTouching(a.end);if(l&&c)return oP(n,[s])}return n.createRange(o,r)}class eX extends A{static get pluginName(){return"PastePlainText"}static get requires(){return[Hn]}init(){const t=this.editor,e=t.model,i=t.editing.view,s=i.document,o=e.document.selection;let r=!1;i.addObserver(Pl),this.listenTo(s,"keydown",(a,l)=>{r=l.shiftKey}),t.plugins.get(Hn).on("contentInsertion",(a,l)=>{!r&&!tX(l.content,e.schema)||e.change(c=>{const u=Array.from(o.getAttributes()).filter(([f])=>e.schema.getAttributeProperties(f).isFormatting);o.isCollapsed||e.deleteContent(o,{doNotAutoparagraph:!0}),u.push(...o.getAttributes());const d=c.createRangeIn(l.content);for(const f of d.getItems())f.is("$textProxy")&&c.setAttributes(u,f)})})}}function tX(n,t){if(n.childCount>1)return!1;const e=n.getChild(0);return t.isObject(e)?!1:Array.from(e.getAttributeKeys()).length==0}class Gb extends A{static get pluginName(){return"Clipboard"}static get requires(){return[il,Hn,QY,eX]}init(){const t=this.editor,e=this.editor.t;t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Copy selected content"),keystroke:"CTRL+C"},{label:e("Paste content"),keystroke:"CTRL+V"},{label:e("Paste content as plain text"),keystroke:"CTRL+SHIFT+V"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const nX={autoRefresh:!0},dv=36e5;class Kb extends Ve(){constructor(e,i={}){super();h(this,"_refresh");h(this,"_options");h(this,"_tokenRefreshTimeout");if(!e)throw new C("token-missing-token-url",this);i.initValue&&this._validateTokenValue(i.initValue),this.set("value",i.initValue),typeof e=="function"?this._refresh=e:this._refresh=()=>iX(e),this._options={...nX,...i}}init(){return new Promise((e,i)=>{if(!this.value){this.refreshToken().then(e).catch(i);return}this._options.autoRefresh&&this._registerRefreshTokenTimeout(),e(this)})}refreshToken(){return this._refresh().then(e=>(this._validateTokenValue(e),this.set("value",e),this._options.autoRefresh&&this._registerRefreshTokenTimeout(),this))}destroy(){clearTimeout(this._tokenRefreshTimeout)}_validateTokenValue(e){const i=typeof e=="string",s=!/^".*"$/.test(e),o=i&&e.split(".").length===3;if(!(s&&o))throw new C("token-not-in-jwt-format",this)}_registerRefreshTokenTimeout(){const e=this._getTokenRefreshTimeoutTime();clearTimeout(this._tokenRefreshTimeout),this._tokenRefreshTimeout=setTimeout(()=>{this.refreshToken()},e)}_getTokenRefreshTimeoutTime(){try{const[,e]=this.value.split("."),{exp:i}=JSON.parse(atob(e));return i?Math.floor((i*1e3-Date.now())/2):dv}catch{return dv}}static create(e,i={}){return new Kb(e,i).init()}}function iX(n){return new Promise((t,e)=>{const i=new XMLHttpRequest;i.open("GET",n),i.addEventListener("load",()=>{const s=i.status,o=i.response;return s<200||s>299?e(new C("token-cannot-download-new-token",null)):t(o)}),i.addEventListener("error",()=>e(new Error("Network Error"))),i.addEventListener("abort",()=>e(new Error("Abort"))),i.send()})}const ng=/^data:(\S*?);base64,/;class sX extends De(){constructor(e,i,s){super();h(this,"file");h(this,"xhr");h(this,"_token");h(this,"_apiAddress");if(!e)throw new C("fileuploader-missing-file",null);if(!i)throw new C("fileuploader-missing-token",null);if(!s)throw new C("fileuploader-missing-api-address",null);this.file=rX(e)?oX(e):e,this._token=i,this._apiAddress=s}onProgress(e){return this.on("progress",(i,s)=>e(s)),this}onError(e){return this.once("error",(i,s)=>e(s)),this}abort(){this.xhr.abort()}send(){return this._prepareRequest(),this._attachXHRListeners(),this._sendRequest()}_prepareRequest(){const e=new XMLHttpRequest;e.open("POST",this._apiAddress),e.setRequestHeader("Authorization",this._token.value),e.responseType="json",this.xhr=e}_attachXHRListeners(){const e=this.xhr,i=s=>()=>this.fire("error",s);e.addEventListener("error",i("Network Error")),e.addEventListener("abort",i("Abort"));/* istanbul ignore else -- @preserve */e.upload&&e.upload.addEventListener("progress",s=>{s.lengthComputable&&this.fire("progress",{total:s.total,uploaded:s.loaded})}),e.addEventListener("load",()=>{const s=e.status,o=e.response;if(s<200||s>299)return this.fire("error",o.message||o.error)})}_sendRequest(){const e=new FormData,i=this.xhr;return e.append("file",this.file),new Promise((s,o)=>{i.addEventListener("load",()=>{const r=i.status,a=i.response;return r<200||r>299?a.message?o(new C("fileuploader-uploading-data-failed",this,{message:a.message})):o(a.error):s(a)}),i.addEventListener("error",()=>o(new Error("Network Error"))),i.addEventListener("abort",()=>o(new Error("Abort"))),i.send(e)})}}function oX(n,t=512){try{const e=n.match(ng)[1],i=atob(n.replace(ng,"")),s=[];for(let o=0;o<i.length;o+=t){const r=i.slice(o,o+t),a=new Array(r.length);for(let l=0;l<r.length;l++)a[l]=r.charCodeAt(l);s.push(new Uint8Array(a))}return new Blob(s,{type:e})}catch{throw new C("fileuploader-decoding-image-data-error",null)}}function rX(n){if(typeof n!="string")return!1;const t=n.match(ng);return!!(t&&t.length)}class aX{constructor(t,e){h(this,"_token");h(this,"_apiAddress");if(!t)throw new C("uploadgateway-missing-token",null);if(!e)throw new C("uploadgateway-missing-api-address",null);this._token=t,this._apiAddress=e}upload(t){return new sX(t,this._token,this._apiAddress)}}class lX extends Rh{static get pluginName(){return"CloudServicesCore"}createToken(t,e){return new Kb(t,e)}createUploadGateway(t,e){return new aX(t,e)}}class cX extends Rh{constructor(){super(...arguments);h(this,"tokenUrl");h(this,"uploadUrl");h(this,"webSocketUrl");h(this,"bundleVersion");h(this,"token",null);h(this,"_tokens",new Map)}static get pluginName(){return"CloudServices"}static get requires(){return[lX]}async init(){const i=this.context.config.get("cloudServices")||{};for(const[o,r]of Object.entries(i))this[o]=r;if(!this.tokenUrl){this.token=null;return}const s=this.context.plugins.get("CloudServicesCore");this.token=await s.createToken(this.tokenUrl).init(),this._tokens.set(this.tokenUrl,this.token)}async registerTokenUrl(e){if(this._tokens.has(e))return this.getTokenFor(e);const s=await this.context.plugins.get("CloudServicesCore").createToken(e).init();return this._tokens.set(e,s),s}getTokenFor(e){const i=this._tokens.get(e);if(!i)throw new C("cloudservices-token-not-registered",this);return i}destroy(){super.destroy();for(const e of this._tokens.values())e.destroy()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ld(n){const t=n.t,e=n.config.get("codeBlock.languages");for(const i of e)i.label==="Plain text"&&(i.label=t("Plain text")),i.class===void 0&&(i.class=`language-${i.language}`);return e}function cd(n,t,e){const i={};for(const s of n)if(t==="class"){const o=s[t].split(" ").shift();i[o]=s[e]}else i[s[t]]=s[e];return i}function Zb(n){return n.data.match(/^(\s*)/)[0]}function uX(n,t){const e=n.createDocumentFragment(),i=t.split(`
`),s=i.reduce((o,r,a)=>(o.push(r),a<i.length-1&&o.push(n.createElement("br")),o),[]);return n.appendChild(s,e),e}function ig(n){const t=n.document.selection,e=[];if(t.isCollapsed)return[t.anchor];const i=t.getFirstRange().getWalker({ignoreElementEnd:!0,direction:"backward"});for(const{item:s}of i){if(!s.is("$textProxy"))continue;const{parent:o,startOffset:r}=s.textNode;if(!o.is("element","codeBlock"))continue;const a=Zb(s.textNode),l=n.createPositionAt(o,r+a.length);e.push(l)}return e}function rP(n){const t=Ye(n.getSelectedBlocks());return!!t&&t.is("element","codeBlock")}function hv(n,t){return t.is("rootElement")||n.isLimit(t)?!1:n.checkChild(t.parent,"codeBlock")}function fv(n,t,e,i){const s=cd(t,"language","label"),o=e.getAttribute("language");if(o in s){const r=s[o];return n(i==="enter"?"Entering %0 code snippet":"Leaving %0 code snippet",r)}return n(i==="enter"?"Entering code snippet":"Leaving code snippet")}class dX extends ne{constructor(e){super(e);h(this,"_lastLanguage");this._lastLanguage=null}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const i=this.editor,s=i.model,o=s.document.selection,a=ld(i)[0],l=Array.from(o.getSelectedBlocks()),c=e.forceValue==null?!this.value:e.forceValue,u=hX(e,this._lastLanguage,a.language);s.change(d=>{c?this._applyCodeBlock(d,l,u):this._removeCodeBlock(d,l)})}_getValue(){const e=this.editor.model.document.selection,i=Ye(e.getSelectedBlocks());return!!(i&&i.is("element","codeBlock"))?i.getAttribute("language"):!1}_checkEnabled(){if(this.value)return!0;const e=this.editor.model.document.selection,i=this.editor.model.schema,s=Ye(e.getSelectedBlocks());return s?hv(i,s):!1}_applyCodeBlock(e,i,s){this._lastLanguage=s;const o=this.editor.model.schema,r=i.filter(a=>hv(o,a));for(const a of r)e.rename(a,"codeBlock"),e.setAttribute("language",s,a),o.removeDisallowedAttributes([a],e),Array.from(a.getChildren()).filter(l=>!o.checkChild(a,l)).forEach(l=>e.remove(l));r.reverse().forEach((a,l)=>{const c=r[l+1];a.previousSibling===c&&(e.appendElement("softBreak",c),e.merge(e.createPositionBefore(a)))})}_removeCodeBlock(e,i){const s=i.filter(o=>o.is("element","codeBlock"));for(const o of s){const r=e.createRangeOn(o);for(const a of Array.from(r.getItems()).reverse())if(a.is("element","softBreak")&&a.parent.is("element","codeBlock")){const{position:l}=e.split(e.createPositionBefore(a)),c=l.nodeAfter;e.rename(c,"paragraph"),e.removeAttribute("language",c),e.remove(a)}e.rename(o,"paragraph"),e.removeAttribute("language",o)}}}function hX(n,t,e){return n.language?n.language:n.usePreviousLanguageChoice&&t?t:e}class fX extends ne{constructor(e){super(e);h(this,"_indentSequence");this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const i=this.editor.model;i.change(s=>{const o=ig(i);for(const r of o){const a=s.createText(this._indentSequence);i.insertContent(a,r)}})}_checkEnabled(){return this._indentSequence?rP(this.editor.model.document.selection):!1}}class mX extends ne{constructor(e){super(e);h(this,"_indentSequence");this._indentSequence=e.config.get("codeBlock.indentSequence")}refresh(){this.isEnabled=this._checkEnabled()}execute(){const i=this.editor.model;i.change(()=>{const s=ig(i);for(const o of s){const r=mv(i,o,this._indentSequence);r&&i.deleteContent(i.createSelection(r))}})}_checkEnabled(){if(!this._indentSequence)return!1;const e=this.editor.model;return rP(e.document.selection)?ig(e).some(i=>mv(e,i,this._indentSequence)):!1}}function mv(n,t,e){const i=gX(t);if(!i)return null;const s=Zb(i),o=s.lastIndexOf(e);if(o+e.length!==s.length||o===-1)return null;const{parent:r,startOffset:a}=i;return n.createRange(n.createPositionAt(r,a+o),n.createPositionAt(r,a+o+e.length))}function gX(n){let t=n.parent.getChild(n.index);return(!t||t.is("element","softBreak"))&&(t=n.nodeBefore),!t||t.is("element","softBreak")?null:t}function gv(n,t,e=!1){const i=cd(t,"language","class"),s=cd(t,"language","label");return(o,r,a)=>{const{writer:l,mapper:c,consumable:u}=a;if(!u.consume(r.item,"insert"))return;const d=r.item.getAttribute("language"),f=c.toViewPosition(n.createPositionBefore(r.item)),m={};e&&(m["data-language"]=s[d],m.spellcheck="false");const g=i[d]?{class:i[d]}:void 0,p=l.createContainerElement("code",g),w=l.createContainerElement("pre",m,p);l.insert(f,w),c.bindElements(r.item,p)}}function pX(n){return(t,e,i)=>{if(e.item.parent.name!=="codeBlock")return;const{writer:s,mapper:o,consumable:r}=i;if(!r.consume(e.item,"insert"))return;const a=o.toViewPosition(n.createPositionBefore(e.item));s.insert(a,s.createText(`
`))}}function bX(n,t){const e=cd(t,"class","language"),i=t[0].language;return(s,o,r)=>{const a=o.viewItem,l=a.parent;if(!l||!l.is("element","pre")||o.modelCursor.findAncestor("codeBlock"))return;const{consumable:c,writer:u}=r;if(!c.test(a,{name:!0}))return;const d=u.createElement("codeBlock"),f=[...a.getClassNames()];f.length||f.push("");for(const m of f){const g=e[m];if(g){u.setAttribute("language",g,d);break}}d.hasAttribute("language")||u.setAttribute("language",i,d),r.convertChildren(a,d),r.safeInsert(d,o.modelCursor)&&(c.consume(a,{name:!0}),r.updateConversionResult(d,o))}}function wX(){return(n,t,{consumable:e,writer:i})=>{let s=t.modelCursor;if(!e.test(t.viewItem)||!s.findAncestor("codeBlock"))return;e.consume(t.viewItem);const r=t.viewItem.data.split(`
`).map(l=>i.createText(l)),a=r[r.length-1];for(const l of r)if(i.insert(l,s),s=s.getShiftedBy(l.offsetSize),l!==a){const c=i.createElement("softBreak");i.insert(c,s),s=i.createPositionAfter(c)}t.modelRange=i.createRange(t.modelCursor,s),t.modelCursor=s}}function _X(){return(n,t,{consumable:e})=>{const i=t.viewItem;if(i.findAncestor("pre"))return;const s=Array.from(i.getChildren()),o=s.find(r=>r.is("element","code"));if(o)for(const r of s)r===o||!r.is("$text")||e.consume(r,{name:!0})}}const aP="paragraph";class vX extends A{static get pluginName(){return"CodeBlockEditing"}static get requires(){return[QI]}constructor(t){super(t),t.config.define("codeBlock",{languages:[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"cs",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],indentSequence:"	"})}init(){const t=this.editor,e=t.model.schema,i=t.model,s=t.editing.view,o=ld(t);t.commands.add("codeBlock",new dX(t)),t.commands.add("indentCodeBlock",new fX(t)),t.commands.add("outdentCodeBlock",new mX(t)),this.listenTo(s.document,"tab",(r,a)=>{const l=a.shiftKey?"outdentCodeBlock":"indentCodeBlock";t.commands.get(l).isEnabled&&(t.execute(l),a.stopPropagation(),a.preventDefault(),r.stop())},{context:"pre"}),e.register("codeBlock",{allowWhere:"$block",allowChildren:"$text",disallowChildren:"$inlineObject",allowAttributes:["language"],allowAttributesOf:"$listItem",isBlock:!0}),e.addAttributeCheck(r=>{if(r.endsWith("codeBlock $text"))return!1}),t.editing.downcastDispatcher.on("insert:codeBlock",gv(i,o,!0)),t.data.downcastDispatcher.on("insert:codeBlock",gv(i,o)),t.data.downcastDispatcher.on("insert:softBreak",pX(i),{priority:"high"}),t.data.upcastDispatcher.on("element:code",bX(s,o)),t.data.upcastDispatcher.on("text",wX()),t.data.upcastDispatcher.on("element:pre",_X(),{priority:"high"}),this.listenTo(t.editing.view.document,"clipboardInput",(r,a)=>{let l=i.createRange(i.document.selection.anchor);if(a.targetRanges&&(l=t.editing.mapper.toModelRange(a.targetRanges[0])),!l.start.parent.is("element","codeBlock"))return;const c=a.dataTransfer.getData("text/plain"),u=new zn(t.editing.view.document);a.content=uX(u,c)}),this.listenTo(i,"getSelectedContent",(r,[a])=>{const l=a.anchor;a.isCollapsed||!l.parent.is("element","codeBlock")||!l.hasSameParentAs(a.focus)||i.change(c=>{const u=r.return;if(l.parent.is("element")&&(u.childCount>1||a.containsEntireContent(l.parent))){const f=c.createElement("codeBlock",l.parent.getAttributes());c.append(u,f);const m=c.createDocumentFragment();c.append(f,m),r.return=m;return}const d=u.getChild(0);e.checkAttribute(d,"code")&&c.setAttribute("code",!0,d)})})}afterInit(){const t=this.editor,e=t.commands,i=e.get("indent"),s=e.get("outdent");i&&i.registerChildCommand(e.get("indentCodeBlock"),{priority:"highest"}),s&&s.registerChildCommand(e.get("outdentCodeBlock")),this.listenTo(t.editing.view.document,"enter",(o,r)=>{t.model.document.selection.getLastPosition().parent.is("element","codeBlock")&&(!CX(t,r.isSoft)&&!kX(t,r.isSoft)&&yX(t),r.preventDefault(),o.stop())},{context:"pre"}),this._initAriaAnnouncements()}_initAriaAnnouncements(){const{model:t,ui:e,t:i}=this.editor,s=ld(this.editor);let o=null;t.document.selection.on("change:range",()=>{const r=t.document.selection.focus.parent;!e||o===r||!r.is("element")||(o&&o.is("element","codeBlock")&&e.ariaLiveAnnouncer.announce(fv(i,s,o,"leave")),r.is("element","codeBlock")&&e.ariaLiveAnnouncer.announce(fv(i,s,r,"enter")),o=r)})}}function yX(n){const e=n.model.document,i=e.selection.getLastPosition(),s=i.nodeBefore||i.textNode;let o;s&&s.is("$text")&&(o=Zb(s)),n.model.change(r=>{n.execute("shiftEnter"),o&&r.insertText(o,e.selection.anchor)})}function CX(n,t){const i=n.model.document,s=n.editing.view,o=i.selection.getLastPosition(),r=o.nodeAfter;return t||!i.selection.isCollapsed||!o.isAtStart||!lo(r)?!1:(n.model.change(a=>{n.execute("enter");const l=i.selection.anchor.parent.previousSibling;a.rename(l,aP),a.setSelection(l,"in"),n.model.schema.removeDisallowedAttributes([l],a),a.remove(r)}),s.scrollToTheSelection(),!0)}function kX(n,t){const e=n.model,i=e.document,s=n.editing.view,o=i.selection.getLastPosition(),r=o.nodeBefore;let a;if(t||!i.selection.isCollapsed||!o.isAtEnd||!r||!r.previousSibling)return!1;if(lo(r)&&lo(r.previousSibling))a=e.createRange(e.createPositionBefore(r.previousSibling),e.createPositionAfter(r));else if(Bf(r)&&lo(r.previousSibling)&&lo(r.previousSibling.previousSibling))a=e.createRange(e.createPositionBefore(r.previousSibling.previousSibling),e.createPositionAfter(r));else if(Bf(r)&&lo(r.previousSibling)&&Bf(r.previousSibling.previousSibling)&&r.previousSibling.previousSibling&&lo(r.previousSibling.previousSibling.previousSibling))a=e.createRange(e.createPositionBefore(r.previousSibling.previousSibling.previousSibling),e.createPositionAfter(r));else return!1;return n.model.change(l=>{l.remove(a),n.execute("enter");const c=i.selection.anchor.parent;l.rename(c,aP),n.model.schema.removeDisallowedAttributes([c],l)}),s.scrollToTheSelection(),!0}function Bf(n){return n&&n.is("$text")&&!n.data.match(/\S/)}function lo(n){return n&&n.is("element","softBreak")}class TX extends A{static get pluginName(){return"CodeBlockUI"}init(){const t=this.editor,e=t.t,i=t.ui.componentFactory,s=ld(t),o=this._getLanguageListItemDefinitions(s),r=t.commands.get("codeBlock");i.add("codeBlock",a=>{const l=Yt(a,la),c=l.buttonView,u=e("Insert code block");return c.set({label:u,tooltip:!0,icon:F.codeBlock,isToggleable:!0}),c.bind("isOn").to(r,"value",d=>!!d),c.on("execute",()=>{t.execute("codeBlock",{usePreviousLanguageChoice:!0}),t.editing.view.focus()}),l.on("execute",d=>{t.execute("codeBlock",{language:d.source._codeBlockLanguage,forceValue:!0}),t.editing.view.focus()}),l.class="ck-code-block-dropdown",l.bind("isEnabled").to(r),ca(l,o,{role:"menu",ariaLabel:u}),l}),i.add("menuBar:codeBlock",a=>{const l=new ui(a);l.buttonView.set({label:e("Code block"),icon:F.codeBlock}),l.bind("isEnabled").to(r);const c=new qr(a);c.set({ariaLabel:e("Insert code block")});for(const u of o){const d=new ua(a,l),f=new pt(a);f.bind(...Object.keys(u.model)).to(u.model),f.bind("ariaChecked").to(f,"isOn"),f.delegate("execute").to(l),f.on("execute",()=>{t.execute("codeBlock",{language:u.model._codeBlockLanguage,forceValue:r.value!=u.model._codeBlockLanguage}),t.editing.view.focus()}),d.children.add(f),c.items.add(d)}return l.panelView.children.add(c),l})}_getLanguageListItemDefinitions(t){const i=this.editor.commands.get("codeBlock"),s=new rn;for(const o of t){const r={type:"button",model:new Wr({_codeBlockLanguage:o.language,label:o.label,role:"menuitemradio",withText:!0})};r.model.bind("isOn").to(i,"value",a=>a===r.model._codeBlockLanguage),s.add(r)}return s}}class EX extends A{static get requires(){return[vX,TX]}static get pluginName(){return"CodeBlock"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AX extends FZ{constructor(e,i){super(e);h(this,"view");h(this,"_toolbarConfig");h(this,"_elementReplacer");this.view=i,this._toolbarConfig=Nb(e.config.get("toolbar")),this._elementReplacer=new XS,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const i=this.editor,s=this.view,o=i.editing.view,r=s.editable,a=o.document.getRoot();r.name=a.rootName,s.render();const l=r.element;this.setEditableElement(r.name,l),s.editable.bind("isFocused").to(this.focusTracker),o.attachDomRoot(l),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),s.menuBarView&&lJ(i,s.menuBarView),this._initDialogPluginIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,i=this.editor.editing.view;this._elementReplacer.restore(),i.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:i})=>i||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,i=e.editing.view,s=i.document.getRoot(),o=e.sourceElement;let r;const a=e.config.get("placeholder");a&&(r=typeof a=="string"?a:a[this.view.editable.name]),!r&&o&&o.tagName.toLowerCase()==="textarea"&&(r=o.getAttribute("placeholder")),r&&(s.placeholder=r),vb({view:i,element:s,isDirectHost:!1,keepOnFocus:!0})}_handleScrollToTheSelectionWithStickyPanel(e,i,s){const o=this.view.stickyPanel;if(o.isSticky){const r=new he(o.element).height;i.viewportOffset.top+=r}else{const r=()=>{this.editor.editing.view.scrollToTheSelection(s)};this.listenTo(o,"change:isSticky",r),setTimeout(()=>{this.stopListening(o,"change:isSticky",r)},20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,i=this.editor.plugins.get("Dialog");i.on("show",()=>{const s=i.view;s.on("moveTo",(o,r)=>{if(!e.isSticky||s.wasMoved)return;const a=new he(e.contentPanelElement);r[1]<a.bottom+Sl.defaultOffset&&(r[1]=a.bottom+Sl.defaultOffset)},{priority:"high"})},{priority:"low"})}}class xX extends $Z{constructor(e,i,s={}){super(e);h(this,"stickyPanel");h(this,"toolbar");h(this,"menuBarView");h(this,"editable");this.stickyPanel=new qZ(e),this.toolbar=new Ro(e,{shouldGroupWhenFull:s.shouldToolbarGroupWhenFull}),s.useMenuBar&&(this.menuBarView=new uJ(e)),this.editable=new zZ(e,i)}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class SX extends qm(mr){constructor(e,i={}){if(!bu(e)&&i.initialData!==void 0)throw new C("editor-create-initial-data",null);super(i);h(this,"ui");this.config.define("menuBar.isVisible",!1),this.config.get("initialData")===void 0&&this.config.set("initialData",IX(e)),bu(e)&&(this.sourceElement=e),this.model.document.createRoot();const s=!this.config.get("toolbar.shouldNotGroupWhenFull"),o=this.config.get("menuBar"),r=new xX(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:s,useMenuBar:o.isVisible});this.ui=new AX(this,r),Mj(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,i={}){return new Promise(s=>{const o=new this(e,i);s(o.initPlugins().then(()=>o.ui.init(bu(e)?e:null)).then(()=>o.data.init(o.config.get("initialData"))).then(()=>o.fire("ready")).then(()=>o))})}}function IX(n){return bu(n)?GH(n):n}function bu(n){return Xi(n)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PX extends ne{constructor(t){super(t),this.affectsData=!1}execute(){const t=this.editor.model,e=t.document.selection;let i=t.schema.getLimitElement(e);if(e.containsEntireContent(i)||!pv(t.schema,i))do if(i=i.parent,!i)return;while(!pv(t.schema,i));t.change(s=>{s.setSelection(i,"in")})}}function pv(n,t){return n.isLimit(t)&&(n.checkChild(t,"$text")||n.checkChild(t,"paragraph"))}const RX=Th("Ctrl+A");class LX extends A{static get pluginName(){return"SelectAllEditing"}init(){const t=this.editor,e=t.t,s=t.editing.view.document;t.commands.add("selectAll",new PX(t)),this.listenTo(s,"keydown",(o,r)=>{Po(r)===RX&&(t.execute("selectAll"),r.preventDefault())}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Select all"),keystroke:"CTRL+A"}]})}}var VX='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>';class BX extends A{static get pluginName(){return"SelectAllUI"}init(){const t=this.editor;t.ui.componentFactory.add("selectAll",()=>{const e=this._createButton(te);return e.set({tooltip:!0}),e}),t.ui.componentFactory.add("menuBar:selectAll",()=>this._createButton(pt))}_createButton(t){const e=this.editor,i=e.locale,s=e.commands.get("selectAll"),o=new t(e.locale),r=i.t;return o.set({label:r("Select all"),icon:VX,keystroke:"Ctrl+A"}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("selectAll"),e.editing.view.focus()}),o}}class lP extends A{static get requires(){return[LX,BX]}static get pluginName(){return"SelectAll"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class cP extends ne{constructor(e){super(e);h(this,"_stack",[]);h(this,"_createdBatches",new WeakSet);this.refresh(),this._isEnabledBasedOnSelection=!1,this.listenTo(e.data,"set",(i,s)=>{s[1]={...s[1]};const o=s[1];o.batchType||(o.batchType={isUndoable:!1})},{priority:"high"}),this.listenTo(e.data,"set",(i,s)=>{s[1].batchType.isUndoable||this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}get createdBatches(){return this._createdBatches}addBatch(e){const i=this.editor.model.document.selection,s={ranges:i.hasOwnRange?Array.from(i.getRanges()):[],isBackward:i.isBackward};this._stack.push({batch:e,selection:s}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,i,s){const o=this.editor.model,r=o.document,a=[],l=e.map(u=>u.getTransformedByOperations(s)),c=l.flat();for(const u of l){const d=u.filter(f=>f.root!=r.graveyard).filter(f=>!OX(f,c));d.length&&(MX(d),a.push(d[0]))}a.length&&o.change(u=>{u.setSelection(a,{backward:i})})}_undo(e,i){const s=this.editor.model,o=s.document;this._createdBatches.add(i);const r=e.operations.slice().filter(a=>a.isDocumentOperation);r.reverse();for(const a of r){const l=a.baseVersion+1,c=Array.from(o.history.getOperations(l)),d=fq([a.getReversed()],c,{useRelations:!0,document:this.editor.model.document,padWithNoOps:!1,forceWeakRemove:!0}).operationsA;for(let f of d){const m=f.affectedSelectable;m&&!s.canEditAt(m)&&(f=new Ct(f.baseVersion)),i.addOperation(f),s.applyOperation(f),o.history.setOperationAsUndone(a,f)}}}}function MX(n){n.sort((t,e)=>t.start.isBefore(e.start)?-1:1);for(let t=1;t<n.length;t++){const i=n[t-1].getJoined(n[t],!0);i&&(t--,n.splice(t,2,i))}}function OX(n,t){return t.some(e=>e!==n&&e.containsRange(n,!0))}class NX extends cP{execute(t=null){const e=t?this._stack.findIndex(o=>o.batch==t):this._stack.length-1,i=this._stack.splice(e,1)[0],s=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(s,()=>{this._undo(i.batch,s);const o=this.editor.model.document.history.getOperations(i.batch.baseVersion);this._restoreSelection(i.selection.ranges,i.selection.isBackward,o)}),this.fire("revert",i.batch,s),this.refresh()}}class FX extends cP{execute(){const t=this._stack.pop(),e=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(e,()=>{const s=t.batch.operations[t.batch.operations.length-1].baseVersion+1,o=this.editor.model.document.history.getOperations(s);this._restoreSelection(t.selection.ranges,t.selection.isBackward,o),this._undo(t.batch,e)}),this.refresh()}}class DX extends A{constructor(){super(...arguments);h(this,"_undoCommand");h(this,"_redoCommand");h(this,"_batchRegistry",new WeakSet)}static get pluginName(){return"UndoEditing"}init(){const e=this.editor,i=e.t;this._undoCommand=new NX(e),this._redoCommand=new FX(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(s,o)=>{const r=o[0];if(!r.isDocumentOperation)return;const a=r.batch,l=this._redoCommand.createdBatches.has(a),c=this._undoCommand.createdBatches.has(a);this._batchRegistry.has(a)||(this._batchRegistry.add(a),a.isUndoable&&(l?this._undoCommand.addBatch(a):c||(this._undoCommand.addBatch(a),this._redoCommand.clearStack())))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(s,o,r)=>{this._redoCommand.addBatch(r)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:i("Undo"),keystroke:"CTRL+Z"},{label:i("Redo"),keystroke:[["CTRL+Y"],["CTRL+SHIFT+Z"]]}]})}}class $X extends A{static get pluginName(){return"UndoUI"}init(){const t=this.editor,e=t.locale,i=t.t,s=e.uiLanguageDirection=="ltr"?F.undo:F.redo,o=e.uiLanguageDirection=="ltr"?F.redo:F.undo;this._addButtonsToFactory("undo",i("Undo"),"CTRL+Z",s),this._addButtonsToFactory("redo",i("Redo"),"CTRL+Y",o)}_addButtonsToFactory(t,e,i,s){const o=this.editor;o.ui.componentFactory.add(t,()=>{const r=this._createButton(te,t,e,i,s);return r.set({tooltip:!0}),r}),o.ui.componentFactory.add("menuBar:"+t,()=>this._createButton(pt,t,e,i,s))}_createButton(t,e,i,s,o){const r=this.editor,a=r.locale,l=r.commands.get(e),c=new t(a);return c.set({label:i,icon:o,keystroke:s}),c.bind("isEnabled").to(l,"isEnabled"),this.listenTo(c,"execute",()=>{r.execute(e),r.editing.view.focus()}),c}}class Nh extends A{static get requires(){return[DX,$X]}static get pluginName(){return"Undo"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class HX extends A{static get requires(){return[kI,Gb,lc,lP,QI,SJ,Nh]}static get pluginName(){return"Essentials"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class zX extends ne{constructor(t){super(t),this._isEnabledBasedOnSelection=!1}refresh(){const t=this.editor.model,e=t.document,i=Ye(e.selection.getSelectedBlocks());this.value=!!i&&i.is("element","paragraph"),this.isEnabled=!!i&&bv(i,t.schema)}execute(t={}){const e=this.editor.model,i=e.document,s=t.selection||i.selection;e.canEditAt(s)&&e.change(o=>{const r=s.getSelectedBlocks();for(const a of r)!a.is("element","paragraph")&&bv(a,e.schema)&&o.rename(a,"paragraph")})}}function bv(n,t){return t.checkChild(n.parent,"paragraph")&&!t.isObject(n)}class UX extends ne{constructor(t){super(t),this._isEnabledBasedOnSelection=!1}execute(t){const e=this.editor.model,i=t.attributes;let s=t.position;e.canEditAt(s)&&e.change(o=>{if(s=this._findPositionToInsertParagraph(s,o),!s)return;const r=o.createElement("paragraph");i&&e.schema.setAllowedAttributes(r,i,o),e.insertContent(r,s),o.setSelection(r,"in")})}_findPositionToInsertParagraph(t,e){const i=this.editor.model;if(i.schema.checkChild(t,"paragraph"))return t;const s=i.schema.findAllowedParent(t,"paragraph");if(!s)return null;const o=t.parent,r=i.schema.checkChild(o,"$text");return o.isEmpty||r&&t.isAtEnd?i.createPositionAfter(o):!o.isEmpty&&r&&t.isAtStart?i.createPositionBefore(o):e.split(t,s).position}}const xd=class xd extends A{static get pluginName(){return"Paragraph"}init(){const t=this.editor,e=t.model;t.commands.add("paragraph",new zX(t)),t.commands.add("insertParagraph",new UX(t)),e.schema.register("paragraph",{inheritAllFrom:"$block"}),t.conversion.elementToElement({model:"paragraph",view:"p"}),t.conversion.for("upcast").elementToElement({model:(i,{writer:s})=>!xd.paragraphLikeElements.has(i.name)||i.isEmpty?null:s.createElement("paragraph"),view:/.+/,converterPriority:"low"})}};h(xd,"paragraphLikeElements",new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]));let ud=xd;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class WX extends ne{constructor(e,i){super(e);h(this,"modelElements");this.modelElements=i}refresh(){const e=Ye(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(i=>wv(e,i,this.editor.model.schema))}execute(e){const i=this.editor.model,s=i.document,o=e.value;i.change(r=>{const a=Array.from(s.selection.getSelectedBlocks()).filter(l=>wv(l,o,i.schema));for(const l of a)l.is("element",o)||r.rename(l,o)})}}function wv(n,t,e){return e.checkChild(n.parent,t)&&!e.isObject(n)}const _v="paragraph";class qX extends A{static get pluginName(){return"HeadingEditing"}constructor(t){super(t),t.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[ud]}init(){const t=this.editor,e=t.config.get("heading.options"),i=[];for(const s of e)s.model!=="paragraph"&&(t.model.schema.register(s.model,{inheritAllFrom:"$block"}),t.conversion.elementToElement(s),i.push(s.model));this._addDefaultH1Conversion(t),t.commands.add("heading",new WX(t,i))}afterInit(){const t=this.editor,e=t.commands.get("enter"),i=t.config.get("heading.options");e&&this.listenTo(e,"afterExecute",(s,o)=>{const r=t.model.document.selection.getFirstPosition().parent;i.some(l=>r.is("element",l.model))&&!r.is("element",_v)&&r.childCount===0&&o.writer.rename(r,_v)})}_addDefaultH1Conversion(t){t.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:Pn.low+1})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function jX(n){const t=n.t,e={Paragraph:t("Paragraph"),"Heading 1":t("Heading 1"),"Heading 2":t("Heading 2"),"Heading 3":t("Heading 3"),"Heading 4":t("Heading 4"),"Heading 5":t("Heading 5"),"Heading 6":t("Heading 6")};return n.config.get("heading.options").map(i=>{const s=e[i.title];return s&&s!=i.title&&(i.title=s),i})}class GX extends A{static get pluginName(){return"HeadingUI"}init(){const t=this.editor,e=t.t,i=jX(t),s=e("Choose heading"),o=e("Heading");t.ui.componentFactory.add("heading",r=>{const a={},l=new rn,c=t.commands.get("heading"),u=t.commands.get("paragraph"),d=[c];for(const m of i){const g={type:"button",model:new Wr({label:m.title,class:m.class,role:"menuitemradio",withText:!0})};m.model==="paragraph"?(g.model.bind("isOn").to(u,"value"),g.model.set("commandName","paragraph"),d.push(u)):(g.model.bind("isOn").to(c,"value",p=>p===m.model),g.model.set({commandName:"heading",commandValue:m.model})),l.add(g),a[m.model]=m.title}const f=Yt(r);return ca(f,l,{ariaLabel:o,role:"menu"}),f.buttonView.set({ariaLabel:o,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:o}),f.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),f.bind("isEnabled").toMany(d,"isEnabled",(...m)=>m.some(g=>g)),f.buttonView.bind("label").to(c,"value",u,"value",(m,g)=>{const p=g?"paragraph":m;return typeof p=="boolean"||!a[p]?s:a[p]}),f.buttonView.bind("ariaLabel").to(c,"value",u,"value",(m,g)=>{const p=g?"paragraph":m;return typeof p=="boolean"||!a[p]?o:`${a[p]}, ${o}`}),this.listenTo(f,"execute",m=>{const{commandName:g,commandValue:p}=m.source;t.execute(g,p?{value:p}:void 0),t.editing.view.focus()}),f}),t.ui.componentFactory.add("menuBar:heading",r=>{const a=new ui(r),l=t.commands.get("heading"),c=t.commands.get("paragraph"),u=[l],d=new qr(r);a.set({class:"ck-heading-dropdown"}),d.set({ariaLabel:e("Heading"),role:"menu"}),a.buttonView.set({label:e("Heading")}),a.panelView.children.add(d);for(const f of i){const m=new ua(r,a),g=new pt(r);m.children.add(g),d.items.add(m),g.set({label:f.title,role:"menuitemradio",class:f.class}),g.bind("ariaChecked").to(g,"isOn"),g.delegate("execute").to(a),g.on("execute",()=>{const p=f.model==="paragraph"?"paragraph":"heading";t.execute(p,{value:f.model}),t.editing.view.focus()}),f.model==="paragraph"?(g.bind("isOn").to(c,"value"),u.push(c)):g.bind("isOn").to(l,"value",p=>p===f.model)}return a.bind("isEnabled").toMany(u,"isEnabled",(...f)=>f.some(m=>m)),a})}}class KX extends A{static get requires(){return[qX,GX]}static get pluginName(){return"Heading"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ZX extends ne{refresh(){const t=this.editor.model,e=t.schema,i=t.document.selection;this.isEnabled=JX(i,e,t)}execute(){const t=this.editor.model;t.change(e=>{const i=e.createElement("horizontalLine");t.insertObject(i,null,null,{setSelection:"after"})})}}function JX(n,t,e){const i=YX(n,e);return t.checkChild(i,"horizontalLine")}function YX(n,t){const i=cc(n,t).start.parent;return i.isEmpty&&!i.is("element","$root")?i.parent:i}class XX extends A{static get pluginName(){return"HorizontalLineEditing"}init(){const t=this.editor,e=t.model.schema,i=t.t,s=t.conversion;e.register("horizontalLine",{inheritAllFrom:"$blockObject"}),s.for("dataDowncast").elementToElement({model:"horizontalLine",view:(o,{writer:r})=>r.createEmptyElement("hr")}),s.for("editingDowncast").elementToStructure({model:"horizontalLine",view:(o,{writer:r})=>{const a=i("Horizontal line"),l=r.createContainerElement("div",null,r.createEmptyElement("hr"));return r.addClass("ck-horizontal-line",l),r.setCustomProperty("hr",!0,l),QX(l,r,a)}}),s.for("upcast").elementToElement({view:"hr",model:"horizontalLine"}),t.commands.add("horizontalLine",new ZX(t))}}function QX(n,t,e){return t.setCustomProperty("horizontalLine",!0,n),Xs(n,t,{label:e})}class eQ extends A{static get pluginName(){return"HorizontalLineUI"}init(){const t=this.editor;t.ui.componentFactory.add("horizontalLine",()=>{const e=this._createButton(te);return e.set({tooltip:!0}),e}),t.ui.componentFactory.add("menuBar:horizontalLine",()=>this._createButton(pt))}_createButton(t){const e=this.editor,i=e.locale,s=e.commands.get("horizontalLine"),o=new t(e.locale),r=i.t;return o.set({label:r("Horizontal line"),icon:F.horizontalLine}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("horizontalLine"),e.editing.view.focus()}),o}}class tQ extends A{static get requires(){return[XX,eQ,ms]}static get pluginName(){return"HorizontalLine"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nQ extends ne{refresh(){const t=this.editor.model,e=t.schema,i=t.document.selection,s=vv(i);this.isEnabled=iQ(i,e,t),this.value=s?s.getAttribute("value")||"":null}execute(t){const e=this.editor.model,i=e.document.selection;e.change(s=>{let o;this.value!==null?o=vv(i):(o=s.createElement("rawHtml"),e.insertObject(o,null,null,{setSelection:"on"})),s.setAttribute("value",t,o)})}}function iQ(n,t,e){const i=sQ(n,e);return t.checkChild(i,"rawHtml")}function sQ(n,t){const i=cc(n,t).start.parent;return i.isEmpty&&!i.is("rootElement")?i.parent:i}function vv(n){const t=n.getSelectedElement();return t&&t.is("element","rawHtml")?t:null}class oQ extends A{constructor(e){super(e);h(this,"_widgetButtonViewReferences",new Set);e.config.define("htmlEmbed",{showPreviews:!1,sanitizeHtml:i=>(Te("html-embed-provide-sanitize-function"),{html:i,hasChanged:!1})})}static get pluginName(){return"HtmlEmbedEditing"}init(){const e=this.editor;e.model.schema.register("rawHtml",{inheritAllFrom:"$blockObject",allowAttributes:["value"]}),e.commands.add("htmlEmbed",new nQ(e)),this._setupConversion()}_setupConversion(){const e=this.editor,i=e.t,s=e.editing.view,o=this._widgetButtonViewReferences,r=e.config.get("htmlEmbed");this.editor.editing.view.on("render",()=>{for(const d of o){if(d.element&&d.element.isConnected)return;d.destroy(),o.delete(d)}},{priority:"lowest"}),e.data.registerRawContentMatcher({name:"div",classes:"raw-html-embed"}),e.conversion.for("upcast").elementToElement({view:{name:"div",classes:"raw-html-embed"},model:(d,{writer:f})=>f.createElement("rawHtml",{value:d.getCustomProperty("$rawContent")})}),e.conversion.for("dataDowncast").elementToElement({model:"rawHtml",view:(d,{writer:f})=>f.createRawElement("div",{class:"raw-html-embed"},function(m){m.innerHTML=d.getAttribute("value")||""})}),e.conversion.for("editingDowncast").elementToStructure({model:{name:"rawHtml",attributes:["value"]},view:(d,{writer:f})=>{let m,g,p;const w=f.createRawElement("div",{class:"raw-html-embed__content-wrapper"},function(y){m=y,a({editor:e,domElement:y,state:g,props:p}),m.addEventListener("mousedown",()=>{if(g.isEditable){const E=e.model;E.document.selection.getSelectedElement()!==d&&E.change(S=>S.setSelection(d,"on"))}},!0)}),v={makeEditable(){g=Object.assign({},g,{isEditable:!0}),a({domElement:m,editor:e,state:g,props:p}),s.change(y=>{y.setAttribute("data-cke-ignore-events","true",w)}),m.querySelector("textarea").focus()},save(y){y!==g.getRawHtmlValue()?(e.execute("htmlEmbed",y),e.editing.view.focus()):this.cancel()},cancel(){g=Object.assign({},g,{isEditable:!1}),a({domElement:m,editor:e,state:g,props:p}),e.editing.view.focus(),s.change(y=>{y.removeAttribute("data-cke-ignore-events",w)})}};g={showPreviews:r.showPreviews,isEditable:!1,getRawHtmlValue:()=>d.getAttribute("value")||""},p={sanitizeHtml:r.sanitizeHtml,textareaPlaceholder:i("Paste raw HTML here..."),onEditClick(){v.makeEditable()},onSaveClick(y){v.save(y)},onCancelClick(){v.cancel()}};const _=f.createContainerElement("div",{class:"raw-html-embed","data-html-embed-label":i("HTML snippet"),dir:e.locale.uiLanguageDirection},w);return f.setCustomProperty("rawHtmlApi",v,_),f.setCustomProperty("rawHtml",!0,_),Xs(_,f,{label:i("HTML snippet"),hasSelectionHandle:!0})}});function a({editor:d,domElement:f,state:m,props:g}){f.textContent="";const p=f.ownerDocument;let w;if(m.isEditable){const _={isDisabled:!1,placeholder:g.textareaPlaceholder};w=c({domDocument:p,state:m,props:_}),f.append(w)}else if(m.showPreviews){const _={sanitizeHtml:g.sanitizeHtml};f.append(u({domDocument:p,state:m,props:_,editor:d}))}else{const _={isDisabled:!0,placeholder:g.textareaPlaceholder};f.append(c({domDocument:p,state:m,props:_}))}const v={onEditClick:g.onEditClick,onSaveClick:()=>{g.onSaveClick(w.value)},onCancelClick:g.onCancelClick};f.prepend(l({editor:d,domDocument:p,state:m,props:v}))}function l({editor:d,domDocument:f,state:m,props:g}){const p=xt(f,"div",{class:"raw-html-embed__buttons-wrapper"});if(m.isEditable){const w=Mf(d,"save",g.onSaveClick),v=Mf(d,"cancel",g.onCancelClick);p.append(w.element,v.element),o.add(w).add(v)}else{const w=Mf(d,"edit",g.onEditClick);p.append(w.element),o.add(w)}return p}function c({domDocument:d,state:f,props:m}){const g=xt(d,"textarea",{placeholder:m.placeholder,class:"ck ck-reset ck-input ck-input-text raw-html-embed__source"});return g.disabled=m.isDisabled,g.value=f.getRawHtmlValue(),g}function u({editor:d,domDocument:f,state:m,props:g}){const p=g.sanitizeHtml(m.getRawHtmlValue()),w=m.getRawHtmlValue().length>0?i("No preview available"):i("Empty snippet content"),v=xt(f,"div",{class:"ck ck-reset_all raw-html-embed__preview-placeholder"},w),_=xt(f,"div",{class:"raw-html-embed__preview-content",dir:d.locale.contentLanguageDirection}),E=f.createRange().createContextualFragment(p.html);return _.appendChild(E),xt(f,"div",{class:"raw-html-embed__preview"},[v,_])}}}function Mf(n,t,e){const{t:i}=n.locale,s=new te(n.locale),o=n.commands.get("htmlEmbed");return s.set({class:`raw-html-embed__${t}-button`,icon:F.pencil,tooltip:!0,tooltipPosition:n.locale.uiLanguageDirection==="rtl"?"e":"w"}),s.render(),t==="edit"?(s.set({icon:F.pencil,label:i("Edit source")}),s.bind("isEnabled").to(o)):t==="save"?(s.set({icon:F.check,label:i("Save changes")}),s.bind("isEnabled").to(o)):s.set({icon:F.cancel,label:i("Cancel")}),s.on("execute",e),s}class rQ extends A{static get pluginName(){return"HtmlEmbedUI"}init(){const t=this.editor,i=t.locale.t;t.ui.componentFactory.add("htmlEmbed",()=>{const s=this._createButton(te);return s.set({tooltip:!0,label:i("Insert HTML")}),s}),t.ui.componentFactory.add("menuBar:htmlEmbed",()=>{const s=this._createButton(pt);return s.set({label:i("HTML snippet")}),s})}_createButton(t){const e=this.editor,i=e.commands.get("htmlEmbed"),s=new t(e.locale);return s.set({icon:F.html}),s.bind("isEnabled").to(i,"isEnabled"),this.listenTo(s,"execute",()=>{e.execute("htmlEmbed"),e.editing.view.focus(),e.editing.view.document.selection.getSelectedElement().getCustomProperty("rawHtmlApi").makeEditable()}),s}}class aQ extends A{static get requires(){return[oQ,rQ,ms]}static get pluginName(){return"HtmlEmbed"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Lo(n,t,e,i){t&&lQ(n,t,i),e&&Ai(n,e,i)}function Ai(n,t,e){if(t.attributes)for(const[i,s]of Object.entries(t.attributes))n.setAttribute(i,s,e);t.styles&&n.setStyle(t.styles,e),t.classes&&n.addClass(t.classes,e)}function lQ(n,t,e){if(t.attributes)for(const[i]of Object.entries(t.attributes))n.removeAttribute(i,e);if(t.styles)for(const i of Object.keys(t.styles))n.removeStyle(i,e);t.classes&&n.removeClass(t.classes,e)}function cQ(n,t){const e=kn(n);let i="attributes";for(i in t)i=="classes"?e[i]=Array.from(new Set([...n[i]||[],...t[i]])):e[i]={...n[i],...t[i]};return e}function ar(n,t,e,i,s){const o=t.getAttribute(e),r={};for(const a of["attributes","styles","classes"]){if(a!=i){o&&o[a]&&(r[a]=o[a]);continue}if(i=="classes"){const c=new Set(o&&o.classes||[]);s(c),c.size&&(r[a]=Array.from(c));continue}const l=new Map(Object.entries(o&&o[a]||{}));s(l),l.size&&(r[a]=Object.fromEntries(l))}Object.keys(r).length?t.is("documentSelection")?n.setSelectionAttribute(e,r):n.setAttribute(e,r,t):o&&(t.is("documentSelection")?n.removeSelectionAttribute(e):n.removeAttribute(e,t))}function uQ(n){return cb(n).replace(/ /g,"")}function Zn(n){return`html${uQ(n)}Attributes`}function Jb({model:n}){return(t,e)=>e.writer.createElement(n,{htmlContent:t.getCustomProperty("$rawContent")})}function dQ(n,{view:t,isInline:e}){const i=n.t;return(s,{writer:o})=>{const r=i("HTML object"),a=Fh(t,s,o),l=s.getAttribute(Zn(t));o.addClass("html-object-embed__content",a),l&&Ai(o,l,a);const c=o.createContainerElement(e?"span":"div",{class:"html-object-embed","data-html-object-embed-label":r},a);return Xs(c,o,{label:r})}}function Fh(n,t,e){return e.createRawElement(n,null,(i,s)=>{s.setContentOf(i,t.getAttribute("htmlContent"))})}function hQ({view:n,model:t,allowEmpty:e},i){return o=>{o.on(`element:${n}`,(r,a,l)=>{let c=i.processViewAttributes(a.viewItem,l);if(!(!c&&!l.consumable.test(a.viewItem,{name:!0}))){if(c=c||{},l.consumable.consume(a.viewItem,{name:!0}),a.modelRange||(a=Object.assign(a,l.convertChildren(a.viewItem,a.modelCursor))),e&&a.modelRange.isCollapsed&&Object.keys(c).length){const u=l.writer.createElement("htmlEmptyElement");if(!l.safeInsert(u,a.modelCursor))return;const d=l.getSplitParts(u);a.modelRange=l.writer.createRange(a.modelRange.start,l.writer.createPositionAfter(d[d.length-1])),l.updateConversionResult(u,a),s(u,c,l);return}for(const u of a.modelRange.getItems())s(u,c,l)}},{priority:"low"})};function s(o,r,a){if(a.schema.checkAttribute(o,t)){const l=o.getAttribute(t),c=cQ(r,l||{});a.writer.setAttribute(t,c,o)}}}function yv({model:n,view:t},e){return(i,{writer:s,consumable:o})=>{if(!i.hasAttribute(n))return null;const r=s.createContainerElement(t),a=i.getAttribute(n);return o.consume(i,`attribute:${n}`),Ai(s,a,r),r.getFillerOffset=()=>null,e?Xs(r,s):r}}function fQ({priority:n,view:t}){return(e,i)=>{if(!e)return;const{writer:s}=i,o=s.createAttributeElement(t,null,{priority:n});return Ai(s,e,o),o}}function Rl({view:n},t){return e=>{e.on(`element:${n}`,(i,s,o)=>{if(!s.modelRange||s.modelRange.isCollapsed)return;const r=t.processViewAttributes(s.viewItem,o);r&&o.writer.setAttribute(Zn(s.viewItem.name),r,s.modelRange)},{priority:"low"})}}function Ll({view:n,model:t}){return e=>{e.on(`attribute:${Zn(n)}:${t}`,(i,s,o)=>{if(!o.consumable.consume(s.item,i.name))return;const{attributeOldValue:r,attributeNewValue:a}=s,l=o.writer,c=o.mapper.toViewElement(s.item);Lo(l,r,a,c)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */var Cv={block:[{model:"codeBlock",view:"pre"},{model:"paragraph",view:"p"},{model:"blockQuote",view:"blockquote"},{model:"listItem",view:"li"},{model:"pageBreak",view:"div"},{model:"rawHtml",view:"div"},{model:"table",view:"table"},{model:"tableRow",view:"tr"},{model:"tableCell",view:"td"},{model:"tableCell",view:"th"},{model:"tableColumnGroup",view:"colgroup"},{model:"tableColumn",view:"col"},{model:"caption",view:"caption"},{model:"caption",view:"figcaption"},{model:"imageBlock",view:"img"},{model:"imageInline",view:"img"},{model:"htmlP",view:"p",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlBlockquote",view:"blockquote",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlTable",view:"table",modelSchema:{allowWhere:"$block",isBlock:!0}},{model:"htmlTbody",view:"tbody",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlThead",view:"thead",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlTfoot",view:"tfoot",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlCaption",view:"caption",modelSchema:{allowIn:"htmlTable",allowChildren:"$text",isBlock:!1}},{model:"htmlColgroup",view:"colgroup",modelSchema:{allowIn:"htmlTable",allowChildren:"col",isBlock:!1}},{model:"htmlCol",view:"col",modelSchema:{allowIn:"htmlColgroup",isBlock:!1}},{model:"htmlTr",view:"tr",modelSchema:{allowIn:["htmlTable","htmlThead","htmlTbody"],isLimit:!0}},{model:"htmlTd",view:"td",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlTh",view:"th",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlFigure",view:"figure",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFigcaption",view:"figcaption",modelSchema:{allowIn:"htmlFigure",allowChildren:"$text",isBlock:!1}},{model:"htmlAddress",view:"address",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlAside",view:"aside",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlMain",view:"main",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDetails",view:"details",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSummary",view:"summary",modelSchema:{allowChildren:"$text",allowIn:"htmlDetails",isBlock:!1}},{model:"htmlDiv",view:"div",paragraphLikeModel:"htmlDivParagraph",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlFieldset",view:"fieldset",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlLegend",view:"legend",modelSchema:{allowIn:"htmlFieldset",allowChildren:"$text"}},{model:"htmlHeader",view:"header",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFooter",view:"footer",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlForm",view:"form",modelSchema:{inheritAllFrom:"$container",isBlock:!0}},{model:"htmlHgroup",view:"hgroup",modelSchema:{allowChildren:["htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6"],isBlock:!1}},{model:"htmlH1",view:"h1",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH2",view:"h2",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH3",view:"h3",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH4",view:"h4",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH5",view:"h5",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH6",view:"h6",modelSchema:{inheritAllFrom:"$block"}},{model:"$htmlList",modelSchema:{allowWhere:"$container",allowChildren:["$htmlList","htmlLi"],isBlock:!1}},{model:"htmlDir",view:"dir",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlMenu",view:"menu",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlUl",view:"ul",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlOl",view:"ol",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlLi",view:"li",modelSchema:{allowIn:"$htmlList",allowChildren:"$text",isBlock:!1}},{model:"htmlPre",view:"pre",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlArticle",view:"article",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSection",view:"section",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlNav",view:"nav",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDivDl",view:"div",modelSchema:{allowChildren:["htmlDt","htmlDd"],allowIn:"htmlDl"}},{model:"htmlDl",view:"dl",modelSchema:{allowWhere:"$container",allowChildren:["htmlDt","htmlDd","htmlDivDl"],isBlock:!1}},{model:"htmlDt",view:"dt",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlDd",view:"dd",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlCenter",view:"center",modelSchema:{inheritAllFrom:"$container",isBlock:!1}}],inline:[{model:"htmlLiAttributes",view:"li",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlOlAttributes",view:"ol",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlUlAttributes",view:"ul",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"table"},{model:"htmlTheadAttributes",view:"thead",appliesToBlock:"table"},{model:"htmlTbodyAttributes",view:"tbody",appliesToBlock:"table"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"imageBlock"},{model:"htmlAcronym",view:"acronym",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTt",view:"tt",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlFont",view:"font",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTime",view:"time",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlVar",view:"var",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBig",view:"big",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSmall",view:"small",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSamp",view:"samp",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlQ",view:"q",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlOutput",view:"output",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlKbd",view:"kbd",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdi",view:"bdi",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdo",view:"bdo",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlAbbr",view:"abbr",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlA",view:"a",priority:5,coupledAttribute:"linkHref"},{model:"htmlStrong",view:"strong",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlB",view:"b",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlI",view:"i",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlEm",view:"em",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlS",view:"s",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDel",view:"del",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlIns",view:"ins",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlU",view:"u",coupledAttribute:"underline",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSub",view:"sub",coupledAttribute:"subscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSup",view:"sup",coupledAttribute:"superscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCode",view:"code",coupledAttribute:"code",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlMark",view:"mark",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSpan",view:"span",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCite",view:"cite",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlLabel",view:"label",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDfn",view:"dfn",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlObject",view:"object",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlIframe",view:"iframe",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlInput",view:"input",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlButton",view:"button",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlTextarea",view:"textarea",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlSelect",view:"select",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlVideo",view:"video",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlEmbed",view:"embed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlOembed",view:"oembed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlAudio",view:"audio",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlImg",view:"img",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlCanvas",view:"canvas",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlMeter",view:"meter",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlProgress",view:"progress",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlScript",view:"script",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlStyle",view:"style",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlCustomElement",view:"$customElement",modelSchema:{allowWhere:["$text","$block"],allowAttributesOf:"$inlineObject",isInline:!0}}]};class jr extends A{constructor(){super(...arguments);h(this,"_definitions",[])}static get pluginName(){return"DataSchema"}init(){for(const e of Cv.block)this.registerBlockElement(e);for(const e of Cv.inline)this.registerInlineElement(e)}registerBlockElement(e){this._definitions.push({...e,isBlock:!0})}registerInlineElement(e){this._definitions.push({...e,isInline:!0})}extendBlockElement(e){this._extendDefinition({...e,isBlock:!0})}extendInlineElement(e){this._extendDefinition({...e,isInline:!0})}getDefinitionsForView(e,i=!1){const s=new Set;for(const o of this._getMatchingViewDefinitions(e)){if(i)for(const r of this._getReferences(o.model))s.add(r);s.add(o)}return s}getDefinitionsForModel(e){return this._definitions.filter(i=>i.model==e)}_getMatchingViewDefinitions(e){return this._definitions.filter(i=>i.view&&mQ(e,i.view))}*_getReferences(e){const i=["inheritAllFrom","inheritTypesFrom","allowWhere","allowContentOf","allowAttributesOf"],s=this._definitions.filter(o=>o.model==e);for(const{modelSchema:o}of s)if(o)for(const r of i)for(const a of Pe(o[r]||[])){const l=this._definitions.filter(c=>c.model==a);for(const c of l)a!==e&&(yield*this._getReferences(c.model),yield c)}}_extendDefinition(e){const i=Array.from(this._definitions.entries()).filter(([,s])=>s.model==e.model);if(i.length==0){this._definitions.push(e);return}for(const[s,o]of i)this._definitions[s]=mh({},o,e,(r,a)=>Array.isArray(r)?r.concat(a):void 0)}}function mQ(n,t){return typeof n=="string"?n===t:n instanceof RegExp?n.test(t):!1}class gt extends A{constructor(e){super(e);h(this,"_dataSchema");h(this,"_allowedAttributes");h(this,"_disallowedAttributes");h(this,"_allowedElements");h(this,"_disallowedElements");h(this,"_dataInitialized");h(this,"_coupledAttributes");this._dataSchema=e.plugins.get("DataSchema"),this._allowedAttributes=new Qt,this._disallowedAttributes=new Qt,this._allowedElements=new Set,this._disallowedElements=new Set,this._dataInitialized=!1,this._coupledAttributes=null,this._registerElementsAfterInit(),this._registerElementHandlers(),this._registerCoupledAttributesPostFixer(),this._registerAssociatedHtmlAttributesPostFixer()}static get pluginName(){return"DataFilter"}static get requires(){return[jr,ms]}loadAllowedConfig(e){for(const i of e){const s=i.name||/[\s\S]+/,o=Tv(i);this.allowElement(s),o.forEach(r=>this.allowAttributes(r))}}loadDisallowedConfig(e){for(const i of e){const s=i.name||/[\s\S]+/,o=Tv(i);o.length==0?this.disallowElement(s):o.forEach(r=>this.disallowAttributes(r))}}loadAllowedEmptyElementsConfig(e){for(const i of e)this.allowEmptyElement(i)}allowElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!0))this._addAllowedElement(i),this._coupledAttributes=null}disallowElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!1))this._disallowedElements.add(i.view)}allowEmptyElement(e){for(const i of this._dataSchema.getDefinitionsForView(e,!0))i.isInline&&this._dataSchema.extendInlineElement({...i,allowEmpty:!0})}allowAttributes(e){this._allowedAttributes.add(e)}disallowAttributes(e){this._disallowedAttributes.add(e)}processViewAttributes(e,i){const{consumable:s}=i;return kv(e,this._disallowedAttributes,s),gQ(e,kv(e,this._allowedAttributes,s))}_addAllowedElement(e){if(!this._allowedElements.has(e)){if(this._allowedElements.add(e),"appliesToBlock"in e&&typeof e.appliesToBlock=="string")for(const i of this._dataSchema.getDefinitionsForModel(e.appliesToBlock))i.isBlock&&this._addAllowedElement(i);this._dataInitialized&&this.editor.data.once("set",()=>{this._fireRegisterEvent(e)},{priority:Pn.highest+1})}}_registerElementsAfterInit(){this.editor.data.on("init",()=>{this._dataInitialized=!0;for(const e of this._allowedElements)this._fireRegisterEvent(e)},{priority:Pn.highest+1})}_registerElementHandlers(){this.on("register",(e,i)=>{const s=this.editor.model.schema;if(i.isObject&&!s.isRegistered(i.model))this._registerObjectElement(i);else if(i.isBlock)this._registerBlockElement(i);else if(i.isInline)this._registerInlineElement(i);else throw new C("data-filter-invalid-definition",null,i);e.stop()},{priority:"lowest"})}_registerCoupledAttributesPostFixer(){const e=this.editor.model,i=e.document.selection;e.document.registerPostFixer(s=>{const o=e.document.differ.getChanges();let r=!1;const a=this._getCoupledAttributesMap();for(const l of o){if(l.type!="attribute"||l.attributeNewValue!==null)continue;const c=a.get(l.attributeKey);if(c)for(const{item:u}of l.range.getWalker())for(const d of c)u.hasAttribute(d)&&(s.removeAttribute(d,u),r=!0)}return r}),this.listenTo(i,"change:attribute",(s,{attributeKeys:o})=>{const r=new Set,a=this._getCoupledAttributesMap();for(const l of o){if(i.hasAttribute(l))continue;const c=a.get(l);if(c)for(const u of c)i.hasAttribute(u)&&r.add(u)}r.size!=0&&e.change(l=>{for(const c of r)l.removeSelectionAttribute(c)})})}_registerAssociatedHtmlAttributesPostFixer(){const e=this.editor.model;e.document.registerPostFixer(i=>{const s=e.document.differ.getChanges();let o=!1;for(const r of s)if(!(r.type!=="insert"||r.name==="$text"))for(const a of r.attributes.keys())!a.startsWith("html")||!a.endsWith("Attributes")||e.schema.checkAttribute(r.name,a)||(i.removeAttribute(a,r.position.nodeAfter),o=!0);return o})}_getCoupledAttributesMap(){if(this._coupledAttributes)return this._coupledAttributes;this._coupledAttributes=new Map;for(const e of this._allowedElements)if(e.coupledAttribute&&e.model){const i=this._coupledAttributes.get(e.coupledAttribute);i?i.push(e.model):this._coupledAttributes.set(e.coupledAttribute,[e.model])}return this._coupledAttributes}_fireRegisterEvent(e){e.view&&this._disallowedElements.has(e.view)||this.fire(e.view?`register:${e.view}`:"register",e)}_registerObjectElement(e){const i=this.editor,s=i.model.schema,o=i.conversion,{view:r,model:a}=e;s.register(a,e.modelSchema);/* istanbul ignore next: paranoid check -- @preserve */r&&(s.extend(e.model,{allowAttributes:[Zn(r),"htmlContent"]}),i.data.registerRawContentMatcher({name:r}),o.for("upcast").elementToElement({view:r,model:Jb(e),converterPriority:Pn.low+2}),o.for("upcast").add(Rl(e,this)),o.for("editingDowncast").elementToStructure({model:{name:a,attributes:[Zn(r)]},view:dQ(i,e)}),o.for("dataDowncast").elementToElement({model:a,view:(l,{writer:c})=>Fh(r,l,c)}),o.for("dataDowncast").add(Ll(e)))}_registerBlockElement(e){const i=this.editor,s=i.model.schema,o=i.conversion,{view:r,model:a}=e;if(!s.isRegistered(e.model)){if(s.register(e.model,e.modelSchema),!r)return;o.for("upcast").elementToElement({model:a,view:r,converterPriority:Pn.low+2}),o.for("downcast").elementToElement({model:a,view:r})}r&&(s.extend(e.model,{allowAttributes:Zn(r)}),o.for("upcast").add(Rl(e,this)),o.for("downcast").add(Ll(e)))}_registerInlineElement(e){const i=this.editor,s=i.model.schema,o=i.conversion,r=e.model;e.appliesToBlock||(s.extend("$text",{allowAttributes:r}),e.attributeProperties&&s.setAttributeProperties(r,e.attributeProperties),o.for("upcast").add(hQ(e,this)),o.for("downcast").attributeToElement({model:r,view:fQ(e)}),e.allowEmpty&&(s.setAttributeProperties(r,{copyFromObject:!1}),s.isRegistered("htmlEmptyElement")||s.register("htmlEmptyElement",{inheritAllFrom:"$inlineObject"}),i.data.htmlProcessor.domConverter.registerInlineObjectMatcher(a=>a.name==e.view&&a.isEmpty&&Array.from(a.getAttributeKeys()).length?{name:!0}:null),o.for("editingDowncast").elementToElement({model:"htmlEmptyElement",view:yv(e,!0)}),o.for("dataDowncast").elementToElement({model:"htmlEmptyElement",view:yv(e)})))}}function kv(n,t,e){const i=t.matchAll(n)||[],s=n.document.stylesProcessor;return i.reduce((o,{match:r})=>{for(const a of r.styles||[]){const l=s.getRelatedStyles(a).filter(c=>c.split("-").length>a.split("-").length).sort((c,u)=>u.split("-").length-c.split("-").length);for(const c of l)e.consume(n,{styles:[c]})&&o.styles.push(c);e.consume(n,{styles:[a]})&&o.styles.push(a)}for(const a of r.classes||[])e.consume(n,{classes:[a]})&&o.classes.push(a);for(const a of r.attributes||[])e.consume(n,{attributes:[a]})&&o.attributes.push(a);return o},{attributes:[],classes:[],styles:[]})}function gQ(n,{attributes:t,classes:e,styles:i}){return!t.length&&!e.length&&!i.length?null:{...t.length&&{attributes:pQ(n,t)},...i.length&&{styles:bQ(n,i)},...e.length&&{classes:e}}}function pQ(n,t){const e={};for(const i of t){const s=n.getAttribute(i);s!==void 0&&r5(i)&&(e[i]=s)}return e}function bQ(n,t){const e=new Yu(n.document.stylesProcessor);for(const i of t){const s=n.getStyle(i);s!==void 0&&e.set(i,s)}return Object.fromEntries(e.getStylesEntries())}function Of(n,t){const{name:e}=n,i=n[t];return Rt(i)?Object.entries(i).map(([s,o])=>({name:e,[t]:{[s]:o}})):Array.isArray(i)?i.map(s=>({name:e,[t]:[s]})):[n]}function Tv(n){const{name:t,attributes:e,classes:i,styles:s}=n,o=[];return e&&o.push(...Of({name:t,attributes:e},"attributes")),i&&o.push(...Of({name:t,classes:i},"classes")),s&&o.push(...Of({name:t,styles:s},"styles")),o}class wQ extends A{static get requires(){return[gt]}static get pluginName(){return"CodeBlockElementSupport"}init(){if(!this.editor.plugins.has("CodeBlockEditing"))return;const t=this.editor.plugins.get(gt);t.on("register:pre",(e,i)=>{if(i.model!=="codeBlock")return;const s=this.editor,o=s.model.schema,r=s.conversion;o.extend("codeBlock",{allowAttributes:["htmlPreAttributes","htmlContentAttributes"]}),r.for("upcast").add(_Q(t)),r.for("downcast").add(vQ()),e.stop()})}}function _Q(n){return t=>{t.on("element:code",(e,i,s)=>{const o=i.viewItem,r=o.parent;if(!r||!r.is("element","pre"))return;a(r,"htmlPreAttributes"),a(o,"htmlContentAttributes");function a(l,c){const u=n.processViewAttributes(l,s);u&&s.writer.setAttribute(c,u,i.modelRange)}},{priority:"low"})}}function vQ(){return n=>{n.on("attribute:htmlPreAttributes:codeBlock",(t,e,i)=>{if(!i.consumable.consume(e.item,t.name))return;const{attributeOldValue:s,attributeNewValue:o}=e,a=i.mapper.toViewElement(e.item).parent;Lo(i.writer,s,o,a)}),n.on("attribute:htmlContentAttributes:codeBlock",(t,e,i)=>{if(!i.consumable.consume(e.item,t.name))return;const{attributeOldValue:s,attributeNewValue:o}=e,r=i.mapper.toViewElement(e.item);Lo(i.writer,s,o,r)})}}class yQ extends A{static get requires(){return[gt]}static get pluginName(){return"DualContentModelElementSupport"}init(){this.editor.plugins.get(gt).on("register",(e,i)=>{const s=i,o=this.editor,r=o.model.schema,a=o.conversion;if(!s.paragraphLikeModel||r.isRegistered(s.model)||r.isRegistered(s.paragraphLikeModel))return;const l={model:s.paragraphLikeModel,view:s.view};r.register(s.model,s.modelSchema),r.register(l.model,{inheritAllFrom:"$block"}),a.for("upcast").elementToElement({view:s.view,model:(c,{writer:u})=>this._hasBlockContent(c)?u.createElement(s.model):u.createElement(l.model),converterPriority:Pn.low+.5}),a.for("downcast").elementToElement({view:s.view,model:s.model}),this._addAttributeConversion(s),a.for("downcast").elementToElement({view:l.view,model:l.model}),this._addAttributeConversion(l),e.stop()})}_hasBlockContent(t){const e=this.editor.editing.view,i=e.domConverter.blockElements;for(const s of e.createRangeIn(t).getItems())if(s.is("element")&&i.includes(s.name))return!0;return!1}_addAttributeConversion(t){const e=this.editor,i=e.conversion,s=e.plugins.get(gt);e.model.schema.extend(t.model,{allowAttributes:Zn(t.view)}),i.for("upcast").add(Rl(t,s)),i.for("downcast").add(Ll(t))}}class CQ extends A{static get requires(){return[jr,lc]}static get pluginName(){return"HeadingElementSupport"}init(){const t=this.editor;if(!t.plugins.has("HeadingEditing"))return;const e=t.config.get("heading.options");this.registerHeadingElements(t,e)}registerHeadingElements(t,e){const i=t.plugins.get(jr),s=[];for(const o of e)"model"in o&&"view"in o&&(i.registerBlockElement({view:o.view,model:o.model}),s.push(o.model));i.extendBlockElement({model:"htmlHgroup",modelSchema:{allowChildren:s}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function dd(n,t,e){const i=n.createRangeOn(t);for(const{item:s}of i.getWalker())if(s.is("element",e))return s}class kQ extends A{static get requires(){return[gt]}static get pluginName(){return"ImageElementSupport"}init(){const t=this.editor;if(!t.plugins.has("ImageInlineEditing")&&!t.plugins.has("ImageBlockEditing"))return;const e=t.model.schema,i=t.conversion,s=t.plugins.get(gt);s.on("register:figure",()=>{i.for("upcast").add(AQ(s))}),s.on("register:img",(o,r)=>{r.model!=="imageBlock"&&r.model!=="imageInline"||(e.isRegistered("imageBlock")&&e.extend("imageBlock",{allowAttributes:["htmlImgAttributes","htmlFigureAttributes","htmlLinkAttributes"]}),e.isRegistered("imageInline")&&e.extend("imageInline",{allowAttributes:["htmlA","htmlImgAttributes"]}),i.for("upcast").add(TQ(s)),i.for("downcast").add(xQ()),t.plugins.has("LinkImage")&&i.for("upcast").add(EQ(s,t)),o.stop())})}}function TQ(n){return t=>{t.on("element:img",(e,i,s)=>{if(!i.modelRange)return;const o=i.viewItem,r=n.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlImgAttributes",r,i.modelRange)},{priority:"low"})}}function EQ(n,t){const e=t.plugins.get("ImageUtils");return i=>{i.on("element:a",(s,o,r)=>{const a=o.viewItem;if(!e.findViewImgElement(a))return;const c=o.modelCursor.parent;if(!c.is("element","imageBlock"))return;const u=n.processViewAttributes(a,r);u&&r.writer.setAttribute("htmlLinkAttributes",u,c)},{priority:"low"})}}function AQ(n){return t=>{t.on("element:figure",(e,i,s)=>{const o=i.viewItem;if(!i.modelRange||!o.hasClass("image"))return;const r=n.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,i.modelRange)},{priority:"low"})}}function xQ(){return n=>{t("htmlImgAttributes"),e("img","htmlImgAttributes"),e("figure","htmlFigureAttributes"),e("a","htmlLinkAttributes");function t(i){n.on(`attribute:${i}:imageInline`,(s,o,r)=>{if(!r.consumable.consume(o.item,s.name))return;const{attributeOldValue:a,attributeNewValue:l}=o,c=r.mapper.toViewElement(o.item);Lo(r.writer,a,l,c)},{priority:"low"})}function e(i,s){n.on(`attribute:${s}:imageBlock`,(o,r,a)=>{if(!a.consumable.test(r.item,o.name))return;const{attributeOldValue:l,attributeNewValue:c}=r,u=a.mapper.toViewElement(r.item),d=dd(a.writer,u,i);d&&(Lo(a.writer,l,c,d),a.consumable.consume(r.item,o.name))},{priority:"low"}),i==="a"&&n.on("attribute:linkHref:imageBlock",(o,r,a)=>{if(!a.consumable.consume(r.item,"attribute:htmlLinkAttributes:imageBlock"))return;const l=a.mapper.toViewElement(r.item),c=dd(a.writer,l,"a");Ai(a.writer,r.item.getAttribute("htmlLinkAttributes"),c)},{priority:"low"})}}}class SQ extends A{static get requires(){return[gt]}static get pluginName(){return"MediaEmbedElementSupport"}init(){const t=this.editor;if(!t.plugins.has("MediaEmbed")||t.config.get("mediaEmbed.previewsInData"))return;const e=t.model.schema,i=t.conversion,s=this.editor.plugins.get(gt),o=this.editor.plugins.get(jr),r=t.config.get("mediaEmbed.elementName");o.registerBlockElement({model:"media",view:r}),s.on("register:figure",()=>{i.for("upcast").add(PQ(s))}),s.on(`register:${r}`,(a,l)=>{l.model==="media"&&(e.extend("media",{allowAttributes:[Zn(r),"htmlFigureAttributes"]}),i.for("upcast").add(IQ(s,r)),i.for("dataDowncast").add(RQ(r)),a.stop())})}}function IQ(n,t){const e=(i,s,o)=>{const r=s.viewItem;a(r,Zn(t));function a(l,c){const u=n.processViewAttributes(l,o);u&&o.writer.setAttribute(c,u,s.modelRange)}};return i=>{i.on(`element:${t}`,e,{priority:"low"})}}function PQ(n){return t=>{t.on("element:figure",(e,i,s)=>{const o=i.viewItem;if(!i.modelRange||!o.hasClass("media"))return;const r=n.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,i.modelRange)},{priority:"low"})}}function RQ(n){return t=>{e(n,Zn(n)),e("figure","htmlFigureAttributes");function e(i,s){t.on(`attribute:${s}:media`,(o,r,a)=>{if(!a.consumable.consume(r.item,o.name))return;const{attributeOldValue:l,attributeNewValue:c}=r,u=a.mapper.toViewElement(r.item),d=dd(a.writer,u,i);Lo(a.writer,l,c,d)})}}}class LQ extends A{static get requires(){return[gt]}static get pluginName(){return"ScriptElementSupport"}init(){const t=this.editor.plugins.get(gt);t.on("register:script",(e,i)=>{const s=this.editor,o=s.model.schema,r=s.conversion;o.register("htmlScript",i.modelSchema),o.extend("htmlScript",{allowAttributes:["htmlScriptAttributes","htmlContent"],isContent:!0}),s.data.registerRawContentMatcher({name:"script"}),r.for("upcast").elementToElement({view:"script",model:Jb(i)}),r.for("upcast").add(Rl(i,t)),r.for("downcast").elementToElement({model:"htmlScript",view:(a,{writer:l})=>Fh("script",a,l)}),r.for("downcast").add(Ll(i)),e.stop()})}}class VQ extends A{static get requires(){return[gt]}static get pluginName(){return"TableElementSupport"}init(){const t=this.editor;if(!t.plugins.has("TableEditing"))return;const e=t.model.schema,i=t.conversion,s=t.plugins.get(gt),o=t.plugins.get("TableUtils");s.on("register:figure",()=>{i.for("upcast").add(OQ(s))}),s.on("register:table",(r,a)=>{a.model==="table"&&(e.extend("table",{allowAttributes:["htmlTableAttributes","htmlFigureAttributes","htmlTheadAttributes","htmlTbodyAttributes"]}),i.for("upcast").add(MQ(s)),i.for("downcast").add(NQ()),t.model.document.registerPostFixer(BQ(t.model,o)),r.stop())})}}function BQ(n,t){return e=>{const i=n.document.differ.getChanges();let s=!1;for(const o of i){if(o.type!="attribute"||o.attributeKey!="headingRows")continue;const r=o.range.start.nodeAfter,a=r.getAttribute("htmlTheadAttributes"),l=r.getAttribute("htmlTbodyAttributes");a&&!o.attributeNewValue?(e.removeAttribute("htmlTheadAttributes",r),s=!0):l&&o.attributeNewValue==t.getRows(r)&&(e.removeAttribute("htmlTbodyAttributes",r),s=!0)}return s}}function MQ(n){return t=>{t.on("element:table",(e,i,s)=>{if(!i.modelRange)return;const o=i.viewItem;r(o,"htmlTableAttributes");for(const a of o.getChildren())a.is("element","thead")&&r(a,"htmlTheadAttributes"),a.is("element","tbody")&&r(a,"htmlTbodyAttributes");function r(a,l){const c=n.processViewAttributes(a,s);c&&s.writer.setAttribute(l,c,i.modelRange)}},{priority:"low"})}}function OQ(n){return t=>{t.on("element:figure",(e,i,s)=>{const o=i.viewItem;if(!i.modelRange||!o.hasClass("table"))return;const r=n.processViewAttributes(o,s);r&&s.writer.setAttribute("htmlFigureAttributes",r,i.modelRange)},{priority:"low"})}}function NQ(){return n=>{t("table","htmlTableAttributes"),t("figure","htmlFigureAttributes"),t("thead","htmlTheadAttributes"),t("tbody","htmlTbodyAttributes");function t(e,i){n.on(`attribute:${i}:table`,(s,o,r)=>{if(!r.consumable.test(o.item,s.name))return;const a=r.mapper.toViewElement(o.item),l=dd(r.writer,a,e);l&&(r.consumable.consume(o.item,s.name),Lo(r.writer,o.attributeOldValue,o.attributeNewValue,l))})}}}class FQ extends A{static get requires(){return[gt]}static get pluginName(){return"StyleElementSupport"}init(){const t=this.editor.plugins.get(gt);t.on("register:style",(e,i)=>{const s=this.editor,o=s.model.schema,r=s.conversion;o.register("htmlStyle",i.modelSchema),o.extend("htmlStyle",{allowAttributes:["htmlStyleAttributes","htmlContent"],isContent:!0}),s.data.registerRawContentMatcher({name:"style"}),r.for("upcast").elementToElement({view:"style",model:Jb(i)}),r.for("upcast").add(Rl(i,t)),r.for("downcast").elementToElement({model:"htmlStyle",view:(a,{writer:l})=>Fh("style",a,l)}),r.for("downcast").add(Ll(i)),e.stop()})}}class DQ extends A{static get requires(){return[gt]}static get pluginName(){return"ListElementSupport"}init(){const t=this.editor;if(!t.plugins.has("ListEditing"))return;const e=t.model.schema,i=t.conversion,s=t.plugins.get(gt),o=t.plugins.get("ListEditing"),r=t.plugins.get("ListUtils"),a=["ul","ol","li"];o.registerDowncastStrategy({scope:"item",attributeName:"htmlLiAttributes",setAttributeOnDowncast:Ai}),o.registerDowncastStrategy({scope:"list",attributeName:"htmlUlAttributes",setAttributeOnDowncast:Ai}),o.registerDowncastStrategy({scope:"list",attributeName:"htmlOlAttributes",setAttributeOnDowncast:Ai}),s.on("register",(l,c)=>{if(!a.includes(c.view)||(l.stop(),e.checkAttribute("$block","htmlLiAttributes")))return;const u=a.map(d=>Zn(d));e.extend("$listItem",{allowAttributes:u}),i.for("upcast").add(d=>{d.on("element:ul",Nf("htmlUlAttributes",s),{priority:"low"}),d.on("element:ol",Nf("htmlOlAttributes",s),{priority:"low"}),d.on("element:li",Nf("htmlLiAttributes",s),{priority:"low"})})}),o.on("postFixer",(l,{listNodes:c,writer:u})=>{for(const{node:d,previousNodeInList:f}of c)if(f){if(f.getAttribute("listType")==d.getAttribute("listType")){const m=Ev(f.getAttribute("listType")),g=f.getAttribute(m);!Ds(d.getAttribute(m),g)&&u.model.schema.checkAttribute(d,m)&&(u.setAttribute(m,g,d),l.return=!0)}if(f.getAttribute("listItemId")==d.getAttribute("listItemId")){const m=f.getAttribute("htmlLiAttributes");!Ds(d.getAttribute("htmlLiAttributes"),m)&&u.model.schema.checkAttribute(d,"htmlLiAttributes")&&(u.setAttribute("htmlLiAttributes",m,d),l.return=!0)}}}),o.on("postFixer",(l,{listNodes:c,writer:u})=>{for(const{node:d}of c){const f=d.getAttribute("listType");!r.isNumberedListType(f)&&d.getAttribute("htmlOlAttributes")&&(u.removeAttribute("htmlOlAttributes",d),l.return=!0),r.isNumberedListType(f)&&d.getAttribute("htmlUlAttributes")&&(u.removeAttribute("htmlUlAttributes",d),l.return=!0)}})}afterInit(){const t=this.editor;if(!t.commands.get("indentList"))return;const e=t.commands.get("indentList");this.listenTo(e,"afterExecute",(i,s)=>{t.model.change(o=>{for(const r of s){const a=Ev(r.getAttribute("listType"));t.model.schema.checkAttribute(r,a)&&o.setAttribute(a,{},r)}})})}}function Nf(n,t){return(e,i,s)=>{const o=i.viewItem;i.modelRange||Object.assign(i,s.convertChildren(i.viewItem,i.modelCursor));const r=t.processViewAttributes(o,s);for(const a of i.modelRange.getItems({shallow:!0}))a.hasAttribute("listItemId")&&(a.hasAttribute("htmlUlAttributes")||a.hasAttribute("htmlOlAttributes")||s.writer.model.schema.checkAttribute(a,n)&&s.writer.setAttribute(n,r||{},a))}}function Ev(n){return n==="numbered"||n=="customNumbered"?"htmlOlAttributes":"htmlUlAttributes"}class $Q extends A{static get requires(){return[gt,jr]}static get pluginName(){return"CustomElementSupport"}init(){const t=this.editor.plugins.get(gt),e=this.editor.plugins.get(jr);t.on("register:$customElement",(i,s)=>{i.stop();const o=this.editor,r=o.model.schema,a=o.conversion,l=o.editing.view.domConverter.unsafeElements,c=o.data.htmlProcessor.domConverter.preElements;r.register(s.model,s.modelSchema),r.extend(s.model,{allowAttributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"],isContent:!0}),o.data.htmlProcessor.domConverter.registerRawContentMatcher({name:"template"}),a.for("upcast").elementToElement({view:/.*/,model:(u,d)=>{if(u.name=="$comment"||!HQ(u.name)||e.getDefinitionsForView(u.name).size)return null;l.includes(u.name)||l.push(u.name),c.includes(u.name)||c.push(u.name);const f=d.writer.createElement(s.model,{htmlElementName:u.name}),m=t.processViewAttributes(u,d);m&&d.writer.setAttribute("htmlCustomElementAttributes",m,f);let g;if(u.is("element","template")&&u.getCustomProperty("$rawContent"))g=u.getCustomProperty("$rawContent");else{const w=new zn(u.document).createDocumentFragment(u),v=o.data.htmlProcessor.domConverter.viewToDom(w),_=v.firstChild;for(;_.firstChild;)v.appendChild(_.firstChild);_.remove(),g=o.data.htmlProcessor.htmlWriter.getHtml(v)}d.writer.setAttribute("htmlContent",g,f);for(const{item:p}of o.editing.view.createRangeIn(u))d.consumable.consume(p,{name:!0});return f},converterPriority:"low"}),a.for("editingDowncast").elementToElement({model:{name:s.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(u,{writer:d})=>{const f=u.getAttribute("htmlElementName"),m=d.createRawElement(f);return u.hasAttribute("htmlCustomElementAttributes")&&Ai(d,u.getAttribute("htmlCustomElementAttributes"),m),m}}),a.for("dataDowncast").elementToElement({model:{name:s.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(u,{writer:d})=>{const f=u.getAttribute("htmlElementName"),m=u.getAttribute("htmlContent"),g=d.createRawElement(f,null,(p,w)=>{w.setContentOf(p,m)});return u.hasAttribute("htmlCustomElementAttributes")&&Ai(d,u.getAttribute("htmlCustomElementAttributes"),g),g}})})}}function HQ(n){try{document.createElement(n)}catch{return!1}return!0}class zQ extends A{static get pluginName(){return"GeneralHtmlSupport"}static get requires(){return[gt,wQ,yQ,CQ,kQ,SQ,LQ,VQ,FQ,DQ,$Q]}init(){const t=this.editor,e=t.plugins.get(gt);e.loadAllowedEmptyElementsConfig(t.config.get("htmlSupport.allowEmpty")||[]),e.loadAllowedConfig(t.config.get("htmlSupport.allow")||[]),e.loadDisallowedConfig(t.config.get("htmlSupport.disallow")||[])}getGhsAttributeNameForElement(t){const e=this.editor.plugins.get("DataSchema"),i=Array.from(e.getDefinitionsForView(t,!1)),s=i.find(o=>o.isInline&&!i[0].isObject);return s?s.model:Zn(t)}addModelHtmlClass(t,e,i){const s=this.editor.model,o=this.getGhsAttributeNameForElement(t);s.change(r=>{for(const a of lr(s,i,o))ar(r,a,o,"classes",l=>{for(const c of Pe(e))l.add(c)})})}removeModelHtmlClass(t,e,i){const s=this.editor.model,o=this.getGhsAttributeNameForElement(t);s.change(r=>{for(const a of lr(s,i,o))ar(r,a,o,"classes",l=>{for(const c of Pe(e))l.delete(c)})})}setModelHtmlAttributes(t,e,i){const s=this.editor.model,o=this.getGhsAttributeNameForElement(t);s.change(r=>{for(const a of lr(s,i,o))ar(r,a,o,"attributes",l=>{for(const[c,u]of Object.entries(e))l.set(c,u)})})}removeModelHtmlAttributes(t,e,i){const s=this.editor.model,o=this.getGhsAttributeNameForElement(t);s.change(r=>{for(const a of lr(s,i,o))ar(r,a,o,"attributes",l=>{for(const c of Pe(e))l.delete(c)})})}setModelHtmlStyles(t,e,i){const s=this.editor.model,o=this.getGhsAttributeNameForElement(t);s.change(r=>{for(const a of lr(s,i,o))ar(r,a,o,"styles",l=>{for(const[c,u]of Object.entries(e))l.set(c,u)})})}removeModelHtmlStyles(t,e,i){const s=this.editor.model,o=this.getGhsAttributeNameForElement(t);s.change(r=>{for(const a of lr(s,i,o))ar(r,a,o,"styles",l=>{for(const c of Pe(e))l.delete(c)})})}}function*lr(n,t,e){if(t)if(!(Symbol.iterator in t)&&t.is("documentSelection")&&t.isCollapsed)n.schema.checkAttributeInSelection(t,e)&&(yield t);else for(const i of UQ(n,t,e))yield*i.getItems({shallow:!0})}function UQ(n,t,e){return!(Symbol.iterator in t)&&(t.is("node")||t.is("$text")||t.is("$textProxy"))?n.schema.checkAttribute(t,e)?[n.createRangeOn(t)]:[]:n.schema.getValidRanges(n.createSelection(t).getRanges(),e)}class WQ extends A{static get pluginName(){return"HtmlComment"}init(){const t=this.editor,e=new Map;t.data.processor.skipComments=!1,t.model.schema.addAttributeCheck((i,s)=>{if(i.endsWith("$root")&&s.startsWith("$comment"))return!0}),t.conversion.for("upcast").elementToMarker({view:"$comment",model:i=>{const o=`$comment:${Cn()}`,r=i.getCustomProperty("$rawContent");return e.set(o,r),o}}),t.conversion.for("dataDowncast").markerToElement({model:"$comment",view:(i,{writer:s})=>{let o;for(const c of this.editor.model.document.getRootNames())if(o=this.editor.model.document.getRoot(c),o.hasAttribute(i.markerName))break;const r=i.markerName,a=o.getAttribute(r),l=s.createUIElement("$comment");return s.setCustomProperty("$rawContent",a,l),l}}),t.model.document.registerPostFixer(i=>{let s=!1;const o=t.model.document.differ.getChangedMarkers().filter(r=>r.name.startsWith("$comment:"));for(const r of o){const{oldRange:a,newRange:l}=r.data;if(!(a&&l&&a.root==l.root)){if(a){const c=a.root;c.hasAttribute(r.name)&&(i.removeAttribute(r.name,c),s=!0)}if(l){const c=l.root;c.rootName=="$graveyard"?(i.removeMarker(r.name),s=!0):c.hasAttribute(r.name)||(i.setAttribute(r.name,e.get(r.name)||"",c),s=!0)}}}return s}),t.data.on("set",()=>{for(const i of t.model.markers.getMarkersGroup("$comment"))this.removeHtmlComment(i.name)},{priority:"high"}),t.model.on("deleteContent",(i,[s])=>{for(const o of s.getRanges()){const r=t.model.schema.getLimitElement(o),a=t.model.createPositionAt(r,0),l=t.model.createPositionAt(r,"end");let c;a.isTouching(o.start)&&l.isTouching(o.end)?c=this.getHtmlCommentsInRange(t.model.createRange(a,l)):c=this.getHtmlCommentsInRange(o,{skipBoundaries:!0});for(const u of c)this.removeHtmlComment(u)}},{priority:"high"})}createHtmlComment(t,e){const i=Cn(),o=this.editor.model,r=o.document.getRoot(t.root.rootName),a=`$comment:${i}`;return o.change(l=>{const c=l.createRange(t);return l.addMarker(a,{usingOperation:!0,affectsData:!0,range:c}),l.setAttribute(a,e,r),a})}removeHtmlComment(t){const e=this.editor,i=e.model.markers.get(t);return i?(e.model.change(s=>{s.removeMarker(i)}),!0):!1}getHtmlCommentData(t){const i=this.editor.model.markers.get(t);if(!i)return null;let s="";for(const o of this.editor.model.document.getRoots())if(o.hasAttribute(t)){s=o.getAttribute(t);break}return{content:s,position:i.getStart()}}getHtmlCommentsInRange(t,{skipBoundaries:e=!1}={}){const i=!e;return Array.from(this.editor.model.markers.getMarkersGroup("$comment")).filter(o=>s(o,t)).map(o=>o.name);function s(o,r){const a=o.getRange().start;return(a.isAfter(r.start)||i&&a.isEqual(r.start))&&(a.isBefore(r.end)||i&&a.isEqual(r.end))}}}class qQ extends Sb{toView(t){if(!t.match(/<(?:html|body|head|meta)(?:\s[^>]*)?>/i))return super.toView(t);let e="",i="";t=t.replace(/<!DOCTYPE[^>]*>/i,a=>(e=a,"")),t=t.replace(/<\?xml\s[^?]*\?>/i,a=>(i=a,""));const s=this._toDom(t),o=this.domConverter.domToView(s,{skipComments:this.skipComments}),r=new zn(o.document);return r.setCustomProperty("$fullPageDocument",s.ownerDocument.documentElement.outerHTML,o),e&&r.setCustomProperty("$fullPageDocType",e,o),i&&r.setCustomProperty("$fullPageXmlDeclaration",i,o),o}toData(t){let e=super.toData(t);const i=t.getCustomProperty("$fullPageDocument"),s=t.getCustomProperty("$fullPageDocType"),o=t.getCustomProperty("$fullPageXmlDeclaration");return i&&(e=i.replace(/<\/body\s*>/,e+"$&"),s&&(e=s+`
`+e),o&&(e=o+`
`+e)),e}}class jQ extends A{static get pluginName(){return"FullPage"}init(){const t=this.editor,e=["$fullPageDocument","$fullPageDocType","$fullPageXmlDeclaration"];t.data.processor=new qQ(t.data.viewDocument),t.model.schema.extend("$root",{allowAttributes:e}),t.data.on("toModel",(i,[s])=>{const o=t.model.document.getRoot();t.model.change(r=>{for(const a of e){const l=s.getCustomProperty(a);l&&r.setAttribute(a,l,o)}})},{priority:"low"}),t.data.on("toView",(i,[s])=>{if(!s.is("rootElement"))return;const o=s,r=i.return;if(!o.hasAttribute("$fullPageDocument"))return;const a=new zn(r.document);for(const l of e){const c=o.getAttribute(l);c&&a.setCustomProperty(l,c,r)}},{priority:"low"}),t.data.on("set",()=>{const i=t.model.document.getRoot();t.model.change(s=>{for(const o of e)i.hasAttribute(o)&&s.removeAttribute(o,i)})},{priority:"high"}),t.data.on("get",(i,s)=>{s[0]||(s[0]={}),s[0].trim=!1},{priority:"high"})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function GQ(n){return n.createContainerElement("span",{class:"image-inline"},n.createEmptyElement("img"))}function Av(n){return n.createContainerElement("figure",{class:"image"},[n.createEmptyElement("img"),n.createSlot("children")])}function uP(n,t){const e=n.plugins.get("ImageUtils"),i=n.plugins.has("ImageInlineEditing")&&n.plugins.has("ImageBlockEditing");return o=>e.isInlineImageView(o)?i&&(o.getStyle("display")=="block"||o.findAncestor(e.isBlockImageView)?"imageBlock":"imageInline")!==t?null:s(o):null;function s(o){const r={name:!0};return o.hasAttribute("src")&&(r.attributes=["src"]),r}}function Yb(n,t){const e=Ye(t.getSelectedBlocks());return!e||n.isObject(e)||e.isEmpty&&e.name!="listItem"?"imageBlock":"imageInline"}function hd(n){return n&&n.endsWith("px")?parseInt(n):null}function fd(n){const t=hd(n.getStyle("width")),e=hd(n.getStyle("height"));return!!(t&&e)}const KQ=/^(image|image-inline)$/;class jt extends A{constructor(){super(...arguments);h(this,"_domEmitter",new(on()))}static get pluginName(){return"ImageUtils"}isImage(e){return this.isInlineImage(e)||this.isBlockImage(e)}isInlineImageView(e){return!!e&&e.is("element","img")}isBlockImageView(e){return!!e&&e.is("element","figure")&&e.hasClass("image")}insertImage(e={},i=null,s=null,o={}){const r=this.editor,a=r.model,l=a.document.selection,c=dP(r,i||l,s);e={...Object.fromEntries(l.getAttributes()),...e};for(const u in e)a.schema.checkAttribute(c,u)||delete e[u];return a.change(u=>{const{setImageSizes:d=!0}=o,f=u.createElement(c,e);return a.insertObject(f,i,null,{setSelection:"on",findOptimalPosition:!i&&c!="imageInline"?"auto":void 0}),f.parent?(d&&this.setImageNaturalSizeAttributes(f),f):null})}setImageNaturalSizeAttributes(e){const i=e.getAttribute("src");i&&(e.getAttribute("width")||e.getAttribute("height")||this.editor.model.change(s=>{const o=new j.window.Image;this._domEmitter.listenTo(o,"load",()=>{!e.getAttribute("width")&&!e.getAttribute("height")&&this.editor.model.enqueueChange(s.batch,r=>{r.setAttribute("width",o.naturalWidth,e),r.setAttribute("height",o.naturalHeight,e)}),this._domEmitter.stopListening(o,"load")}),o.src=i}))}getClosestSelectedImageWidget(e){const i=e.getFirstPosition();if(!i)return null;const s=e.getSelectedElement();if(s&&this.isImageWidget(s))return s;let o=i.parent;for(;o;){if(o.is("element")&&this.isImageWidget(o))return o;o=o.parent}return null}getClosestSelectedImageElement(e){const i=e.getSelectedElement();return this.isImage(i)?i:e.getFirstPosition().findAncestor("imageBlock")}getImageWidgetFromImageView(e){return e.findAncestor({classes:KQ})}isImageAllowed(){const i=this.editor.model.document.selection;return ZQ(this.editor,i)&&JQ(i)}toImageWidget(e,i,s){return i.setCustomProperty("image",!0,e),Xs(e,i,{label:()=>{const a=this.findViewImgElement(e).getAttribute("alt");return a?`${a} ${s}`:s}})}isImageWidget(e){return!!e.getCustomProperty("image")&&ht(e)}isBlockImage(e){return!!e&&e.is("element","imageBlock")}isInlineImage(e){return!!e&&e.is("element","imageInline")}findViewImgElement(e){if(this.isInlineImageView(e))return e;const i=this.editor.editing.view;for(const{item:s}of i.createRangeIn(e))if(this.isInlineImageView(s))return s}destroy(){return this._domEmitter.stopListening(),super.destroy()}}function ZQ(n,t){if(dP(n,t,null)=="imageBlock"){const i=YQ(t,n.model);if(n.model.schema.checkChild(i,"imageBlock"))return!0}else if(n.model.schema.checkChild(t.focus,"imageInline"))return!0;return!1}function JQ(n){return[...n.focus.getAncestors()].every(t=>!t.is("element","imageBlock"))}function YQ(n,t){const i=cc(n,t).start.parent;return i.isEmpty&&!i.is("element","$root")?i.parent:i}function dP(n,t,e){const i=n.model.schema,s=n.config.get("image.insert.type");return n.plugins.has("ImageBlockEditing")?n.plugins.has("ImageInlineEditing")?e||(s==="inline"?"imageInline":s!=="auto"?"imageBlock":t.is("selection")?Yb(i,t):i.checkChild(t,"imageInline")?"imageInline":"imageBlock"):"imageBlock":"imageInline"}const XQ=new RegExp(String(/^(http(s)?:\/\/)?[\w-]+\.[\w.~:/[\]@!$&'()*+,;=%-]+/.source+/\.(jpg|jpeg|png|gif|ico|webp|JPG|JPEG|PNG|GIF|ICO|WEBP)/.source+/(\?[\w.~:/[\]@!$&'()*+,;=%-]*)?/.source+/(#[\w.~:/[\]@!$&'()*+,;=%-]*)?$/.source));class QQ extends A{constructor(e){super(e);h(this,"_timeoutId");h(this,"_positionToInsert");this._timeoutId=null,this._positionToInsert=null}static get requires(){return[Gb,jt,Nh,Pi]}static get pluginName(){return"AutoImage"}init(){const e=this.editor,i=e.model.document,s=e.plugins.get("ClipboardPipeline");this.listenTo(s,"inputTransformation",()=>{const o=i.selection.getFirstRange(),r=bt.fromPosition(o.start);r.stickiness="toPrevious";const a=bt.fromPosition(o.end);a.stickiness="toNext",i.once("change:data",()=>{this._embedImageBetweenPositions(r,a),r.detach(),a.detach()},{priority:"high"})}),e.commands.get("undo").on("execute",()=>{this._timeoutId&&(j.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedImageBetweenPositions(e,i){const s=this.editor,o=new hn(e,i),r=o.getWalker({ignoreElementEnd:!0}),a=Object.fromEntries(s.model.document.selection.getAttributes()),l=this.editor.plugins.get("ImageUtils");let c="";for(const u of r)u.item.is("$textProxy")&&(c+=u.item.data);if(c=c.trim(),!c.match(XQ)){o.detach();return}this._positionToInsert=bt.fromPosition(e),this._timeoutId=setTimeout(()=>{if(!s.commands.get("insertImage").isEnabled){o.detach();return}s.model.change(f=>{this._timeoutId=null,f.remove(o),o.detach();let m;this._positionToInsert.root.rootName!=="$graveyard"&&(m=this._positionToInsert.toPosition()),l.insertImage({...a,src:c},m),this._positionToInsert.detach(),this._positionToInsert=null}),s.plugins.get("Delete").requestUndoOnBackspace()},100)}}class eee extends ne{refresh(){const i=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!i,this.isEnabled&&i.hasAttribute("alt")?this.value=i.getAttribute("alt"):this.value=!1}execute(t){const e=this.editor,i=e.plugins.get("ImageUtils"),s=e.model,o=i.getClosestSelectedImageElement(s.document.selection);s.change(r=>{r.setAttribute("alt",t.newValue,o)})}}class tee extends A{static get requires(){return[jt]}static get pluginName(){return"ImageTextAlternativeEditing"}init(){this.editor.commands.add("imageTextAlternative",new eee(this.editor))}}class nee extends q{constructor(e){super(e);h(this,"focusTracker");h(this,"keystrokes");h(this,"labeledInput");h(this,"saveButtonView");h(this,"cancelButtonView");h(this,"_focusables");h(this,"_focusCycler");const i=this.locale.t;this.focusTracker=new Ge,this.keystrokes=new tt,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(i("Save"),F.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(i("Cancel"),F.cancel,"ck-button-cancel","cancel"),this._focusables=new Mt,this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-text-alternative-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),this.keystrokes.listenTo(this.element),qo({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createButton(e,i,s,o){const r=new te(this.locale);return r.set({label:e,icon:i,tooltip:!0}),r.extendTemplate({attributes:{class:s}}),o&&r.delegate("execute").to(this,o),r}_createLabeledInputView(){const e=this.locale.t,i=new wt(this.locale,jn);return i.label=e("Text alternative"),i}}function iee(n){const t=n.plugins.get("ContextualBalloon");if(n.plugins.get("ImageUtils").getClosestSelectedImageWidget(n.editing.view.document.selection)){const i=Xb(n);t.updatePosition(i)}}function Xb(n){const t=n.editing.view,e=St.defaultPositions,i=n.plugins.get("ImageUtils");return{target:t.domConverter.mapViewToDom(i.getClosestSelectedImageWidget(t.document.selection)),positions:[e.northArrowSouth,e.northArrowSouthWest,e.northArrowSouthEast,e.southArrowNorth,e.southArrowNorthWest,e.southArrowNorthEast,e.viewportStickyNorth]}}class see extends A{constructor(){super(...arguments);h(this,"_balloon");h(this,"_form")}static get requires(){return[mi]}static get pluginName(){return"ImageTextAlternativeUI"}init(){this._createButton()}destroy(){super.destroy(),this._form&&this._form.destroy()}_createButton(){const e=this.editor,i=e.t;e.ui.componentFactory.add("imageTextAlternative",s=>{const o=e.commands.get("imageTextAlternative"),r=new te(s);return r.set({label:i("Change image text alternative"),icon:F.textAlternative,tooltip:!0}),r.bind("isEnabled").to(o,"isEnabled"),r.bind("isOn").to(o,"value",a=>!!a),this.listenTo(r,"execute",()=>{this._showForm()}),r})}_createForm(){const e=this.editor,s=e.editing.view.document,o=e.plugins.get("ImageUtils");this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(Vh(nee))(e.locale),this._form.render(),this.listenTo(this._form,"submit",()=>{e.execute("imageTextAlternative",{newValue:this._form.labeledInput.fieldView.element.value}),this._hideForm(!0)}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(r,a)=>{this._hideForm(!0),a()}),this.listenTo(e.ui,"update",()=>{o.getClosestSelectedImageWidget(s.selection)?this._isVisible&&iee(e):this._hideForm(!0)}),Wo({emitter:this._form,activator:()=>this._isVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(){if(this._isVisible)return;this._form||this._createForm();const e=this.editor,i=e.commands.get("imageTextAlternative"),s=this._form.labeledInput;this._form.disableCssTransitions(),this._isInBalloon||this._balloon.add({view:this._form,position:Xb(e)}),s.fieldView.value=s.fieldView.element.value=i.value||"",this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e=!1){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return!!this._balloon&&this._balloon.visibleView===this._form}get _isInBalloon(){return!!this._balloon&&this._balloon.hasView(this._form)}}class Qb extends A{static get requires(){return[tee,see]}static get pluginName(){return"ImageTextAlternative"}}function oee(n){const t=(e,i,s)=>{if(!s.consumable.test(i.viewItem,{name:!0,classes:"image"}))return;const o=n.findViewImgElement(i.viewItem);if(!o||!s.consumable.test(o,{name:!0}))return;s.consumable.consume(i.viewItem,{name:!0,classes:"image"});const r=s.convertItem(o,i.modelCursor),a=Ye(r.modelRange.getItems());if(!a){s.consumable.revert(i.viewItem,{name:!0,classes:"image"});return}s.convertChildren(i.viewItem,a),s.updateConversionResult(a,i)};return e=>{e.on("element:figure",t)}}function hP(n,t){const e=(i,s,o)=>{if(!o.consumable.consume(s.item,i.name))return;const r=o.writer,a=o.mapper.toViewElement(s.item),l=n.findViewImgElement(a);s.attributeNewValue===null?(r.removeAttribute("srcset",l),r.removeAttribute("sizes",l)):s.attributeNewValue&&(r.setAttribute("srcset",s.attributeNewValue,l),r.setAttribute("sizes","100vw",l))};return i=>{i.on(`attribute:srcset:${t}`,e)}}function md(n,t,e){const i=(s,o,r)=>{if(!r.consumable.consume(o.item,s.name))return;const a=r.writer,l=r.mapper.toViewElement(o.item),c=n.findViewImgElement(l);a.setAttribute(o.attributeKey,o.attributeNewValue||"",c)};return s=>{s.on(`attribute:${e}:${t}`,i)}}class ew extends Oi{observe(t){this.listenTo(t,"load",(e,i)=>{const s=i.target;this.checkShouldIgnoreEventFromTarget(s)||s.tagName=="IMG"&&this._fireEvents(i)},{useCapture:!0})}stopObserving(t){this.stopListening(t)}_fireEvents(t){this.isEnabled&&(this.document.fire("layoutChanged"),this.document.fire("imageLoaded",t))}}class ree extends ne{constructor(t){super(t);const e=t.config.get("image.insert.type");t.plugins.has("ImageBlockEditing")||e==="block"&&Te("image-block-plugin-required"),t.plugins.has("ImageInlineEditing")||e==="inline"&&Te("image-inline-plugin-required")}refresh(){const t=this.editor.plugins.get("ImageUtils");this.isEnabled=t.isImageAllowed()}execute(t){const e=Pe(t.source),i=this.editor.model.document.selection,s=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(i.getAttributes());e.forEach((r,a)=>{const l=i.getSelectedElement();if(typeof r=="string"&&(r={src:r}),a&&l&&s.isImage(l)){const c=this.editor.model.createPositionAfter(l);s.insertImage({...r,...o},c)}else s.insertImage({...r,...o})})}}class aee extends ne{constructor(t){super(t),this.decorate("cleanupImage")}refresh(){const e=this.editor.plugins.get("ImageUtils"),i=this.editor.model.document.selection.getSelectedElement();this.isEnabled=e.isImage(i),this.value=this.isEnabled?i.getAttribute("src"):null}execute(t){const e=this.editor.model.document.selection.getSelectedElement(),i=this.editor.plugins.get("ImageUtils");this.editor.model.change(s=>{s.setAttribute("src",t.source,e),this.cleanupImage(s,e),i.setImageNaturalSizeAttributes(e)})}cleanupImage(t,e){t.removeAttribute("srcset",e),t.removeAttribute("sizes",e),t.removeAttribute("sources",e),t.removeAttribute("width",e),t.removeAttribute("height",e),t.removeAttribute("alt",e)}}class fP extends A{static get requires(){return[jt]}static get pluginName(){return"ImageEditing"}init(){const t=this.editor,e=t.conversion;t.editing.view.addObserver(ew),e.for("upcast").attributeToAttribute({view:{name:"img",key:"alt"},model:"alt"}).attributeToAttribute({view:{name:"img",key:"srcset"},model:"srcset"});const i=new ree(t),s=new aee(t);t.commands.add("insertImage",i),t.commands.add("replaceImageSource",s),t.commands.add("imageInsert",i)}}class mP extends A{static get requires(){return[jt]}static get pluginName(){return"ImageSizeAttributes"}afterInit(){this._registerSchema(),this._registerConverters("imageBlock"),this._registerConverters("imageInline")}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:["width","height"]}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:["width","height"]})}_registerConverters(t){const e=this.editor,i=e.plugins.get("ImageUtils"),s=t==="imageBlock"?"figure":"img";e.conversion.for("upcast").attributeToAttribute({view:{name:s,styles:{width:/.+/}},model:{key:"width",value:r=>fd(r)?hd(r.getStyle("width")):null}}).attributeToAttribute({view:{name:s,key:"width"},model:"width"}).attributeToAttribute({view:{name:s,styles:{height:/.+/}},model:{key:"height",value:r=>fd(r)?hd(r.getStyle("height")):null}}).attributeToAttribute({view:{name:s,key:"height"},model:"height"}),e.conversion.for("editingDowncast").add(r=>{o(r,"width","width",!0),o(r,"height","height",!0)}),e.conversion.for("dataDowncast").add(r=>{o(r,"width","width",!1),o(r,"height","height",!1)});function o(r,a,l,c){r.on(`attribute:${a}:${t}`,(u,d,f)=>{if(!f.consumable.consume(d.item,u.name))return;const m=f.writer,g=f.mapper.toViewElement(d.item),p=i.findViewImgElement(g);if(d.attributeNewValue!==null?m.setAttribute(l,d.attributeNewValue,p):m.removeAttribute(l,p),d.item.hasAttribute("sources"))return;const w=d.item.hasAttribute("resizedWidth");if(t==="imageInline"&&!w&&!c)return;const v=d.item.getAttribute("width"),_=d.item.getAttribute("height");v&&_&&m.setStyle("aspect-ratio",`${v}/${_}`,p)})}}}class gP extends ne{constructor(e,i){super(e);h(this,"_modelElementName");this._modelElementName=i}refresh(){const i=this.editor.plugins.get("ImageUtils"),s=i.getClosestSelectedImageElement(this.editor.model.document.selection);this._modelElementName==="imageBlock"?this.isEnabled=i.isInlineImage(s):this.isEnabled=i.isBlockImage(s)}execute(e={}){const i=this.editor,s=this.editor.model,o=i.plugins.get("ImageUtils"),r=o.getClosestSelectedImageElement(s.document.selection),a=Object.fromEntries(r.getAttributes());return!a.src&&!a.uploadId?null:s.change(l=>{const{setImageSizes:c=!0}=e,u=Array.from(s.markers).filter(m=>m.getRange().containsItem(r)),d=o.insertImage(a,s.createSelection(r,"on"),this._modelElementName,{setImageSizes:c});if(!d)return null;const f=l.createRangeOn(d);for(const m of u){const g=m.getRange(),p=g.root.rootName!="$graveyard"?g.getJoined(f,!0):f;l.updateMarker(m,{range:p})}return{oldElement:r,newElement:d}})}}class pP extends A{static get requires(){return[jt]}static get pluginName(){return"ImagePlaceholder"}afterInit(){this._setupSchema(),this._setupConversion(),this._setupLoadListener()}_setupSchema(){const t=this.editor.model.schema;t.isRegistered("imageBlock")&&t.extend("imageBlock",{allowAttributes:["placeholder"]}),t.isRegistered("imageInline")&&t.extend("imageInline",{allowAttributes:["placeholder"]})}_setupConversion(){const t=this.editor,e=t.conversion,i=t.plugins.get("ImageUtils");e.for("editingDowncast").add(s=>{s.on("attribute:placeholder",(o,r,a)=>{if(!a.consumable.test(r.item,o.name)||!r.item.is("element","imageBlock")&&!r.item.is("element","imageInline"))return;a.consumable.consume(r.item,o.name);const l=a.writer,c=a.mapper.toViewElement(r.item),u=i.findViewImgElement(c);r.attributeNewValue?(l.addClass("image_placeholder",u),l.setStyle("background-image",`url(${r.attributeNewValue})`,u),l.setCustomProperty("editingPipeline:doNotReuseOnce",!0,u)):(l.removeClass("image_placeholder",u),l.removeStyle("background-image",u))})})}_setupLoadListener(){const t=this.editor,e=t.model,i=t.editing,s=i.view,o=t.plugins.get("ImageUtils");s.addObserver(ew),this.listenTo(s.document,"imageLoaded",(r,a)=>{const l=s.domConverter.mapDomToView(a.target);if(!l)return;const c=o.getImageWidgetFromImageView(l);if(!c)return;const u=i.mapper.toModelElement(c);!u||!u.hasAttribute("placeholder")||e.enqueueChange({isUndoable:!1},d=>{d.removeAttribute("placeholder",u)})})}}class bP extends A{static get requires(){return[fP,mP,jt,pP,Hn]}static get pluginName(){return"ImageBlockEditing"}init(){const t=this.editor;t.model.schema.register("imageBlock",{inheritAllFrom:"$blockObject",allowAttributes:["alt","src","srcset"]}),this._setupConversion(),t.plugins.has("ImageInlineEditing")&&(t.commands.add("imageTypeBlock",new gP(this.editor,"imageBlock")),this._setupClipboardIntegration())}_setupConversion(){const t=this.editor,e=t.t,i=t.conversion,s=t.plugins.get("ImageUtils");i.for("dataDowncast").elementToStructure({model:"imageBlock",view:(o,{writer:r})=>Av(r)}),i.for("editingDowncast").elementToStructure({model:"imageBlock",view:(o,{writer:r})=>s.toImageWidget(Av(r),r,e("image widget"))}),i.for("downcast").add(md(s,"imageBlock","src")).add(md(s,"imageBlock","alt")).add(hP(s,"imageBlock")),i.for("upcast").elementToElement({view:uP(t,"imageBlock"),model:(o,{writer:r})=>r.createElement("imageBlock",o.hasAttribute("src")?{src:o.getAttribute("src")}:void 0)}).add(oee(s))}_setupClipboardIntegration(){const t=this.editor,e=t.model,i=t.editing.view,s=t.plugins.get("ImageUtils"),o=t.plugins.get("ClipboardPipeline");this.listenTo(o,"inputTransformation",(r,a)=>{const l=Array.from(a.content.getChildren());let c;if(!l.every(s.isInlineImageView))return;a.targetRanges?c=t.editing.mapper.toModelRange(a.targetRanges[0]):c=e.document.selection.getFirstRange();const u=e.createSelection(c);if(Yb(e.schema,u)==="imageBlock"){const d=new zn(i.document),f=l.map(m=>d.createElement("figure",{class:"image"},m));a.content=d.createDocumentFragment(f)}}),this.listenTo(o,"contentInsertion",(r,a)=>{a.method==="paste"&&e.change(l=>{const c=l.createRangeIn(a.content);for(const u of c.getItems())u.is("element","imageBlock")&&s.setImageNaturalSizeAttributes(u)})})}}class lee extends q{constructor(e,i=[]){super(e);h(this,"focusTracker");h(this,"keystrokes");h(this,"_focusables");h(this,"_focusCycler");h(this,"children");this.focusTracker=new Ge,this.keystrokes=new tt,this._focusables=new Mt,this.children=this.createCollection(),this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});for(const s of i)this.children.add(s),this._focusables.add(s),s instanceof TI&&this._focusables.addMany(s.children);this.setTemplate({tag:"form",attributes:{class:["ck","ck-image-insert-form"],tabindex:-1},children:this.children})}render(){super.render(),qo({view:this});for(const i of this._focusables)this.focusTracker.add(i.element);this.keystrokes.listenTo(this.element);const e=i=>i.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}}class uc extends A{constructor(e){super(e);h(this,"dropdownView");h(this,"_integrations",new Map);e.config.define("image.insert.integrations",["upload","assetManager","url"])}static get pluginName(){return"ImageInsertUI"}static get requires(){return[jt]}init(){const e=this.editor,i=e.model.document.selection,s=e.plugins.get("ImageUtils");this.set("isImageSelected",!1),this.listenTo(e.model.document,"change",()=>{this.isImageSelected=s.isImage(i.getSelectedElement())});const o=a=>this._createToolbarComponent(a),r=a=>this._createMenuBarComponent(a);e.ui.componentFactory.add("insertImage",o),e.ui.componentFactory.add("imageInsert",o),e.ui.componentFactory.add("menuBar:insertImage",r)}registerIntegration({name:e,observable:i,buttonViewCreator:s,formViewCreator:o,menuBarButtonViewCreator:r,requiresForm:a=!1}){this._integrations.has(e)&&Te("image-insert-integration-exists",{name:e}),this._integrations.set(e,{observable:i,buttonViewCreator:s,menuBarButtonViewCreator:r,formViewCreator:o,requiresForm:a})}_createToolbarComponent(e){const i=this.editor,s=e.t,o=this._prepareIntegrations();if(!o.length)return null;let r;const a=o[0];if(o.length==1){if(!a.requiresForm)return a.buttonViewCreator(!0);r=a.buttonViewCreator(!0)}else{const u=a.buttonViewCreator(!1);r=new la(e,u),r.tooltip=!0,r.bind("label").to(this,"isImageSelected",d=>s(d?"Replace image":"Insert image"))}const l=this.dropdownView=Yt(e,r),c=o.map(({observable:u})=>typeof u=="function"?u():u);return l.bind("isEnabled").toMany(c,"isEnabled",(...u)=>u.some(d=>d)),l.once("change:isOpen",()=>{const u=o.map(({formViewCreator:f})=>f(o.length==1)),d=new lee(i.locale,u);l.panelView.children.add(d)}),l}_createMenuBarComponent(e){const i=e.t,s=this._prepareIntegrations();if(!s.length)return null;let o;const r=s[0];if(s.length==1)o=r.menuBarButtonViewCreator(!0);else{o=new ui(e);const a=new qr(e);o.panelView.children.add(a),o.buttonView.set({icon:F.image,label:i("Image")});for(const l of s){const c=new ua(e,o),u=l.menuBarButtonViewCreator(!1);c.children.add(u),a.items.add(c)}}return o}_prepareIntegrations(){const i=this.editor.config.get("image.insert.integrations"),s=[];if(!i.length)return Te("image-insert-integrations-not-specified"),s;for(const o of i){if(!this._integrations.has(o)){["upload","assetManager","url"].includes(o)||Te("image-insert-unknown-integration",{item:o});continue}s.push(this._integrations.get(o))}return s.length||Te("image-insert-integrations-not-registered"),s}}class cee extends A{static get requires(){return[bP,ms,Qb,uc]}static get pluginName(){return"ImageBlock"}}class uee extends A{static get requires(){return[fP,mP,jt,pP,Hn]}static get pluginName(){return"ImageInlineEditing"}init(){const t=this.editor;t.model.schema.register("imageInline",{inheritAllFrom:"$inlineObject",allowAttributes:["alt","src","srcset"],disallowIn:["caption"]}),this._setupConversion(),t.plugins.has("ImageBlockEditing")&&(t.commands.add("imageTypeInline",new gP(this.editor,"imageInline")),this._setupClipboardIntegration())}_setupConversion(){const t=this.editor,e=t.t,i=t.conversion,s=t.plugins.get("ImageUtils");i.for("dataDowncast").elementToElement({model:"imageInline",view:(o,{writer:r})=>r.createEmptyElement("img")}),i.for("editingDowncast").elementToStructure({model:"imageInline",view:(o,{writer:r})=>s.toImageWidget(GQ(r),r,e("image widget"))}),i.for("downcast").add(md(s,"imageInline","src")).add(md(s,"imageInline","alt")).add(hP(s,"imageInline")),i.for("upcast").elementToElement({view:uP(t,"imageInline"),model:(o,{writer:r})=>r.createElement("imageInline",o.hasAttribute("src")?{src:o.getAttribute("src")}:void 0)})}_setupClipboardIntegration(){const t=this.editor,e=t.model,i=t.editing.view,s=t.plugins.get("ImageUtils"),o=t.plugins.get("ClipboardPipeline");this.listenTo(o,"inputTransformation",(r,a)=>{const l=Array.from(a.content.getChildren());let c;if(!l.every(s.isBlockImageView))return;a.targetRanges?c=t.editing.mapper.toModelRange(a.targetRanges[0]):c=e.document.selection.getFirstRange();const u=e.createSelection(c);if(Yb(e.schema,u)==="imageInline"){const d=new zn(i.document),f=l.map(m=>m.childCount===1?(Array.from(m.getAttributes()).forEach(g=>d.setAttribute(...g,s.findViewImgElement(m))),m.getChild(0)):m);a.content=d.createDocumentFragment(f)}}),this.listenTo(o,"contentInsertion",(r,a)=>{a.method==="paste"&&e.change(l=>{const c=l.createRangeIn(a.content);for(const u of c.getItems())u.is("element","imageInline")&&s.setImageNaturalSizeAttributes(u)})})}}class dee extends A{static get requires(){return[uee,ms,Qb,uc]}static get pluginName(){return"ImageInline"}}class wP extends A{static get pluginName(){return"ImageCaptionUtils"}static get requires(){return[jt]}getCaptionFromImageModelElement(t){for(const e of t.getChildren())if(e&&e.is("element","caption"))return e;return null}getCaptionFromModelSelection(t){const e=this.editor.plugins.get("ImageUtils"),i=t.getFirstPosition().findAncestor("caption");return i&&e.isBlockImage(i.parent)?i:null}matchImageCaptionViewElement(t){const e=this.editor.plugins.get("ImageUtils");return t.name=="figcaption"&&e.isBlockImageView(t.parent)?{name:!0}:null}}class hee extends ne{refresh(){const t=this.editor,e=t.plugins.get("ImageCaptionUtils"),i=t.plugins.get("ImageUtils");if(!t.plugins.has(bP)){this.isEnabled=!1,this.value=!1;return}const s=t.model.document.selection,o=s.getSelectedElement();if(!o){const r=e.getCaptionFromModelSelection(s);this.isEnabled=!!r,this.value=!!r;return}this.isEnabled=i.isImage(o),this.isEnabled?this.value=!!e.getCaptionFromImageModelElement(o):this.value=!1}execute(t={}){const{focusCaptionOnShow:e}=t;this.editor.model.change(i=>{this.value?this._hideImageCaption(i):this._showImageCaption(i,e)})}_showImageCaption(t,e){const s=this.editor.model.document.selection,o=this.editor.plugins.get("ImageCaptionEditing"),r=this.editor.plugins.get("ImageUtils");let a=s.getSelectedElement();const l=o._getSavedCaption(a);r.isInlineImage(a)&&(this.editor.execute("imageTypeBlock"),a=s.getSelectedElement());const c=l||t.createElement("caption");t.append(c,a),e&&t.setSelection(c,"in")}_hideImageCaption(t){const e=this.editor,i=e.model.document.selection,s=e.plugins.get("ImageCaptionEditing"),o=e.plugins.get("ImageCaptionUtils");let r=i.getSelectedElement(),a;r?a=o.getCaptionFromImageModelElement(r):(a=o.getCaptionFromModelSelection(i),r=a.parent),s._saveCaption(r,a),t.setSelection(r,"on"),t.remove(a)}}class fee extends A{constructor(e){super(e);h(this,"_savedCaptionsMap");this._savedCaptionsMap=new WeakMap}static get requires(){return[jt,wP]}static get pluginName(){return"ImageCaptionEditing"}init(){const e=this.editor,i=e.model.schema;i.isRegistered("caption")?i.extend("caption",{allowIn:"imageBlock"}):i.register("caption",{allowIn:"imageBlock",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleImageCaption",new hee(this.editor)),this._setupConversion(),this._setupImageTypeCommandsIntegration(),this._registerCaptionReconversion()}_setupConversion(){const e=this.editor,i=e.editing.view,s=e.plugins.get("ImageUtils"),o=e.plugins.get("ImageCaptionUtils"),r=e.t;e.conversion.for("upcast").elementToElement({view:a=>o.matchImageCaptionViewElement(a),model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(a,{writer:l})=>s.isBlockImage(a.parent)?l.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(a,{writer:l})=>{if(!s.isBlockImage(a.parent))return null;const c=l.createEditableElement("figcaption");l.setCustomProperty("imageCaption",!0,c),c.placeholder=r("Enter image caption"),vb({view:i,element:c,keepOnFocus:!0});const u=a.parent.getAttribute("alt"),d=u?r("Caption for image: %0",[u]):r("Caption for the image");return qb(c,l,{label:d})}})}_setupImageTypeCommandsIntegration(){const e=this.editor,i=e.plugins.get("ImageUtils"),s=e.plugins.get("ImageCaptionUtils"),o=e.commands.get("imageTypeInline"),r=e.commands.get("imageTypeBlock"),a=l=>{if(!l.return)return;const{oldElement:c,newElement:u}=l.return;/* istanbul ignore if: paranoid check -- @preserve */if(!c)return;if(i.isBlockImage(c)){const f=s.getCaptionFromImageModelElement(c);if(f){this._saveCaption(u,f);return}}const d=this._getSavedCaption(c);d&&this._saveCaption(u,d)};o&&this.listenTo(o,"execute",a,{priority:"low"}),r&&this.listenTo(r,"execute",a,{priority:"low"})}_getSavedCaption(e){const i=this._savedCaptionsMap.get(e);return i?Je.fromJSON(i):null}_saveCaption(e,i){this._savedCaptionsMap.set(e,i.toJSON())}_registerCaptionReconversion(){const e=this.editor,i=e.model,s=e.plugins.get("ImageUtils"),o=e.plugins.get("ImageCaptionUtils");i.document.on("change:data",()=>{const r=i.document.differ.getChanges();for(const a of r){if(a.attributeKey!=="alt")continue;const l=a.range.start.nodeAfter;if(s.isBlockImage(l)){const c=o.getCaptionFromImageModelElement(l);if(!c)return;e.editing.reconvertItem(c)}}})}}class mee extends A{static get requires(){return[wP]}static get pluginName(){return"ImageCaptionUI"}init(){const t=this.editor,e=t.editing.view,i=t.plugins.get("ImageCaptionUtils"),s=t.t;t.ui.componentFactory.add("toggleImageCaption",o=>{const r=t.commands.get("toggleImageCaption"),a=new te(o);return a.set({icon:F.caption,tooltip:!0,isToggleable:!0}),a.bind("isOn","isEnabled").to(r,"value","isEnabled"),a.bind("label").to(r,"value",l=>s(l?"Toggle caption off":"Toggle caption on")),this.listenTo(a,"execute",()=>{t.execute("toggleImageCaption",{focusCaptionOnShow:!0});const l=i.getCaptionFromModelSelection(t.model.document.selection);if(l){const c=t.editing.mapper.toViewElement(l);e.scrollToTheSelection(),e.change(u=>{u.addClass("image__caption_highlighted",c)})}t.editing.view.focus()}),a})}}class gee extends A{static get requires(){return[fee,mee]}static get pluginName(){return"ImageCaption"}}function _P(n){const t=n.map(e=>e.replace("+","\\+"));return new RegExp(`^image\\/(${t.join("|")})$`)}function pee(n){return new Promise((t,e)=>{const i=n.getAttribute("src");fetch(i).then(s=>s.blob()).then(s=>{const o=vP(s,i),a=`image.${o.replace("image/","")}`,l=new File([s],a,{type:o});t(l)}).catch(s=>s&&s.name==="TypeError"?wee(i).then(t).catch(e):e(s))})}function bee(n,t){return!n.isInlineImageView(t)||!t.getAttribute("src")?!1:!!t.getAttribute("src").match(/^data:image\/\w+;base64,/g)||!!t.getAttribute("src").match(/^blob:/g)}function vP(n,t){return n.type?n.type:t.match(/data:(image\/\w+);base64/)?t.match(/data:(image\/\w+);base64/)[1].toLowerCase():"image/jpeg"}function wee(n){return _ee(n).then(t=>{const e=vP(t,n),s=`image.${e.replace("image/","")}`;return new File([t],s,{type:e})})}function _ee(n){return new Promise((t,e)=>{const i=j.document.createElement("img");i.addEventListener("load",()=>{const s=j.document.createElement("canvas");s.width=i.width,s.height=i.height,s.getContext("2d").drawImage(i,0,0),s.toBlob(r=>r?t(r):e())}),i.addEventListener("error",()=>e()),i.src=n})}class vee extends A{static get pluginName(){return"ImageUploadUI"}init(){const t=this.editor;t.ui.componentFactory.add("uploadImage",()=>this._createToolbarButton()),t.ui.componentFactory.add("imageUpload",()=>this._createToolbarButton()),t.ui.componentFactory.add("menuBar:uploadImage",()=>this._createMenuBarButton("standalone")),t.plugins.has("ImageInsertUI")&&t.plugins.get("ImageInsertUI").registerIntegration({name:"upload",observable:()=>t.commands.get("uploadImage"),buttonViewCreator:()=>this._createToolbarButton(),formViewCreator:()=>this._createDropdownButton(),menuBarButtonViewCreator:e=>this._createMenuBarButton(e?"insertOnly":"insertNested")})}_createButton(t){const e=this.editor,i=e.locale,s=e.commands.get("uploadImage"),o=e.config.get("image.upload.types"),r=_P(o),a=new t(e.locale),l=i.t;return a.set({acceptedType:o.map(c=>`image/${c}`).join(","),allowMultipleFiles:!0,label:l("Upload from computer"),icon:F.imageUpload}),a.bind("isEnabled").to(s),a.on("done",(c,u)=>{const d=Array.from(u).filter(f=>r.test(f.type));d.length&&(e.execute("uploadImage",{file:d}),e.editing.view.focus())}),a}_createToolbarButton(){const t=this.editor.locale.t,e=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(Jm);return i.tooltip=!0,i.bind("label").to(e,"isImageSelected",s=>t(s?"Replace image from computer":"Upload image from computer")),i}_createDropdownButton(){const t=this.editor.locale.t,e=this.editor.plugins.get("ImageInsertUI"),i=this._createButton(Jm);return i.withText=!0,i.bind("label").to(e,"isImageSelected",s=>t(s?"Replace from computer":"Upload from computer")),i.on("execute",()=>{e.dropdownView.isOpen=!1}),i}_createMenuBarButton(t){const e=this.editor.locale.t,i=this._createButton(HI);switch(i.withText=!0,t){case"standalone":i.label=e("Image from computer");break;case"insertOnly":i.label=e("Image");break;case"insertNested":i.label=e("From computer");break}return i}}class yee extends A{constructor(e){super(e);h(this,"placeholder");h(this,"uploadStatusChange",(e,i,s)=>{const o=this.editor,r=i.item,a=r.getAttribute("uploadId");if(!s.consumable.consume(i.item,e.name))return;const l=o.plugins.get("ImageUtils"),c=o.plugins.get(nl),u=a?i.attributeNewValue:null,d=this.placeholder,f=o.editing.mapper.toViewElement(r),m=s.writer;if(u=="reading"){xv(f,m),Sv(l,d,f,m);return}if(u=="uploading"){const g=c.loaders.get(a);xv(f,m),g?(Iv(f,m),kee(f,m,g,o.editing.view),See(l,f,m,g)):Sv(l,d,f,m);return}u=="complete"&&c.loaders.get(a)&&Eee(f,m,o.editing.view),Tee(f,m),Iv(f,m),Cee(f,m)});this.placeholder="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="}static get pluginName(){return"ImageUploadProgress"}init(){const e=this.editor;e.plugins.has("ImageBlockEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageBlock",this.uploadStatusChange),e.plugins.has("ImageInlineEditing")&&e.editing.downcastDispatcher.on("attribute:uploadStatus:imageInline",this.uploadStatusChange)}}function xv(n,t){n.hasClass("ck-appear")||t.addClass("ck-appear",n)}function Cee(n,t){t.removeClass("ck-appear",n)}function Sv(n,t,e,i){e.hasClass("ck-image-upload-placeholder")||i.addClass("ck-image-upload-placeholder",e);const s=n.findViewImgElement(e);s.getAttribute("src")!==t&&i.setAttribute("src",t,s),yP(e,"placeholder")||i.insert(i.createPositionAfter(s),xee(i))}function Iv(n,t){n.hasClass("ck-image-upload-placeholder")&&t.removeClass("ck-image-upload-placeholder",n),CP(n,t,"placeholder")}function kee(n,t,e,i){const s=Aee(t);t.insert(t.createPositionAt(n,"end"),s),e.on("change:uploadedPercent",(o,r,a)=>{i.change(l=>{l.setStyle("width",a+"%",s)})})}function Tee(n,t){CP(n,t,"progressBar")}function Eee(n,t,e){const i=t.createUIElement("div",{class:"ck-image-upload-complete-icon"});t.insert(t.createPositionAt(n,"end"),i),setTimeout(()=>{e.change(s=>s.remove(s.createRangeOn(i)))},3e3)}function Aee(n){const t=n.createUIElement("div",{class:"ck-progress-bar"});return n.setCustomProperty("progressBar",!0,t),t}function xee(n){const t=n.createUIElement("div",{class:"ck-upload-placeholder-loader"});return n.setCustomProperty("placeholder",!0,t),t}function yP(n,t){for(const e of n.getChildren())if(e.getCustomProperty(t))return e}function CP(n,t,e){const i=yP(n,e);i&&t.remove(t.createRangeOn(i))}function See(n,t,e,i){if(i.data){const s=n.findViewImgElement(t);e.setAttribute("src",i.data,s)}}class Iee extends ne{refresh(){const t=this.editor,e=t.plugins.get("ImageUtils"),i=t.model.document.selection.getSelectedElement();this.isEnabled=e.isImageAllowed()||e.isImage(i)}execute(t){const e=Pe(t.file),i=this.editor.model.document.selection,s=this.editor.plugins.get("ImageUtils"),o=Object.fromEntries(i.getAttributes());e.forEach((r,a)=>{const l=i.getSelectedElement();if(a&&l&&s.isImage(l)){const c=this.editor.model.createPositionAfter(l);this._uploadImage(r,o,c)}else this._uploadImage(r,o)})}_uploadImage(t,e,i){const s=this.editor,r=s.plugins.get(nl).createLoader(t),a=s.plugins.get("ImageUtils");r&&a.insertImage({...e,uploadId:r.id},i)}}class Pee extends A{constructor(e){super(e);h(this,"_uploadImageElements");e.config.define("image",{upload:{types:["jpeg","png","gif","bmp","webp","tiff"]}}),this._uploadImageElements=new Map}static get requires(){return[nl,F_,Hn,jt]}static get pluginName(){return"ImageUploadEditing"}init(){const e=this.editor,i=e.model.document,s=e.conversion,o=e.plugins.get(nl),r=e.plugins.get("ImageUtils"),a=e.plugins.get("ClipboardPipeline"),l=_P(e.config.get("image.upload.types")),c=new Iee(e);e.commands.add("uploadImage",c),e.commands.add("imageUpload",c),s.for("upcast").attributeToAttribute({view:{name:"img",key:"uploadId"},model:"uploadId"}),this.listenTo(e.editing.view.document,"clipboardInput",(u,d)=>{if(Ree(d.dataTransfer))return;const f=Array.from(d.dataTransfer.files).filter(m=>m?l.test(m.type):!1);f.length&&(u.stop(),e.model.change(m=>{d.targetRanges&&m.setSelection(d.targetRanges.map(g=>e.editing.mapper.toModelRange(g))),e.execute("uploadImage",{file:f})}))}),this.listenTo(a,"inputTransformation",(u,d)=>{const f=Array.from(e.editing.view.createRangeIn(d.content)).map(g=>g.item).filter(g=>bee(r,g)&&!g.getAttribute("uploadProcessed")).map(g=>({promise:pee(g),imageElement:g}));if(!f.length)return;const m=new zn(e.editing.view.document);for(const g of f){m.setAttribute("uploadProcessed",!0,g.imageElement);const p=o.createLoader(g.promise);p&&(m.setAttribute("src","",g.imageElement),m.setAttribute("uploadId",p.id,g.imageElement))}}),e.editing.view.document.on("dragover",(u,d)=>{d.preventDefault()}),i.on("change",()=>{const u=i.differ.getChanges({includeChangesInGraveyard:!0}).reverse(),d=new Set;for(const f of u)if(f.type=="insert"&&f.name!="$text"){const m=f.position.nodeAfter,g=f.position.root.rootName=="$graveyard";for(const p of Lee(e,m)){const w=p.getAttribute("uploadId");if(!w)continue;const v=o.loaders.get(w);v&&(g?d.has(w)||v.abort():(d.add(w),this._uploadImageElements.set(w,p),v.status=="idle"&&this._readAndUpload(v)))}}}),this.on("uploadComplete",(u,{imageElement:d,data:f})=>{const m=f.urls?f.urls:f;this.editor.model.change(g=>{g.setAttribute("src",m.default,d),this._parseAndSetSrcsetAttributeOnImage(m,d,g),r.setImageNaturalSizeAttributes(d)})},{priority:"low"})}afterInit(){const e=this.editor.model.schema;this.editor.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["uploadId","uploadStatus"]}),this.editor.plugins.has("ImageInlineEditing")&&e.extend("imageInline",{allowAttributes:["uploadId","uploadStatus"]})}_readAndUpload(e){const i=this.editor,s=i.model,o=i.locale.t,r=i.plugins.get(nl),a=i.plugins.get(F_),l=i.plugins.get("ImageUtils"),c=this._uploadImageElements;return s.enqueueChange({isUndoable:!1},d=>{d.setAttribute("uploadStatus","reading",c.get(e.id))}),e.read().then(()=>{const d=e.upload(),f=c.get(e.id);/* istanbul ignore next -- @preserve */if(ue.isSafari){const m=i.editing.mapper.toViewElement(f),g=l.findViewImgElement(m);i.editing.view.once("render",()=>{if(!g.parent)return;const p=i.editing.view.domConverter.mapViewToDom(g.parent);if(!p)return;const w=p.style.display;p.style.display="none",p._ckHack=p.offsetHeight,p.style.display=w})}return i.ui&&i.ui.ariaLiveAnnouncer.announce(o("Uploading image")),s.enqueueChange({isUndoable:!1},m=>{m.setAttribute("uploadStatus","uploading",f)}),d}).then(d=>{s.enqueueChange({isUndoable:!1},f=>{const m=c.get(e.id);f.setAttribute("uploadStatus","complete",m),i.ui&&i.ui.ariaLiveAnnouncer.announce(o("Image upload complete")),this.fire("uploadComplete",{data:d,imageElement:m})}),u()}).catch(d=>{if(i.ui&&i.ui.ariaLiveAnnouncer.announce(o("Error during image upload")),e.status!=="error"&&e.status!=="aborted")throw d;e.status=="error"&&d&&a.showWarning(d,{title:o("Upload failed"),namespace:"upload"}),s.enqueueChange({isUndoable:!1},f=>{f.remove(c.get(e.id))}),u()});function u(){s.enqueueChange({isUndoable:!1},d=>{const f=c.get(e.id);d.removeAttribute("uploadId",f),d.removeAttribute("uploadStatus",f),c.delete(e.id)}),r.destroyLoader(e)}}_parseAndSetSrcsetAttributeOnImage(e,i,s){let o=0;const r=Object.keys(e).filter(a=>{const l=parseInt(a,10);if(!isNaN(l))return o=Math.max(o,l),!0}).map(a=>`${e[a]} ${a}w`).join(", ");if(r!=""){const a={srcset:r};!i.hasAttribute("width")&&!i.hasAttribute("height")&&(a.width=o),s.setAttributes(a,i)}}}function Ree(n){return Array.from(n.types).includes("text/html")&&n.getData("text/html")!==""}function Lee(n,t){const e=n.plugins.get("ImageUtils");return Array.from(n.model.createRangeOn(t)).filter(i=>e.isImage(i.item)).map(i=>i.item)}class kP extends A{static get pluginName(){return"ImageUpload"}static get requires(){return[Pee,vee,yee]}}class Vee extends q{constructor(e){super(e);h(this,"urlInputView");h(this,"keystrokes");this.set("imageURLInputValue",""),this.set("isImageSelected",!1),this.set("isEnabled",!0),this.keystrokes=new tt,this.urlInputView=this._createUrlInputView(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-image-insert-url"]},children:[this.urlInputView,{tag:"div",attributes:{class:["ck","ck-image-insert-url__action-row"]}}]})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.keystrokes.destroy()}_createUrlInputView(){const e=this.locale,i=e.t,s=new wt(e,jn);return s.bind("label").to(this,"isImageSelected",o=>i(o?"Update image URL":"Insert image via URL")),s.bind("isEnabled").to(this),s.fieldView.inputMode="url",s.fieldView.placeholder="https://example.com/image.png",s.fieldView.bind("value").to(this,"imageURLInputValue",o=>o||""),s.fieldView.on("input",()=>{this.imageURLInputValue=s.fieldView.element.value.trim()}),s}focus(){this.urlInputView.focus()}}class Bee extends A{constructor(){super(...arguments);h(this,"_imageInsertUI");h(this,"_formView")}static get pluginName(){return"ImageInsertViaUrlUI"}static get requires(){return[uc,Il]}init(){this.editor.ui.componentFactory.add("insertImageViaUrl",()=>this._createToolbarButton()),this.editor.ui.componentFactory.add("menuBar:insertImageViaUrl",()=>this._createMenuBarButton("standalone"))}afterInit(){this._imageInsertUI=this.editor.plugins.get("ImageInsertUI"),this._imageInsertUI.registerIntegration({name:"url",observable:()=>this.editor.commands.get("insertImage"),buttonViewCreator:()=>this._createToolbarButton(),formViewCreator:()=>this._createDropdownButton(),menuBarButtonViewCreator:e=>this._createMenuBarButton(e?"insertOnly":"insertNested")})}_createInsertUrlButton(e){const i=new e(this.editor.locale);return i.icon=F.imageUrl,i.on("execute",()=>{this._showModal()}),i}_createToolbarButton(){const e=this.editor.locale.t,i=this._createInsertUrlButton(te);return i.tooltip=!0,i.bind("label").to(this._imageInsertUI,"isImageSelected",s=>e(s?"Update image URL":"Insert image via URL")),i}_createDropdownButton(){const e=this.editor.locale.t,i=this._createInsertUrlButton(te);return i.withText=!0,i.bind("label").to(this._imageInsertUI,"isImageSelected",s=>e(s?"Update image URL":"Insert via URL")),i}_createMenuBarButton(e){const i=this.editor.locale.t,s=this._createInsertUrlButton(pt);switch(s.withText=!0,e){case"standalone":s.label=i("Image via URL");break;case"insertOnly":s.label=i("Image");break;case"insertNested":s.label=i("Via URL");break}return s}_createInsertUrlView(){const e=this.editor,i=e.locale,s=e.commands.get("replaceImageSource"),o=e.commands.get("insertImage"),r=new Vee(i);return r.bind("isImageSelected").to(this._imageInsertUI),r.bind("isEnabled").toMany([o,s],"isEnabled",(...a)=>a.some(l=>l)),r}_showModal(){const e=this.editor,s=e.locale.t,o=e.plugins.get("Dialog");this._formView||(this._formView=this._createInsertUrlView(),this._formView.on("submit",()=>this._handleSave()));const r=e.commands.get("replaceImageSource");this._formView.imageURLInputValue=r.value||"",o.show({id:"insertImageViaUrl",title:this._imageInsertUI.isImageSelected?s("Update image URL"):s("Insert image via URL"),isModal:!0,content:this._formView,actionButtons:[{label:s("Cancel"),withText:!0,onExecute:()=>o.hide()},{label:s("Accept"),class:"ck-button-action",withText:!0,onExecute:()=>this._handleSave()}]})}_handleSave(){this.editor.commands.get("replaceImageSource").isEnabled?this.editor.execute("replaceImageSource",{source:this._formView.imageURLInputValue}):this.editor.execute("insertImage",{source:this._formView.imageURLInputValue}),this.editor.plugins.get("Dialog").hide()}}class TP extends A{static get pluginName(){return"ImageInsertViaUrl"}static get requires(){return[Bee,uc]}}class Mee extends A{static get pluginName(){return"ImageInsert"}static get requires(){return[kP,TP,uc]}}class Oee extends ne{refresh(){const t=this.editor,i=t.plugins.get("ImageUtils").getClosestSelectedImageElement(t.model.document.selection);this.isEnabled=!!i,!i||!i.hasAttribute("resizedWidth")?this.value=null:this.value={width:i.getAttribute("resizedWidth"),height:null}}execute(t){const e=this.editor,i=e.model,s=e.plugins.get("ImageUtils"),o=s.getClosestSelectedImageElement(i.document.selection);this.value={width:t.width,height:null},o&&i.change(r=>{r.setAttribute("resizedWidth",t.width,o),r.removeAttribute("resizedHeight",o),s.setImageNaturalSizeAttributes(o)})}}class EP extends A{static get requires(){return[jt]}static get pluginName(){return"ImageResizeEditing"}constructor(t){super(t),t.config.define("image",{resizeUnit:"%",resizeOptions:[{name:"resizeImage:original",value:null,icon:"original"},{name:"resizeImage:custom",value:"custom",icon:"custom"},{name:"resizeImage:25",value:"25",icon:"small"},{name:"resizeImage:50",value:"50",icon:"medium"},{name:"resizeImage:75",value:"75",icon:"large"}]})}init(){const t=this.editor,e=new Oee(t);this._registerConverters("imageBlock"),this._registerConverters("imageInline"),t.commands.add("resizeImage",e),t.commands.add("imageResize",e)}afterInit(){this._registerSchema()}_registerSchema(){this.editor.plugins.has("ImageBlockEditing")&&this.editor.model.schema.extend("imageBlock",{allowAttributes:["resizedWidth","resizedHeight"]}),this.editor.plugins.has("ImageInlineEditing")&&this.editor.model.schema.extend("imageInline",{allowAttributes:["resizedWidth","resizedHeight"]})}_registerConverters(t){const e=this.editor,i=e.plugins.get("ImageUtils");e.conversion.for("downcast").add(s=>s.on(`attribute:resizedWidth:${t}`,(o,r,a)=>{if(!a.consumable.consume(r.item,o.name))return;const l=a.writer,c=a.mapper.toViewElement(r.item);r.attributeNewValue!==null?(l.setStyle("width",r.attributeNewValue,c),l.addClass("image_resized",c)):(l.removeStyle("width",c),l.removeClass("image_resized",c))})),e.conversion.for("dataDowncast").attributeToAttribute({model:{name:t,key:"resizedHeight"},view:s=>({key:"style",value:{height:s}})}),e.conversion.for("editingDowncast").add(s=>s.on(`attribute:resizedHeight:${t}`,(o,r,a)=>{if(!a.consumable.consume(r.item,o.name))return;const l=a.writer,c=a.mapper.toViewElement(r.item),u=t==="imageInline"?i.findViewImgElement(c):c;r.attributeNewValue!==null?l.setStyle("height",r.attributeNewValue,u):l.removeStyle("height",u)})),e.conversion.for("upcast").attributeToAttribute({view:{name:t==="imageBlock"?"figure":"img",styles:{width:/.+/}},model:{key:"resizedWidth",value:s=>fd(s)?null:s.getStyle("width")}}),e.conversion.for("upcast").attributeToAttribute({view:{name:t==="imageBlock"?"figure":"img",styles:{height:/.+/}},model:{key:"resizedHeight",value:s=>fd(s)?null:s.getStyle("height")}})}}const Ff={small:F.objectSizeSmall,medium:F.objectSizeMedium,large:F.objectSizeLarge,custom:F.objectSizeCustom,original:F.objectSizeFull};class Nee extends A{constructor(e){super(e);h(this,"_resizeUnit");this._resizeUnit=e.config.get("image.resizeUnit")}static get requires(){return[EP]}static get pluginName(){return"ImageResizeButtons"}init(){const e=this.editor,i=e.config.get("image.resizeOptions"),s=e.commands.get("resizeImage");this.bind("isEnabled").to(s);for(const o of i)this._registerImageResizeButton(o);this._registerImageResizeDropdown(i)}_registerImageResizeButton(e){const i=this.editor,{name:s,value:o,icon:r}=e;i.ui.componentFactory.add(s,a=>{const l=new te(a),c=i.commands.get("resizeImage"),u=this._getOptionLabelValue(e,!0);if(!Ff[r])throw new C("imageresizebuttons-missing-icon",i,e);if(l.set({label:u,icon:Ff[r],tooltip:u,isToggleable:!0}),l.bind("isEnabled").to(this),i.plugins.has("ImageCustomResizeUI")&&xa(e)){const d=i.plugins.get("ImageCustomResizeUI");this.listenTo(l,"execute",()=>{d._showForm(this._resizeUnit)})}else{const d=o?o+this._resizeUnit:null;l.bind("isOn").to(c,"value",sg(d)),this.listenTo(l,"execute",()=>{i.execute("resizeImage",{width:d})})}return l})}_registerImageResizeDropdown(e){const i=this.editor,s=i.t,o=e.find(a=>!a.value),r=a=>{const l=i.commands.get("resizeImage"),c=Yt(a,PI),u=c.buttonView,d=s("Resize image");return u.set({tooltip:d,commandValue:o.value,icon:Ff.medium,isToggleable:!0,label:this._getOptionLabelValue(o),withText:!0,class:"ck-resize-image-button",ariaLabel:d,ariaLabelledBy:void 0}),u.bind("label").to(l,"value",f=>f&&f.width?f.width:this._getOptionLabelValue(o)),c.bind("isEnabled").to(this),ca(c,()=>this._getResizeDropdownListItemDefinitions(e,l),{ariaLabel:s("Image resize list"),role:"menu"}),this.listenTo(c,"execute",f=>{"onClick"in f.source?f.source.onClick():(i.execute(f.source.commandName,{width:f.source.commandValue}),i.editing.view.focus())}),c};i.ui.componentFactory.add("resizeImage",r),i.ui.componentFactory.add("imageResize",r)}_getOptionLabelValue(e,i=!1){const s=this.editor.t;return e.label?e.label:i?xa(e)?s("Custom image size"):e.value?s("Resize image to %0",e.value+this._resizeUnit):s("Resize image to the original size"):xa(e)?s("Custom"):e.value?e.value+this._resizeUnit:s("Original")}_getResizeDropdownListItemDefinitions(e,i){const{editor:s}=this,o=new rn,r=e.map(a=>xa(a)?{...a,valueWithUnits:"custom"}:a.value?{...a,valueWithUnits:`${a.value}${this._resizeUnit}`}:{...a,valueWithUnits:null});for(const a of r){let l=null;if(s.plugins.has("ImageCustomResizeUI")&&xa(a)){const c=s.plugins.get("ImageCustomResizeUI");l={type:"button",model:new Wr({label:this._getOptionLabelValue(a),role:"menuitemradio",withText:!0,icon:null,onClick:()=>{c._showForm(this._resizeUnit)}})};const u=na(r,"valueWithUnits");l.model.bind("isOn").to(i,"value",Fee(u))}else l={type:"button",model:new Wr({commandName:"resizeImage",commandValue:a.valueWithUnits,label:this._getOptionLabelValue(a),role:"menuitemradio",withText:!0,icon:null})},l.model.bind("isOn").to(i,"value",sg(a.valueWithUnits));l.model.bind("isEnabled").to(i,"isEnabled"),o.add(l)}return o}}function xa(n){return n.value==="custom"}function sg(n){return t=>{const e=t;return n===null&&e===n?!0:e!==null&&e.width===n}}function Fee(n){return t=>!n.some(e=>sg(e)(t))}const Dee="figure.image.ck-widget > img,figure.image.ck-widget > picture > img,figure.image.ck-widget > a > img,figure.image.ck-widget > a > picture > img,span.image-inline.ck-widget > img,span.image-inline.ck-widget > picture > img",Df="image_resized";class $ee extends A{static get requires(){return[Lf,jt]}static get pluginName(){return"ImageResizeHandles"}init(){const t=this.editor.commands.get("resizeImage");this.bind("isEnabled").to(t),this._setupResizerCreator()}_setupResizerCreator(){const t=this.editor,e=t.editing.view,i=t.plugins.get("ImageUtils");e.addObserver(ew),this.listenTo(e.document,"imageLoaded",(s,o)=>{if(!o.target.matches(Dee))return;const r=t.editing.view.domConverter,a=r.domToView(o.target),l=i.getImageWidgetFromImageView(a);let c=this.editor.plugins.get(Lf).getResizerByViewElement(l);if(c){c.redraw();return}const u=t.editing.mapper,d=u.toModelElement(l);c=t.plugins.get(Lf).attachTo({unit:t.config.get("image.resizeUnit"),modelElement:d,viewElement:l,editor:t,getHandleHost(f){return f.querySelector("img")},getResizeHost(){return r.mapViewToDom(u.toViewElement(d))},isCentered(){return d.getAttribute("imageStyle")=="alignCenter"},onCommit(f){e.change(m=>{m.removeClass(Df,l)}),t.execute("resizeImage",{width:f})}}),c.on("updateSize",()=>{l.hasClass(Df)||e.change(m=>{m.addClass(Df,l)});const f=d.name==="imageInline"?a:l;f.getStyle("height")&&e.change(m=>{m.removeStyle("height",f)})}),c.bind("isEnabled").to(this)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function AP(n){if(!n)return null;const[,t,e]=n.trim().match(/([.,\d]+)(%|px)$/)||[],i=Number.parseFloat(t);return Number.isNaN(i)?null:{value:i,unit:e}}function xP(n,t,e){return e==="px"?{value:t.value,unit:"px"}:{value:t.value/n*100,unit:"%"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function SP(n){const{editing:t}=n,i=n.plugins.get("ImageUtils").getClosestSelectedImageElement(n.model.document.selection);if(!i)return null;const s=t.mapper.toViewElement(i),o=t.view.domConverter.mapViewToDom(s);return{model:i,view:s,dom:o}}function Hee(n,t){const e=SP(n);if(!e)return null;const i=AP(e.model.getAttribute("resizedWidth")||null);if(!i)return null;if(i.unit===t)return i;const s=jb(e.dom),o={unit:"px",value:new he(e.dom).width};return xP(s,o,t)}class zee extends q{constructor(e,i,s){super(e);h(this,"focusTracker");h(this,"keystrokes");h(this,"unit");h(this,"labeledInput");h(this,"saveButtonView");h(this,"cancelButtonView");h(this,"_focusables");h(this,"_focusCycler");h(this,"_validators");const o=this.locale.t;this.focusTracker=new Ge,this.keystrokes=new tt,this.unit=i,this.labeledInput=this._createLabeledInputView(),this.saveButtonView=this._createButton(o("Save"),F.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(o("Cancel"),F.cancel,"ck-button-cancel","cancel"),this._focusables=new Mt,this._validators=s,this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"form",attributes:{class:["ck","ck-image-custom-resize-form","ck-responsive-form"],tabindex:"-1"},children:[this.labeledInput,this.saveButtonView,this.cancelButtonView]})}render(){super.render(),this.keystrokes.listenTo(this.element),qo({view:this}),[this.labeledInput,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createButton(e,i,s,o){const r=new te(this.locale);return r.set({label:e,icon:i,tooltip:!0}),r.extendTemplate({attributes:{class:s}}),o&&r.delegate("execute").to(this,o),r}_createLabeledInputView(){const e=this.locale.t,i=new wt(this.locale,VI);return i.label=e("Resize image (in %0)",this.unit),i.fieldView.set({step:.1}),i}isValid(){this.resetFormStatus();for(const e of this._validators){const i=e(this);if(i)return this.labeledInput.errorText=i,!1}return!0}resetFormStatus(){this.labeledInput.errorText=null}get rawSize(){const{element:e}=this.labeledInput.fieldView;return e?e.value:null}get parsedSize(){const{rawSize:e}=this;if(e===null)return null;const i=Number.parseFloat(e);return Number.isNaN(i)?null:i}get sizeWithUnits(){const{parsedSize:e,unit:i}=this;return e===null?null:`${e}${i}`}}function Uee(n,t){const e=SP(n);if(!e)return null;const i=jb(e.dom),s=AP(window.getComputedStyle(e.dom).minWidth)||{value:1,unit:"px"},o=Math.max(.1,xP(i,s,t).value);return{unit:t,lower:o,upper:t==="px"?i:100}}class Wee extends A{constructor(){super(...arguments);h(this,"_balloon");h(this,"_form")}static get requires(){return[mi]}static get pluginName(){return"ImageCustomResizeUI"}destroy(){super.destroy(),this._form&&this._form.destroy()}_createForm(e){const i=this.editor;this._balloon=this.editor.plugins.get("ContextualBalloon"),this._form=new(Vh(zee))(i.locale,e,qee(i)),this._form.render(),this.listenTo(this._form,"submit",()=>{this._form.isValid()&&(i.execute("resizeImage",{width:this._form.sizeWithUnits}),this._hideForm(!0))}),this.listenTo(this._form.labeledInput,"change:errorText",()=>{i.ui.update()}),this.listenTo(this._form,"cancel",()=>{this._hideForm(!0)}),this._form.keystrokes.set("Esc",(s,o)=>{this._hideForm(!0),o()}),Wo({emitter:this._form,activator:()=>this._isVisible,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideForm()})}_showForm(e){if(this._isVisible)return;this._form||this._createForm(e);const i=this.editor,s=this._form.labeledInput;this._form.disableCssTransitions(),this._form.resetFormStatus(),this._isInBalloon||this._balloon.add({view:this._form,position:Xb(i)});const o=Hee(i,e),r=o?o.value.toFixed(1):"",a=Uee(i,e);s.fieldView.value=s.fieldView.element.value=r,a&&Object.assign(s.fieldView,{min:a.lower.toFixed(1),max:Math.ceil(a.upper).toFixed(1)}),this._form.labeledInput.fieldView.select(),this._form.enableCssTransitions()}_hideForm(e=!1){this._isInBalloon&&(this._form.focusTracker.isFocused&&this._form.saveButtonView.focus(),this._balloon.remove(this._form),e&&this.editor.editing.view.focus())}get _isVisible(){return!!this._balloon&&this._balloon.visibleView===this._form}get _isInBalloon(){return!!this._balloon&&this._balloon.hasView(this._form)}}function qee(n){const t=n.t;return[e=>{if(e.rawSize.trim()==="")return t("The value must not be empty.");if(e.parsedSize===null)return t("The value should be a plain number.")}]}class jee extends A{static get requires(){return[EP,$ee,Wee,Nee]}static get pluginName(){return"ImageResize"}}class Gee extends ne{constructor(e,i){super(e);h(this,"_defaultStyles");h(this,"_styles");this._defaultStyles={imageBlock:!1,imageInline:!1},this._styles=new Map(i.map(s=>{if(s.isDefault)for(const o of s.modelElements)this._defaultStyles[o]=s.name;return[s.name,s]}))}refresh(){const s=this.editor.plugins.get("ImageUtils").getClosestSelectedImageElement(this.editor.model.document.selection);this.isEnabled=!!s,this.isEnabled?s.hasAttribute("imageStyle")?this.value=s.getAttribute("imageStyle"):this.value=this._defaultStyles[s.name]:this.value=!1}execute(e={}){const i=this.editor,s=i.model,o=i.plugins.get("ImageUtils");s.change(r=>{const a=e.value,{setImageSizes:l=!0}=e;let c=o.getClosestSelectedImageElement(s.document.selection);a&&this.shouldConvertImageType(a,c)&&(this.editor.execute(o.isBlockImage(c)?"imageTypeInline":"imageTypeBlock",{setImageSizes:l}),c=o.getClosestSelectedImageElement(s.document.selection)),!a||this._styles.get(a).isDefault?r.removeAttribute("imageStyle",c):r.setAttribute("imageStyle",a,c),l&&o.setImageNaturalSizeAttributes(c)})}shouldConvertImageType(e,i){return!this._styles.get(e).modelElements.includes(i.name)}}const wu={get inline(){return{name:"inline",title:"In line",icon:F.objectInline,modelElements:["imageInline"],isDefault:!0}},get alignLeft(){return{name:"alignLeft",title:"Left aligned image",icon:F.objectLeft,modelElements:["imageBlock","imageInline"],className:"image-style-align-left"}},get alignBlockLeft(){return{name:"alignBlockLeft",title:"Left aligned image",icon:F.objectBlockLeft,modelElements:["imageBlock"],className:"image-style-block-align-left"}},get alignCenter(){return{name:"alignCenter",title:"Centered image",icon:F.objectCenter,modelElements:["imageBlock"],className:"image-style-align-center"}},get alignRight(){return{name:"alignRight",title:"Right aligned image",icon:F.objectRight,modelElements:["imageBlock","imageInline"],className:"image-style-align-right"}},get alignBlockRight(){return{name:"alignBlockRight",title:"Right aligned image",icon:F.objectBlockRight,modelElements:["imageBlock"],className:"image-style-block-align-right"}},get block(){return{name:"block",title:"Centered image",icon:F.objectCenter,modelElements:["imageBlock"],isDefault:!0}},get side(){return{name:"side",title:"Side image",icon:F.objectRight,modelElements:["imageBlock"],className:"image-style-side"}}},IP={full:F.objectFullWidth,left:F.objectBlockLeft,right:F.objectBlockRight,center:F.objectCenter,inlineLeft:F.objectLeft,inlineRight:F.objectRight,inline:F.objectInline},PP=[{name:"imageStyle:wrapText",title:"Wrap text",defaultItem:"imageStyle:alignLeft",items:["imageStyle:alignLeft","imageStyle:alignRight"]},{name:"imageStyle:breakText",title:"Break text",defaultItem:"imageStyle:block",items:["imageStyle:alignBlockLeft","imageStyle:block","imageStyle:alignBlockRight"]}];function Kee(n){return(n.configuredStyles.options||[]).map(i=>Yee(i)).filter(i=>Xee(i,n))}function Zee(n,t){return n&&t?{options:["inline","alignLeft","alignRight","alignCenter","alignBlockLeft","alignBlockRight","block","side"]}:n?{options:["block","side"]}:t?{options:["inline","alignLeft","alignRight"]}:{}}function Jee(n){return n.has("ImageBlockEditing")&&n.has("ImageInlineEditing")?[...PP]:[]}function Yee(n){return typeof n=="string"?wu[n]?n={...wu[n]}:n={name:n}:n=Qee(wu[n.name],n),typeof n.icon=="string"&&(n.icon=IP[n.icon]||n.icon),n}function Xee(n,{isBlockPluginLoaded:t,isInlinePluginLoaded:e}){const{modelElements:i,name:s}=n;if(!i||!i.length||!s)return RP({style:n}),!1;{const o=[t?"imageBlock":null,e?"imageInline":null];if(!i.some(r=>o.includes(r)))return Te("image-style-missing-dependency",{style:n,missingPlugins:i.map(r=>r==="imageBlock"?"ImageBlockEditing":"ImageInlineEditing")}),!1}return!0}function Qee(n,t){const e={...t};for(const i in n)Object.prototype.hasOwnProperty.call(t,i)||(e[i]=n[i]);return e}function RP(n){Te("image-style-configuration-definition-invalid",n)}var og={normalizeStyles:Kee,getDefaultStylesConfiguration:Zee,getDefaultDropdownDefinitions:Jee,warnInvalidStyle:RP,DEFAULT_OPTIONS:wu,DEFAULT_ICONS:IP,DEFAULT_DROPDOWN_DEFINITIONS:PP};function ete(n){return(t,e,i)=>{if(!i.consumable.consume(e.item,t.name))return;const s=Pv(e.attributeNewValue,n),o=Pv(e.attributeOldValue,n),r=i.mapper.toViewElement(e.item),a=i.writer;o&&a.removeClass(o.className,r),s&&a.addClass(s.className,r)}}function tte(n){const t={imageInline:n.filter(e=>!e.isDefault&&e.modelElements.includes("imageInline")),imageBlock:n.filter(e=>!e.isDefault&&e.modelElements.includes("imageBlock"))};return(e,i,s)=>{if(!i.modelRange)return;const o=i.viewItem,r=Ye(i.modelRange.getItems());if(r&&s.schema.checkAttribute(r,"imageStyle"))for(const a of t[r.name])s.consumable.consume(o,{classes:a.className})&&s.writer.setAttribute("imageStyle",a.name,r)}}function Pv(n,t){for(const e of t)if(e.name===n)return e}class LP extends A{constructor(){super(...arguments);h(this,"normalizedStyles")}static get pluginName(){return"ImageStyleEditing"}static get requires(){return[jt]}init(){const{normalizeStyles:e,getDefaultStylesConfiguration:i}=og,s=this.editor,o=s.plugins.has("ImageBlockEditing"),r=s.plugins.has("ImageInlineEditing");s.config.define("image.styles",i(o,r)),this.normalizedStyles=e({configuredStyles:s.config.get("image.styles"),isBlockPluginLoaded:o,isInlinePluginLoaded:r}),this._setupConversion(o,r),this._setupPostFixer(),s.commands.add("imageStyle",new Gee(s,this.normalizedStyles))}_setupConversion(e,i){const s=this.editor,o=s.model.schema,r=ete(this.normalizedStyles),a=tte(this.normalizedStyles);s.editing.downcastDispatcher.on("attribute:imageStyle",r),s.data.downcastDispatcher.on("attribute:imageStyle",r),e&&(o.extend("imageBlock",{allowAttributes:"imageStyle"}),s.data.upcastDispatcher.on("element:figure",a,{priority:"low"})),i&&(o.extend("imageInline",{allowAttributes:"imageStyle"}),s.data.upcastDispatcher.on("element:img",a,{priority:"low"}))}_setupPostFixer(){const e=this.editor,i=e.model.document,s=e.plugins.get(jt),o=new Map(this.normalizedStyles.map(r=>[r.name,r]));i.registerPostFixer(r=>{let a=!1;for(const l of i.differ.getChanges())if(l.type=="insert"||l.type=="attribute"&&l.attributeKey=="imageStyle"){let c=l.type=="insert"?l.position.nodeAfter:l.range.start.nodeAfter;if(c&&c.is("element","paragraph")&&c.childCount>0&&(c=c.getChild(0)),!s.isImage(c))continue;const u=c.getAttribute("imageStyle");if(!u)continue;const d=o.get(u);(!d||!d.modelElements.includes(c.name))&&(r.removeAttribute("imageStyle",c),a=!0)}return a})}}class nte extends A{static get requires(){return[LP]}static get pluginName(){return"ImageStyleUI"}get localizedDefaultStylesTitles(){const t=this.editor.t;return{"Wrap text":t("Wrap text"),"Break text":t("Break text"),"In line":t("In line"),"Full size image":t("Full size image"),"Side image":t("Side image"),"Left aligned image":t("Left aligned image"),"Centered image":t("Centered image"),"Right aligned image":t("Right aligned image")}}init(){const t=this.editor.plugins,e=this.editor.config.get("image.toolbar")||[],i=t.get("ImageStyleEditing"),s=Rv(i.normalizedStyles,this.localizedDefaultStylesTitles);for(const r of s)this._createButton(r);const o=Rv([...e.filter(Ce),...og.getDefaultDropdownDefinitions(t)],this.localizedDefaultStylesTitles);for(const r of o)this._createDropdown(r,s)}_createDropdown(t,e){const i=this.editor.ui.componentFactory;i.add(t.name,s=>{let o;const{defaultItem:r,items:a,title:l}=t,c=a.filter(m=>e.find(({name:g})=>Lv(g)===m)).map(m=>{const g=i.create(m);return m===r&&(o=g),g});a.length!==c.length&&og.warnInvalidStyle({dropdown:t});const u=Yt(s,la),d=u.buttonView,f=d.arrowView;return Oh(u,c,{enableActiveItemFocusOnDropdownOpen:!0}),d.set({label:Vv(l,o.label),class:null,tooltip:!0}),f.unbind("label"),f.set({label:l}),d.bind("icon").toMany(c,"isOn",(...m)=>{const g=m.findIndex(ft);return g<0?o.icon:c[g].icon}),d.bind("label").toMany(c,"isOn",(...m)=>{const g=m.findIndex(ft);return Vv(l,g<0?o.label:c[g].label)}),d.bind("isOn").toMany(c,"isOn",(...m)=>m.some(ft)),d.bind("class").toMany(c,"isOn",(...m)=>m.some(ft)?"ck-splitbutton_flatten":void 0),d.on("execute",()=>{c.some(({isOn:m})=>m)?u.isOpen=!u.isOpen:o.fire("execute")}),u.bind("isEnabled").toMany(c,"isEnabled",(...m)=>m.some(ft)),this.listenTo(u,"execute",()=>{this.editor.editing.view.focus()}),u})}_createButton(t){const e=t.name;this.editor.ui.componentFactory.add(Lv(e),i=>{const s=this.editor.commands.get("imageStyle"),o=new te(i);return o.set({label:t.title,icon:t.icon,tooltip:!0,isToggleable:!0}),o.bind("isEnabled").to(s,"isEnabled"),o.bind("isOn").to(s,"value",r=>r===e),o.on("execute",this._executeCommand.bind(this,e)),o})}_executeCommand(t){this.editor.execute("imageStyle",{value:t}),this.editor.editing.view.focus()}}function Rv(n,t){for(const e of n)t[e.title]&&(e.title=t[e.title]);return n}function Lv(n){return`imageStyle:${n}`}function Vv(n,t){return(n?n+": ":"")+t}class ite extends A{static get requires(){return[LP,nte]}static get pluginName(){return"ImageStyle"}}class ste extends A{static get requires(){return[ad,jt]}static get pluginName(){return"ImageToolbar"}afterInit(){const t=this.editor,e=t.t,i=t.plugins.get(ad),s=t.plugins.get("ImageUtils");i.register("image",{ariaLabel:e("Image toolbar"),items:ote(t.config.get("image.toolbar")||[]),getRelatedElement:o=>s.getClosestSelectedImageWidget(o)})}}function ote(n){return n.map(t=>Ce(t)?t.name:t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class rte extends A{static get pluginName(){return"IndentEditing"}init(){const t=this.editor;t.commands.add("indent",new d_(t)),t.commands.add("outdent",new d_(t))}}class ate extends A{static get pluginName(){return"IndentUI"}init(){const t=this.editor,e=t.locale,i=t.t,s=e.uiLanguageDirection=="ltr"?F.indent:F.outdent,o=e.uiLanguageDirection=="ltr"?F.outdent:F.indent;this._defineButton("indent",i("Increase indent"),s),this._defineButton("outdent",i("Decrease indent"),o)}_defineButton(t,e,i){const s=this.editor;s.ui.componentFactory.add(t,()=>{const o=this._createButton(te,t,e,i);return o.set({tooltip:!0}),o}),s.ui.componentFactory.add("menuBar:"+t,()=>this._createButton(pt,t,e,i))}_createButton(t,e,i,s){const o=this.editor,r=o.commands.get(e),a=new t(o.locale);return a.set({label:i,icon:s}),a.bind("isEnabled").to(r,"isEnabled"),this.listenTo(a,"execute",()=>{o.execute(e),o.editing.view.focus()}),a}}class lte extends A{static get pluginName(){return"Indent"}static get requires(){return[rte,ate]}}class eu extends ne{constructor(e,i){super(e);h(this,"_indentBehavior");this._indentBehavior=i}refresh(){const i=this.editor.model,s=Ye(i.document.selection.getSelectedBlocks());if(!s||!this._isIndentationChangeAllowed(s)){this.isEnabled=!1;return}this.isEnabled=this._indentBehavior.checkEnabled(s.getAttribute("blockIndent"))}execute(){const e=this.editor.model,i=this._getBlocksToChange();e.change(s=>{for(const o of i){const r=o.getAttribute("blockIndent"),a=this._indentBehavior.getNextIndent(r);a?s.setAttribute("blockIndent",a,o):s.removeAttribute("blockIndent",o)}})}_getBlocksToChange(){const i=this.editor.model.document.selection;return Array.from(i.getSelectedBlocks()).filter(o=>this._isIndentationChangeAllowed(o))}_isIndentationChangeAllowed(e){const i=this.editor;return i.model.schema.checkAttribute(e,"blockIndent")?!i.plugins.has("ListUtils")||!this._indentBehavior.isForward?!0:!i.plugins.get("ListUtils").isListItemBlock(e):!1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Bv{constructor(t){h(this,"isForward");h(this,"offset");h(this,"unit");this.isForward=t.direction==="forward",this.offset=t.offset,this.unit=t.unit}checkEnabled(t){const e=parseFloat(t||"0");return this.isForward||e>0}getNextIndent(t){const e=parseFloat(t||"0");if(!(!t||t.endsWith(this.unit)))return this.isForward?this.offset+this.unit:void 0;const s=this.isForward?this.offset:-this.offset,o=e+s;return o>0?o+this.unit:void 0}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Mv{constructor(t){h(this,"isForward");h(this,"classes");this.isForward=t.direction==="forward",this.classes=t.classes}checkEnabled(t){const e=this.classes.indexOf(t);return this.isForward?e<this.classes.length-1:e>=0}getNextIndent(t){const e=this.classes.indexOf(t),i=this.isForward?1:-1;return this.classes[e+i]}}const cte=["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"];class ute extends A{constructor(t){super(t),t.config.define("indentBlock",{offset:40,unit:"px"})}static get pluginName(){return"IndentBlock"}init(){const t=this.editor,e=t.config.get("indentBlock");e.classes&&e.classes.length?(this._setupConversionUsingClasses(e.classes),t.commands.add("indentBlock",new eu(t,new Mv({direction:"forward",classes:e.classes}))),t.commands.add("outdentBlock",new eu(t,new Mv({direction:"backward",classes:e.classes})))):(t.data.addStyleProcessorRules(Ej),this._setupConversionUsingOffset(),t.commands.add("indentBlock",new eu(t,new Bv({direction:"forward",offset:e.offset,unit:e.unit}))),t.commands.add("outdentBlock",new eu(t,new Bv({direction:"backward",offset:e.offset,unit:e.unit}))))}afterInit(){const t=this.editor,e=t.model.schema,i=t.commands.get("indent"),s=t.commands.get("outdent"),o=t.config.get("heading.options");(o&&o.map(l=>l.model)||cte).forEach(l=>{e.isRegistered(l)&&e.extend(l,{allowAttributes:"blockIndent"})}),e.setAttributeProperties("blockIndent",{isFormatting:!0}),i.registerChildCommand(t.commands.get("indentBlock")),s.registerChildCommand(t.commands.get("outdentBlock"))}_setupConversionUsingOffset(){const t=this.editor.conversion,i=this.editor.locale.contentLanguageDirection==="rtl"?"margin-right":"margin-left";t.for("upcast").attributeToAttribute({view:{styles:{[i]:/[\s\S]+/}},model:{key:"blockIndent",value:s=>{if(!s.is("element","li"))return s.getStyle(i)}}}),t.for("downcast").attributeToAttribute({model:"blockIndent",view:s=>({key:"style",value:{[i]:s}})})}_setupConversionUsingClasses(t){const e={model:{key:"blockIndent",values:[]},view:{}};for(const i of t)e.model.values.push(i),e.view[i]={key:"class",value:[i]};this.editor.conversion.attributeToAttribute(e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class dte{constructor(){h(this,"_definitions",new Set)}get length(){return this._definitions.size}add(t){Array.isArray(t)?t.forEach(e=>this._definitions.add(e)):this._definitions.add(t)}getDispatcher(){return t=>{t.on("attribute:linkHref",(e,i,s)=>{if(!s.consumable.test(i.item,"attribute:linkHref")||!(i.item.is("selection")||s.schema.isInline(i.item)))return;const o=s.writer,r=o.document.selection;for(const a of this._definitions){const l=o.createAttributeElement("a",a.attributes,{priority:5});a.classes&&o.addClass(a.classes,l);for(const c in a.styles)o.setStyle(c,a.styles[c],l);o.setCustomProperty("link",!0,l),a.callback(i.attributeNewValue)?i.item.is("selection")?o.wrap(r.getFirstRange(),l):o.wrap(s.mapper.toViewRange(i.range),l):o.unwrap(s.mapper.toViewRange(i.range),l)}},{priority:"high"})}}getDispatcherForLinkedImage(){return t=>{t.on("attribute:linkHref:imageBlock",(e,i,{writer:s,mapper:o})=>{const r=o.toViewElement(i.item),a=Array.from(r.getChildren()).find(l=>l.is("element","a"));for(const l of this._definitions){const c=Ii(l.attributes);if(l.callback(i.attributeNewValue)){for(const[u,d]of c)u==="class"?s.addClass(d,a):s.setAttribute(u,d,a);l.classes&&s.addClass(l.classes,a);for(const u in l.styles)s.setStyle(u,l.styles[u],a)}else{for(const[u,d]of c)u==="class"?s.removeClass(d,a):s.removeAttribute(u,a);l.classes&&s.removeClass(l.classes,a);for(const u in l.styles)s.removeStyle(u,a)}}})}}}const hte=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,fte="^(?:(?:<protocols>):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))",mte=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,gte=/^((\w+:(\/{2,})?)|(\W))/i,pte=["https?","ftps?","mailto"],Ba="Ctrl+K";function bte(n){return n.is("attributeElement")&&!!n.getCustomProperty("link")}function Ov(n,{writer:t}){const e=t.createAttributeElement("a",{href:n},{priority:5});return t.setCustomProperty("link",!0,e),e}function VP(n,t=pte){const e=String(n),i=t.join("|"),s=new RegExp(`${fte.replace("<protocols>",i)}`,"i");return wte(e,s)?e:"#"}function wte(n,t){return!!n.replace(hte,"").match(t)}function _te(n,t){const e={"Open in a new tab":n("Open in a new tab"),Downloadable:n("Downloadable")};return t.forEach(i=>("label"in i&&e[i.label]&&(i.label=e[i.label]),i)),t}function vte(n){const t=[];if(n)for(const[e,i]of Object.entries(n)){const s=Object.assign({},i,{id:`link${Yl(e)}`});t.push(s)}return t}function rg(n,t){return n?t.checkAttribute(n.name,"linkHref"):!1}function yte(n){return mte.test(n)}function tw(n,t){const e=yte(n)?"mailto:":t,i=!!e&&!BP(n);return n&&i?e+n:n}function BP(n){return gte.test(n)}function Nv(n){window.open(n,"_blank","noopener")}class Cte extends ne{constructor(){super(...arguments);h(this,"manualDecorators",new rn);h(this,"automaticDecorators",new dte)}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,i=e.document.selection,s=i.getSelectedElement()||Ye(i.getSelectedBlocks());rg(s,e.schema)?(this.value=s.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(s,"linkHref")):(this.value=i.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(i,"linkHref"));for(const o of this.manualDecorators)o.value=this._getDecoratorStateFromModel(o.id)}execute(e,i={}){const s=this.editor.model,o=s.document.selection,r=[],a=[];for(const l in i)i[l]?r.push(l):a.push(l);s.change(l=>{if(o.isCollapsed){const c=o.getFirstPosition();if(o.hasAttribute("linkHref")){const u=Fv(o);let d=ac(c,"linkHref",o.getAttribute("linkHref"),s);o.getAttribute("linkHref")===u&&(d=this._updateLinkContent(s,l,d,e)),l.setAttribute("linkHref",e,d),r.forEach(f=>{l.setAttribute(f,!0,d)}),a.forEach(f=>{l.removeAttribute(f,d)}),l.setSelection(l.createPositionAfter(d.end.nodeBefore))}else if(e!==""){const u=Ii(o.getAttributes());u.set("linkHref",e),r.forEach(f=>{u.set(f,!0)});const{end:d}=s.insertContent(l.createText(e,u),c);l.setSelection(d)}["linkHref",...r,...a].forEach(u=>{l.removeSelectionAttribute(u)})}else{const c=s.schema.getValidRanges(o.getRanges(),"linkHref"),u=[];for(const f of o.getSelectedBlocks())s.schema.checkAttribute(f,"linkHref")&&u.push(l.createRangeOn(f));const d=u.slice();for(const f of c)this._isRangeToUpdate(f,u)&&d.push(f);for(const f of d){let m=f;if(d.length===1){const g=Fv(o);o.getAttribute("linkHref")===g&&(m=this._updateLinkContent(s,l,f,e),l.setSelection(l.createSelection(m)))}l.setAttribute("linkHref",e,m),r.forEach(g=>{l.setAttribute(g,!0,m)}),a.forEach(g=>{l.removeAttribute(g,m)})}}})}_getDecoratorStateFromModel(e){const i=this.editor.model,s=i.document.selection,o=s.getSelectedElement();return rg(o,i.schema)?o.getAttribute(e):s.getAttribute(e)}_isRangeToUpdate(e,i){for(const s of i)if(s.containsRange(e))return!1;return!0}_updateLinkContent(e,i,s,o){const r=i.createText(o,{linkHref:o});return e.insertContent(r,s)}}function Fv(n){if(n.isCollapsed){const t=n.getFirstPosition();return t.textNode&&t.textNode.data}else{const t=Array.from(n.getFirstRange().getItems());if(t.length>1)return null;const e=t[0];return e.is("$text")||e.is("$textProxy")?e.data:null}}class kte extends ne{refresh(){const t=this.editor.model,e=t.document.selection,i=e.getSelectedElement();rg(i,t.schema)?this.isEnabled=t.schema.checkAttribute(i,"linkHref"):this.isEnabled=t.schema.checkAttributeInSelection(e,"linkHref")}execute(){const t=this.editor,e=this.editor.model,i=e.document.selection,s=t.commands.get("link");e.change(o=>{const r=i.isCollapsed?[ac(i.getFirstPosition(),"linkHref",i.getAttribute("linkHref"),e)]:e.schema.getValidRanges(i.getRanges(),"linkHref");for(const a of r)if(o.removeAttribute("linkHref",a),s)for(const l of s.manualDecorators)o.removeAttribute(l.id,a)})}}class Tte extends Ve(){constructor({id:e,label:i,attributes:s,classes:o,styles:r,defaultValue:a}){super();h(this,"id");h(this,"defaultValue");h(this,"label");h(this,"attributes");h(this,"classes");h(this,"styles");this.id=e,this.set("value",void 0),this.defaultValue=a,this.label=i,this.attributes=s,this.classes=o,this.styles=r}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}const Ete="ck-link_selected",Dv="automatic",Ate="manual",xte=/^(https?:)?\/\//;class Dh extends A{static get pluginName(){return"LinkEditing"}static get requires(){return[od,jI,Hn]}constructor(t){super(t),t.config.define("link",{allowCreatingEmptyLinks:!1,addTargetToExternalLinks:!1})}init(){const t=this.editor,e=this.editor.config.get("link.allowedProtocols");t.model.schema.extend("$text",{allowAttributes:"linkHref"}),t.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:Ov}),t.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(o,r)=>Ov(VP(o,e),r)}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:o=>o.getAttribute("href")}}),t.commands.add("link",new Cte(t)),t.commands.add("unlink",new kte(t));const i=_te(t.t,vte(t.config.get("link.decorators")));this._enableAutomaticDecorators(i.filter(o=>o.mode===Dv)),this._enableManualDecorators(i.filter(o=>o.mode===Ate)),t.plugins.get(od).registerAttribute("linkHref"),JI(t,"linkHref","a",Ete),this._enableLinkOpen(),this._enableSelectionAttributesFixer(),this._enableClipboardIntegration()}_enableAutomaticDecorators(t){const e=this.editor,s=e.commands.get("link").automaticDecorators;e.config.get("link.addTargetToExternalLinks")&&s.add({id:"linkIsExternal",mode:Dv,callback:o=>!!o&&xte.test(o),attributes:{target:"_blank",rel:"noopener noreferrer"}}),s.add(t),s.length&&e.conversion.for("downcast").add(s.getDispatcher())}_enableManualDecorators(t){if(!t.length)return;const e=this.editor,s=e.commands.get("link").manualDecorators;t.forEach(o=>{e.model.schema.extend("$text",{allowAttributes:o.id});const r=new Tte(o);s.add(r),e.conversion.for("downcast").attributeToElement({model:r.id,view:(a,{writer:l,schema:c},{item:u})=>{if((u.is("selection")||c.isInline(u))&&a){const d=l.createAttributeElement("a",r.attributes,{priority:5});r.classes&&l.addClass(r.classes,d);for(const f in r.styles)l.setStyle(f,r.styles[f],d);return l.setCustomProperty("link",!0,d),d}}}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",...r._createPattern()},model:{key:r.id}})})}_enableLinkOpen(){const t=this.editor,i=t.editing.view.document;this.listenTo(i,"click",(s,o)=>{if(!(ue.isMac?o.domEvent.metaKey:o.domEvent.ctrlKey))return;let a=o.domTarget;if(a.tagName.toLowerCase()!="a"&&(a=a.closest("a")),!a)return;const l=a.getAttribute("href");l&&(s.stop(),o.preventDefault(),Nv(l))},{context:"$capture"}),this.listenTo(i,"keydown",(s,o)=>{const a=t.commands.get("link").value;a&&o.keyCode===_e.enter&&o.altKey&&(s.stop(),Nv(a))})}_enableSelectionAttributesFixer(){const e=this.editor.model,i=e.document.selection;this.listenTo(i,"change:attribute",(s,{attributeKeys:o})=>{!o.includes("linkHref")||i.hasAttribute("linkHref")||e.change(r=>{Ste(r,Ite(e.schema))})})}_enableClipboardIntegration(){const t=this.editor,e=t.model,i=this.editor.config.get("link.defaultProtocol");i&&this.listenTo(t.plugins.get("ClipboardPipeline"),"contentInsertion",(s,o)=>{e.change(r=>{const a=r.createRangeIn(o.content);for(const l of a.getItems())if(l.hasAttribute("linkHref")){const c=tw(l.getAttribute("linkHref"),i);r.setAttribute("linkHref",c,l)}})})}}function Ste(n,t){n.removeSelectionAttribute("linkHref");for(const e of t)n.removeSelectionAttribute(e)}function Ite(n){return n.getDefinition("$text").allowAttributes.filter(e=>e.startsWith("link"))}class Pte extends q{constructor(e,i,s){super(e);h(this,"focusTracker",new Ge);h(this,"keystrokes",new tt);h(this,"urlInputView");h(this,"saveButtonView");h(this,"cancelButtonView");h(this,"_manualDecoratorSwitches");h(this,"children");h(this,"_validators");h(this,"_focusables",new Mt);h(this,"_focusCycler");const o=e.t;this._validators=s,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(o("Save"),F.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(o("Cancel"),F.cancel,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(i),this.children=this._createFormChildren(i.manualDecorators),this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const r=["ck","ck-link-form","ck-responsive-form"];i.manualDecorators.length&&r.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:r,tabindex:"-1"},children:this.children})}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce((e,i)=>(e[i.name]=i.isOn,e),{})}render(){super.render(),qo({view:this}),[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}isValid(){this.resetFormStatus();for(const e of this._validators){const i=e(this);if(i)return this.urlInputView.errorText=i,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null}_createUrlInput(){const e=this.locale.t,i=new wt(this.locale,jn);return i.fieldView.inputMode="url",i.label=e("Link URL"),i}_createButton(e,i,s,o){const r=new te(this.locale);return r.set({label:e,icon:i,tooltip:!0}),r.extendTemplate({attributes:{class:s}}),o&&r.delegate("execute").to(this,o),r}_createManualDecoratorSwitches(e){const i=this.createCollection();for(const s of e.manualDecorators){const o=new rc(this.locale);o.set({name:s.id,label:s.label,withText:!0}),o.bind("isOn").toMany([s,e],"value",(r,a)=>a===void 0&&r===void 0?!!s.defaultValue:!!r),o.on("execute",()=>{s.set("value",!o.isOn)}),i.add(o)}return i}_createFormChildren(e){const i=this.createCollection();if(i.add(this.urlInputView),e.length){const s=new q;s.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(o=>({tag:"li",children:[o],attributes:{class:["ck","ck-list__item"]}})),attributes:{class:["ck","ck-reset","ck-list"]}}),i.add(s)}return i.add(this.saveButtonView),i.add(this.cancelButtonView),i}get url(){const{element:e}=this.urlInputView.fieldView;return e?e.value.trim():null}}var Rte='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>';class Lte extends q{constructor(e,i={}){super(e);h(this,"focusTracker",new Ge);h(this,"keystrokes",new tt);h(this,"previewButtonView");h(this,"unlinkButtonView");h(this,"editButtonView");h(this,"_focusables",new Mt);h(this,"_focusCycler");h(this,"_linkConfig");const s=e.t;this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(s("Unlink"),Rte,"unlink"),this.editButtonView=this._createButton(s("Edit link"),F.pencil,"edit"),this.set("href",void 0),this._linkConfig=i,this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render(),[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(i=>{this._focusables.add(i),this.focusTracker.add(i.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createButton(e,i,s){const o=new te(this.locale);return o.set({label:e,icon:i,tooltip:!0}),o.delegate("execute").to(this,s),o}_createPreviewButton(){const e=new te(this.locale),i=this.bindTemplate,s=this.t;return e.set({withText:!0,tooltip:s("Open link in new tab")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:i.to("href",o=>o&&VP(o,this._linkConfig.allowedProtocols)),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",o=>o||s("This link has no URL")),e.bind("isEnabled").to(this,"href",o=>!!o),e.template.tag="a",e.template.eventListeners={},e}}var MP='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';const _i="link-ui";class OP extends A{constructor(){super(...arguments);h(this,"actionsView",null);h(this,"formView",null);h(this,"_balloon")}static get requires(){return[mi]}static get pluginName(){return"LinkUI"}init(){const e=this.editor,i=this.editor.t;e.editing.view.addObserver(Yq),this._balloon=e.plugins.get(mi),this._createToolbarLinkButton(),this._enableBalloonActivators(),e.conversion.for("editingDowncast").markerToHighlight({model:_i,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:_i,view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:i("Create link"),keystroke:Ba},{label:i("Move out of a link"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}destroy(){super.destroy(),this.formView&&this.formView.destroy(),this.actionsView&&this.actionsView.destroy()}_createViews(){this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._enableUserBalloonInteractions()}_createActionsView(){const e=this.editor,i=new Lte(e.locale,e.config.get("link")),s=e.commands.get("link"),o=e.commands.get("unlink");return i.bind("href").to(s,"value"),i.editButtonView.bind("isEnabled").to(s),i.unlinkButtonView.bind("isEnabled").to(o),this.listenTo(i,"edit",()=>{this._addFormView()}),this.listenTo(i,"unlink",()=>{e.execute("unlink"),this._hideUI()}),i.keystrokes.set("Esc",(r,a)=>{this._hideUI(),a()}),i.keystrokes.set(Ba,(r,a)=>{this._addFormView(),a()}),i}_createFormView(){const e=this.editor,i=e.commands.get("link"),s=e.config.get("link.defaultProtocol"),o=new(Vh(Pte))(e.locale,i,Vte(e));return o.urlInputView.fieldView.bind("value").to(i,"value"),o.urlInputView.bind("isEnabled").to(i,"isEnabled"),o.saveButtonView.bind("isEnabled").to(i,"isEnabled"),this.listenTo(o,"submit",()=>{if(o.isValid()){const{value:r}=o.urlInputView.fieldView.element,a=tw(r,s);e.execute("link",a,o.getDecoratorSwitchesState()),this._closeFormView()}}),this.listenTo(o.urlInputView,"change:errorText",()=>{e.ui.update()}),this.listenTo(o,"cancel",()=>{this._closeFormView()}),o.keystrokes.set("Esc",(r,a)=>{this._closeFormView(),a()}),o}_createToolbarLinkButton(){const e=this.editor,i=e.commands.get("link");e.ui.componentFactory.add("link",()=>{const s=this._createButton(te);return s.set({tooltip:!0,isToggleable:!0}),s.bind("isOn").to(i,"value",o=>!!o),s}),e.ui.componentFactory.add("menuBar:link",()=>this._createButton(pt))}_createButton(e){const i=this.editor,s=i.locale,o=i.commands.get("link"),r=new e(i.locale),a=s.t;return r.set({label:a("Link"),icon:MP,keystroke:Ba}),r.bind("isEnabled").to(o,"isEnabled"),this.listenTo(r,"execute",()=>this._showUI(!0)),r}_enableBalloonActivators(){const e=this.editor,i=e.editing.view.document;this.listenTo(i,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),e.keystrokes.set(Ba,(s,o)=>{o(),e.commands.get("link").isEnabled&&this._showUI(!0)})}_enableUserBalloonInteractions(){this.editor.keystrokes.set("Tab",(e,i)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),i())},{priority:"high"}),this.editor.keystrokes.set("Esc",(e,i)=>{this._isUIVisible&&(this._hideUI(),i())}),Wo({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this.actionsView||this._createViews(),!this._areActionsInPanel&&this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this.formView||this._createViews(),this._isFormInPanel)return;const i=this.editor.commands.get("link");this.formView.disableCssTransitions(),this.formView.resetFormStatus(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.urlInputView.fieldView.value=i.value||"",this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions()}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),e.value!==void 0?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this.formView.urlInputView.fieldView.reset(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this.formView||this._createViews(),this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,i=e.editing.view.document;let s=this._getSelectedLinkElement(),o=a();const r=()=>{const l=this._getSelectedLinkElement(),c=a();s&&!l||!s&&c!==o?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),s=l,o=c};function a(){return i.selection.focus.getAncestors().reverse().find(l=>l.is("element"))}this.listenTo(e.ui,"update",r),this.listenTo(this._balloon,"change:visibleView",r)}get _isFormInPanel(){return!!this.formView&&this._balloon.hasView(this.formView)}get _areActionsInPanel(){return!!this.actionsView&&this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return!!this.actionsView&&this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){const e=this._balloon.visibleView;return!!this.formView&&e==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,i=this.editor.model,s=e.document;let o;if(i.markers.has(_i)){const r=Array.from(this.editor.editing.mapper.markerNameToElements(_i)),a=e.createRange(e.createPositionBefore(r[0]),e.createPositionAfter(r[r.length-1]));o=e.domConverter.viewRangeToDom(a)}else o=()=>{const r=this._getSelectedLinkElement();return r?e.domConverter.mapViewToDom(r):e.domConverter.viewRangeToDom(s.selection.getFirstRange())};return{target:o}}_getSelectedLinkElement(){const e=this.editor.editing.view,i=e.document.selection,s=i.getSelectedElement();if(i.isCollapsed||s&&ht(s))return $f(i.getFirstPosition());{const o=i.getFirstRange().getTrimmed(),r=$f(o.start),a=$f(o.end);return!r||r!=a?null:e.createRangeIn(r).getTrimmed().isEqual(o)?r:null}}_showFakeVisualSelection(){const e=this.editor.model;e.change(i=>{const s=e.document.selection.getFirstRange();if(e.markers.has(_i))i.updateMarker(_i,{range:s});else if(s.start.isAtEnd){const o=s.start.getLastMatchingPosition(({item:r})=>!e.schema.isContent(r),{boundaries:s});i.addMarker(_i,{usingOperation:!1,affectsData:!1,range:i.createRange(o,s.end)})}else i.addMarker(_i,{usingOperation:!1,affectsData:!1,range:s})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(_i)&&e.change(i=>{i.removeMarker(_i)})}}function $f(n){return n.getAncestors().find(t=>bte(t))||null}function Vte(n){const t=n.t,e=n.config.get("link.allowCreatingEmptyLinks");return[i=>{if(!e&&!i.url.length)return t("Link URL must not be empty.")}]}const Bte=4,NP=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),Mte=2;class FP extends A{static get requires(){return[Pi,Dh]}static get pluginName(){return"AutoLink"}init(){const e=this.editor.model.document.selection;e.on("change:range",()=>{this.isEnabled=!e.anchor.parent.is("element","codeBlock")}),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling(),this._enablePasteLinking()}_expandLinkRange(t,e){return e.textNode&&e.textNode.hasAttribute("linkHref")?ac(e,"linkHref",e.textNode.getAttribute("linkHref"),t):null}_selectEntireLinks(t,e){const s=this.editor.model,o=s.document.selection,r=o.getFirstPosition(),a=o.getLastPosition();let l=e.getJoined(this._expandLinkRange(s,r)||e);l&&(l=l.getJoined(this._expandLinkRange(s,a)||e)),l&&(l.start.isBefore(r)||l.end.isAfter(a))&&t.setSelection(l)}_enablePasteLinking(){const t=this.editor,e=t.model,i=e.document.selection,s=t.plugins.get("ClipboardPipeline"),o=t.commands.get("link");s.on("inputTransformation",(r,a)=>{if(!this.isEnabled||!o.isEnabled||i.isCollapsed||a.method!=="paste"||i.rangeCount>1)return;const l=i.getFirstRange(),c=a.dataTransfer.getData("text/plain");if(!c)return;const u=c.match(NP);u&&u[2]===c&&(e.change(d=>{this._selectEntireLinks(d,l),o.execute(c)}),r.stop())},{priority:"high"})}_enableTypingHandling(){const t=this.editor,e=new ZI(t.model,i=>{if(!Ote(i))return;const s=$v(i.substr(0,i.length-1));if(s)return{url:s}});e.on("matched:data",(i,s)=>{const{batch:o,range:r,url:a}=s;if(!o.isTyping)return;const l=r.end.getShiftedBy(-1),c=l.getShiftedBy(-a.length),u=t.model.createRange(c,l);this._applyAutoLink(a,u)}),e.bind("isEnabled").to(this)}_enableEnterHandling(){const t=this.editor,e=t.model,i=t.commands.get("enter");i&&i.on("execute",()=>{const s=e.document.selection.getFirstPosition();if(!s.parent.previousSibling)return;const o=e.createRangeIn(s.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(o)})}_enableShiftEnterHandling(){const t=this.editor,e=t.model,i=t.commands.get("shiftEnter");i&&i.on("execute",()=>{const s=e.document.selection.getFirstPosition(),o=e.createRange(e.createPositionAt(s.parent,0),s.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(o)})}_checkAndApplyAutoLinkOnRange(t){const e=this.editor.model,{text:i,range:s}=KI(t,e),o=$v(i);if(o){const r=e.createRange(s.end.getShiftedBy(-o.length),s.end);this._applyAutoLink(o,r)}}_applyAutoLink(t,e){const i=this.editor.model,s=this.editor.config.get("link.defaultProtocol"),o=tw(t,s);!this.isEnabled||!Nte(e,i)||!BP(o)||Fte(e)||this._persistAutoLink(o,e)}_persistAutoLink(t,e){const i=this.editor.model,s=this.editor.plugins.get("Delete");i.enqueueChange(o=>{o.setAttribute("linkHref",t,e),i.enqueueChange(()=>{s.requestUndoOnBackspace()})})}}function Ote(n){return n.length>Bte&&n[n.length-1]===" "&&n[n.length-2]!==" "}function $v(n){const t=NP.exec(n);return t?t[Mte]:null}function Nte(n,t){return t.schema.checkAttributeInSelection(t.createSelection(n),"linkHref")}function Fte(n){const t=n.start.nodeAfter;return!!t&&t.hasAttribute("linkHref")}class Dte extends A{static get requires(){return[Dh,OP,FP]}static get pluginName(){return"Link"}}class $te extends A{static get requires(){return["ImageEditing","ImageUtils",Dh]}static get pluginName(){return"LinkImageEditing"}afterInit(){const t=this.editor,e=t.model.schema;t.plugins.has("ImageBlockEditing")&&e.extend("imageBlock",{allowAttributes:["linkHref"]}),t.conversion.for("upcast").add(Hte(t)),t.conversion.for("downcast").add(zte(t)),this._enableAutomaticDecorators(),this._enableManualDecorators()}_enableAutomaticDecorators(){const t=this.editor,i=t.commands.get("link").automaticDecorators;i.length&&t.conversion.for("downcast").add(i.getDispatcherForLinkedImage())}_enableManualDecorators(){const t=this.editor,e=t.commands.get("link");for(const i of e.manualDecorators)t.plugins.has("ImageBlockEditing")&&t.model.schema.extend("imageBlock",{allowAttributes:i.id}),t.plugins.has("ImageInlineEditing")&&t.model.schema.extend("imageInline",{allowAttributes:i.id}),t.conversion.for("downcast").add(Ute(i)),t.conversion.for("upcast").add(Wte(t,i))}}function Hte(n){const t=n.plugins.has("ImageInlineEditing"),e=n.plugins.get("ImageUtils");return i=>{i.on("element:a",(s,o,r)=>{const a=o.viewItem,l=e.findViewImgElement(a);if(!l)return;const c=l.findAncestor(m=>e.isBlockImageView(m));if(t&&!c)return;const u={attributes:["href"]};if(!r.consumable.consume(a,u))return;const d=a.getAttribute("href");if(!d)return;let f=o.modelCursor.parent;if(!f.is("element","imageBlock")){const m=r.convertItem(l,o.modelCursor);o.modelRange=m.modelRange,o.modelCursor=m.modelCursor,f=o.modelCursor.nodeBefore}f&&f.is("element","imageBlock")&&r.writer.setAttribute("linkHref",d,f)},{priority:"high"})}}function zte(n){const t=n.plugins.get("ImageUtils");return e=>{e.on("attribute:linkHref:imageBlock",(i,s,o)=>{if(!o.consumable.consume(s.item,i.name))return;const r=o.mapper.toViewElement(s.item),a=o.writer,l=Array.from(r.getChildren()).find(d=>d.is("element","a")),c=t.findViewImgElement(r),u=c.parent.is("element","picture")?c.parent:c;if(l)s.attributeNewValue?a.setAttribute("href",s.attributeNewValue,l):(a.move(a.createRangeOn(u),a.createPositionAt(r,0)),a.remove(l));else{const d=a.createContainerElement("a",{href:s.attributeNewValue});a.insert(a.createPositionAt(r,0),d),a.move(a.createRangeOn(u),a.createPositionAt(d,0))}},{priority:"high"})}}function Ute(n){return t=>{t.on(`attribute:${n.id}:imageBlock`,(e,i,s)=>{const o=s.mapper.toViewElement(i.item),r=Array.from(o.getChildren()).find(a=>a.is("element","a"));if(r){for(const[a,l]of Ii(n.attributes))s.writer.setAttribute(a,l,r);n.classes&&s.writer.addClass(n.classes,r);for(const a in n.styles)s.writer.setStyle(a,n.styles[a],r)}})}}function Wte(n,t){const e=n.plugins.has("ImageInlineEditing"),i=n.plugins.get("ImageUtils");return s=>{s.on("element:a",(o,r,a)=>{const l=r.viewItem,c=i.findViewImgElement(l);if(!c)return;const u=c.findAncestor(g=>i.isBlockImageView(g));if(e&&!u)return;const f=new Qt(t._createPattern()).match(l);if(!f||!a.consumable.consume(l,f.match))return;const m=r.modelCursor.nodeBefore||r.modelCursor.parent;a.writer.setAttribute(t.id,!0,m)},{priority:"high"})}}class qte extends A{static get requires(){return[Dh,OP,"ImageBlockEditing"]}static get pluginName(){return"LinkImageUI"}init(){const t=this.editor,e=t.editing.view.document;this.listenTo(e,"click",(i,s)=>{this._isSelectedLinkedImage(t.model.document.selection)&&(s.preventDefault(),i.stop())},{priority:"high"}),this._createToolbarLinkImageButton()}_createToolbarLinkImageButton(){const t=this.editor,e=t.t;t.ui.componentFactory.add("linkImage",i=>{const s=new te(i),o=t.plugins.get("LinkUI"),r=t.commands.get("link");return s.set({isEnabled:!0,label:e("Link image"),icon:MP,keystroke:Ba,tooltip:!0,isToggleable:!0}),s.bind("isEnabled").to(r,"isEnabled"),s.bind("isOn").to(r,"value",a=>!!a),this.listenTo(s,"execute",()=>{this._isSelectedLinkedImage(t.model.document.selection)?o._addActionsView():o._showUI(!0)}),s})}_isSelectedLinkedImage(t){const e=t.getSelectedElement();return this.editor.plugins.get("ImageUtils").isImage(e)&&e.hasAttribute("linkHref")}}class jte extends A{static get requires(){return[$te,qte]}static get pluginName(){return"LinkImage"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Qn{constructor(t,e){h(this,"_startElement");h(this,"_referenceIndent");h(this,"_isForward");h(this,"_includeSelf");h(this,"_sameAttributes");h(this,"_sameIndent");h(this,"_lowerIndent");h(this,"_higherIndent");this._startElement=t,this._referenceIndent=t.getAttribute("listIndent"),this._isForward=e.direction=="forward",this._includeSelf=!!e.includeSelf,this._sameAttributes=Pe(e.sameAttributes||[]),this._sameIndent=!!e.sameIndent,this._lowerIndent=!!e.lowerIndent,this._higherIndent=!!e.higherIndent}static first(t,e){const s=new this(t,e)[Symbol.iterator]();return Ye(s)}*[Symbol.iterator](){const t=[];for(const{node:e}of dc(this._getStartNode(),this._isForward?"forward":"backward")){const i=e.getAttribute("listIndent");if(i<this._referenceIndent){if(!this._lowerIndent)break;this._referenceIndent=i}else if(i>this._referenceIndent){if(!this._higherIndent)continue;if(!this._isForward){t.push(e);continue}}else{if(!this._sameIndent){if(this._higherIndent){t.length&&(yield*t,t.length=0);break}continue}if(this._sameAttributes.some(s=>e.getAttribute(s)!==this._startElement.getAttribute(s)))break}t.length&&(yield*t,t.length=0),yield e}}_getStartNode(){return this._includeSelf?this._startElement:this._isForward?this._startElement.nextSibling:this._startElement.previousSibling}}function*dc(n,t="forward"){const e=t=="forward",i=[];let s=null;for(;je(n);){let o=null;if(s){const r=n.getAttribute("listIndent"),a=s.getAttribute("listIndent");r>a?i[a]=s:r<a?(o=i[r],i.length=r):o=s}yield{node:n,previous:s,previousNodeInList:o},s=n,n=e?n.nextSibling:n.previousSibling}}class Gte{constructor(t){h(this,"_listHead");this._listHead=t}[Symbol.iterator](){return dc(this._listHead,"forward")}}class Gr{static next(){return Cn()}}function je(n){return!!n&&n.is("element")&&n.hasAttribute("listItemId")}function Vl(n,t={}){return[...Us(n,{...t,direction:"backward"}),...Us(n,{...t,direction:"forward"})]}function Us(n,t={}){const e=t.direction=="forward",i=Array.from(new Qn(n,{...t,includeSelf:e,sameIndent:!0,sameAttributes:"listItemId"}));return e?i:i.reverse()}function Kte(n){return Array.from(new Qn(n,{direction:"forward",higherIndent:!0}))}function DP(n,t){const e=new Qn(n,{sameIndent:!0,sameAttributes:"listType",...t}),i=new Qn(n,{sameIndent:!0,sameAttributes:"listType",includeSelf:!0,direction:"forward",...t});return[...Array.from(e).reverse(),...i]}function ts(n){return!Qn.first(n,{sameIndent:!0,sameAttributes:"listItemId"})}function Hv(n){return!Qn.first(n,{direction:"forward",sameIndent:!0,sameAttributes:"listItemId"})}function hc(n,t={}){n=Pe(n);const e=t.withNested!==!1,i=new Set;for(const s of n)for(const o of Vl(s,{higherIndent:e}))i.add(o);return jo(i)}function $h(n){n=Pe(n);const t=new Set;for(const e of n)for(const i of DP(e))t.add(i);return jo(t)}function nw(n,t){const e=Us(n,{direction:"forward"}),i=Gr.next();for(const s of e)t.setAttribute("listItemId",i,s);return e}function ag(n,t,e){const i={};for(const[o,r]of t.getAttributes())o.startsWith("list")&&(i[o]=r);const s=Us(n,{direction:"forward"});for(const o of s)e.setAttributes(i,o);return s}function lg(n,t,{expand:e,indentBy:i=1}={}){n=Pe(n);const s=e?hc(n):n;for(const o of s){const r=o.getAttribute("listIndent")+i;r<0?Hh(o,t):t.setAttribute("listIndent",r,o)}return s}function Zte(n,t){n=Pe(n);const e=hc(n),i=new Set,s=Math.min(...e.map(r=>r.getAttribute("listIndent"))),o=new Map;for(const r of e)o.set(r,Qn.first(r,{lowerIndent:!0}));for(const r of e){if(i.has(r))continue;i.add(r);const a=r.getAttribute("listIndent")-1;if(a<0){Hh(r,t);continue}if(r.getAttribute("listIndent")==s){const l=Yte(r,o.get(r),t);for(const c of l)i.add(c);if(l.length)continue}t.setAttribute("listIndent",a,r)}return jo(i)}function Hh(n,t){n=Pe(n);for(const e of n)e.is("element","listItem")&&t.rename(e,"paragraph");for(const e of n)for(const i of e.getAttributeKeys())i.startsWith("list")&&t.removeAttribute(i,e);return n}function Bl(n){if(!n.length)return!1;const t=n[0].getAttribute("listItemId");return t?!n.some(e=>e.getAttribute("listItemId")!=t):!1}function Jte(n,t){const e=[];let i=Number.POSITIVE_INFINITY;for(const{node:s}of dc(n.nextSibling,"forward")){const o=s.getAttribute("listIndent");if(o==0)break;o<i&&(i=o);const r=o-i;t.setAttribute("listIndent",r,s),e.push(s)}return e}function jo(n){return Array.from(n).filter(t=>t.root.rootName!=="$graveyard").sort((t,e)=>t.index-e.index)}function Ml(n){const t=n.document.selection.getSelectedElement();return t&&n.schema.isObject(t)&&n.schema.isBlock(t)?t:null}function Hf(n,t){return t.checkChild(n.parent,"listItem")&&t.checkChild(n,"$text")&&!t.isObject(n)}function gd(n){return n=="numbered"||n=="customNumbered"}function Yte(n,t,e){return Us(t,{direction:"forward"}).pop().index>n.index?ag(n,t,e):[]}class zv extends ne{constructor(e,i){super(e);h(this,"_direction");this._direction=i}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,i=Uv(e.document.selection);e.change(s=>{const o=[];Bl(i)&&!ts(i[0])?(this._direction=="forward"&&o.push(...lg(i,s)),o.push(...nw(i[0],s))):this._direction=="forward"?o.push(...lg(i,s,{expand:!0})):o.push(...Zte(i,s));for(const r of o){if(!r.hasAttribute("listType"))continue;const a=Qn.first(r,{sameIndent:!0});a&&s.setAttribute("listType",a.getAttribute("listType"),r)}this._fireAfterExecute(o)})}_fireAfterExecute(e){this.fire("afterExecute",jo(new Set(e)))}_checkEnabled(){let e=Uv(this.editor.model.document.selection),i=e[0];if(!i)return!1;if(this._direction=="backward"||Bl(e)&&!ts(e[0]))return!0;e=hc(e),i=e[0];const s=Qn.first(i,{sameIndent:!0});return s?s.getAttribute("listType")==i.getAttribute("listType"):!1}}function Uv(n){const t=Array.from(n.getSelectedBlocks()),e=t.findIndex(i=>!je(i));return e!=-1&&(t.length=e),t}class Ma extends ne{constructor(e,i,s={}){super(e);h(this,"type");h(this,"_listWalkerOptions");this.type=i,this._listWalkerOptions=s.multiLevel?{higherIndent:!0,lowerIndent:!0,sameAttributes:[]}:void 0}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const i=this.editor.model,s=i.document,o=Ml(i),r=Array.from(s.selection.getSelectedBlocks()).filter(l=>i.schema.checkAttribute(l,"listType")||Hf(l,i.schema)),a=e.forceValue!==void 0?!e.forceValue:this.value;i.change(l=>{if(a){const c=r[r.length-1],u=Us(c,{direction:"forward"}),d=[];u.length>1&&d.push(...nw(u[1],l)),d.push(...Hh(r,l)),d.push(...Jte(c,l)),this._fireAfterExecute(d)}else if((o||s.selection.isCollapsed)&&je(r[0])){const c=DP(o||r[0],this._listWalkerOptions);for(const u of c)l.setAttributes({...e.additionalAttributes,listType:this.type},u);this._fireAfterExecute(c)}else{const c=[];for(const u of r)if(!u.hasAttribute("listType"))!u.is("element","listItem")&&Hf(u,i.schema)&&l.rename(u,"listItem"),l.setAttributes({...e.additionalAttributes,listIndent:0,listItemId:Gr.next(),listType:this.type},u),c.push(u);else for(const d of hc(u,{withNested:!1}))d.getAttribute("listType")!=this.type&&(l.setAttributes({...e.additionalAttributes,listType:this.type},d),c.push(d));this._fireAfterExecute(c)}})}_fireAfterExecute(e){this.fire("afterExecute",jo(new Set(e)))}_getValue(){const e=this.editor.model.document.selection,i=Array.from(e.getSelectedBlocks());if(!i.length)return!1;for(const s of i)if(s.getAttribute("listType")!=this.type)return!1;return!0}_checkEnabled(){const e=this.editor.model,i=e.schema,s=e.document.selection,o=Array.from(s.getSelectedBlocks());if(!o.length)return!1;if(this.value)return!0;for(const r of o)if(i.checkAttribute(r,"listType")||Hf(r,i))return!0;return!1}}class Wv extends ne{constructor(e,i){super(e);h(this,"_direction");this._direction=i}refresh(){this.isEnabled=this._checkEnabled()}execute({shouldMergeOnBlocksContentLevel:e=!1}={}){const i=this.editor.model,s=i.document.selection,o=[];i.change(r=>{const{firstElement:a,lastElement:l}=this._getMergeSubjectElements(s,e),c=a.getAttribute("listIndent")||0,u=l.getAttribute("listIndent"),d=l.getAttribute("listItemId");if(c!=u){const f=Kte(l);o.push(...lg([l,...f],r,{indentBy:c-u,expand:c<u}))}if(e){let f=s;s.isCollapsed&&(f=r.createSelection(r.createRange(r.createPositionAt(a,"end"),r.createPositionAt(l,0)))),i.deleteContent(f,{doNotResetEntireContent:s.isCollapsed});const m=f.getLastPosition().parent,g=m.nextSibling;o.push(m),g&&g!==l&&g.getAttribute("listItemId")==d&&o.push(...ag(g,m,r))}else o.push(...ag(l,a,r));this._fireAfterExecute(o)})}_fireAfterExecute(e){this.fire("afterExecute",jo(new Set(e)))}_checkEnabled(){const e=this.editor.model,i=e.document.selection,s=Ml(e);if(i.isCollapsed||s){const o=s||i.getFirstPosition().parent;if(!je(o))return!1;const r=this._direction=="backward"?o.previousSibling:o.nextSibling;if(!r||Bl([o,r]))return!1}else{const o=i.getLastPosition(),r=i.getFirstPosition();if(o.parent===r.parent||!je(o.parent))return!1}return!0}_getMergeSubjectElements(e,i){const s=this.editor.model,o=Ml(s);let r,a;if(e.isCollapsed||o){const l=o||e.getFirstPosition().parent,c=ts(l);this._direction=="backward"?(a=l,c&&!i?r=Qn.first(l,{sameIndent:!0,lowerIndent:!0}):r=l.previousSibling):(r=l,a=l.nextSibling)}else r=e.getFirstPosition().parent,a=e.getLastPosition().parent;return{firstElement:r,lastElement:a}}}class qv extends ne{constructor(e,i){super(e);h(this,"_direction");this._direction=i}refresh(){this.isEnabled=this._checkEnabled()}execute(){this.editor.model.change(i=>{const s=nw(this._getStartBlock(),i);this._fireAfterExecute(s)})}_fireAfterExecute(e){this.fire("afterExecute",jo(new Set(e)))}_checkEnabled(){const e=this.editor.model.document.selection,i=this._getStartBlock();return e.isCollapsed&&je(i)&&!ts(i)}_getStartBlock(){const i=this.editor.model.document.selection.getFirstPosition().parent;return this._direction=="before"?i:i.nextSibling}}class Xte extends A{static get pluginName(){return"ListUtils"}expandListBlocksToCompleteList(t){return $h(t)}isFirstBlockOfListItem(t){return ts(t)}isListItemBlock(t){return je(t)}expandListBlocksToCompleteItems(t,e={}){return hc(t,e)}isNumberedListType(t){return gd(t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function $P(n){return n.is("element","ol")||n.is("element","ul")}function pd(n){return n.is("element","li")}function Qte(n){let t=0,e=n.parent;for(;e;){if(pd(e))t++;else{const i=e.previousSibling;i&&pd(i)&&t++}e=e.parent}return t}function ene(n,t,e,i=zP(e,t)){return n.createAttributeElement(HP(e),null,{priority:2*t/100-100,id:i})}function tne(n,t,e){return n.createAttributeElement("li",null,{priority:(2*t+1)/100-100,id:e})}function HP(n){return n=="numbered"||n=="customNumbered"?"ol":"ul"}function zP(n,t){return`list-${n}-${t}`}function oi(n,t){const e=n.nodeBefore;if(je(e)){let i=e;for(const{node:s}of dc(i,"backward"))if(i=s,t.has(i))return;t.set(e,i)}else{const i=n.nodeAfter;je(i)&&t.set(i,i)}}function nne(n,t){let e=0,i=-1,s=null,o=!1;for(const{node:r}of n){const a=r.getAttribute("listIndent");if(a>e){let l;s===null?(s=a-e,l=e):(s>a&&(s=a),l=a-s),l>i+1&&(l=i+1),t.setAttribute("listIndent",l,r),o=!0,i=l}else s=null,e=a+1,i=a}return o}function ine(n,t,e){const i=new Set;let s=!1;for(const{node:o}of n){if(i.has(o))continue;let r=o.getAttribute("listType"),a=o.getAttribute("listItemId");if(t.has(a)&&(a=Gr.next()),t.add(a),o.is("element","listItem")){o.getAttribute("listItemId")!=a&&(e.setAttribute("listItemId",a,o),s=!0);continue}for(const l of Us(o,{direction:"forward"}))i.add(l),l.getAttribute("listType")!=r&&(a=Gr.next(),r=l.getAttribute("listType")),l.getAttribute("listItemId")!=a&&(e.setAttribute("listItemId",a,l),s=!0)}return s}function sne(){return(n,t,e)=>{const{writer:i,schema:s}=e;if(!t.modelRange)return;const o=Array.from(t.modelRange.getItems({shallow:!0})).filter(d=>s.checkAttribute(d,"listItemId"));if(!o.length)return;const r=Gr.next(),a=Qte(t.viewItem);let l=t.viewItem.parent&&t.viewItem.parent.is("element","ol")?"numbered":"bulleted";const c=o[0].getAttribute("listType");c&&(l=c);const u={listItemId:r,listIndent:a,listType:l};for(const d of o)d.hasAttribute("listItemId")||i.setAttributes(u,d);o.length>1&&o[1].getAttribute("listItemId")!=u.listItemId&&e.keepEmptyElement(o[0])}}function jv(){return(n,t,e)=>{if(!e.consumable.test(t.viewItem,{name:!0}))return;const i=new zn(t.viewItem.document);for(const s of Array.from(t.viewItem.getChildren()))!pd(s)&&!$P(s)&&i.remove(s)}}function one(n,t,e,i){return()=>{const a=n.document.differ.getChanges(),l=[],c=new Map,u=new Set;for(const d of a)if(d.type=="insert"&&d.name!="$text")oi(d.position,c),d.attributes.has("listItemId")?u.add(d.position.nodeAfter):oi(d.position.getShiftedBy(d.length),c);else if(d.type=="remove"&&d.attributes.has("listItemId"))oi(d.position,c);else if(d.type=="attribute"){const f=d.range.start.nodeAfter;e.includes(d.attributeKey)?(oi(d.range.start,c),d.attributeNewValue===null?(oi(d.range.start.getShiftedBy(1),c),o(f)&&l.push(f)):u.add(f)):je(f)&&o(f)&&l.push(f)}for(const d of c.values())l.push(...s(d,u));for(const d of new Set(l))t.reconvertItem(d)};function s(a,l){const c=[],u=new Set,d=[];for(const{node:f,previous:m}of dc(a,"forward")){if(u.has(f))continue;const g=f.getAttribute("listIndent");m&&g<m.getAttribute("listIndent")&&(d.length=g+1),d[g]=Object.fromEntries(Array.from(f.getAttributes()).filter(([w])=>e.includes(w)));const p=Us(f,{direction:"forward"});for(const w of p)u.add(w),(o(w,p)||r(w,d,l))&&c.push(w)}return c}function o(a,l){const c=t.mapper.toViewElement(a);if(!c)return!1;if(i.fire("checkElement",{modelElement:a,viewElement:c}))return!0;if(!a.is("element","paragraph")&&!a.is("element","listItem"))return!1;const d=WP(a,e,l);return d&&c.is("element","p")?!0:!!(!d&&c.is("element","span"))}function r(a,l,c){if(c.has(a))return!1;const u=t.mapper.toViewElement(a);let d=l.length-1;for(let f=u.parent;!f.is("editableElement");f=f.parent){const m=pd(f),g=$P(f);if(!g&&!m)continue;const p=`checkAttributes:${m?"item":"list"}`;if(i.fire(p,{viewElement:f,modelAttributes:l[d]}))break;if(g&&(d--,d<0))return!1}return!0}}function Gv(n,t,e,{dataPipeline:i}={}){const s=hne(n);return(o,r,a)=>{const{writer:l,mapper:c,consumable:u}=a,d=r.item;if(!n.includes(r.attributeKey)||!s(d,u))return;const f=ane(d,c,e);UP(f,l,c),une(f,l);const m=cne(d,f,t,l,{dataPipeline:i});dne(d,m,t,l)}}function rne(n){return(t,e,i)=>{const{writer:s,mapper:o}=i,r=t.name.split(":")[1];if(!n.checkAttribute(r,"listItemId"))return;const a=o.toViewPosition(e.position),l=e.position.getShiftedBy(e.length),c=o.toViewPosition(l,{isPhantom:!0}),d=s.createRange(a,c).getTrimmed().end.nodeBefore;/* istanbul ignore next -- @preserve */d&&UP(d,s,o)}}function Kv(n,{dataPipeline:t}={}){return(e,{writer:i})=>{if(!WP(e,n))return null;if(!t)return i.createContainerElement("span",{class:"ck-list-bogus-paragraph"});const s=i.createContainerElement("p");return i.setCustomProperty("dataPipeline:transparentRendering",!0,s),s}}function ane(n,t,e){const i=e.createRangeOn(n);return t.toViewRange(i).getTrimmed().end.nodeBefore}function lne(n,t){return(e,i)=>{if(i.modelPosition.offset>0)return;const s=i.modelPosition.parent;if(!je(s)||!n.some(c=>c.scope=="itemMarker"&&c.canInjectMarkerIntoElement&&c.canInjectMarkerIntoElement(s)))return;const o=i.mapper.toViewElement(s),r=t.createRangeIn(o),a=r.getWalker();let l=r.start;for(const{item:c}of a){if(c.is("element")&&i.mapper.toModelElement(c)||c.is("$textProxy"))break;c.is("element")&&c.getCustomProperty("listItemMarker")&&(l=t.createPositionAfter(c),a.skip(({previousPosition:u})=>!u.isEqual(l)))}i.viewPosition=l}}function UP(n,t,e){for(;n.parent.is("attributeElement")&&n.parent.getCustomProperty("listItemWrapper");)t.unwrap(t.createRangeOn(n),n.parent);const i=[];s(t.createPositionBefore(n).getWalker({direction:"backward"})),s(t.createRangeIn(n).getWalker());for(const o of i)t.remove(o);function s(o){for(const{item:r}of o){if(r.is("element")&&e.toModelElement(r))break;r.is("element")&&r.getCustomProperty("listItemMarker")&&i.push(r)}}}function cne(n,t,e,i,{dataPipeline:s}){let o=i.createRangeOn(t);if(!ts(n))return o;for(const r of e){if(r.scope!="itemMarker")continue;const a=r.createElement(i,n,{dataPipeline:s});if(!a||(i.setCustomProperty("listItemMarker",!0,a),r.canInjectMarkerIntoElement&&r.canInjectMarkerIntoElement(n)?i.insert(i.createPositionAt(t,0),a):(i.insert(o.start,a),o=i.createRange(i.createPositionBefore(a),i.createPositionAfter(t))),!r.createWrapperElement||!r.canWrapElement))continue;const l=r.createWrapperElement(i,n,{dataPipeline:s});i.setCustomProperty("listItemWrapper",!0,l),r.canWrapElement(n)?o=i.wrap(o,l):(o=i.wrap(i.createRangeOn(a),l),o=i.createRange(o.start,i.createPositionAfter(t)))}return o}function une(n,t){let e=n.parent;for(;e.is("attributeElement")&&["ul","ol","li"].includes(e.name);){const i=e.parent;t.unwrap(t.createRangeOn(n),e),e=i}}function dne(n,t,e,i){if(!n.hasAttribute("listIndent"))return;const s=n.getAttribute("listIndent");let o=n;for(let r=s;r>=0;r--){const a=tne(i,r,o.getAttribute("listItemId")),l=ene(i,r,o.getAttribute("listType"));for(const c of e)(c.scope=="list"||c.scope=="item")&&o.hasAttribute(c.attributeName)&&c.setAttributeOnDowncast(i,o.getAttribute(c.attributeName),c.scope=="list"?l:a);if(t=i.wrap(t,a),t=i.wrap(t,l),r==0||(o=Qn.first(o,{lowerIndent:!0}),!o))break}}function hne(n){return(t,e)=>{const i=[];for(const s of n)t.hasAttribute(s)&&i.push(`attribute:${s}`);return i.every(s=>e.test(t,s)!==!1)?(i.forEach(s=>e.consume(t,s)),!0):!1}}function WP(n,t,e=Vl(n)){if(!je(n))return!1;for(const i of n.getAttributeKeys())if(!i.startsWith("selection:")&&!t.includes(i))return!1;return e.length<2}const _u=["listType","listIndent","listItemId"];class Ol extends A{constructor(e){super(e);h(this,"_downcastStrategies",[]);e.config.define("list.multiBlock",!0)}static get pluginName(){return"ListEditing"}static get requires(){return[lc,Pi,Xte,Hn]}init(){const e=this.editor,i=e.model,s=e.config.get("list.multiBlock");if(e.plugins.has("LegacyListEditing"))throw new C("list-feature-conflict",this,{conflictPlugin:"LegacyListEditing"});i.schema.register("$listItem",{allowAttributes:_u}),s?(i.schema.extend("$container",{allowAttributesOf:"$listItem"}),i.schema.extend("$block",{allowAttributesOf:"$listItem"}),i.schema.extend("$blockObject",{allowAttributesOf:"$listItem"})):i.schema.register("listItem",{inheritAllFrom:"$block",allowAttributesOf:"$listItem"});for(const o of _u)i.schema.setAttributeProperties(o,{copyOnReplace:!0});e.commands.add("numberedList",new Ma(e,"numbered")),e.commands.add("bulletedList",new Ma(e,"bulleted")),e.commands.add("customNumberedList",new Ma(e,"customNumbered",{multiLevel:!0})),e.commands.add("customBulletedList",new Ma(e,"customBulleted",{multiLevel:!0})),e.commands.add("indentList",new zv(e,"forward")),e.commands.add("outdentList",new zv(e,"backward")),e.commands.add("splitListItemBefore",new qv(e,"before")),e.commands.add("splitListItemAfter",new qv(e,"after")),s&&(e.commands.add("mergeListItemBackward",new Wv(e,"backward")),e.commands.add("mergeListItemForward",new Wv(e,"forward"))),this._setupDeleteIntegration(),this._setupEnterIntegration(),this._setupTabIntegration(),this._setupClipboardIntegration(),this._setupAccessibilityIntegration()}afterInit(){const i=this.editor.commands,s=i.get("indent"),o=i.get("outdent");s&&s.registerChildCommand(i.get("indentList"),{priority:"high"}),o&&o.registerChildCommand(i.get("outdentList"),{priority:"lowest"}),this._setupModelPostFixing(),this._setupConversion()}registerDowncastStrategy(e){this._downcastStrategies.push(e)}getListAttributeNames(){return[..._u,...this._downcastStrategies.map(e=>e.attributeName)]}_setupDeleteIntegration(){const e=this.editor,i=e.commands.get("mergeListItemBackward"),s=e.commands.get("mergeListItemForward");this.listenTo(e.editing.view.document,"delete",(o,r)=>{const a=e.model.document.selection;Ml(e.model)||e.model.change(()=>{const l=a.getFirstPosition();if(a.isCollapsed&&r.direction=="backward"){if(!l.isAtStart)return;const c=l.parent;if(!je(c))return;if(!Qn.first(c,{sameAttributes:"listType",sameIndent:!0})&&c.getAttribute("listIndent")===0)Hv(c)||e.execute("splitListItemAfter"),e.execute("outdentList");else{if(!i||!i.isEnabled)return;i.execute({shouldMergeOnBlocksContentLevel:Zv(e.model,"backward")})}r.preventDefault(),o.stop()}else{if(a.isCollapsed&&!a.getLastPosition().isAtEnd||!s||!s.isEnabled)return;s.execute({shouldMergeOnBlocksContentLevel:Zv(e.model,"forward")}),r.preventDefault(),o.stop()}})},{context:"li"})}_setupEnterIntegration(){const e=this.editor,i=e.model,s=e.commands,o=s.get("enter");this.listenTo(e.editing.view.document,"enter",(r,a)=>{const l=i.document,c=l.selection.getFirstPosition().parent;if(l.selection.isCollapsed&&je(c)&&c.isEmpty&&!a.isSoft){const u=ts(c),d=Hv(c);u&&d?(e.execute("outdentList"),a.preventDefault(),r.stop()):u&&!d?(e.execute("splitListItemAfter"),a.preventDefault(),r.stop()):d&&(e.execute("splitListItemBefore"),a.preventDefault(),r.stop())}},{context:"li"}),this.listenTo(o,"afterExecute",()=>{const r=s.get("splitListItemBefore");if(r.refresh(),!r.isEnabled)return;const l=e.model.document.selection.getLastPosition().parent;Vl(l).length===2&&r.execute()})}_setupTabIntegration(){const e=this.editor;this.listenTo(e.editing.view.document,"tab",(i,s)=>{const o=s.shiftKey?"outdentList":"indentList";this.editor.commands.get(o).isEnabled&&(e.execute(o),s.stopPropagation(),s.preventDefault(),i.stop())},{context:"li"})}_setupConversion(){const e=this.editor,i=e.model,s=this.getListAttributeNames(),o=e.config.get("list.multiBlock"),r=o?"paragraph":"listItem";e.conversion.for("upcast").elementToElement({view:"li",model:(l,{writer:c})=>c.createElement(r,{listType:""})}).elementToElement({view:"p",model:(l,{writer:c})=>l.parent&&l.parent.is("element","li")?c.createElement(r,{listType:""}):null,converterPriority:"high"}).add(l=>{l.on("element:li",sne()),l.on("element:ul",jv(),{priority:"high"}),l.on("element:ol",jv(),{priority:"high"})}),o||e.conversion.for("downcast").elementToElement({model:"listItem",view:"p"}),e.conversion.for("editingDowncast").elementToElement({model:r,view:Kv(s),converterPriority:"high"}).add(l=>{l.on("attribute",Gv(s,this._downcastStrategies,i)),l.on("remove",rne(i.schema))}),e.conversion.for("dataDowncast").elementToElement({model:r,view:Kv(s,{dataPipeline:!0}),converterPriority:"high"}).add(l=>{l.on("attribute",Gv(s,this._downcastStrategies,i,{dataPipeline:!0}))});const a=lne(this._downcastStrategies,e.editing.view);e.editing.mapper.on("modelToViewPosition",a),e.data.mapper.on("modelToViewPosition",a),this.listenTo(i.document,"change:data",one(i,e.editing,s,this),{priority:"high"}),this.on("checkAttributes:item",(l,{viewElement:c,modelAttributes:u})=>{c.id!=u.listItemId&&(l.return=!0,l.stop())}),this.on("checkAttributes:list",(l,{viewElement:c,modelAttributes:u})=>{(c.name!=HP(u.listType)||c.id!=zP(u.listType,u.listIndent))&&(l.return=!0,l.stop())})}_setupModelPostFixing(){const e=this.editor.model,i=this.getListAttributeNames();e.document.registerPostFixer(s=>fne(e,s,i,this)),this.on("postFixer",(s,{listNodes:o,writer:r})=>{s.return=nne(o,r)||s.return},{priority:"high"}),this.on("postFixer",(s,{listNodes:o,writer:r,seenIds:a})=>{s.return=ine(o,a,r)||s.return},{priority:"high"})}_setupClipboardIntegration(){const e=this.editor.model,i=this.editor.plugins.get("ClipboardPipeline");this.listenTo(e,"insertContent",mne(e),{priority:"high"}),this.listenTo(i,"outputTransformation",(s,o)=>{e.change(r=>{const a=Array.from(o.content.getChildren()),l=a[a.length-1];if(a.length>1&&l.is("element")&&l.isEmpty&&a.slice(0,-1).every(je)&&r.remove(l),o.method=="copy"||o.method=="cut"){const c=Array.from(o.content.getChildren());Bl(c)&&Hh(c,r)}})})}_setupAccessibilityIntegration(){const e=this.editor,i=e.t;e.accessibility.addKeystrokeInfoGroup({id:"list",label:i("Keystrokes that can be used in a list"),keystrokes:[{label:i("Increase list item indent"),keystroke:"Tab"},{label:i("Decrease list item indent"),keystroke:"Shift+Tab"}]})}}function fne(n,t,e,i){const s=n.document.differ.getChanges(),o=new Map,r=i.editor.config.get("list.multiBlock");let a=!1;for(const c of s){if(c.type=="insert"&&c.name!="$text"){const u=c.position.nodeAfter;if(!n.schema.checkAttribute(u,"listItemId"))for(const d of Array.from(u.getAttributeKeys()))e.includes(d)&&(t.removeAttribute(d,u),a=!0);oi(c.position,o),c.attributes.has("listItemId")||oi(c.position.getShiftedBy(c.length),o);for(const{item:d,previousPosition:f}of n.createRangeIn(u))je(d)&&oi(f,o)}else c.type=="remove"?oi(c.position,o):c.type=="attribute"&&e.includes(c.attributeKey)&&(oi(c.range.start,o),c.attributeNewValue===null&&oi(c.range.start.getShiftedBy(1),o));if(!r&&c.type=="attribute"&&_u.includes(c.attributeKey)){const u=c.range.start.nodeAfter;c.attributeNewValue===null&&u&&u.is("element","listItem")?(t.rename(u,"paragraph"),a=!0):c.attributeOldValue===null&&u&&u.is("element")&&u.name!="listItem"&&(t.rename(u,"listItem"),a=!0)}}const l=new Set;for(const c of o.values())a=i.fire("postFixer",{listNodes:new Gte(c),listHead:c,writer:t,seenIds:l})||a;return a}function mne(n){return(t,[e,i])=>{const s=e.is("documentFragment")?Array.from(e.getChildren()):[e];if(!s.length)return;const r=(i?n.createSelection(i):n.document.selection).getFirstPosition();let a;if(je(r.parent))a=r.parent;else if(je(r.nodeBefore))a=r.nodeBefore;else return;n.change(l=>{const c=a.getAttribute("listType"),u=a.getAttribute("listIndent"),d=s[0].getAttribute("listIndent")||0,f=Math.max(u-d,0);for(const m of s){const g=je(m);a.is("element","listItem")&&m.is("element","paragraph")&&l.rename(m,"listItem"),l.setAttributes({listIndent:(g?m.getAttribute("listIndent"):0)+f,listItemId:g?m.getAttribute("listItemId"):Gr.next(),listType:c},m)}})}}function Zv(n,t){const e=n.document.selection;if(!e.isCollapsed)return!Ml(n);if(t==="forward")return!0;const s=e.getFirstPosition().parent,o=s.previousSibling;return n.schema.isObject(o)?!1:o.isEmpty?!0:Bl([s,o])}function cg(n,t,e,i){n.ui.componentFactory.add(t,()=>{const s=Jv(te,n,t,e,i);return s.set({tooltip:!0,isToggleable:!0}),s}),n.ui.componentFactory.add(`menuBar:${t}`,()=>Jv(pt,n,t,e,i))}function Jv(n,t,e,i,s){const o=t.commands.get(e),r=new n(t.locale);return r.set({label:i,icon:s}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.on("execute",()=>{t.execute(e),t.editing.view.focus()}),r}class gne extends A{static get pluginName(){return"ListUI"}init(){const t=this.editor.t;this.editor.ui.componentFactory.has("numberedList")||cg(this.editor,"numberedList",t("Numbered List"),F.numberedList),this.editor.ui.componentFactory.has("bulletedList")||cg(this.editor,"bulletedList",t("Bulleted List"),F.bulletedList)}}class pne extends A{static get requires(){return[Ol,gne]}static get pluginName(){return"List"}}class bne extends ne{refresh(){const t=this._getValue();this.value=t,this.isEnabled=t!=null}execute({startIndex:t=1}={}){const e=this.editor.model,i=e.document;let s=Array.from(i.selection.getSelectedBlocks()).filter(o=>je(o)&&gd(o.getAttribute("listType")));s=$h(s),e.change(o=>{for(const r of s)o.setAttribute("listStart",t>=0?t:1,r)})}_getValue(){const e=this.editor.model.document,i=Ye(e.selection.getSelectedBlocks());return i&&je(i)&&gd(i.getAttribute("listType"))?i.getAttribute("listStart"):null}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const qP={},jP={},GP={},KP=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:n,typeAttribute:t,listType:e}of KP)qP[n]=e,jP[n]=t,t&&(GP[t]=n);function ZP(){return KP.map(n=>n.listStyle)}function iw(n){return qP[n]||null}function JP(n){return GP[n]||null}function ug(n){return jP[n]||null}class wne extends ne{constructor(e,i,s){super(e);h(this,"defaultType");h(this,"_supportedTypes");this.defaultType=i,this._supportedTypes=s}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const i=this.editor.model,s=i.document;i.change(o=>{this._tryToConvertItemsToList(e);let r=Array.from(s.selection.getSelectedBlocks()).filter(a=>a.hasAttribute("listType"));if(r.length){r=$h(r);for(const a of r)o.setAttribute("listStyle",e.type||this.defaultType,a)}})}isStyleTypeSupported(e){return this._supportedTypes?this._supportedTypes.includes(e):!0}_getValue(){const e=Ye(this.editor.model.document.selection.getSelectedBlocks());return je(e)?e.getAttribute("listStyle"):null}_checkEnabled(){const e=this.editor,i=e.commands.get("numberedList"),s=e.commands.get("bulletedList");return i.isEnabled||s.isEnabled}_tryToConvertItemsToList(e){if(!e.type)return;const i=iw(e.type);if(!i)return;const s=this.editor,o=`${i}List`;s.commands.get(o).value||s.execute(o)}}class _ne extends ne{refresh(){const t=this._getValue();this.value=t,this.isEnabled=t!=null}execute(t={}){const e=this.editor.model,i=e.document;let s=Array.from(i.selection.getSelectedBlocks()).filter(o=>je(o)&&o.getAttribute("listType")=="numbered");s=$h(s),e.change(o=>{for(const r of s)o.setAttribute("listReversed",!!t.reversed,r)})}_getValue(){const e=this.editor.model.document,i=Ye(e.selection.getSelectedBlocks());return je(i)&&i.getAttribute("listType")=="numbered"?i.getAttribute("listReversed"):null}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Yv(n){return(t,e,i)=>{const{writer:s,schema:o,consumable:r}=i;if(r.test(e.viewItem,n.viewConsumables)===!1)return;e.modelRange||Object.assign(e,i.convertChildren(e.viewItem,e.modelCursor));let a=!1;for(const l of e.modelRange.getItems({shallow:!0}))o.checkAttribute(l,n.attributeName)&&n.appliesToListItem(l)&&(l.hasAttribute(n.attributeName)||(s.setAttribute(n.attributeName,n.getAttributeOnUpcast(e.viewItem),l),a=!0));a&&r.consume(e.viewItem,n.viewConsumables)}}class vne extends A{static get pluginName(){return"ListPropertiesUtils"}getAllSupportedStyleTypes(){return ZP()}getListTypeFromListStyleType(t){return iw(t)}getListStyleTypeFromTypeAttribute(t){return JP(t)}getTypeAttributeFromListStyleType(t){return ug(t)}}const Sa="default";class yne extends A{static get requires(){return[Ol,vne]}static get pluginName(){return"ListPropertiesEditing"}constructor(t){super(t),t.config.define("list.properties",{styles:!0,startIndex:!1,reversed:!1})}init(){const t=this.editor,e=t.model,i=t.plugins.get(Ol),s=t.config.get("list.properties"),o=Cne(s);for(const r of o)r.addCommand(t),e.schema.extend("$listItem",{allowAttributes:r.attributeName}),i.registerDowncastStrategy({scope:"list",attributeName:r.attributeName,setAttributeOnDowncast(a,l,c){r.setAttributeOnDowncast(a,l,c)}});t.conversion.for("upcast").add(r=>{for(const a of o)r.on("element:ol",Yv(a)),r.on("element:ul",Yv(a))}),i.on("checkAttributes:list",(r,{viewElement:a,modelAttributes:l})=>{for(const c of o)c.getAttributeOnUpcast(a)!=l[c.attributeName]&&(r.return=!0,r.stop())}),this.listenTo(t.commands.get("indentList"),"afterExecute",(r,a)=>{e.change(l=>{for(const c of a)for(const u of o)u.appliesToListItem(c)&&l.setAttribute(u.attributeName,u.defaultValue,c)})}),i.on("postFixer",(r,{listNodes:a,writer:l})=>{for(const{node:c}of a)for(const u of o)u.hasValidAttribute(c)||(u.appliesToListItem(c)?l.setAttribute(u.attributeName,u.defaultValue,c):l.removeAttribute(u.attributeName,c),r.return=!0)}),i.on("postFixer",(r,{listNodes:a,writer:l})=>{for(const{node:c,previousNodeInList:u}of a)if(u&&u.getAttribute("listType")==c.getAttribute("listType"))for(const d of o){const{attributeName:f}=d;if(!d.appliesToListItem(c))continue;const m=u.getAttribute(f);c.getAttribute(f)!=m&&(l.setAttribute(f,m,c),r.return=!0)}})}}function Cne(n){const t=[];if(n.styles){const e=typeof n.styles=="object"&&n.styles.useAttribute;t.push({attributeName:"listStyle",defaultValue:Sa,viewConsumables:{styles:"list-style-type"},addCommand(i){let s=ZP();e&&(s=s.filter(o=>!!ug(o))),i.commands.add("listStyle",new wne(i,Sa,s))},appliesToListItem(i){return i.getAttribute("listType")=="numbered"||i.getAttribute("listType")=="bulleted"},hasValidAttribute(i){if(!this.appliesToListItem(i))return!i.hasAttribute("listStyle");if(!i.hasAttribute("listStyle"))return!1;const s=i.getAttribute("listStyle");return s==Sa?!0:iw(s)==i.getAttribute("listType")},setAttributeOnDowncast(i,s,o){if(s&&s!==Sa)if(e){const r=ug(s);if(r){i.setAttribute("type",r,o);return}}else{i.setStyle("list-style-type",s,o);return}i.removeStyle("list-style-type",o),i.removeAttribute("type",o)},getAttributeOnUpcast(i){const s=i.getStyle("list-style-type");if(s)return s;const o=i.getAttribute("type");return o?JP(o):Sa}})}return n.reversed&&t.push({attributeName:"listReversed",defaultValue:!1,viewConsumables:{attributes:"reversed"},addCommand(e){e.commands.add("listReversed",new _ne(e))},appliesToListItem(e){return e.getAttribute("listType")=="numbered"},hasValidAttribute(e){return this.appliesToListItem(e)==e.hasAttribute("listReversed")},setAttributeOnDowncast(e,i,s){i?e.setAttribute("reversed","reversed",s):e.removeAttribute("reversed",s)},getAttributeOnUpcast(e){return e.hasAttribute("reversed")}}),n.startIndex&&t.push({attributeName:"listStart",defaultValue:1,viewConsumables:{attributes:"start"},addCommand(e){e.commands.add("listStart",new bne(e))},appliesToListItem(e){return gd(e.getAttribute("listType"))},hasValidAttribute(e){return this.appliesToListItem(e)==e.hasAttribute("listStart")},setAttributeOnDowncast(e,i,s){i==0||i>1?e.setAttribute("start",i,s):e.removeAttribute("start",s)},getAttributeOnUpcast(e){const i=e.getAttribute("start");return i>=0?i:1}}),t}class YP extends q{constructor(e,{enabledProperties:i,styleButtonViews:s,styleGridAriaLabel:o}){super(e);h(this,"children");h(this,"stylesView",null);h(this,"additionalPropertiesCollapsibleView",null);h(this,"startIndexFieldView",null);h(this,"reversedSwitchButtonView",null);h(this,"focusTracker",new Ge);h(this,"keystrokes",new tt);h(this,"focusables",new Mt);h(this,"focusCycler");const r=["ck","ck-list-properties"];this.children=this.createCollection(),this.focusCycler=new Gt({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),i.styles?(this.stylesView=this._createStylesView(s,o),this.children.add(this.stylesView)):r.push("ck-list-properties_without-styles"),(i.startIndex||i.reversed)&&(this._addNumberedListPropertyViews(i),r.push("ck-list-properties_with-numbered-properties")),this.setTemplate({tag:"div",attributes:{class:r},children:this.children})}render(){if(super.render(),this.stylesView){this.focusables.add(this.stylesView),this.focusTracker.add(this.stylesView.element),(this.startIndexFieldView||this.reversedSwitchButtonView)&&(this.focusables.add(this.children.last.buttonView),this.focusTracker.add(this.children.last.buttonView.element));for(const e of this.stylesView.children)this.stylesView.focusTracker.add(e.element);Bh({keystrokeHandler:this.stylesView.keystrokes,focusTracker:this.stylesView.focusTracker,gridItems:this.stylesView.children,numberOfColumns:()=>j.window.getComputedStyle(this.stylesView.element).getPropertyValue("grid-template-columns").split(" ").length,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}if(this.startIndexFieldView){this.focusables.add(this.startIndexFieldView),this.focusTracker.add(this.startIndexFieldView.element);const e=i=>i.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}this.reversedSwitchButtonView&&(this.focusables.add(this.reversedSwitchButtonView),this.focusTracker.add(this.reversedSwitchButtonView.element)),this.keystrokes.listenTo(this.element)}focus(){this.focusCycler.focusFirst()}focusLast(){this.focusCycler.focusLast()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createStylesView(e,i){const s=new q(this.locale);return s.children=s.createCollection(),s.children.addMany(e),s.setTemplate({tag:"div",attributes:{"aria-label":i,class:["ck","ck-list-styles-list"]},children:s.children}),s.children.delegate("execute").to(this),s.focus=function(){this.children.first.focus()},s.focusTracker=new Ge,s.keystrokes=new tt,s.render(),s.keystrokes.listenTo(s.element),s}_addNumberedListPropertyViews(e){const i=this.locale.t,s=[];e.startIndex&&(this.startIndexFieldView=this._createStartIndexField(),s.push(this.startIndexFieldView)),e.reversed&&(this.reversedSwitchButtonView=this._createReversedSwitchButton(),s.push(this.reversedSwitchButtonView)),e.styles?(this.additionalPropertiesCollapsibleView=new TI(this.locale,s),this.additionalPropertiesCollapsibleView.set({label:i("List properties"),isCollapsed:!0}),this.additionalPropertiesCollapsibleView.buttonView.bind("isEnabled").toMany(s,"isEnabled",(...o)=>o.some(r=>r)),this.additionalPropertiesCollapsibleView.buttonView.on("change:isEnabled",(o,r,a)=>{a||(this.additionalPropertiesCollapsibleView.isCollapsed=!0)}),this.children.add(this.additionalPropertiesCollapsibleView)):this.children.addMany(s)}_createStartIndexField(){const e=this.locale.t,i=new wt(this.locale,VI);return i.set({label:e("Start at"),class:"ck-numbered-list-properties__start-index"}),i.fieldView.set({min:0,step:1,value:1,inputMode:"numeric"}),i.fieldView.on("input",()=>{const s=i.fieldView.element,o=s.valueAsNumber;if(Number.isNaN(o)){i.errorText=e("Invalid start index value.");return}s.checkValidity()?this.fire("listStart",{startIndex:o}):i.errorText=e("Start index must be greater than 0.")}),i}_createReversedSwitchButton(){const e=this.locale.t,i=new rc(this.locale);return i.set({withText:!0,label:e("Reversed order"),class:"ck-numbered-list-properties__reversed-order"}),i.delegate("execute").to(this,"listReversed"),i}}var kne='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0-9a3 3 0 1 1 0 6 3 3 0 0 1 0-6z"/></svg>',Tne='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11 27a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm0-10a3 3 0 1 1 0 6 3 3 0 0 1 0-6zm0 1a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"/></svg>',Ene='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M14 27v6H8v-6h6zm0-9v6H8v-6h6zm0-9v6H8V9h6z"/></svg>',Ane='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M10.29 15V8.531H9.286c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.343 0v-1.235h-1.235V15h1.235zM11.3 24v-1.147H8.848c.064-.111.148-.226.252-.343.104-.117.351-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.494-.824.104-.263.156-.539.156-.829 0-.51-.182-.936-.545-1.279-.363-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.153-.155.358-.233.616-.233.26 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.468.536-1.024 1.055-.692.641-1.155 1.156-1.389 1.544-.234.389-.375.8-.422 1.233H11.3zm2.333 0v-1.235h-1.235V24h1.235zM9.204 34.11c.615 0 1.129-.2 1.542-.598.413-.398.62-.88.62-1.446 0-.39-.11-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.619-.337.928-.788.928-1.353 0-.399-.151-.756-.453-1.073-.366-.386-.852-.58-1.459-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.668.55c-.16.232-.28.544-.358.933l1.138.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.215 0 .386.065.515.194s.193.302.193.518c0 .255-.087.46-.263.613-.176.154-.43.227-.765.218l-.136 1.006c.22-.061.409-.092.567-.092.24 0 .444.09.61.272.168.182.251.428.251.739 0 .328-.087.589-.261.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.307-.698l-1.196.145c.062.542.285.98.668 1.316.384.335.868.503 1.45.503zm4.43-.11v-1.235h-1.236V34h1.235z"/></svg>',xne='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M5.714 15.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm6.078.914V8.531H10.79c-.14.393-.4.736-.778 1.03-.378.295-.728.495-1.05.6v1.121a4.257 4.257 0 0 0 1.595-.936V15h1.235zm3.344 0v-1.235h-1.235V15h1.235zm-9.422 9.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm7.088.914v-1.147H10.35c.065-.111.149-.226.253-.343.104-.117.35-.354.74-.712.39-.357.66-.631.81-.821.225-.288.39-.562.493-.824.104-.263.156-.539.156-.829 0-.51-.181-.936-.544-1.279-.364-.342-.863-.514-1.499-.514-.58 0-1.063.148-1.45.444-.387.296-.617.784-.69 1.463l1.23.124c.024-.36.112-.619.264-.774.152-.155.357-.233.615-.233.261 0 .465.074.613.222.148.148.222.36.222.635 0 .25-.085.501-.255.756-.126.185-.467.536-1.024 1.055-.691.641-1.154 1.156-1.388 1.544-.235.389-.375.8-.422 1.233h4.328zm2.334 0v-1.235h-1.235V24h1.235zM5.714 34.11c.624 0 1.11-.22 1.46-.66.421-.533.632-1.408.632-2.627 0-1.222-.21-2.096-.629-2.624-.351-.445-.839-.668-1.463-.668-.624 0-1.11.22-1.459.66-.422.533-.633 1.406-.633 2.619 0 1.236.192 2.095.576 2.577.384.482.89.723 1.516.723zm0-1.024a.614.614 0 0 1-.398-.14c-.115-.094-.211-.283-.287-.565-.077-.283-.115-.802-.115-1.558s.043-1.294.128-1.613c.064-.246.155-.417.272-.512a.617.617 0 0 1 .4-.143.61.61 0 0 1 .398.143c.116.095.211.284.288.567.076.283.114.802.114 1.558s-.043 1.292-.128 1.608c-.064.246-.155.417-.272.512a.617.617 0 0 1-.4.143zm4.992 1.024c.616 0 1.13-.2 1.543-.598.413-.398.62-.88.62-1.446 0-.39-.111-.722-.332-.997a1.5 1.5 0 0 0-.886-.532c.618-.337.927-.788.927-1.353 0-.399-.15-.756-.452-1.073-.366-.386-.853-.58-1.46-.58a2.25 2.25 0 0 0-.96.2 1.617 1.617 0 0 0-.667.55c-.16.232-.28.544-.359.933l1.139.194c.032-.282.123-.495.272-.642.15-.146.33-.22.54-.22.214 0 .386.065.515.194s.193.302.193.518c0 .255-.088.46-.264.613-.175.154-.43.227-.764.218l-.136 1.006c.22-.061.408-.092.566-.092.24 0 .444.09.611.272.167.182.25.428.25.739 0 .328-.086.589-.26.782a.833.833 0 0 1-.644.29.841.841 0 0 1-.607-.242c-.167-.16-.27-.394-.308-.698l-1.195.145c.062.542.284.98.668 1.316.384.335.867.503 1.45.503zm4.43-.11v-1.235h-1.235V34h1.235z"/></svg>',Sne='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.88 8.7V7.558h-1.234V8.7h1.234zm0 5.3V9.333h-1.234V14h1.234zm2.5 0v-1.235h-1.234V14h1.235zm-4.75 4.7v-1.142H8.395V18.7H9.63zm0 5.3v-4.667H8.395V24H9.63zm2.5-5.3v-1.142h-1.234V18.7h1.235zm0 5.3v-4.667h-1.234V24h1.235zm2.501 0v-1.235h-1.235V24h1.235zM7.38 28.7v-1.142H6.145V28.7H7.38zm0 5.3v-4.667H6.145V34H7.38zm2.5-5.3v-1.142H8.646V28.7H9.88zm0 5.3v-4.667H8.646V34H9.88zm2.5-5.3v-1.142h-1.234V28.7h1.235zm0 5.3v-4.667h-1.234V34h1.235zm2.501 0v-1.235h-1.235V34h1.235z"/></svg>',Ine='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M11.916 15V8.558h-1.301V15h1.3zm2.465 0v-1.235h-1.235V15h1.235zM9.665 25v-6.442h-1.3V25h1.3zm2.5 0v-6.442h-1.3V25h1.3zm2.466 0v-1.235h-1.235V25h1.235zm-7.216 9v-6.442h-1.3V34h1.3zm2.5 0v-6.442h-1.3V34h1.3zm2.501 0v-6.442h-1.3V34h1.3zm2.465 0v-1.235h-1.235V34h1.235z"/></svg>',Pne='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="M9.62 14.105c.272 0 .528-.05.768-.153s.466-.257.677-.462c.009.024.023.072.044.145.047.161.086.283.119.365h1.221a2.649 2.649 0 0 1-.222-.626c-.04-.195-.059-.498-.059-.908l.013-1.441c0-.536-.055-.905-.165-1.105-.11-.201-.3-.367-.569-.497-.27-.13-.68-.195-1.23-.195-.607 0-1.064.108-1.371.325-.308.217-.525.55-.65 1.002l1.12.202c.076-.217.176-.369.299-.455.123-.086.294-.13.514-.13.325 0 .546.05.663.152.118.101.176.27.176.508v.123c-.222.093-.622.194-1.2.303-.427.082-.755.178-.982.288-.227.11-.403.268-.53.474a1.327 1.327 0 0 0-.188.706c0 .398.138.728.415.988.277.261.656.391 1.136.391zm.368-.87a.675.675 0 0 1-.492-.189.606.606 0 0 1-.193-.448c0-.176.08-.32.241-.435.106-.07.33-.142.673-.215a7.19 7.19 0 0 0 .751-.19v.247c0 .296-.016.496-.048.602a.773.773 0 0 1-.295.409 1.07 1.07 0 0 1-.637.22zm4.645.765v-1.235h-1.235V14h1.235zM10.2 25.105c.542 0 1.003-.215 1.382-.646.38-.43.57-1.044.57-1.84 0-.771-.187-1.362-.559-1.774a1.82 1.82 0 0 0-1.41-.617c-.522 0-.973.216-1.354.65v-2.32H7.594V25h1.147v-.686a1.9 1.9 0 0 0 .67.592c.26.133.523.2.79.2zm-.299-.975c-.354 0-.638-.164-.852-.492-.153-.232-.229-.59-.229-1.073 0-.468.098-.818.295-1.048a.93.93 0 0 1 .738-.345c.302 0 .55.118.743.354.193.236.29.62.29 1.154 0 .5-.096.868-.288 1.1-.192.233-.424.35-.697.35zm4.478.87v-1.235h-1.234V25h1.234zm-4.017 9.105c.6 0 1.08-.142 1.437-.426.357-.284.599-.704.725-1.261l-1.213-.207c-.061.326-.167.555-.316.688a.832.832 0 0 1-.576.2.916.916 0 0 1-.75-.343c-.185-.228-.278-.62-.278-1.173 0-.498.091-.853.274-1.066.183-.212.429-.318.736-.318.232 0 .42.061.565.184.145.123.238.306.28.55l1.216-.22c-.146-.501-.387-.874-.722-1.119-.336-.244-.788-.366-1.356-.366-.695 0-1.245.214-1.653.643-.407.43-.61 1.03-.61 1.8 0 .762.202 1.358.608 1.788.406.431.95.646 1.633.646zM14.633 34v-1.235h-1.235V34h1.235z"/></svg>',Rne='<svg viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg"><path d="M35 29a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17zm0-9a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H18a1 1 0 0 1-1-1v-1a1 1 0 0 1 1-1h17z" fill-opacity=".163"/><path d="m7.88 15 .532-1.463h2.575L11.549 15h1.415l-2.58-6.442H9.01L6.5 15h1.38zm2.69-2.549H8.811l.87-2.39.887 2.39zM14.88 15v-1.235h-1.234V15h1.234zM9.352 25c.83-.006 1.352-.02 1.569-.044.346-.038.636-.14.872-.305.236-.166.422-.387.558-.664.137-.277.205-.562.205-.855 0-.372-.106-.695-.317-.97-.21-.276-.512-.471-.905-.585a1.51 1.51 0 0 0 .661-.567 1.5 1.5 0 0 0 .244-.83c0-.28-.066-.53-.197-.754a1.654 1.654 0 0 0-.495-.539 1.676 1.676 0 0 0-.672-.266c-.25-.042-.63-.063-1.14-.063H7.158V25h2.193zm.142-3.88H8.46v-1.49h.747c.612 0 .983.007 1.112.022.217.026.38.102.49.226.11.125.165.287.165.486a.68.68 0 0 1-.192.503.86.86 0 0 1-.525.23 11.47 11.47 0 0 1-.944.023h.18zm.17 2.795H8.46v-1.723h1.05c.592 0 .977.03 1.154.092.177.062.313.16.406.295a.84.84 0 0 1 .14.492c0 .228-.06.41-.181.547a.806.806 0 0 1-.473.257c-.126.026-.423.04-.892.04zM14.88 25v-1.235h-1.234V25h1.234zm-5.018 9.11c.691 0 1.262-.17 1.711-.512.45-.341.772-.864.965-1.567l-1.261-.4c-.109.472-.287.818-.536 1.037-.25.22-.547.33-.892.33-.47 0-.85-.173-1.143-.519-.293-.345-.44-.925-.44-1.74 0-.767.15-1.322.447-1.665.297-.343.684-.514 1.162-.514.346 0 .64.096.881.29.242.193.4.457.477.79l1.288-.307c-.147-.516-.367-.911-.66-1.187-.492-.465-1.132-.698-1.92-.698-.902 0-1.63.296-2.184.89-.554.593-.83 1.426-.83 2.498 0 1.014.275 1.813.825 2.397.551.585 1.254.877 2.11.877zM14.88 34v-1.235h-1.234V34h1.234z"/></svg>';class Lne extends A{static get pluginName(){return"ListPropertiesUI"}init(){const t=this.editor,e=t.locale.t,i=t.config.get("list.properties");if(i.styles){const s=[{label:e("Toggle the disc list style"),tooltip:e("Disc"),type:"disc",icon:kne},{label:e("Toggle the circle list style"),tooltip:e("Circle"),type:"circle",icon:Tne},{label:e("Toggle the square list style"),tooltip:e("Square"),type:"square",icon:Ene}],o=e("Bulleted List"),r=e("Bulleted list styles toolbar"),a="bulletedList";t.ui.componentFactory.add(a,Xv({editor:t,propertiesConfig:i,parentCommandName:a,buttonLabel:o,buttonIcon:F.bulletedList,styleGridAriaLabel:r,styleDefinitions:s})),t.ui.componentFactory.add(`menuBar:${a}`,Qv({editor:t,propertiesConfig:i,parentCommandName:a,buttonLabel:o,styleGridAriaLabel:r,styleDefinitions:s}))}if(i.styles||i.startIndex||i.reversed){const s=[{label:e("Toggle the decimal list style"),tooltip:e("Decimal"),type:"decimal",icon:Ane},{label:e("Toggle the decimal with leading zero list style"),tooltip:e("Decimal with leading zero"),type:"decimal-leading-zero",icon:xne},{label:e("Toggle the lower–roman list style"),tooltip:e("Lower–roman"),type:"lower-roman",icon:Sne},{label:e("Toggle the upper–roman list style"),tooltip:e("Upper-roman"),type:"upper-roman",icon:Ine},{label:e("Toggle the lower–latin list style"),tooltip:e("Lower-latin"),type:"lower-latin",icon:Pne},{label:e("Toggle the upper–latin list style"),tooltip:e("Upper-latin"),type:"upper-latin",icon:Rne}],o=e("Numbered List"),r=e("Numbered list styles toolbar"),a="numberedList";t.ui.componentFactory.add(a,Xv({editor:t,propertiesConfig:i,parentCommandName:a,buttonLabel:o,buttonIcon:F.numberedList,styleGridAriaLabel:r,styleDefinitions:s})),i.styles&&t.ui.componentFactory.add(`menuBar:${a}`,Qv({editor:t,propertiesConfig:i,parentCommandName:a,buttonLabel:o,styleGridAriaLabel:r,styleDefinitions:s}))}}}function Xv({editor:n,propertiesConfig:t,parentCommandName:e,buttonLabel:i,buttonIcon:s,styleGridAriaLabel:o,styleDefinitions:r}){const a=n.commands.get(e);return l=>{const c=Yt(l,la),u=c.buttonView;return c.bind("isEnabled").to(a),c.class="ck-list-styles-dropdown",u.on("execute",()=>{n.execute(e),n.editing.view.focus()}),u.set({label:i,icon:s,tooltip:!0,isToggleable:!0}),u.bind("isOn").to(a,"value",d=>!!d),c.once("change:isOpen",()=>{const d=Vne({editor:n,propertiesConfig:t,dropdownView:c,parentCommandName:e,styleGridAriaLabel:o,styleDefinitions:r});c.panelView.children.add(d)}),c.on("execute",()=>{n.editing.view.focus()}),c}}function XP({editor:n,listStyleCommand:t,parentCommandName:e}){const i=n.locale,s=n.commands.get(e);return({label:o,type:r,icon:a,tooltip:l})=>{const c=new te(i);return c.set({label:o,icon:a,tooltip:l}),t.on("change:value",()=>{c.isOn=t.value===r}),c.on("execute",()=>{s.value?t.value===r?n.execute(e):t.value!==r&&n.execute("listStyle",{type:r}):n.model.change(()=>{n.execute("listStyle",{type:r})})}),c}}function Vne({editor:n,propertiesConfig:t,dropdownView:e,parentCommandName:i,styleDefinitions:s,styleGridAriaLabel:o}){const r=n.locale,a={...t};i!="numberedList"&&(a.startIndex=!1,a.reversed=!1);let l=null;if(a.styles){const u=n.commands.get("listStyle"),d=XP({editor:n,parentCommandName:i,listStyleCommand:u}),f=QP(u);l=s.filter(f).map(d)}const c=new YP(r,{styleGridAriaLabel:o,enabledProperties:a,styleButtonViews:l});if(a.styles&&$b(e,()=>c.stylesView.children.find(u=>u.isOn)),a.startIndex){const u=n.commands.get("listStart");c.startIndexFieldView.bind("isEnabled").to(u),c.startIndexFieldView.fieldView.bind("value").to(u),c.on("listStart",(d,f)=>n.execute("listStart",f))}if(a.reversed){const u=n.commands.get("listReversed");c.reversedSwitchButtonView.bind("isEnabled").to(u),c.reversedSwitchButtonView.bind("isOn").to(u,"value",d=>!!d),c.on("listReversed",()=>{const d=u.value;n.execute("listReversed",{reversed:!d})})}return c.delegate("execute").to(e),c}function Qv({editor:n,propertiesConfig:t,parentCommandName:e,buttonLabel:i,styleGridAriaLabel:s,styleDefinitions:o}){return r=>{const a=new ui(r),l=n.commands.get(e),c=n.commands.get("listStyle"),u=QP(c),d=XP({editor:n,parentCommandName:e,listStyleCommand:c}),f=o.filter(u).map(d),m=new YP(r,{styleGridAriaLabel:s,enabledProperties:{...t,startIndex:!1,reversed:!1},styleButtonViews:f});return m.delegate("execute").to(a),a.buttonView.set({label:i,icon:F[e]}),a.panelView.children.add(m),a.bind("isEnabled").to(l,"isEnabled"),a.on("execute",()=>{n.editing.view.focus()}),a}}function QP(n){return typeof n.isStyleTypeSupported=="function"?t=>n.isStyleTypeSupported(t.type):()=>!0}class Bne extends A{static get requires(){return[yne,Lne]}static get pluginName(){return"ListProperties"}}class Mne extends ne{constructor(t){super(t),this.on("execute",()=>{this.refresh()},{priority:"highest"})}refresh(){const t=this._getSelectedItems();this.value=this._getValue(t),this.isEnabled=!!t.length}execute(t={}){this.editor.model.change(e=>{const i=this._getSelectedItems(),s=t.forceValue===void 0?!this._getValue(i):t.forceValue;for(const o of i)s?e.setAttribute("todoListChecked",!0,o):e.removeAttribute("todoListChecked",o)})}_getValue(t){return t.every(e=>e.getAttribute("todoListChecked"))}_getSelectedItems(){const t=this.editor.model,e=t.schema,i=t.document.selection.getFirstRange(),s=i.start.parent,o=[];e.checkAttribute(s,"todoListChecked")&&o.push(...Vl(s));for(const r of i.getItems({shallow:!0}))e.checkAttribute(r,"todoListChecked")&&!o.includes(r)&&o.push(...Vl(r));return o}}class One extends fs{constructor(){super(...arguments);h(this,"domEventType",["change"])}onDomEvent(e){if(e.target){const i=this.view.domConverter.mapDomToView(e.target);i&&i.is("element","input")&&i.getAttribute("type")=="checkbox"&&i.findAncestor({classes:"todo-list__label"})&&this.fire("todoCheckboxChange",e)}}}const Nne=Th("Ctrl+Enter");class Fne extends A{static get pluginName(){return"TodoListEditing"}static get requires(){return[Ol]}init(){const t=this.editor,e=t.model,i=t.editing,s=t.plugins.get(Ol),r=t.config.get("list.multiBlock")?"paragraph":"listItem";t.commands.add("todoList",new Ma(t,"todo")),t.commands.add("checkTodoList",new Mne(t)),i.view.addObserver(One),e.schema.extend("$listItem",{allowAttributes:"todoListChecked"}),e.schema.addAttributeCheck((a,l)=>{const c=a.last;if(l=="todoListChecked"&&(!c.getAttribute("listItemId")||c.getAttribute("listType")!="todo"))return!1}),t.conversion.for("upcast").add(a=>{a.on("element:input",Dne()),a.on("element:label",zf({name:"label",classes:"todo-list__label"})),a.on("element:label",zf({name:"label",classes:["todo-list__label","todo-list__label_without-description"]})),a.on("element:span",zf({name:"span",classes:"todo-list__label__description"})),a.on("element:ul",$ne({name:"ul",classes:"todo-list"}))}),t.conversion.for("downcast").elementToElement({model:r,view:(a,{writer:l})=>{if(tu(a,s.getListAttributeNames()))return l.createContainerElement("span",{class:"todo-list__label__description"})},converterPriority:"highest"}),s.registerDowncastStrategy({scope:"list",attributeName:"listType",setAttributeOnDowncast(a,l,c){l=="todo"?a.addClass("todo-list",c):a.removeClass("todo-list",c)}}),s.registerDowncastStrategy({scope:"itemMarker",attributeName:"todoListChecked",createElement(a,l,{dataPipeline:c}){if(l.getAttribute("listType")!="todo")return null;const u=a.createUIElement("input",{type:"checkbox",...l.getAttribute("todoListChecked")?{checked:"checked"}:null,...c?{disabled:"disabled"}:{tabindex:"-1"}});if(c)return u;const d=a.createContainerElement("span",{contenteditable:"false"},u);return d.getFillerOffset=()=>null,d},canWrapElement(a){return tu(a,s.getListAttributeNames())},createWrapperElement(a,l,{dataPipeline:c}){const u=["todo-list__label"];return tu(l,s.getListAttributeNames())||u.push("todo-list__label_without-description"),a.createAttributeElement(c?"label":"span",{class:u.join(" ")})}}),s.on("checkElement",(a,{modelElement:l,viewElement:c})=>{const u=tu(l,s.getListAttributeNames());c.hasClass("todo-list__label__description")!=u&&(a.return=!0,a.stop())}),s.on("checkElement",(a,{modelElement:l,viewElement:c})=>{const u=l.getAttribute("listType")=="todo"&&ts(l);let d=!1;const f=t.editing.view.createPositionBefore(c).getWalker({direction:"backward"});for(const{item:m}of f){if(m.is("element")&&t.editing.mapper.toModelElement(m))break;m.is("element","input")&&m.getAttribute("type")=="checkbox"&&(d=!0)}d!=u&&(a.return=!0,a.stop())}),s.on("postFixer",(a,{listNodes:l,writer:c})=>{for(const{node:u,previousNodeInList:d}of l){if(!d||d.getAttribute("listItemId")!=u.getAttribute("listItemId"))continue;const f=d.hasAttribute("todoListChecked"),m=u.hasAttribute("todoListChecked");m&&!f?(c.removeAttribute("todoListChecked",u),a.return=!0):!m&&f&&(c.setAttribute("todoListChecked",!0,u),a.return=!0)}}),e.document.registerPostFixer(a=>{const l=e.document.differ.getChanges();let c=!1;for(const u of l)if(u.type=="attribute"&&u.attributeKey=="listType"){const d=u.range.start.nodeAfter;u.attributeOldValue=="todo"&&d.hasAttribute("todoListChecked")&&(a.removeAttribute("todoListChecked",d),c=!0)}else if(u.type=="insert"&&u.name!="$text")for(const{item:d}of a.createRangeOn(u.position.nodeAfter))d.is("element")&&d.getAttribute("listType")!="todo"&&d.hasAttribute("todoListChecked")&&(a.removeAttribute("todoListChecked",d),c=!0);return c}),this.listenTo(i.view.document,"keydown",(a,l)=>{Po(l)===Nne&&(t.execute("checkTodoList"),a.stop())},{priority:"high"}),this.listenTo(i.view.document,"todoCheckboxChange",(a,l)=>{const c=l.target;if(!c||!c.is("element","input"))return;const u=i.view.createPositionAfter(c),f=i.mapper.toModelPosition(u).parent;f&&je(f)&&f.getAttribute("listType")=="todo"&&this._handleCheckmarkChange(f)}),this.listenTo(i.view.document,"arrowKey",zne(e,t.locale),{context:"$text"}),this.listenTo(i.mapper,"viewToModelPosition",(a,l)=>{const c=l.viewPosition.parent,u=c.is("attributeElement","li")&&l.viewPosition.offset==0,d=ey(c)&&l.viewPosition.offset<=1,f=c.is("element","span")&&c.getAttribute("contenteditable")=="false"&&ey(c.parent);if(!u&&!d&&!f)return;const m=l.modelPosition.nodeAfter;m&&m.getAttribute("listType")=="todo"&&(l.modelPosition=e.createPositionAt(m,0))},{priority:"low"}),this._initAriaAnnouncements()}_handleCheckmarkChange(t){const e=this.editor,i=e.model,s=Array.from(i.document.selection.getRanges());i.change(o=>{o.setSelection(t,"end"),e.execute("checkTodoList"),o.setSelection(s)})}_initAriaAnnouncements(){const{model:t,ui:e,t:i}=this.editor;let s=null;e&&t.document.selection.on("change:range",()=>{const o=t.document.selection.focus.parent,r=ty(s),a=ty(o);r&&!a?e.ariaLiveAnnouncer.announce(i("Leaving a to-do list")):!r&&a&&e.ariaLiveAnnouncer.announce(i("Entering a to-do list")),s=o})}}function Dne(){return(n,t,e)=>{const i=t.modelCursor,s=i.parent,o=t.viewItem;if(!e.consumable.test(o,{name:!0})||o.getAttribute("type")!="checkbox"||!i.isAtStart||!s.hasAttribute("listType"))return;e.consumable.consume(o,{name:!0});const r=e.writer;r.setAttribute("listType","todo",s),t.viewItem.hasAttribute("checked")&&r.setAttribute("todoListChecked",!0,s),t.modelRange=r.createRange(i)}}function zf(n){const t=new Qt(n);return(e,i,s)=>{const o=t.match(i.viewItem);o&&s.consumable.consume(i.viewItem,o.match)&&Object.assign(i,s.convertChildren(i.viewItem,i.modelCursor))}}function $ne(n){const t=new Qt(n);return(e,i,s)=>{const o=t.match(i.viewItem);if(!o)return;const r=o.match;r.name=!1,s.consumable.consume(i.viewItem,r)}}function tu(n,t){return(n.is("element","paragraph")||n.is("element","listItem"))&&n.getAttribute("listType")=="todo"&&ts(n)&&Hne(n,t)}function Hne(n,t){for(const e of n.getAttributeKeys())if(!e.startsWith("selection:")&&!t.includes(e))return!1;return!0}function zne(n,t){return(e,i)=>{const s=Eh(i.keyCode,t.contentLanguageDirection),o=n.schema,r=n.document.selection;if(!r.isCollapsed)return;const a=r.getFirstPosition(),l=a.parent;if(s=="right"&&a.isAtEnd){const c=o.getNearestSelectionRange(n.createPositionAfter(l),"forward");if(!c)return;const u=c.start.parent;u&&je(u)&&u.getAttribute("listType")=="todo"&&(n.change(d=>d.setSelection(c)),i.preventDefault(),i.stopPropagation(),e.stop())}else if(s=="left"&&a.isAtStart&&je(l)&&l.getAttribute("listType")=="todo"){const c=o.getNearestSelectionRange(n.createPositionBefore(l),"backward");if(!c)return;n.change(u=>u.setSelection(c)),i.preventDefault(),i.stopPropagation(),e.stop()}}}function ey(n){return!!n&&n.is("attributeElement")&&n.hasClass("todo-list__label")}function ty(n){return!n||!n.is("element","paragraph")&&!n.is("element","listItem")?!1:n.getAttribute("listType")=="todo"}class Une extends A{static get pluginName(){return"TodoListUI"}init(){const t=this.editor.t;cg(this.editor,"todoList",t("To-do List"),F.todoList)}}class Wne extends A{static get requires(){return[Fne,Une]}static get pluginName(){return"TodoList"}}function eR(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let ha=eR();function qne(n){ha=n}const jne=/[&<>"']/,Gne=/[&<>"']/g,Kne=/[<>"']|&(?!#?\w+;)/,Zne=/[<>"']|&(?!#?\w+;)/g,Jne={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ny=n=>Jne[n];function At(n,t){if(t){if(jne.test(n))return n.replace(Gne,ny)}else if(Kne.test(n))return n.replace(Zne,ny);return n}const Yne=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function tR(n){return n.replace(Yne,(t,e)=>(e=e.toLowerCase(),e==="colon"?":":e.charAt(0)==="#"?e.charAt(1)==="x"?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""))}const Xne=/(^|[^\[])\^/g;function Ke(n,t){n=n.source||n,t=t||"";const e={replace:(i,s)=>(s=s.source||s,s=s.replace(Xne,"$1"),n=n.replace(i,s),e),getRegex:()=>new RegExp(n,t)};return e}const Qne=/[^\w:]/g,eie=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function iy(n,t,e){if(n){let i;try{i=decodeURIComponent(tR(e)).replace(Qne,"").toLowerCase()}catch{return null}if(i.indexOf("javascript:")===0||i.indexOf("vbscript:")===0||i.indexOf("data:")===0)return null}t&&!eie.test(e)&&(e=sie(t,e));try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}const nu={},tie=/^[^:]+:\/*[^/]*$/,nie=/^([^:]+:)[\s\S]*$/,iie=/^([^:]+:\/*[^/]*)[\s\S]*$/;function sie(n,t){nu[" "+n]||(tie.test(n)?nu[" "+n]=n+"/":nu[" "+n]=vu(n,"/",!0)),n=nu[" "+n];const e=n.indexOf(":")===-1;return t.substring(0,2)==="//"?e?t:n.replace(nie,"$1")+t:t.charAt(0)==="/"?e?t:n.replace(iie,"$1")+t:n+t}const bd={exec:function(){}};function gi(n){let t=1,e,i;for(;t<arguments.length;t++){e=arguments[t];for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n}function sy(n,t){const e=n.replace(/\|/g,(o,r,a)=>{let l=!1,c=r;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),i=e.split(/ \|/);let s=0;if(i[0].trim()||i.shift(),i.length>0&&!i[i.length-1].trim()&&i.pop(),i.length>t)i.splice(t);else for(;i.length<t;)i.push("");for(;s<i.length;s++)i[s]=i[s].trim().replace(/\\\|/g,"|");return i}function vu(n,t,e){const i=n.length;if(i===0)return"";let s=0;for(;s<i;){const o=n.charAt(i-s-1);if(o===t&&!e)s++;else if(o!==t&&e)s++;else break}return n.substr(0,i-s)}function oie(n,t){if(n.indexOf(t[1])===-1)return-1;const e=n.length;let i=0,s=0;for(;s<e;s++)if(n[s]==="\\")s++;else if(n[s]===t[0])i++;else if(n[s]===t[1]&&(i--,i<0))return s;return-1}function nR(n){n&&n.sanitize&&!n.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function oy(n,t){if(t<1)return"";let e="";for(;t>1;)t&1&&(e+=n),t>>=1,n+=n;return e+n}function ry(n,t,e,i){const s=t.href,o=t.title?At(t.title):null,r=n[1].replace(/\\([\[\]])/g,"$1");if(n[0].charAt(0)!=="!"){i.state.inLink=!0;const a={type:"link",raw:e,href:s,title:o,text:r,tokens:i.inlineTokens(r,[])};return i.state.inLink=!1,a}else return{type:"image",raw:e,href:s,title:o,text:At(r)}}function rie(n,t){const e=n.match(/^(\s+)(?:```)/);if(e===null)return t;const i=e[1];return t.split(`
`).map(s=>{const o=s.match(/^\s+/);if(o===null)return s;const[r]=o;return r.length>=i.length?s.slice(i.length):s}).join(`
`)}class sw{constructor(t){this.options=t||ha}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const i=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?i:vu(i,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const i=e[0],s=rie(i,e[3]||"");return{type:"code",raw:i,lang:e[2]?e[2].trim():e[2],text:s}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let i=e[2].trim();if(/#$/.test(i)){const o=vu(i,"#");(this.options.pedantic||!o||/ $/.test(o))&&(i=o.trim())}const s={type:"heading",raw:e[0],depth:e[1].length,text:i,tokens:[]};return this.lexer.inline(s.text,s.tokens),s}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){const i=e[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:e[0],tokens:this.lexer.blockTokens(i,[]),text:i}}}list(t){let e=this.rules.block.list.exec(t);if(e){let i,s,o,r,a,l,c,u,d,f,m,g,p=e[1].trim();const w=p.length>1,v={type:"list",raw:"",ordered:w,start:w?+p.slice(0,-1):"",loose:!1,items:[]};p=w?`\\d{1,9}\\${p.slice(-1)}`:`\\${p}`,this.options.pedantic&&(p=w?p:"[*+-]");const _=new RegExp(`^( {0,3}${p})((?: [^\\n]*)?(?:\\n|$))`);for(;t&&(g=!1,!(!(e=_.exec(t))||this.rules.block.hr.test(t)));){if(i=e[0],t=t.substring(i.length),u=e[2].split(`
`,1)[0],d=t.split(`
`,1)[0],this.options.pedantic?(r=2,m=u.trimLeft()):(r=e[2].search(/[^ ]/),r=r>4?1:r,m=u.slice(r),r+=e[1].length),l=!1,!u&&/^ *$/.test(d)&&(i+=d+`
`,t=t.substring(d.length+1),g=!0),!g){const E=new RegExp(`^ {0,${Math.min(3,r-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(;t&&(f=t.split(`
`,1)[0],u=f,this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!E.test(u));){if(u.search(/[^ ]/)>=r||!u.trim())m+=`
`+u.slice(r);else if(!l)m+=`
`+u;else break;!l&&!u.trim()&&(l=!0),i+=f+`
`,t=t.substring(f.length+1)}}v.loose||(c?v.loose=!0:/\n *\n *$/.test(i)&&(c=!0)),this.options.gfm&&(s=/^\[[ xX]\] /.exec(m),s&&(o=s[0]!=="[ ] ",m=m.replace(/^\[[ xX]\] +/,""))),v.items.push({type:"list_item",raw:i,task:!!s,checked:o,loose:!1,text:m}),v.raw+=i}v.items[v.items.length-1].raw=i.trimRight(),v.items[v.items.length-1].text=m.trimRight(),v.raw=v.raw.trimRight();const y=v.items.length;for(a=0;a<y;a++){this.lexer.state.top=!1,v.items[a].tokens=this.lexer.blockTokens(v.items[a].text,[]);const E=v.items[a].tokens.filter(S=>S.type==="space"),x=E.every(S=>{const R=S.raw.split("");let V=0;for(const P of R)if(P===`
`&&(V+=1),V>1)return!0;return!1});!v.loose&&E.length&&x&&(v.loose=!0,v.items[a].loose=!0)}return v}}html(t){const e=this.rules.block.html.exec(t);if(e){const i={type:"html",raw:e[0],pre:!this.options.sanitizer&&(e[1]==="pre"||e[1]==="script"||e[1]==="style"),text:e[0]};return this.options.sanitize&&(i.type="paragraph",i.text=this.options.sanitizer?this.options.sanitizer(e[0]):At(e[0]),i.tokens=[],this.lexer.inline(i.text,i.tokens)),i}}def(t){const e=this.rules.block.def.exec(t);if(e)return e[3]&&(e[3]=e[3].substring(1,e[3].length-1)),{type:"def",tag:e[1].toLowerCase().replace(/\s+/g," "),raw:e[0],href:e[2],title:e[3]}}table(t){const e=this.rules.block.table.exec(t);if(e){const i={type:"table",header:sy(e[1]).map(s=>({text:s})),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(i.header.length===i.align.length){i.raw=e[0];let s=i.align.length,o,r,a,l;for(o=0;o<s;o++)/^ *-+: *$/.test(i.align[o])?i.align[o]="right":/^ *:-+: *$/.test(i.align[o])?i.align[o]="center":/^ *:-+ *$/.test(i.align[o])?i.align[o]="left":i.align[o]=null;for(s=i.rows.length,o=0;o<s;o++)i.rows[o]=sy(i.rows[o],i.header.length).map(c=>({text:c}));for(s=i.header.length,r=0;r<s;r++)i.header[r].tokens=[],this.lexer.inlineTokens(i.header[r].text,i.header[r].tokens);for(s=i.rows.length,r=0;r<s;r++)for(l=i.rows[r],a=0;a<l.length;a++)l[a].tokens=[],this.lexer.inlineTokens(l[a].text,l[a].tokens);return i}}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e){const i={type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const i={type:"paragraph",raw:e[0],text:e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}text(t){const e=this.rules.block.text.exec(t);if(e){const i={type:"text",raw:e[0],text:e[0],tokens:[]};return this.lexer.inline(i.text,i.tokens),i}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:At(e[1])}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):At(e[0]):e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const i=e[2].trim();if(!this.options.pedantic&&/^</.test(i)){if(!/>$/.test(i))return;const r=vu(i.slice(0,-1),"\\");if((i.length-r.length)%2===0)return}else{const r=oie(e[2],"()");if(r>-1){const l=(e[0].indexOf("!")===0?5:4)+e[1].length+r;e[2]=e[2].substring(0,r),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let s=e[2],o="";if(this.options.pedantic){const r=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);r&&(s=r[1],o=r[3])}else o=e[3]?e[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(i)?s=s.slice(1):s=s.slice(1,-1)),ry(e,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:o&&o.replace(this.rules.inline._escapes,"$1")},e[0],this.lexer)}}reflink(t,e){let i;if((i=this.rules.inline.reflink.exec(t))||(i=this.rules.inline.nolink.exec(t))){let s=(i[2]||i[1]).replace(/\s+/g," ");if(s=e[s.toLowerCase()],!s||!s.href){const o=i[0].charAt(0);return{type:"text",raw:o,text:o}}return ry(i,s,i[0],this.lexer)}}emStrong(t,e,i=""){let s=this.rules.inline.emStrong.lDelim.exec(t);if(!s||s[3]&&i.match(/[\p{L}\p{N}]/u))return;const o=s[1]||s[2]||"";if(!o||o&&(i===""||this.rules.inline.punctuation.exec(i))){const r=s[0].length-1;let a,l,c=r,u=0;const d=s[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+r);(s=d.exec(e))!=null;){if(a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!a)continue;if(l=a.length,s[3]||s[4]){c+=l;continue}else if((s[5]||s[6])&&r%3&&!((r+l)%3)){u+=l;continue}if(c-=l,c>0)continue;if(l=Math.min(l,l+c+u),Math.min(r,l)%2){const m=t.slice(1,r+s.index+l);return{type:"em",raw:t.slice(0,r+s.index+l+1),text:m,tokens:this.lexer.inlineTokens(m,[])}}const f=t.slice(2,r+s.index+l-1);return{type:"strong",raw:t.slice(0,r+s.index+l+1),text:f,tokens:this.lexer.inlineTokens(f,[])}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let i=e[2].replace(/\n/g," ");const s=/[^ ]/.test(i),o=/^ /.test(i)&&/ $/.test(i);return s&&o&&(i=i.substring(1,i.length-1)),i=At(i,!0),{type:"codespan",raw:e[0],text:i}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2],[])}}autolink(t,e){const i=this.rules.inline.autolink.exec(t);if(i){let s,o;return i[2]==="@"?(s=At(this.options.mangle?e(i[1]):i[1]),o="mailto:"+s):(s=At(i[1]),o=s),{type:"link",raw:i[0],text:s,href:o,tokens:[{type:"text",raw:s,text:s}]}}}url(t,e){let i;if(i=this.rules.inline.url.exec(t)){let s,o;if(i[2]==="@")s=At(this.options.mangle?e(i[0]):i[0]),o="mailto:"+s;else{let r;do r=i[0],i[0]=this.rules.inline._backpedal.exec(i[0])[0];while(r!==i[0]);s=At(i[0]),i[1]==="www."?o="http://"+s:o=s}return{type:"link",raw:i[0],text:s,href:o,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t,e){const i=this.rules.inline.text.exec(t);if(i){let s;return this.lexer.state.inRawBlock?s=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(i[0]):At(i[0]):i[0]:s=At(this.options.smartypants?e(i[0]):i[0]),{type:"text",raw:i[0],text:s}}}}const ae={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:bd,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};ae._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;ae._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;ae.def=Ke(ae.def).replace("label",ae._label).replace("title",ae._title).getRegex();ae.bullet=/(?:[*+-]|\d{1,9}[.)])/;ae.listItemStart=Ke(/^( *)(bull) */).replace("bull",ae.bullet).getRegex();ae.list=Ke(ae.list).replace(/bull/g,ae.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+ae.def.source+")").getRegex();ae._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";ae._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;ae.html=Ke(ae.html,"i").replace("comment",ae._comment).replace("tag",ae._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();ae.paragraph=Ke(ae._paragraph).replace("hr",ae.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae._tag).getRegex();ae.blockquote=Ke(ae.blockquote).replace("paragraph",ae.paragraph).getRegex();ae.normal=gi({},ae);ae.gfm=gi({},ae.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});ae.gfm.table=Ke(ae.gfm.table).replace("hr",ae.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae._tag).getRegex();ae.gfm.paragraph=Ke(ae._paragraph).replace("hr",ae.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",ae.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae._tag).getRegex();ae.pedantic=gi({},ae.normal,{html:Ke(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ae._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:bd,paragraph:Ke(ae.normal._paragraph).replace("hr",ae.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ae.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const Z={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:bd,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:bd,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};Z._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";Z.punctuation=Ke(Z.punctuation).replace(/punctuation/g,Z._punctuation).getRegex();Z.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;Z.escapedEmSt=/\\\*|\\_/g;Z._comment=Ke(ae._comment).replace("(?:-->|$)","-->").getRegex();Z.emStrong.lDelim=Ke(Z.emStrong.lDelim).replace(/punct/g,Z._punctuation).getRegex();Z.emStrong.rDelimAst=Ke(Z.emStrong.rDelimAst,"g").replace(/punct/g,Z._punctuation).getRegex();Z.emStrong.rDelimUnd=Ke(Z.emStrong.rDelimUnd,"g").replace(/punct/g,Z._punctuation).getRegex();Z._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;Z._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;Z._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;Z.autolink=Ke(Z.autolink).replace("scheme",Z._scheme).replace("email",Z._email).getRegex();Z._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;Z.tag=Ke(Z.tag).replace("comment",Z._comment).replace("attribute",Z._attribute).getRegex();Z._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;Z._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;Z._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;Z.link=Ke(Z.link).replace("label",Z._label).replace("href",Z._href).replace("title",Z._title).getRegex();Z.reflink=Ke(Z.reflink).replace("label",Z._label).replace("ref",ae._label).getRegex();Z.nolink=Ke(Z.nolink).replace("ref",ae._label).getRegex();Z.reflinkSearch=Ke(Z.reflinkSearch,"g").replace("reflink",Z.reflink).replace("nolink",Z.nolink).getRegex();Z.normal=gi({},Z);Z.pedantic=gi({},Z.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ke(/^!?\[(label)\]\((.*?)\)/).replace("label",Z._label).getRegex(),reflink:Ke(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",Z._label).getRegex()});Z.gfm=gi({},Z.normal,{escape:Ke(Z.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});Z.gfm.url=Ke(Z.gfm.url,"i").replace("email",Z.gfm._extended_email).getRegex();Z.breaks=gi({},Z.gfm,{br:Ke(Z.br).replace("{2,}","*").getRegex(),text:Ke(Z.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function aie(n){return n.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function ay(n){let t="",e,i;const s=n.length;for(e=0;e<s;e++)i=n.charCodeAt(e),Math.random()>.5&&(i="x"+i.toString(16)),t+="&#"+i+";";return t}class ns{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||ha,this.options.tokenizer=this.options.tokenizer||new sw,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const e={block:ae.normal,inline:Z.normal};this.options.pedantic?(e.block=ae.pedantic,e.inline=Z.pedantic):this.options.gfm&&(e.block=ae.gfm,this.options.breaks?e.inline=Z.breaks:e.inline=Z.gfm),this.tokenizer.rules=e}static get rules(){return{block:ae,inline:Z}}static lex(t,e){return new ns(e).lex(t)}static lexInline(t,e){return new ns(e).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(t,this.tokens);let e;for(;e=this.inlineQueue.shift();)this.inlineTokens(e.src,e.tokens);return this.tokens}blockTokens(t,e=[]){this.options.pedantic&&(t=t.replace(/^ +$/gm,""));let i,s,o,r;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(i=a.call({lexer:this},t,e))?(t=t.substring(i.raw.length),e.push(i),!0):!1))){if(i=this.tokenizer.space(t)){t=t.substring(i.raw.length),i.raw.length===1&&e.length>0?e[e.length-1].raw+=`
`:e.push(i);continue}if(i=this.tokenizer.code(t)){t=t.substring(i.raw.length),s=e[e.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):e.push(i);continue}if(i=this.tokenizer.fences(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.heading(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.hr(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.blockquote(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.list(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.html(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.def(t)){t=t.substring(i.raw.length),s=e[e.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+i.raw,s.text+=`
`+i.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title});continue}if(i=this.tokenizer.table(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.lheading(t)){t=t.substring(i.raw.length),e.push(i);continue}if(o=t,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=t.slice(1);let c;this.options.extensions.startBlock.forEach(function(u){c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(o=t.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(o))){s=e[e.length-1],r&&s.type==="paragraph"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):e.push(i),r=o.length!==t.length,t=t.substring(i.raw.length);continue}if(i=this.tokenizer.text(t)){t=t.substring(i.raw.length),s=e[e.length-1],s&&s.type==="text"?(s.raw+=`
`+i.raw,s.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):e.push(i);continue}if(t){const a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,e}inline(t,e){this.inlineQueue.push({src:t,tokens:e})}inlineTokens(t,e=[]){let i,s,o,r=t,a,l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,a.index)+"["+oy("a",a[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,a.index)+"["+oy("a",a[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(r))!=null;)r=r.slice(0,a.index)+"++"+r.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;t;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(i=u.call({lexer:this},t,e))?(t=t.substring(i.raw.length),e.push(i),!0):!1))){if(i=this.tokenizer.escape(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.tag(t)){t=t.substring(i.raw.length),s=e[e.length-1],s&&i.type==="text"&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):e.push(i);continue}if(i=this.tokenizer.link(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(i.raw.length),s=e[e.length-1],s&&i.type==="text"&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):e.push(i);continue}if(i=this.tokenizer.emStrong(t,r,c)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.codespan(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.br(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.del(t)){t=t.substring(i.raw.length),e.push(i);continue}if(i=this.tokenizer.autolink(t,ay)){t=t.substring(i.raw.length),e.push(i);continue}if(!this.state.inLink&&(i=this.tokenizer.url(t,ay))){t=t.substring(i.raw.length),e.push(i);continue}if(o=t,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=t.slice(1);let f;this.options.extensions.startInline.forEach(function(m){f=m.call({lexer:this},d),typeof f=="number"&&f>=0&&(u=Math.min(u,f))}),u<1/0&&u>=0&&(o=t.substring(0,u+1))}if(i=this.tokenizer.inlineText(o,aie)){t=t.substring(i.raw.length),i.raw.slice(-1)!=="_"&&(c=i.raw.slice(-1)),l=!0,s=e[e.length-1],s&&s.type==="text"?(s.raw+=i.raw,s.text+=i.text):e.push(i);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return e}}class ow{constructor(t){this.options=t||ha}code(t,e,i){const s=(e||"").match(/\S*/)[0];if(this.options.highlight){const o=this.options.highlight(t,s);o!=null&&o!==t&&(i=!0,t=o)}return t=t.replace(/\n$/,"")+`
`,s?'<pre><code class="'+this.options.langPrefix+At(s,!0)+'">'+(i?t:At(t,!0))+`</code></pre>
`:"<pre><code>"+(i?t:At(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
`+t+`</blockquote>
`}html(t){return t}heading(t,e,i,s){return this.options.headerIds?"<h"+e+' id="'+this.options.headerPrefix+s.slug(i)+'">'+t+"</h"+e+`>
`:"<h"+e+">"+t+"</h"+e+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(t,e,i){const s=e?"ol":"ul",o=e&&i!==1?' start="'+i+'"':"";return"<"+s+o+`>
`+t+"</"+s+`>
`}listitem(t){return"<li>"+t+`</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return"<p>"+t+`</p>
`}table(t,e){return e&&(e="<tbody>"+e+"</tbody>"),`<table>
<thead>
`+t+`</thead>
`+e+`</table>
`}tablerow(t){return`<tr>
`+t+`</tr>
`}tablecell(t,e){const i=e.header?"th":"td";return(e.align?"<"+i+' align="'+e.align+'">':"<"+i+">")+t+"</"+i+`>
`}strong(t){return"<strong>"+t+"</strong>"}em(t){return"<em>"+t+"</em>"}codespan(t){return"<code>"+t+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return"<del>"+t+"</del>"}link(t,e,i){if(t=iy(this.options.sanitize,this.options.baseUrl,t),t===null)return i;let s='<a href="'+At(t)+'"';return e&&(s+=' title="'+e+'"'),s+=">"+i+"</a>",s}image(t,e,i){if(t=iy(this.options.sanitize,this.options.baseUrl,t),t===null)return i;let s='<img src="'+t+'" alt="'+i+'"';return e&&(s+=' title="'+e+'"'),s+=this.options.xhtml?"/>":">",s}text(t){return t}}class iR{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,e,i){return""+i}image(t,e,i){return""+i}br(){return""}}class sR{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,e){let i=t,s=0;if(this.seen.hasOwnProperty(i)){s=this.seen[t];do s++,i=t+"-"+s;while(this.seen.hasOwnProperty(i))}return e||(this.seen[t]=s,this.seen[i]=0),i}slug(t,e={}){const i=this.serialize(t);return this.getNextSafeSlug(i,e.dryrun)}}class is{constructor(t){this.options=t||ha,this.options.renderer=this.options.renderer||new ow,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new iR,this.slugger=new sR}static parse(t,e){return new is(e).parse(t)}static parseInline(t,e){return new is(e).parseInline(t)}parse(t,e=!0){let i="",s,o,r,a,l,c,u,d,f,m,g,p,w,v,_,y,E,x,S;const R=t.length;for(s=0;s<R;s++){if(m=t[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[m.type]&&(S=this.options.extensions.renderers[m.type].call({parser:this},m),S!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(m.type))){i+=S||"";continue}switch(m.type){case"space":continue;case"hr":{i+=this.renderer.hr();continue}case"heading":{i+=this.renderer.heading(this.parseInline(m.tokens),m.depth,tR(this.parseInline(m.tokens,this.textRenderer)),this.slugger);continue}case"code":{i+=this.renderer.code(m.text,m.lang,m.escaped);continue}case"table":{for(d="",u="",a=m.header.length,o=0;o<a;o++)u+=this.renderer.tablecell(this.parseInline(m.header[o].tokens),{header:!0,align:m.align[o]});for(d+=this.renderer.tablerow(u),f="",a=m.rows.length,o=0;o<a;o++){for(c=m.rows[o],u="",l=c.length,r=0;r<l;r++)u+=this.renderer.tablecell(this.parseInline(c[r].tokens),{header:!1,align:m.align[r]});f+=this.renderer.tablerow(u)}i+=this.renderer.table(d,f);continue}case"blockquote":{f=this.parse(m.tokens),i+=this.renderer.blockquote(f);continue}case"list":{for(g=m.ordered,p=m.start,w=m.loose,a=m.items.length,f="",o=0;o<a;o++)_=m.items[o],y=_.checked,E=_.task,v="",_.task&&(x=this.renderer.checkbox(y),w?_.tokens.length>0&&_.tokens[0].type==="paragraph"?(_.tokens[0].text=x+" "+_.tokens[0].text,_.tokens[0].tokens&&_.tokens[0].tokens.length>0&&_.tokens[0].tokens[0].type==="text"&&(_.tokens[0].tokens[0].text=x+" "+_.tokens[0].tokens[0].text)):_.tokens.unshift({type:"text",text:x}):v+=x),v+=this.parse(_.tokens,w),f+=this.renderer.listitem(v,E,y);i+=this.renderer.list(f,g,p);continue}case"html":{i+=this.renderer.html(m.text);continue}case"paragraph":{i+=this.renderer.paragraph(this.parseInline(m.tokens));continue}case"text":{for(f=m.tokens?this.parseInline(m.tokens):m.text;s+1<R&&t[s+1].type==="text";)m=t[++s],f+=`
`+(m.tokens?this.parseInline(m.tokens):m.text);i+=e?this.renderer.paragraph(f):f;continue}default:{const V='Token with "'+m.type+'" type was not found.';if(this.options.silent){console.error(V);return}else throw new Error(V)}}}return i}parseInline(t,e){e=e||this.renderer;let i="",s,o,r;const a=t.length;for(s=0;s<a;s++){if(o=t[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]&&(r=this.options.extensions.renderers[o.type].call({parser:this},o),r!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type))){i+=r||"";continue}switch(o.type){case"escape":{i+=e.text(o.text);break}case"html":{i+=e.html(o.text);break}case"link":{i+=e.link(o.href,o.title,this.parseInline(o.tokens,e));break}case"image":{i+=e.image(o.href,o.title,o.text);break}case"strong":{i+=e.strong(this.parseInline(o.tokens,e));break}case"em":{i+=e.em(this.parseInline(o.tokens,e));break}case"codespan":{i+=e.codespan(o.text);break}case"br":{i+=e.br();break}case"del":{i+=e.del(this.parseInline(o.tokens,e));break}case"text":{i+=e.text(o.text);break}default:{const l='Token with "'+o.type+'" type was not found.';if(this.options.silent){console.error(l);return}else throw new Error(l)}}}return i}}function de(n,t,e){if(typeof n>"u"||n===null)throw new Error("marked(): input parameter is undefined or null");if(typeof n!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected");if(typeof t=="function"&&(e=t,t=null),t=gi({},de.defaults,t||{}),nR(t),e){const i=t.highlight;let s;try{s=ns.lex(n,t)}catch(a){return e(a)}const o=function(a){let l;if(!a)try{t.walkTokens&&de.walkTokens(s,t.walkTokens),l=is.parse(s,t)}catch(c){a=c}return t.highlight=i,a?e(a):e(null,l)};if(!i||i.length<3||(delete t.highlight,!s.length))return o();let r=0;de.walkTokens(s,function(a){a.type==="code"&&(r++,setTimeout(()=>{i(a.text,a.lang,function(l,c){if(l)return o(l);c!=null&&c!==a.text&&(a.text=c,a.escaped=!0),r--,r===0&&o()})},0))}),r===0&&o();return}try{const i=ns.lex(n,t);return t.walkTokens&&de.walkTokens(i,t.walkTokens),is.parse(i,t)}catch(i){if(i.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+At(i.message+"",!0)+"</pre>";throw i}}de.options=de.setOptions=function(n){return gi(de.defaults,n),qne(de.defaults),de};de.getDefaults=eR;de.defaults=ha;de.use=function(...n){const t=gi({},...n),e=de.defaults.extensions||{renderers:{},childTokens:{}};let i;n.forEach(s=>{if(s.extensions&&(i=!0,s.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if(o.renderer){const r=e.renderers?e.renderers[o.name]:null;r?e.renderers[o.name]=function(...a){let l=o.renderer.apply(this,a);return l===!1&&(l=r.apply(this,a)),l}:e.renderers[o.name]=o.renderer}if(o.tokenizer){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");e[o.level]?e[o.level].unshift(o.tokenizer):e[o.level]=[o.tokenizer],o.start&&(o.level==="block"?e.startBlock?e.startBlock.push(o.start):e.startBlock=[o.start]:o.level==="inline"&&(e.startInline?e.startInline.push(o.start):e.startInline=[o.start]))}o.childTokens&&(e.childTokens[o.name]=o.childTokens)})),s.renderer){const o=de.defaults.renderer||new ow;for(const r in s.renderer){const a=o[r];o[r]=(...l)=>{let c=s.renderer[r].apply(o,l);return c===!1&&(c=a.apply(o,l)),c}}t.renderer=o}if(s.tokenizer){const o=de.defaults.tokenizer||new sw;for(const r in s.tokenizer){const a=o[r];o[r]=(...l)=>{let c=s.tokenizer[r].apply(o,l);return c===!1&&(c=a.apply(o,l)),c}}t.tokenizer=o}if(s.walkTokens){const o=de.defaults.walkTokens;t.walkTokens=function(r){s.walkTokens.call(this,r),o&&o.call(this,r)}}i&&(t.extensions=e),de.setOptions(t)})};de.walkTokens=function(n,t){for(const e of n)switch(t.call(de,e),e.type){case"table":{for(const i of e.header)de.walkTokens(i.tokens,t);for(const i of e.rows)for(const s of i)de.walkTokens(s.tokens,t);break}case"list":{de.walkTokens(e.items,t);break}default:de.defaults.extensions&&de.defaults.extensions.childTokens&&de.defaults.extensions.childTokens[e.type]?de.defaults.extensions.childTokens[e.type].forEach(function(i){de.walkTokens(e[i],t)}):e.tokens&&de.walkTokens(e.tokens,t)}};de.parseInline=function(n,t){if(typeof n>"u"||n===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof n!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected");t=gi({},de.defaults,t||{}),nR(t);try{const e=ns.lexInline(n,t);return t.walkTokens&&de.walkTokens(e,t.walkTokens),is.parseInline(e,t)}catch(e){if(e.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+At(e.message+"",!0)+"</pre>";throw e}};de.Parser=is;de.parser=is.parse;de.Renderer=ow;de.TextRenderer=iR;de.Lexer=ns;de.lexer=ns.lex;de.Tokenizer=sw;de.Slugger=sR;de.parse=de;de.options;de.setOptions;de.use;de.walkTokens;de.parseInline;is.parse;ns.lex;function lie(n){for(var t=1;t<arguments.length;t++){var e=arguments[t];for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i])}return n}function dg(n,t){return Array(t+1).join(n)}function cie(n){return n.replace(/^\n*/,"")}function uie(n){for(var t=n.length;t>0&&n[t-1]===`
`;)t--;return n.substring(0,t)}var die=["ADDRESS","ARTICLE","ASIDE","AUDIO","BLOCKQUOTE","BODY","CANVAS","CENTER","DD","DIR","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","FRAMESET","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","HTML","ISINDEX","LI","MAIN","MENU","NAV","NOFRAMES","NOSCRIPT","OL","OUTPUT","P","PRE","SECTION","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","UL"];function rw(n){return aw(n,die)}var oR=["AREA","BASE","BR","COL","COMMAND","EMBED","HR","IMG","INPUT","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR"];function rR(n){return aw(n,oR)}function hie(n){return lR(n,oR)}var aR=["A","TABLE","THEAD","TBODY","TFOOT","TH","TD","IFRAME","SCRIPT","AUDIO","VIDEO"];function fie(n){return aw(n,aR)}function mie(n){return lR(n,aR)}function aw(n,t){return t.indexOf(n.nodeName)>=0}function lR(n,t){return n.getElementsByTagName&&t.some(function(e){return n.getElementsByTagName(e).length})}var Kt={};Kt.paragraph={filter:"p",replacement:function(n){return`

`+n+`

`}};Kt.lineBreak={filter:"br",replacement:function(n,t,e){return e.br+`
`}};Kt.heading={filter:["h1","h2","h3","h4","h5","h6"],replacement:function(n,t,e){var i=Number(t.nodeName.charAt(1));if(e.headingStyle==="setext"&&i<3){var s=dg(i===1?"=":"-",n.length);return`

`+n+`
`+s+`

`}else return`

`+dg("#",i)+" "+n+`

`}};Kt.blockquote={filter:"blockquote",replacement:function(n){return n=n.replace(/^\n+|\n+$/g,""),n=n.replace(/^/gm,"> "),`

`+n+`

`}};Kt.list={filter:["ul","ol"],replacement:function(n,t){var e=t.parentNode;return e.nodeName==="LI"&&e.lastElementChild===t?`
`+n:`

`+n+`

`}};Kt.listItem={filter:"li",replacement:function(n,t,e){n=n.replace(/^\n+/,"").replace(/\n+$/,`
`).replace(/\n/gm,`
    `);var i=e.bulletListMarker+"   ",s=t.parentNode;if(s.nodeName==="OL"){var o=s.getAttribute("start"),r=Array.prototype.indexOf.call(s.children,t);i=(o?Number(o)+r:r+1)+".  "}return i+n+(t.nextSibling&&!/\n$/.test(n)?`
`:"")}};Kt.indentedCodeBlock={filter:function(n,t){return t.codeBlockStyle==="indented"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,t,e){return`

    `+t.firstChild.textContent.replace(/\n/g,`
    `)+`

`}};Kt.fencedCodeBlock={filter:function(n,t){return t.codeBlockStyle==="fenced"&&n.nodeName==="PRE"&&n.firstChild&&n.firstChild.nodeName==="CODE"},replacement:function(n,t,e){for(var i=t.firstChild.getAttribute("class")||"",s=(i.match(/language-(\S+)/)||[null,""])[1],o=t.firstChild.textContent,r=e.fence.charAt(0),a=3,l=new RegExp("^"+r+"{3,}","gm"),c;c=l.exec(o);)c[0].length>=a&&(a=c[0].length+1);var u=dg(r,a);return`

`+u+s+`
`+o.replace(/\n$/,"")+`
`+u+`

`}};Kt.horizontalRule={filter:"hr",replacement:function(n,t,e){return`

`+e.hr+`

`}};Kt.inlineLink={filter:function(n,t){return t.linkStyle==="inlined"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,t){var e=t.getAttribute("href");e&&(e=e.replace(/([()])/g,"\\$1"));var i=wd(t.getAttribute("title"));return i&&(i=' "'+i.replace(/"/g,'\\"')+'"'),"["+n+"]("+e+i+")"}};Kt.referenceLink={filter:function(n,t){return t.linkStyle==="referenced"&&n.nodeName==="A"&&n.getAttribute("href")},replacement:function(n,t,e){var i=t.getAttribute("href"),s=wd(t.getAttribute("title"));s&&(s=' "'+s+'"');var o,r;switch(e.linkReferenceStyle){case"collapsed":o="["+n+"][]",r="["+n+"]: "+i+s;break;case"shortcut":o="["+n+"]",r="["+n+"]: "+i+s;break;default:var a=this.references.length+1;o="["+n+"]["+a+"]",r="["+a+"]: "+i+s}return this.references.push(r),o},references:[],append:function(n){var t="";return this.references.length&&(t=`

`+this.references.join(`
`)+`

`,this.references=[]),t}};Kt.emphasis={filter:["em","i"],replacement:function(n,t,e){return n.trim()?e.emDelimiter+n+e.emDelimiter:""}};Kt.strong={filter:["strong","b"],replacement:function(n,t,e){return n.trim()?e.strongDelimiter+n+e.strongDelimiter:""}};Kt.code={filter:function(n){var t=n.previousSibling||n.nextSibling,e=n.parentNode.nodeName==="PRE"&&!t;return n.nodeName==="CODE"&&!e},replacement:function(n){if(!n)return"";n=n.replace(/\r?\n|\r/g," ");for(var t=/^`|^ .*?[^ ].* $|`$/.test(n)?" ":"",e="`",i=n.match(/`+/gm)||[];i.indexOf(e)!==-1;)e=e+"`";return e+t+n+t+e}};Kt.image={filter:"img",replacement:function(n,t){var e=wd(t.getAttribute("alt")),i=t.getAttribute("src")||"",s=wd(t.getAttribute("title")),o=s?' "'+s+'"':"";return i?"!["+e+"]("+i+o+")":""}};function wd(n){return n?n.replace(/(\n+\s*)+/g,`
`):""}function cR(n){this.options=n,this._keep=[],this._remove=[],this.blankRule={replacement:n.blankReplacement},this.keepReplacement=n.keepReplacement,this.defaultRule={replacement:n.defaultReplacement},this.array=[];for(var t in n.rules)this.array.push(n.rules[t])}cR.prototype={add:function(n,t){this.array.unshift(t)},keep:function(n){this._keep.unshift({filter:n,replacement:this.keepReplacement})},remove:function(n){this._remove.unshift({filter:n,replacement:function(){return""}})},forNode:function(n){if(n.isBlank)return this.blankRule;var t;return(t=Uf(this.array,n,this.options))||(t=Uf(this._keep,n,this.options))||(t=Uf(this._remove,n,this.options))?t:this.defaultRule},forEach:function(n){for(var t=0;t<this.array.length;t++)n(this.array[t],t)}};function Uf(n,t,e){for(var i=0;i<n.length;i++){var s=n[i];if(gie(s,t,e))return s}}function gie(n,t,e){var i=n.filter;if(typeof i=="string"){if(i===t.nodeName.toLowerCase())return!0}else if(Array.isArray(i)){if(i.indexOf(t.nodeName.toLowerCase())>-1)return!0}else if(typeof i=="function"){if(i.call(n,t,e))return!0}else throw new TypeError("`filter` needs to be a string, array, or function")}function pie(n){var t=n.element,e=n.isBlock,i=n.isVoid,s=n.isPre||function(d){return d.nodeName==="PRE"};if(!(!t.firstChild||s(t))){for(var o=null,r=!1,a=null,l=ly(a,t,s);l!==t;){if(l.nodeType===3||l.nodeType===4){var c=l.data.replace(/[ \r\n\t]+/g," ");if((!o||/ $/.test(o.data))&&!r&&c[0]===" "&&(c=c.substr(1)),!c){l=Wf(l);continue}l.data=c,o=l}else if(l.nodeType===1)e(l)||l.nodeName==="BR"?(o&&(o.data=o.data.replace(/ $/,"")),o=null,r=!1):i(l)||s(l)?(o=null,r=!0):o&&(r=!1);else{l=Wf(l);continue}var u=ly(a,l,s);a=l,l=u}o&&(o.data=o.data.replace(/ $/,""),o.data||Wf(o))}}function Wf(n){var t=n.nextSibling||n.parentNode;return n.parentNode.removeChild(n),t}function ly(n,t,e){return n&&n.parentNode===t||e(t)?t.nextSibling||t.parentNode:t.firstChild||t.nextSibling||t.parentNode}var lw=typeof window<"u"?window:{};function bie(){var n=lw.DOMParser,t=!1;try{new n().parseFromString("","text/html")&&(t=!0)}catch{}return t}function wie(){var n=function(){};return _ie()?n.prototype.parseFromString=function(t){var e=new window.ActiveXObject("htmlfile");return e.designMode="on",e.open(),e.write(t),e.close(),e}:n.prototype.parseFromString=function(t){var e=document.implementation.createHTMLDocument("");return e.open(),e.write(t),e.close(),e},n}function _ie(){var n=!1;try{document.implementation.createHTMLDocument("").open()}catch{lw.ActiveXObject&&(n=!0)}return n}var vie=bie()?lw.DOMParser:wie();function yie(n,t){var e;if(typeof n=="string"){var i=Cie().parseFromString('<x-turndown id="turndown-root">'+n+"</x-turndown>","text/html");e=i.getElementById("turndown-root")}else e=n.cloneNode(!0);return pie({element:e,isBlock:rw,isVoid:rR,isPre:t.preformattedCode?kie:null}),e}var qf;function Cie(){return qf=qf||new vie,qf}function kie(n){return n.nodeName==="PRE"||n.nodeName==="CODE"}function Tie(n,t){return n.isBlock=rw(n),n.isCode=n.nodeName==="CODE"||n.parentNode.isCode,n.isBlank=Eie(n),n.flankingWhitespace=Aie(n,t),n}function Eie(n){return!rR(n)&&!fie(n)&&/^\s*$/i.test(n.textContent)&&!hie(n)&&!mie(n)}function Aie(n,t){if(n.isBlock||t.preformattedCode&&n.isCode)return{leading:"",trailing:""};var e=xie(n.textContent);return e.leadingAscii&&cy("left",n,t)&&(e.leading=e.leadingNonAscii),e.trailingAscii&&cy("right",n,t)&&(e.trailing=e.trailingNonAscii),{leading:e.leading,trailing:e.trailing}}function xie(n){var t=n.match(/^(([ \t\r\n]*)(\s*))(?:(?=\S)[\s\S]*\S)?((\s*?)([ \t\r\n]*))$/);return{leading:t[1],leadingAscii:t[2],leadingNonAscii:t[3],trailing:t[4],trailingNonAscii:t[5],trailingAscii:t[6]}}function cy(n,t,e){var i,s,o;return n==="left"?(i=t.previousSibling,s=/ $/):(i=t.nextSibling,s=/^ /),i&&(i.nodeType===3?o=s.test(i.nodeValue):e.preformattedCode&&i.nodeName==="CODE"?o=!1:i.nodeType===1&&!rw(i)&&(o=s.test(i.textContent))),o}var Sie=Array.prototype.reduce,Iie=[[/\\/g,"\\\\"],[/\*/g,"\\*"],[/^-/g,"\\-"],[/^\+ /g,"\\+ "],[/^(=+)/g,"\\$1"],[/^(#{1,6}) /g,"\\$1 "],[/`/g,"\\`"],[/^~~~/g,"\\~~~"],[/\[/g,"\\["],[/\]/g,"\\]"],[/^>/g,"\\>"],[/_/g,"\\_"],[/^(\d+)\. /g,"$1\\. "]];function _d(n){if(!(this instanceof _d))return new _d(n);var t={rules:Kt,headingStyle:"setext",hr:"* * *",bulletListMarker:"*",codeBlockStyle:"indented",fence:"```",emDelimiter:"_",strongDelimiter:"**",linkStyle:"inlined",linkReferenceStyle:"full",br:"  ",preformattedCode:!1,blankReplacement:function(e,i){return i.isBlock?`

`:""},keepReplacement:function(e,i){return i.isBlock?`

`+i.outerHTML+`

`:i.outerHTML},defaultReplacement:function(e,i){return i.isBlock?`

`+e+`

`:e}};this.options=lie({},t,n),this.rules=new cR(this.options)}_d.prototype={turndown:function(n){if(!Lie(n))throw new TypeError(n+" is not a string, or an element/document/fragment node.");if(n==="")return"";var t=uR.call(this,new yie(n,this.options));return Pie.call(this,t)},use:function(n){if(Array.isArray(n))for(var t=0;t<n.length;t++)this.use(n[t]);else if(typeof n=="function")n(this);else throw new TypeError("plugin must be a Function or an Array of Functions");return this},addRule:function(n,t){return this.rules.add(n,t),this},keep:function(n){return this.rules.keep(n),this},remove:function(n){return this.rules.remove(n),this},escape:function(n){return Iie.reduce(function(t,e){return t.replace(e[0],e[1])},n)}};function uR(n){var t=this;return Sie.call(n.childNodes,function(e,i){i=new Tie(i,t.options);var s="";return i.nodeType===3?s=i.isCode?i.nodeValue:t.escape(i.nodeValue):i.nodeType===1&&(s=Rie.call(t,i)),dR(e,s)},"")}function Pie(n){var t=this;return this.rules.forEach(function(e){typeof e.append=="function"&&(n=dR(n,e.append(t.options)))}),n.replace(/^[\t\r\n]+/,"").replace(/[\t\r\n\s]+$/,"")}function Rie(n){var t=this.rules.forNode(n),e=uR.call(this,n),i=n.flankingWhitespace;return(i.leading||i.trailing)&&(e=e.trim()),i.leading+t.replacement(e,n,this.options)+i.trailing}function dR(n,t){var e=uie(n),i=cie(t),s=Math.max(n.length-e.length,t.length-i.length),o=`

`.substring(0,s);return e+o+i}function Lie(n){return n!=null&&(typeof n=="string"||n.nodeType&&(n.nodeType===1||n.nodeType===9||n.nodeType===11))}var uy=/highlight-(?:text|source)-([a-z0-9]+)/;function Vie(n){n.addRule("highlightedCodeBlock",{filter:function(t){var e=t.firstChild;return t.nodeName==="DIV"&&uy.test(t.className)&&e&&e.nodeName==="PRE"},replacement:function(t,e,i){var s=e.className||"",o=(s.match(uy)||[null,""])[1];return`

`+i.fence+o+`
`+e.firstChild.textContent+`
`+i.fence+`

`}})}function Bie(n){n.addRule("strikethrough",{filter:["del","s","strike"],replacement:function(t){return"~"+t+"~"}})}var Mie=Array.prototype.indexOf,Oie=Array.prototype.every,Kr={};Kr.tableCell={filter:["th","td"],replacement:function(n,t){return hR(n,t)}};Kr.tableRow={filter:"tr",replacement:function(n,t){var e="",i={left:":--",right:"--:",center:":-:"};if(cw(t))for(var s=0;s<t.childNodes.length;s++){var o="---",r=(t.childNodes[s].getAttribute("align")||"").toLowerCase();r&&(o=i[r]||o),e+=hR(o,t.childNodes[s])}return`
`+n+(e?`
`+e:"")}};Kr.table={filter:function(n){return n.nodeName==="TABLE"&&cw(n.rows[0])},replacement:function(n){return n=n.replace(`

`,`
`),`

`+n+`

`}};Kr.tableSection={filter:["thead","tbody","tfoot"],replacement:function(n){return n}};function cw(n){var t=n.parentNode;return t.nodeName==="THEAD"||t.firstChild===n&&(t.nodeName==="TABLE"||Nie(t))&&Oie.call(n.childNodes,function(e){return e.nodeName==="TH"})}function Nie(n){var t=n.previousSibling;return n.nodeName==="TBODY"&&(!t||t.nodeName==="THEAD"&&/^\s*$/i.test(t.textContent))}function hR(n,t){var e=Mie.call(t.parentNode.childNodes,t),i=" ";return e===0&&(i="| "),i+n+" |"}function Fie(n){n.keep(function(e){return e.nodeName==="TABLE"&&!cw(e.rows[0])});for(var t in Kr)n.addRule(t,Kr[t])}function Die(n){n.addRule("taskListItems",{filter:function(t){return t.type==="checkbox"&&t.parentNode.nodeName==="LI"},replacement:function(t,e){return(e.checked?"[x]":"[ ]")+" "}})}function $ie(n){n.use([Vie,Bie,Fie,Die])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Hie{constructor(){h(this,"_parser");h(this,"_options",{gfm:!0,breaks:!0,tables:!0,xhtml:!0,headerIds:!1});de.use({tokenizer:{autolink:()=>null,url:()=>null},renderer:{checkbox(...t){return Object.getPrototypeOf(this).checkbox.call(this,...t).trimRight()},code(...t){return Object.getPrototypeOf(this).code.call(this,...t).replace(`
</code>`,"</code>")}}}),this._parser=de}parse(t){return this._parser.parse(t,this._options)}}const zie=new RegExp(/\b(?:(?:https?|ftp):\/\/|www\.)/.source+/(?![-_])(?:[-_a-z0-9\u00a1-\uffff]{1,63}\.)+(?:[a-z\u00a1-\uffff]{2,63})/.source+/(?:[^\s<>]*)/.source,"gi");class Uie extends _d{escape(t){const e=super.escape;function i(r){return r=e(r),r=r.replace(/</g,"\\<"),r}let s="",o=0;for(const r of this._matchAutolink(t)){const a=r.index;a>o&&(s+=i(t.substring(o,a)));const l=r[0];s+=l,o=a+l.length}return o<t.length&&(s+=i(t.substring(o,t.length))),s}*_matchAutolink(t){for(const e of t.matchAll(zie)){const i=e[0],s=this._autolinkFindEnd(i);yield Object.assign([i.substring(0,s)],{index:e.index})}}_autolinkFindEnd(t){let e=t.length;for(;e>0;){const i=t[e-1];if(`?!.,:*_~'"`.includes(i))e--;else if(i==")"){let s=0;for(let o=0;o<e;o++)t[o]=="("?s++:t[o]==")"&&s--;if(s<0)e--;else break}else break}return e}}class Wie{constructor(){h(this,"_parser");this._parser=this._createParser()}parse(t){return this._parser.turndown(t)}keep(t){this._parser.keep(t)}_createParser(){const t=new Uie({codeBlockStyle:"fenced",hr:"---",headingStyle:"atx"});return t.use([$ie,this._todoList]),t}_todoList(t){t.addRule("taskListItems",{filter(e){return e.type==="checkbox"&&(e.parentNode.nodeName==="LI"||e.parentNode.parentNode.nodeName==="LI")},replacement(e,i){return(i.checked?"[x]":"[ ]")+" "}})}}class fR{constructor(t){h(this,"_htmlDP");h(this,"_markdown2html");h(this,"_html2markdown");this._htmlDP=new Sb(t),this._markdown2html=new Hie,this._html2markdown=new Wie}keepHtml(t){this._html2markdown.keep([t])}toView(t){const e=this._markdown2html.parse(t);return this._htmlDP.toView(e)}toData(t){const e=this._htmlDP.toData(t);return this._html2markdown.parse(e)}registerRawContentMatcher(t){this._htmlDP.registerRawContentMatcher(t)}useFillerType(){}}class qie extends A{constructor(t){super(t),t.data.processor=new fR(t.data.viewDocument)}static get pluginName(){return"Markdown"}}const jie=["SPAN","BR","PRE","CODE"];class Gie extends A{constructor(e){super(e);h(this,"_gfmDataProcessor");this._gfmDataProcessor=new fR(e.data.viewDocument)}static get pluginName(){return"PasteFromMarkdownExperimental"}static get requires(){return[Hn]}init(){const e=this.editor,s=e.editing.view.document,o=e.plugins.get("ClipboardPipeline");let r=!1;this.listenTo(s,"keydown",(a,l)=>{r=l.shiftKey}),this.listenTo(o,"inputTransformation",(a,l)=>{if(r)return;const c=l.dataTransfer.getData("text/html");if(!c){const d=l.dataTransfer.getData("text/plain");l.content=this._gfmDataProcessor.toView(d);return}const u=this._parseMarkdownFromHtml(c);u&&(l.content=this._gfmDataProcessor.toView(u))})}_parseMarkdownFromHtml(e){const i=this._removeOsSpecificTags(e);if(!this._containsOnlyAllowedFirstLevelTags(i))return null;const s=this._removeFirstLevelWrapperTagsAndBrs(i);return this._containsAnyRemainingHtmlTags(s)?null:this._replaceHtmlReservedEntitiesWithCharacters(s)}_removeOsSpecificTags(e){return e.replace(/^<meta\b[^>]*>/,"").trim().replace(/^<html>/,"").replace(/<\/html>$/,"").trim().replace(/^<body>/,"").replace(/<\/body>$/,"").trim().replace(/^<!--StartFragment-->/,"").replace(/<!--EndFragment-->$/,"").trim()}_containsOnlyAllowedFirstLevelTags(e){const i=new DOMParser,{body:s}=i.parseFromString(e,"text/html");return Array.from(s.children).map(r=>r.tagName).every(r=>jie.includes(r))}_removeFirstLevelWrapperTagsAndBrs(e){const i=new DOMParser,{body:s}=i.parseFromString(e,"text/html"),o=s.querySelectorAll("br");for(const a of o)a.replaceWith(`
`);const r=s.querySelectorAll(":scope > *");for(const a of r){const l=a.cloneNode(!0);a.replaceWith(...l.childNodes)}return s.innerHTML}_containsAnyRemainingHtmlTags(e){return e.includes("<")}_replaceHtmlReservedEntitiesWithCharacters(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&nbsp;/g," ")}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function dy(n,t){const e=(i,s,o)=>{if(!o.consumable.consume(s.item,i.name))return;const r=s.attributeNewValue,a=o.writer,l=o.mapper.toViewElement(s.item),c=[...l.getChildren()].find(d=>d.getCustomProperty("media-content"));a.remove(c);const u=n.getMediaViewElement(a,r,t);a.insert(a.createPositionAt(l,0),u)};return i=>{i.on("attribute:url:media",e)}}function Kie(n,t,e){return t.setCustomProperty("media",!0,n),Xs(n,t,{label:e})}function hy(n,t,e,i){return n.createContainerElement("figure",{class:"media"},[t.getMediaViewElement(n,e,i),n.createSlot()])}function fy(n){const t=n.getSelectedElement();return t&&t.is("element","media")?t:null}function mR(n,t,e,i){n.change(s=>{const o=s.createElement("media",{url:t});n.insertObject(o,e,null,{setSelection:"on",findOptimalPosition:i?"auto":void 0})})}class Zie extends ne{refresh(){const t=this.editor.model,e=t.document.selection,i=fy(e);this.value=i?i.getAttribute("url"):void 0,this.isEnabled=Yie(e)||Jie(e,t)}execute(t){const e=this.editor.model,i=e.document.selection,s=fy(i);s?e.change(o=>{o.setAttribute("url",t,s)}):mR(e,t,i,!0)}}function Jie(n,t){let i=cc(n,t).start.parent;return i.isEmpty&&!t.schema.isLimit(i)&&(i=i.parent),t.schema.checkChild(i,"media")}function Yie(n){const t=n.getSelectedElement();return!!t&&t.name==="media"}var Xie='<svg viewBox="0 0 64 42" xmlns="http://www.w3.org/2000/svg"><path d="M47.426 17V3.713L63.102 0v19.389h-.001l.001.272c0 1.595-2.032 3.43-4.538 4.098-2.506.668-4.538-.083-4.538-1.678 0-1.594 2.032-3.43 4.538-4.098.914-.244 2.032-.565 2.888-.603V4.516L49.076 7.447v9.556A1.014 1.014 0 0 0 49 17h-1.574zM29.5 17h-8.343a7.073 7.073 0 1 0-4.657 4.06v3.781H3.3a2.803 2.803 0 0 1-2.8-2.804V8.63a2.803 2.803 0 0 1 2.8-2.805h4.082L8.58 2.768A1.994 1.994 0 0 1 10.435 1.5h8.985c.773 0 1.477.448 1.805 1.149l1.488 3.177H26.7c1.546 0 2.8 1.256 2.8 2.805V17zm-11.637 0H17.5a1 1 0 0 0-1 1v.05A4.244 4.244 0 1 1 17.863 17zm29.684 2c.97 0 .953-.048.953.889v20.743c0 .953.016.905-.953.905H19.453c-.97 0-.953.048-.953-.905V19.89c0-.937-.016-.889.97-.889h28.077zm-4.701 19.338V22.183H24.154v16.155h18.692zM20.6 21.375v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616v-1.616H20.6zm0 3.231v1.616h1.616V37.53H20.6zm24.233-16.155v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615v-1.616h-1.615zm0 3.231v1.616h1.615V37.53h-1.615zM29.485 25.283a.4.4 0 0 1 .593-.35l9.05 4.977a.4.4 0 0 1 0 .701l-9.05 4.978a.4.4 0 0 1-.593-.35v-9.956z"/></svg>';const Qie="0 0 64 42";class ese{constructor(t,e){h(this,"locale");h(this,"providerDefinitions");const i=e.providers,s=e.extraProviders||[],o=new Set(e.removeProviders),r=i.concat(s).filter(a=>{const l=a.name;return l?!o.has(l):(Te("media-embed-no-provider-name",{provider:a}),!1)});this.locale=t,this.providerDefinitions=r}hasMedia(t){return!!this._getMedia(t)}getMediaViewElement(t,e,i){return this._getMedia(e).getViewElement(t,i)}_getMedia(t){if(!t)return new my(this.locale);t=t.trim();for(const e of this.providerDefinitions){const i=e.html,s=Pe(e.url);for(const o of s){const r=this._getUrlMatches(t,o);if(r)return new my(this.locale,t,r,i)}}return null}_getUrlMatches(t,e){let i=t.match(e);if(i)return i;let s=t.replace(/^https?:\/\//,"");return i=s.match(e),i||(s=s.replace(/^www\./,""),i=s.match(e),i)?i:null}}class my{constructor(t,e,i,s){h(this,"url");h(this,"_locale");h(this,"_match");h(this,"_previewRenderer");this.url=this._getValidUrl(e),this._locale=t,this._match=i,this._previewRenderer=s}getViewElement(t,e){const i={};let s;if(e.renderForEditingView||e.renderMediaPreview&&this.url&&this._previewRenderer){this.url&&(i["data-oembed-url"]=this.url),e.renderForEditingView&&(i.class="ck-media__wrapper");const o=this._getPreviewHtml(e);s=t.createRawElement("div",i,(r,a)=>{a.setContentOf(r,o)})}else this.url&&(i.url=this.url),s=t.createEmptyElement(e.elementName,i);return t.setCustomProperty("media-content",!0,s),s}_getPreviewHtml(t){return this._previewRenderer?this._previewRenderer(this._match):this.url&&t.renderForEditingView?this._getPlaceholderHtml():""}_getPlaceholderHtml(){const t=new es,e=this._locale.t;return t.content=Xie,t.viewBox=Qie,new bn({tag:"div",attributes:{class:"ck ck-reset_all ck-media__placeholder"},children:[{tag:"div",attributes:{class:"ck-media__placeholder__icon"},children:[t]},{tag:"a",attributes:{class:"ck-media__placeholder__url",target:"_blank",rel:"noopener noreferrer",href:this.url,"data-cke-tooltip-text":e("Open media in new tab")},children:[{tag:"span",attributes:{class:"ck-media__placeholder__url__text"},children:[this.url]}]}]}).render().outerHTML}_getValidUrl(t){return t?t.match(/^https?/)?t:"https://"+t:null}}class vd extends A{constructor(e){super(e);h(this,"registry");e.config.define("mediaEmbed",{elementName:"oembed",providers:[{name:"dailymotion",url:[/^dailymotion\.com\/video\/(\w+)/,/^dai.ly\/(\w+)/],html:i=>`<div style="position: relative; padding-bottom: 100%; height: 0; "><iframe src="https://www.dailymotion.com/embed/video/${i[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" width="480" height="270" allowfullscreen allow="autoplay"></iframe></div>`},{name:"spotify",url:[/^open\.spotify\.com\/(artist\/\w+)/,/^open\.spotify\.com\/(album\/\w+)/,/^open\.spotify\.com\/(track\/\w+)/],html:i=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 126%;"><iframe src="https://open.spotify.com/embed/${i[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe></div>`},{name:"youtube",url:[/^(?:m\.)?youtube\.com\/watch\?v=([\w-]+)(?:&t=(\d+))?/,/^(?:m\.)?youtube\.com\/v\/([\w-]+)(?:\?t=(\d+))?/,/^youtube\.com\/embed\/([\w-]+)(?:\?start=(\d+))?/,/^youtu\.be\/([\w-]+)(?:\?t=(\d+))?/],html:i=>{const s=i[1],o=i[2];return`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://www.youtube.com/embed/${s}${o?`?start=${o}`:""}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe></div>`}},{name:"vimeo",url:[/^vimeo\.com\/(\d+)/,/^vimeo\.com\/[^/]+\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/album\/[^/]+\/video\/(\d+)/,/^vimeo\.com\/channels\/[^/]+\/(\d+)/,/^vimeo\.com\/groups\/[^/]+\/videos\/(\d+)/,/^vimeo\.com\/ondemand\/[^/]+\/(\d+)/,/^player\.vimeo\.com\/video\/(\d+)/],html:i=>`<div style="position: relative; padding-bottom: 100%; height: 0; padding-bottom: 56.2493%;"><iframe src="https://player.vimeo.com/video/${i[1]}" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0;" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>`},{name:"instagram",url:/^instagram\.com\/p\/(\w+)/},{name:"twitter",url:/^twitter\.com/},{name:"googleMaps",url:[/^google\.com\/maps/,/^goo\.gl\/maps/,/^maps\.google\.com/,/^maps\.app\.goo\.gl/]},{name:"flickr",url:/^flickr\.com/},{name:"facebook",url:/^facebook\.com/}]}),this.registry=new ese(e.locale,e.config.get("mediaEmbed"))}static get pluginName(){return"MediaEmbedEditing"}init(){const e=this.editor,i=e.model.schema,s=e.t,o=e.conversion,r=e.config.get("mediaEmbed.previewsInData"),a=e.config.get("mediaEmbed.elementName"),l=this.registry;e.commands.add("mediaEmbed",new Zie(e)),i.register("media",{inheritAllFrom:"$blockObject",allowAttributes:["url"]}),o.for("dataDowncast").elementToStructure({model:"media",view:(c,{writer:u})=>{const d=c.getAttribute("url");return hy(u,l,d,{elementName:a,renderMediaPreview:!!d&&r})}}),o.for("dataDowncast").add(dy(l,{elementName:a,renderMediaPreview:r})),o.for("editingDowncast").elementToStructure({model:"media",view:(c,{writer:u})=>{const d=c.getAttribute("url"),f=hy(u,l,d,{elementName:a,renderForEditingView:!0});return Kie(f,u,s("media widget"))}}),o.for("editingDowncast").add(dy(l,{elementName:a,renderForEditingView:!0})),o.for("upcast").elementToElement({view:c=>["oembed",a].includes(c.name)&&c.getAttribute("url")?{name:!0}:null,model:(c,{writer:u})=>{const d=c.getAttribute("url");return l.hasMedia(d)?u.createElement("media",{url:d}):null}}).elementToElement({view:{name:"div",attributes:{"data-oembed-url":!0}},model:(c,{writer:u})=>{const d=c.getAttribute("data-oembed-url");return l.hasMedia(d)?u.createElement("media",{url:d}):null}}).add(c=>{const u=(d,f,m)=>{if(!m.consumable.consume(f.viewItem,{name:!0,classes:"media"}))return;const{modelRange:g,modelCursor:p}=m.convertChildren(f.viewItem,f.modelCursor);f.modelRange=g,f.modelCursor=p,Ye(g.getItems())||m.consumable.revert(f.viewItem,{name:!0,classes:"media"})};c.on("element:figure",u)})}}const tse=/^(?:http(s)?:\/\/)?[\w-]+\.[\w-.~:/?#[\]@!$&'()*+,;=%]+$/;class nse extends A{constructor(e){super(e);h(this,"_timeoutId");h(this,"_positionToInsert");this._timeoutId=null,this._positionToInsert=null}static get requires(){return[Gb,Pi,Nh]}static get pluginName(){return"AutoMediaEmbed"}init(){const e=this.editor,i=e.model.document,s=e.plugins.get("ClipboardPipeline");this.listenTo(s,"inputTransformation",()=>{const r=i.selection.getFirstRange(),a=bt.fromPosition(r.start);a.stickiness="toPrevious";const l=bt.fromPosition(r.end);l.stickiness="toNext",i.once("change:data",()=>{this._embedMediaBetweenPositions(a,l),a.detach(),l.detach()},{priority:"high"})}),e.commands.get("undo").on("execute",()=>{this._timeoutId&&(j.window.clearTimeout(this._timeoutId),this._positionToInsert.detach(),this._timeoutId=null,this._positionToInsert=null)},{priority:"high"})}_embedMediaBetweenPositions(e,i){const s=this.editor,o=s.plugins.get(vd).registry,r=new hn(e,i),a=r.getWalker({ignoreElementEnd:!0});let l="";for(const u of a)u.item.is("$textProxy")&&(l+=u.item.data);if(l=l.trim(),!l.match(tse)){r.detach();return}if(!o.hasMedia(l)){r.detach();return}if(!s.commands.get("mediaEmbed").isEnabled){r.detach();return}this._positionToInsert=bt.fromPosition(e),this._timeoutId=j.window.setTimeout(()=>{s.model.change(u=>{this._timeoutId=null,u.remove(r),r.detach();let d=null;this._positionToInsert.root.rootName!=="$graveyard"&&(d=this._positionToInsert),mR(s.model,l,d,!1),this._positionToInsert.detach(),this._positionToInsert=null}),s.plugins.get(Pi).requestUndoOnBackspace()},100)}}class ise extends q{constructor(e,i){super(i);h(this,"focusTracker");h(this,"keystrokes");h(this,"urlInputView");h(this,"_validators");h(this,"_urlInputViewInfoDefault");h(this,"_urlInputViewInfoTip");this.focusTracker=new Ge,this.keystrokes=new tt,this.set("mediaURLInputValue",""),this.urlInputView=this._createUrlInput(),this._validators=e,this.setTemplate({tag:"form",attributes:{class:["ck","ck-media-form","ck-responsive-form"],tabindex:"-1"},children:[this.urlInputView]})}render(){super.render(),qo({view:this}),this.focusTracker.add(this.urlInputView.element),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.urlInputView.focus()}get url(){return this.urlInputView.fieldView.element.value.trim()}set url(e){this.urlInputView.fieldView.value=e.trim()}isValid(){this.resetFormStatus();for(const e of this._validators){const i=e(this);if(i)return this.urlInputView.errorText=i,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null,this.urlInputView.infoText=this._urlInputViewInfoDefault}_createUrlInput(){const e=this.locale.t,i=new wt(this.locale,jn),s=i.fieldView;return this._urlInputViewInfoDefault=e("Paste the media URL in the input."),this._urlInputViewInfoTip=e("Tip: Paste the URL into the content to embed faster."),i.label=e("Media URL"),i.infoText=this._urlInputViewInfoDefault,s.inputMode="url",s.on("input",()=>{i.infoText=s.element.value?this._urlInputViewInfoTip:this._urlInputViewInfoDefault,this.mediaURLInputValue=s.element.value.trim()}),i}}var sse='<svg viewBox="0 0 22 20" xmlns="http://www.w3.org/2000/svg"><path d="M1.587 1.5c-.612 0-.601-.029-.601.551v14.84c0 .59-.01.559.591.559h18.846c.602 0 .591.03.591-.56V2.052c0-.58.01-.55-.591-.55H1.587Zm.701.971h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-14.24 1h13.008v12H4.467l.029-12Zm-2.208 1h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h1.003v1H2.288v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h1.003l-.029 1h-.974v-1Zm16.448 0h1.003v1h-1.003v-1Zm-16.448 2h.974v1h-.974v-1Zm16.448 0h1.003v1h-1.003v-1Z"/><path d="M8.374 6.648a.399.399 0 0 1 .395-.4.402.402 0 0 1 .2.049l5.148 2.824a.4.4 0 0 1 0 .7l-5.148 2.824a.403.403 0 0 1-.595-.35V6.648Z"/></svg>';class ose extends A{constructor(){super(...arguments);h(this,"_formView")}static get requires(){return[vd,Il]}static get pluginName(){return"MediaEmbedUI"}init(){const e=this.editor;e.ui.componentFactory.add("mediaEmbed",()=>{const i=this.editor.locale.t,s=this._createDialogButton(te);return s.tooltip=!0,s.label=i("Insert media"),s}),e.ui.componentFactory.add("menuBar:mediaEmbed",()=>{const i=this.editor.locale.t,s=this._createDialogButton(pt);return s.label=i("Media"),s})}_createDialogButton(e){const i=this.editor,s=new e(i.locale),o=i.commands.get("mediaEmbed"),r=this.editor.plugins.get("Dialog");return s.icon=sse,s.bind("isEnabled").to(o,"isEnabled"),s.on("execute",()=>{r.id==="mediaEmbed"?r.hide():this._showDialog()}),s}_showDialog(){const e=this.editor,i=e.plugins.get("Dialog"),s=e.commands.get("mediaEmbed"),o=e.locale.t;if(!this._formView){const r=e.plugins.get(vd).registry;this._formView=new(Vh(ise))(rse(e.t,r),e.locale),this._formView.on("submit",()=>this._handleSubmitForm())}i.show({id:"mediaEmbed",title:o("Insert media"),content:this._formView,isModal:!0,onShow:()=>{this._formView.url=s.value||"",this._formView.resetFormStatus(),this._formView.urlInputView.fieldView.select()},actionButtons:[{label:o("Cancel"),withText:!0,onExecute:()=>i.hide()},{label:o("Accept"),class:"ck-button-action",withText:!0,onExecute:()=>this._handleSubmitForm()}]})}_handleSubmitForm(){const e=this.editor,i=e.plugins.get("Dialog");this._formView.isValid()&&(e.execute("mediaEmbed",this._formView.url),i.hide(),e.editing.view.focus())}}function rse(n,t){return[e=>{if(!e.url.length)return n("The URL must not be empty.")},e=>{if(!t.hasMedia(e.url))return n("This media URL is not supported.")}]}class ase extends A{static get requires(){return[vd,ose,nse,ms]}static get pluginName(){return"MediaEmbed"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */_e.arrowup,_e.arrowdown,_e.esc;_e.enter,_e.tab;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lse extends ne{refresh(){const t=this.editor.model,e=t.schema,i=t.document.selection;this.isEnabled=cse(i,e,t)}execute(){const t=this.editor.model;t.change(e=>{const i=e.createElement("pageBreak");t.insertObject(i,null,null,{setSelection:"after"})})}}function cse(n,t,e){const i=use(n,e);return t.checkChild(i,"pageBreak")}function use(n,t){const i=cc(n,t).start.parent;return i.isEmpty&&!i.is("element","$root")?i.parent:i}class dse extends A{static get pluginName(){return"PageBreakEditing"}init(){const t=this.editor,e=t.model.schema,i=t.t,s=t.conversion;e.register("pageBreak",{inheritAllFrom:"$blockObject"}),s.for("dataDowncast").elementToStructure({model:"pageBreak",view:(o,{writer:r})=>r.createContainerElement("div",{class:"page-break",style:"page-break-after: always"},r.createContainerElement("span",{style:"display: none"}))}),s.for("editingDowncast").elementToStructure({model:"pageBreak",view:(o,{writer:r})=>{const a=i("Page break"),l=r.createContainerElement("div"),c=r.createRawElement("span",{class:"page-break__label"},function(u){u.innerText=i("Page break")});return r.addClass("page-break",l),r.insert(r.createPositionAt(l,0),c),hse(l,r,a)}}),s.for("upcast").elementToElement({view:o=>{const r=o.getStyle("page-break-before")=="always",a=o.getStyle("page-break-after")=="always";if(!r&&!a)return null;if(o.childCount==1){const l=o.getChild(0);if(!l.is("element","span")||l.getStyle("display")!="none")return null}else if(o.childCount>1)return null;return{name:!0}},model:"pageBreak",converterPriority:"high"}),t.commands.add("pageBreak",new lse(t))}}function hse(n,t,e){return t.setCustomProperty("pageBreak",!0,n),Xs(n,t,{label:e})}var fse='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3.598.687h1.5v5h-1.5zm14.5 0h1.5v5h-1.5z"/><path d="M19.598 4.187v1.5h-16v-1.5zm-16 14.569h1.5v-5h-1.5zm14.5 0h1.5v-5h-1.5z"/><path d="M19.598 15.256v-1.5h-16v1.5zM5.081 9h6v2h-6zm8 0h6v2h-6zm-9.483 1L0 12.5v-5z"/></svg>';class mse extends A{static get pluginName(){return"PageBreakUI"}init(){const t=this.editor;t.ui.componentFactory.add("pageBreak",()=>{const e=this._createButton(te);return e.set({tooltip:!0}),e}),t.ui.componentFactory.add("menuBar:pageBreak",()=>this._createButton(pt))}_createButton(t){const e=this.editor,i=e.locale,s=e.commands.get("pageBreak"),o=new t(e.locale),r=i.t;return o.set({label:r("Page break"),icon:fse}),o.bind("isEnabled").to(s,"isEnabled"),this.listenTo(o,"execute",()=>{e.execute("pageBreak"),e.editing.view.focus()}),o}}class gse extends A{static get requires(){return[dse,mse,ms]}static get pluginName(){return"PageBreak"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function pse(n){const t=parseFloat(n);return n.endsWith("pt")?br(t*96/72):n.endsWith("pc")?br(t*12*96/72):n.endsWith("in")?br(t*96):n.endsWith("cm")?br(t*96/2.54):n.endsWith("mm")?br(t/10*96/2.54):n}function gy(n){return n!==void 0&&n.endsWith("px")}function br(n){return n.toFixed(2).replace(/\.?0+$/,"")+"px"}function bse(n,t,e){if(!n.childCount)return;const i=new zn(n.document),s=_se(n,i);if(!s.length)return;const o={},r=[];for(const a of s)if(a.indent!==void 0){vse(a)||(r.length=0);const l=`${a.id}:${a.indent}`,c=Math.min(a.indent-1,r.length);if(c<r.length&&r[c].id!==a.id&&(r.length=c),c<r.length-1)r.length=c+1;else{const d=yse(a,t);if(c>r.length-1||r[c].listElement.name!=d.type){c==0&&d.type=="ol"&&a.id!==void 0&&o[l]&&(d.startIndex=o[l]);const f=Ese(d,i,e);if(gy(a.marginLeft)&&(c==0||gy(r[c-1].marginLeft))){let m=a.marginLeft;c>0&&(m=br(parseFloat(m)-parseFloat(r[c-1].marginLeft))),i.setStyle("padding-left",m,f)}if(r.length==0){const m=a.element.parent,g=m.getChildIndex(a.element)+1;i.insertChild(g,f,m)}else{const m=r[c-1].listItemElements;i.appendChild(f,m[m.length-1])}r[c]={...a,listElement:f,listItemElements:[]},c==0&&a.id!==void 0&&(o[l]=d.startIndex||1)}}const u=a.element.name=="li"?a.element:i.createElement("li");i.appendChild(u,r[c].listElement),r[c].listItemElements.push(u),c==0&&a.id!==void 0&&o[l]++,a.element!=u&&i.appendChild(a.element,u),xse(a.element,i),i.removeStyle("text-indent",a.element),i.removeStyle("margin-left",a.element)}else{const l=r.find(c=>c.marginLeft==a.marginLeft);if(l){const c=l.listItemElements;i.appendChild(a.element,c[c.length-1]),i.removeStyle("margin-left",a.element)}else r.length=0}}function wse(n,t){for(const e of t.createRangeIn(n)){const i=e.item;if(i.is("element","li")){const s=i.getChild(0);s&&s.is("element","p")&&t.unwrapElement(s)}}}function _se(n,t){const e=t.createRangeIn(n),i=[],s=new Set;for(const o of e.getItems()){if(!o.is("element")||!o.name.match(/^(p|h\d+|li|div)$/))continue;let r=Sse(o);if(r!==void 0&&parseFloat(r)==0&&!Array.from(o.getClassNames()).find(a=>a.startsWith("MsoList"))&&(r=void 0),o.hasStyle("mso-list")||r!==void 0&&s.has(r)){const a=Ase(o);i.push({element:o,id:a.id,order:a.order,indent:a.indent,marginLeft:r}),r!==void 0&&s.add(r)}else s.clear()}return i}function vse(n){const t=n.element.previousSibling;return py(t||n.element.parent)}function py(n){return n.is("element","ol")||n.is("element","ul")}function yse(n,t){const e=new RegExp(`@list l${n.id}:level${n.indent}\\s*({[^}]*)`,"gi"),i=/mso-level-number-format:([^;]{0,100});/gi,s=/mso-level-start-at:\s{0,100}([0-9]{0,10})\s{0,100};/gi,o=new RegExp(`@list\\s+l${n.id}:level\\d\\s*{[^{]*mso-level-text:"%\\d\\\\.`,"gi"),r=new RegExp(`@list l${n.id}:level\\d\\s*{[^{]*mso-level-number-format:`,"gi"),a=o.exec(t),l=r.exec(t),c=a&&!l,u=e.exec(t);let d="decimal",f="ol",m=null;if(u&&u[1]){const g=i.exec(u[1]);if(g&&g[1]&&(d=g[1].trim(),f=d!=="bullet"&&d!=="image"?"ol":"ul"),d==="bullet"){const p=Cse(n.element);p&&(d=p)}else{const p=s.exec(u[1]);p&&p[1]&&(m=parseInt(p[1]))}c&&(f="ol")}return{type:f,startIndex:m,style:Tse(d),isLegalStyleList:c}}function Cse(n){if(n.name=="li"&&n.parent.name=="ul"&&n.parent.hasAttribute("type"))return n.parent.getAttribute("type");const t=kse(n);if(!t)return null;const e=t._data;return e==="o"?"circle":e==="·"?"disc":e==="§"?"square":null}function kse(n){if(n.getChild(0).is("$text"))return null;for(const t of n.getChildren()){if(!t.is("element","span"))continue;const e=t.getChild(0);if(e)return e.is("$text")?e:e.getChild(0)}/* istanbul ignore next -- @preserve */return null}function Tse(n){if(n.startsWith("arabic-leading-zero"))return"decimal-leading-zero";switch(n){case"alpha-upper":return"upper-alpha";case"alpha-lower":return"lower-alpha";case"roman-upper":return"upper-roman";case"roman-lower":return"lower-roman";case"circle":case"disc":case"square":return n;default:return null}}function Ese(n,t,e){const i=t.createElement(n.type);return n.style&&t.setStyle("list-style-type",n.style,i),n.startIndex&&n.startIndex>1&&t.setAttribute("start",n.startIndex,i),n.isLegalStyleList&&e&&t.addClass("legal-list",i),i}function Ase(n){const t=n.getStyle("mso-list");if(t===void 0)return{};const e=t.match(/(^|\s{1,100})l(\d+)/i),i=t.match(/\s{0,100}lfo(\d+)/i),s=t.match(/\s{0,100}level(\d+)/i);return e&&i&&s?{id:e[2],order:i[1],indent:parseInt(s[1])}:{indent:1}}function xse(n,t){const e=new Qt({name:"span",styles:{"mso-list":"Ignore"}}),i=t.createRangeIn(n);for(const s of i)s.type==="elementStart"&&e.match(s.item)&&t.remove(s.item)}function Sse(n){const t=n.getStyle("margin-left");return t===void 0||t.endsWith("px")?t:pse(t)}function Ise(n,t){if(!n.childCount)return;const e=new zn(n.document),i=Rse(n,e);Lse(i,n,e),Bse(i,n,e),Vse(n,e);const s=Mse(n,e);s.length&&Nse(s,Ose(t),e)}function Pse(n){return btoa(n.match(/\w{2}/g).map(t=>String.fromCharCode(parseInt(t,16))).join(""))}function Rse(n,t){const e=t.createRangeIn(n),i=new Qt({name:/v:(.+)/}),s=[];for(const o of e){if(o.type!="elementStart")continue;const r=o.item,a=r.previousSibling,l=a&&a.is("element")?a.name:null,c=["Chart"],u=i.match(r),d=r.getAttribute("o:gfxdata"),f=l==="v:shapetype",m=d&&c.some(g=>r.getAttribute("id").includes(g));u&&d&&!f&&!m&&s.push(o.item.getAttribute("id"))}return s}function Lse(n,t,e){const i=e.createRangeIn(t),s=new Qt({name:"img"}),o=[];for(const r of i)if(r.item.is("element")&&s.match(r.item)){const a=r.item,l=a.getAttribute("v:shapes")?a.getAttribute("v:shapes").split(" "):[];l.length&&l.every(c=>n.indexOf(c)>-1)?o.push(a):a.getAttribute("src")||o.push(a)}for(const r of o)e.remove(r)}function Vse(n,t){const e=t.createRangeIn(n),i=new Qt({name:/v:(.+)/}),s=[];for(const o of e)o.type=="elementStart"&&i.match(o.item)&&s.push(o.item);for(const o of s)t.remove(o)}function Bse(n,t,e){const i=e.createRangeIn(t),s=[];for(const a of i)if(a.type=="elementStart"&&a.item.is("element","v:shape")){const l=a.item.getAttribute("id");if(n.includes(l))continue;o(a.item.parent.getChildren(),l)||s.push(a.item)}for(const a of s){const l={src:r(a)};a.hasAttribute("alt")&&(l.alt=a.getAttribute("alt"));const c=e.createElement("img",l);e.insertChild(a.index+1,c,a.parent)}function o(a,l){for(const c of a){/* istanbul ignore else -- @preserve */if(c.is("element")&&(c.name=="img"&&c.getAttribute("v:shapes")==l||o(c.getChildren(),l)))return!0}return!1}function r(a){for(const l of a.getChildren()){/* istanbul ignore else -- @preserve */if(l.is("element")&&l.getAttribute("src"))return l.getAttribute("src")}}}function Mse(n,t){const e=t.createRangeIn(n),i=new Qt({name:"img"}),s=[];for(const o of e)o.item.is("element")&&i.match(o.item)&&o.item.getAttribute("src").startsWith("file://")&&s.push(o.item);return s}function Ose(n){if(!n)return[];const t=/{\\pict[\s\S]+?\\bliptag-?\d+(\\blipupi-?\d+)?({\\\*\\blipuid\s?[\da-fA-F]+)?[\s}]*?/,e=new RegExp("(?:("+t.source+"))([\\da-fA-F\\s]+)\\}","g"),i=n.match(e),s=[];if(i)for(const o of i){let r=!1;o.includes("\\pngblip")?r="image/png":o.includes("\\jpegblip")&&(r="image/jpeg"),r&&s.push({hex:o.replace(t,"").replace(/[^\da-fA-F]/g,""),type:r})}return s}function Nse(n,t,e){if(n.length===t.length)for(let i=0;i<n.length;i++){const s=`data:${t[i].type};base64,${Pse(t[i].hex)}`;e.setAttribute("src",s,n[i])}}function Fse(n){const t=[],e=new zn(n.document);for(const{item:i}of e.createRangeIn(n))if(i.is("element")){for(const s of i.getClassNames())/\bmso/gi.exec(s)&&e.removeClass(s,i);for(const s of i.getStyleNames())/\bmso/gi.exec(s)&&e.removeStyle(s,i);(i.is("element","w:sdt")||i.is("element","w:sdtpr")&&i.isEmpty||i.is("element","o:p")&&i.isEmpty)&&t.push(i)}for(const i of t){const s=i.parent,o=s.getChildIndex(i);e.insertChild(o,i.getChildren(),s),e.remove(i)}}const Dse=/<meta\s*name="?generator"?\s*content="?microsoft\s*word\s*\d+"?\/?>/i,$se=/xmlns:o="urn:schemas-microsoft-com/i;class Hse{constructor(t,e=!1){h(this,"document");h(this,"hasMultiLevelListPlugin");this.document=t,this.hasMultiLevelListPlugin=e}isActive(t){return Dse.test(t)||$se.test(t)}execute(t){const{body:e,stylesString:i}=t._parsedData;bse(e,i,this.hasMultiLevelListPlugin),Ise(e,t.dataTransfer.getData("text/rtf")),Fse(e),t.content=e}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function zse(n,t){for(const e of n.getChildren())if(e.is("element","b")&&e.getStyle("font-weight")==="normal"){const i=n.getChildIndex(e);t.remove(e),t.insertChild(i,e.getChildren(),n)}}function Use(n,t){const e=new xh(t.document.stylesProcessor),i=new Ih(e,{renderingMode:"data"}),s=i.blockElements,o=i.inlineObjectElements,r=[];for(const a of t.createRangeIn(n)){const l=a.item;if(l.is("element","br")){const c=by(l,"forward",t,{blockElements:s,inlineObjectElements:o}),u=by(l,"backward",t,{blockElements:s,inlineObjectElements:o}),d=wy(c,s);(wy(u,s)||d)&&r.push(l)}}for(const a of r)a.hasClass("Apple-interchange-newline")?t.remove(a):t.replace(a,t.createElement("p"))}function by(n,t,e,{blockElements:i,inlineObjectElements:s}){let o=e.createPositionAt(n,t=="forward"?"after":"before");return o=o.getLastMatchingPosition(({item:r})=>r.is("element")&&!i.includes(r.name)&&!s.includes(r.name),{direction:t}),t=="forward"?o.nodeAfter:o.nodeBefore}function wy(n,t){return!!n&&n.is("element")&&t.includes(n.name)}const Wse=/id=("|')docs-internal-guid-[-0-9a-f]+("|')/i;class qse{constructor(t){h(this,"document");this.document=t}isActive(t){return Wse.test(t)}execute(t){const e=new zn(this.document),{body:i}=t._parsedData;zse(i,e),wse(i,e),Use(i,e),t.content=i}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function jse(n,t){for(const e of n.getChildren())e.is("element","table")&&e.hasAttribute("xmlns")&&t.removeAttribute("xmlns",e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Gse(n,t){for(const e of n.getChildren())if(e.is("element","google-sheets-html-origin")){const i=n.getChildIndex(e);t.remove(e),t.insertChild(i,e.getChildren(),n)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Kse(n,t){for(const e of n.getChildren())e.is("element","table")&&e.getStyle("width")==="0px"&&t.removeStyle("width",e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Zse(n,t){for(const e of Array.from(n.getChildren()))e.is("element","style")&&t.remove(e)}const Jse=/<google-sheets-html-origin/i;class Yse{constructor(t){h(this,"document");this.document=t}isActive(t){return Jse.test(t)}execute(t){const e=new zn(this.document),{body:i}=t._parsedData;Gse(i,e),jse(i,e),Kse(i,e),Zse(i,e),t.content=i}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Xse(n){return _y(_y(n)).replace(/(<span\s+style=['"]mso-spacerun:yes['"]>[^\S\r\n]*?)[\r\n]+([^\S\r\n]*<\/span>)/g,"$1$2").replace(/<span\s+style=['"]mso-spacerun:yes['"]><\/span>/g,"").replace(/(<span\s+style=['"]letter-spacing:[^'"]+?['"]>)[\r\n]+(<\/span>)/g,"$1 $2").replace(/ <\//g," </").replace(/ <o:p><\/o:p>/g," <o:p></o:p>").replace(/<o:p>(&nbsp;|\u00A0)<\/o:p>/g,"").replace(/>([^\S\r\n]*[\r\n]\s*)</g,"><")}function Qse(n){n.querySelectorAll("span[style*=spacerun]").forEach(t=>{const e=t,i=e.innerText.length||0;e.innerText=Array(i+1).join("  ").substr(0,i)})}function _y(n){return n.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>e.length===1?" ":Array(e.length+1).join("  ").substr(0,e.length))}function eoe(n,t){const e=new DOMParser;n=n.replace(/<!--\[if gte vml 1]>/g,""),n=n.replace(/<o:SmartTagType(?:\s+[^\s>=]+(?:="[^"]*")?)*\s*\/?>/gi,"");const i=Xse(ioe(n)),s=e.parseFromString(i,"text/html");Qse(s);const o=s.body.innerHTML,r=toe(s,t),a=noe(s);return{body:r,bodyString:o,styles:a.styles,stylesString:a.stylesString}}function toe(n,t){const e=new xh(t),i=new Ih(e,{renderingMode:"data"}),s=n.createDocumentFragment(),o=n.body.childNodes;for(;o.length>0;)s.appendChild(o[0]);return i.domToView(s,{skipComments:!0})}function noe(n){const t=[],e=[],i=Array.from(n.getElementsByTagName("style"));for(const s of i)s.sheet&&s.sheet.cssRules&&s.sheet.cssRules.length&&(t.push(s.sheet),e.push(s.innerHTML));return{styles:t,stylesString:e.join(" ")}}function ioe(n){const t="</body>",e="</html>",i=n.indexOf(t);if(i<0)return n;const s=n.indexOf(e,i+t.length);return n.substring(0,i+t.length)+(s>=0?n.substring(s):"")}class soe extends A{static get pluginName(){return"PasteFromOffice"}static get requires(){return[Hn]}init(){const t=this.editor,e=t.plugins.get("ClipboardPipeline"),i=t.editing.view.document,s=[],o=this.editor.plugins.has("MultiLevelList");s.push(new Hse(i,o)),s.push(new qse(i)),s.push(new Yse(i)),e.on("inputTransformation",(r,a)=>{if(a._isTransformedWithPasteFromOffice||t.model.document.selection.getFirstPosition().parent.is("element","codeBlock"))return;const c=a.dataTransfer.getData("text/html"),u=s.find(d=>d.isActive(c));u&&(a._parsedData||(a._parsedData=eoe(c,i.stylesProcessor)),u.execute(a),a._isTransformedWithPasteFromOffice=!0)},{priority:"high"})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ooe extends ne{constructor(t){super(t),this.affectsData=!1,this.value=!1}execute(){const t="ck-show-blocks",e=this.editor.editing.view;e.change(i=>{for(const s of e.document.roots)s.hasClass(t)?(i.removeClass(t,s),this.value=!1):(i.addClass(t,s),this.value=!0)})}}class roe extends A{static get pluginName(){return"ShowBlocksEditing"}init(){const{editor:t}=this;t.commands.add("showBlocks",new ooe(t))}}var aoe='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m6.395 9.196 2.545-.007V6.498a.598.598 0 0 1 .598-.598h.299a.598.598 0 0 1 .598.598v6.877a.598.598 0 0 1-.598.598h-.299a.598.598 0 0 1-.598-.598v-2.691l-2.545.007v2.691a.598.598 0 0 1-.598.598h-.299a.598.598 0 0 1-.598-.598V6.505a.598.598 0 0 1 .598-.598h.299a.598.598 0 0 1 .598.598v2.691Z"/><path d="M15.094 13.417V6.462a.562.562 0 0 0-.562-.562h-.782a1 1 0 0 0-.39.08l-1.017.43a.562.562 0 0 0-.343.517v.197c0 .4.406.67.775.519l.819-.337v6.111c0 .31.251.562.561.562h.377c.31 0 .562-.251.562-.562Z"/><path d="M0 15.417v1.5h1.5v-1.5H0Z"/><path d="M18.5 15.417v1.5H20v-1.5h-1.5Z"/><path d="M18.5 12.333v1.5H20v-1.5h-1.5Z"/><path d="M18.5 9.25v1.5H20v-1.5h-1.5Z"/><path d="M18.5 6.167v1.5H20v-1.5h-1.5Z"/><path d="M0 18.5v.5a1 1 0 0 0 1 1h.5v-1.5H0Z"/><path d="M3.083 18.5V20h1.5v-1.5h-1.5Z"/><path d="M6.167 18.5V20h1.5v-1.5h-1.5Z"/><path d="M9.25 18.5V20h1.5v-1.5h-1.5Z"/><path d="M12.333 18.5V20h1.5v-1.5h-1.5Z"/><path d="M15.417 18.5V20h1.5v-1.5h-1.5Z"/><path d="M18.5 18.5V20h.5a1 1 0 0 0 1-1v-.5h-1.5Z"/><path clip-rule="evenodd" d="M0 1a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v3.583h-1.5V1.5h-17v12.333H0V1Z"/></svg>';class loe extends A{static get pluginName(){return"ShowBlocksUI"}init(){const t=this.editor;t.ui.componentFactory.add("showBlocks",()=>{const e=this._createButton(te);return e.set({tooltip:!0,icon:aoe}),e}),t.ui.componentFactory.add("menuBar:showBlocks",()=>this._createButton(pt))}_createButton(t){const e=this.editor,i=e.locale,s=e.commands.get("showBlocks"),o=new t(i),r=i.t;return o.set({label:r("Show blocks")}),o.bind("isEnabled").to(s),o.bind("isOn").to(s,"value",s,"isEnabled",(a,l)=>a&&l),this.listenTo(o,"execute",()=>{e.execute("showBlocks"),e.editing.view.focus()}),o}}class coe extends A{static get pluginName(){return"ShowBlocks"}static get requires(){return[roe,loe]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function uoe(n){const t=[{name:"address",isVoid:!1},{name:"article",isVoid:!1},{name:"aside",isVoid:!1},{name:"blockquote",isVoid:!1},{name:"details",isVoid:!1},{name:"dialog",isVoid:!1},{name:"dd",isVoid:!1},{name:"div",isVoid:!1},{name:"dl",isVoid:!1},{name:"dt",isVoid:!1},{name:"fieldset",isVoid:!1},{name:"figcaption",isVoid:!1},{name:"figure",isVoid:!1},{name:"footer",isVoid:!1},{name:"form",isVoid:!1},{name:"h1",isVoid:!1},{name:"h2",isVoid:!1},{name:"h3",isVoid:!1},{name:"h4",isVoid:!1},{name:"h5",isVoid:!1},{name:"h6",isVoid:!1},{name:"header",isVoid:!1},{name:"hgroup",isVoid:!1},{name:"hr",isVoid:!0},{name:"li",isVoid:!1},{name:"main",isVoid:!1},{name:"nav",isVoid:!1},{name:"ol",isVoid:!1},{name:"p",isVoid:!1},{name:"section",isVoid:!1},{name:"table",isVoid:!1},{name:"tbody",isVoid:!1},{name:"td",isVoid:!1},{name:"th",isVoid:!1},{name:"thead",isVoid:!1},{name:"tr",isVoid:!1},{name:"ul",isVoid:!1}],e=t.map(r=>r.name).join("|"),i=n.replace(new RegExp(`</?(${e})( .*?)?>`,"g"),`
$&
`).replace(/<br[^>]*>/g,`$&
`).split(`
`);let s=0,o=!1;return i.filter(r=>r.length).map(r=>(o=foe(r,o),doe(r,t)?jf(r,s++):hoe(r,t)?jf(r,--s):o==="middle"||o==="last"?r:jf(r,s))).join(`
`)}function doe(n,t){return t.some(e=>!(e.isVoid||!new RegExp(`<${e.name}( .*?)?>`).test(n)))}function hoe(n,t){return t.some(e=>new RegExp(`</${e.name}>`).test(n))}function jf(n,t,e="    "){return`${e.repeat(Math.max(0,t))}${n}`}function foe(n,t){return new RegExp("<pre( .*?)?>").test(n)?"first":new RegExp("</pre>").test(n)?"last":t==="first"||t==="middle"?"middle":!1}var moe='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 0 5 4.5v15.003h-16V0h11zM3 1.5v3.25l-1.497 1-.003 8 1.5 1v3.254L7.685 18l-.001 1.504H17.5V8.002L16 9.428l-.004-4.22-4.222-3.692L3 1.5z"/><path d="M4.06 6.64a.75.75 0 0 1 .958 1.15l-.085.07L2.29 9.75l2.646 1.89c.302.216.4.62.232.951l-.058.095a.75.75 0 0 1-.951.232l-.095-.058-3.5-2.5V9.14l3.496-2.5zm4.194 6.22a.75.75 0 0 1-.958-1.149l.085-.07 2.643-1.89-2.646-1.89a.75.75 0 0 1-.232-.952l.058-.095a.75.75 0 0 1 .95-.232l.096.058 3.5 2.5v1.22l-3.496 2.5zm7.644-.836 2.122 2.122-5.825 5.809-2.125-.005.003-2.116zm2.539-1.847 1.414 1.414a.5.5 0 0 1 0 .707l-1.06 1.06-2.122-2.12 1.061-1.061a.5.5 0 0 1 .707 0z"/></svg>';const iu="SourceEditingMode";class goe extends A{constructor(e){super(e);h(this,"_elementReplacer");h(this,"_replacedRoots");h(this,"_dataFromRoots");this.set("isSourceEditingMode",!1),this._elementReplacer=new XS,this._replacedRoots=new Map,this._dataFromRoots=new Map,e.config.define("sourceEditing.allowCollaborationFeatures",!1)}static get pluginName(){return"SourceEditing"}static get requires(){return[Hr]}init(){this._checkCompatibility();const e=this.editor,i=e.locale.t;e.ui.componentFactory.add("sourceEditing",()=>{const s=this._createButton(te);return s.set({label:i("Source"),icon:moe,tooltip:!0,class:"ck-source-editing-button"}),s}),e.ui.componentFactory.add("menuBar:sourceEditing",()=>{const s=this._createButton(pt);return s.set({label:i("Show source")}),s}),this._isAllowedToHandleSourceEditingMode()&&(this.on("change:isSourceEditingMode",(s,o,r)=>{r?(this._hideVisibleDialog(),this._showSourceEditing(),this._disableCommands()):(this._hideSourceEditing(),this._enableCommands())}),this.on("change:isEnabled",(s,o,r)=>this._handleReadOnlyMode(!r)),this.listenTo(e,"change:isReadOnly",(s,o,r)=>this._handleReadOnlyMode(r))),e.data.on("get",()=>{this.isSourceEditingMode&&this.updateEditorData()},{priority:"high"})}updateEditorData(){const e=this.editor,i={};for(const[s,o]of this._replacedRoots){const r=this._dataFromRoots.get(s),a=o.dataset.value;r!==a&&(i[s]=a,this._dataFromRoots.set(s,a))}Object.keys(i).length&&e.data.set(i,{batchType:{isUndoable:!0},suppressErrorInCollaboration:!0})}_checkCompatibility(){const e=this.editor,i=e.config.get("sourceEditing.allowCollaborationFeatures");if(!i&&e.plugins.has("RealTimeCollaborativeEditing"))throw new C("source-editing-incompatible-with-real-time-collaboration",null);!i&&["CommentsEditing","TrackChangesEditing","RevisionHistory"].some(o=>e.plugins.has(o))&&console.warn("You initialized the editor with the source editing feature and at least one of the collaboration features. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the collaboration features."),e.plugins.has("RestrictedEditingModeEditing")&&console.warn("You initialized the editor with the source editing feature and restricted editing feature. Please be advised that the source editing feature may not work, and be careful when editing document source that contains markers created by the restricted editing feature.")}_showSourceEditing(){const e=this.editor,i=e.editing.view,s=e.model;s.change(o=>{o.setSelection(null),o.removeSelectionAttribute(s.document.selection.getAttributeKeys())});for(const[o,r]of i.domRoots){const a=poe(e.data.get({rootName:o})),l=xt(r.ownerDocument,"textarea",{rows:"1","aria-label":"Source code editing area"}),c=xt(r.ownerDocument,"div",{class:"ck-source-editing-area","data-value":a},[l]);l.value=a,l.setSelectionRange(0,0),l.addEventListener("input",()=>{c.dataset.value=l.value,e.ui.update()}),i.change(u=>{const d=i.document.getRoot(o);u.addClass("ck-hidden",d)}),e.ui.setEditableElement("sourceEditing:"+o,l),this._replacedRoots.set(o,c),this._elementReplacer.replace(r,c),this._dataFromRoots.set(o,a)}this._focusSourceEditing()}_hideSourceEditing(){const i=this.editor.editing.view;this.updateEditorData(),i.change(s=>{for(const[o]of this._replacedRoots)s.removeClass("ck-hidden",i.document.getRoot(o))}),this._elementReplacer.restore(),this._replacedRoots.clear(),this._dataFromRoots.clear(),i.focus()}_focusSourceEditing(){const e=this.editor,[i]=this._replacedRoots.values(),s=i.querySelector("textarea");e.editing.view.document.isFocused=!1,s.focus()}_disableCommands(){const e=this.editor;for(const i of e.commands.commands())i.forceDisabled(iu);e.plugins.has("CommentsArchiveUI")&&e.plugins.get("CommentsArchiveUI").forceDisabled(iu)}_enableCommands(){const e=this.editor;for(const i of e.commands.commands())i.clearForceDisabled(iu);e.plugins.has("CommentsArchiveUI")&&e.plugins.get("CommentsArchiveUI").clearForceDisabled(iu)}_handleReadOnlyMode(e){if(this.isSourceEditingMode)for(const[,i]of this._replacedRoots)i.querySelector("textarea").readOnly=e}_isAllowedToHandleSourceEditingMode(){const i=this.editor.ui.view.editable;return i&&!i.hasExternalElement}_hideVisibleDialog(){if(this.editor.plugins.has("Dialog")){const e=this.editor.plugins.get("Dialog");e.isOpen&&e.hide()}}_createButton(e){const i=this.editor,s=new e(i.locale);return s.set({withText:!0}),s.bind("isOn").to(this,"isSourceEditingMode"),s.bind("isEnabled").to(this,"isEnabled",i,"isReadOnly",i.plugins.get(Hr),"hasAny",(o,r,a)=>!(!o||r||a)),this.listenTo(s,"execute",()=>{this.isSourceEditingMode=!this.isSourceEditingMode}),s}}function poe(n){return boe(n)?uoe(n):n}function boe(n){return n.startsWith("<")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class woe extends te{constructor(e,i){super(e);h(this,"styleDefinition");h(this,"previewView");this.styleDefinition=i,this.previewView=this._createPreview(),this.set({label:i.name,class:"ck-style-grid__button",withText:!0}),this.extendTemplate({attributes:{role:"option"}}),this.children.add(this.previewView,0)}_createPreview(){const e=new q(this.locale);return e.setTemplate({tag:"div",attributes:{class:["ck","ck-reset_all-excluded","ck-style-grid__button__preview","ck-content"],"aria-hidden":"true"},children:[this.styleDefinition.previewTemplate]}),e}}class _oe extends q{constructor(e,i){super(e);h(this,"focusTracker");h(this,"keystrokes");h(this,"children");this.focusTracker=new Ge,this.keystrokes=new tt,this.set("activeStyles",[]),this.set("enabledStyles",[]),this.children=this.createCollection(),this.children.delegate("execute").to(this);for(const s of i){const o=new woe(e,s);this.children.add(o)}this.on("change:activeStyles",()=>{for(const s of this.children)s.isOn=this.activeStyles.includes(s.styleDefinition.name)}),this.on("change:enabledStyles",()=>{for(const s of this.children)s.isEnabled=this.enabledStyles.includes(s.styleDefinition.name)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-grid"],role:"listbox"},children:this.children})}render(){super.render();for(const e of this.children)this.focusTracker.add(e.element);Bh({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.children,numberOfColumns:3,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection}),this.keystrokes.listenTo(this.element)}focus(){this.children.first.focus()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}class vy extends q{constructor(e,i,s){super(e);h(this,"gridView");h(this,"labelView");this.labelView=new fn(e),this.labelView.text=i,this.gridView=new _oe(e,s),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-panel__style-group"],role:"group","aria-labelledby":this.labelView.id},children:[this.labelView,this.gridView]})}}class voe extends q{constructor(e,i){super(e);h(this,"focusTracker");h(this,"keystrokes");h(this,"children");h(this,"blockStylesGroupView");h(this,"inlineStylesGroupView");h(this,"_focusables");h(this,"_focusCycler");const s=e.t;this.focusTracker=new Ge,this.keystrokes=new tt,this.children=this.createCollection(),this.blockStylesGroupView=new vy(e,s("Block styles"),i.block),this.inlineStylesGroupView=new vy(e,s("Text styles"),i.inline),this.set("activeStyles",[]),this.set("enabledStyles",[]),this._focusables=new Mt,this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:["shift + tab"],focusNext:["tab"]}}),i.block.length&&this.children.add(this.blockStylesGroupView),i.inline.length&&this.children.add(this.inlineStylesGroupView),this.blockStylesGroupView.gridView.delegate("execute").to(this),this.inlineStylesGroupView.gridView.delegate("execute").to(this),this.blockStylesGroupView.gridView.bind("activeStyles","enabledStyles").to(this,"activeStyles","enabledStyles"),this.inlineStylesGroupView.gridView.bind("activeStyles","enabledStyles").to(this,"activeStyles","enabledStyles"),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-panel"]},children:this.children})}render(){super.render(),this._focusables.add(this.blockStylesGroupView.gridView),this._focusables.add(this.inlineStylesGroupView.gridView),this.focusTracker.add(this.blockStylesGroupView.gridView.element),this.focusTracker.add(this.inlineStylesGroupView.gridView.element),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}const yoe=["caption","colgroup","dd","dt","figcaption","legend","li","optgroup","option","rp","rt","summary","tbody","td","tfoot","th","thead","tr"];class ss extends A{constructor(e){super(e);h(this,"_htmlSupport");this.decorate("isStyleEnabledForBlock"),this.decorate("isStyleActiveForBlock"),this.decorate("getAffectedBlocks"),this.decorate("isStyleEnabledForInlineSelection"),this.decorate("isStyleActiveForInlineSelection"),this.decorate("getAffectedInlineSelectable"),this.decorate("getStylePreview"),this.decorate("configureGHSDataFilter")}static get pluginName(){return"StyleUtils"}init(){this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport")}normalizeConfig(e,i=[]){const s={block:[],inline:[]};for(const o of i){const r=[],a=[];for(const c of e.getDefinitionsForView(o.element)){const u="appliesToBlock"in c?c.appliesToBlock:!1;if(c.isBlock||u){if(typeof u=="string")r.push(u);else if(c.isBlock){const d=c;r.push(c.model),d.paragraphLikeModel&&r.push(d.paragraphLikeModel)}}else a.push(c.model)}const l=this.getStylePreview(o,[{text:"AaBbCcDdEeFfGgHhIiJj"}]);r.length?s.block.push({...o,previewTemplate:l,modelElements:r,isBlock:!0}):s.inline.push({...o,previewTemplate:l,ghsAttributes:a})}return s}isStyleEnabledForBlock(e,i){const s=this.editor.model,o=this._htmlSupport.getGhsAttributeNameForElement(e.element);return s.schema.checkAttribute(i,o)?e.modelElements.includes(i.name):!1}isStyleActiveForBlock(e,i){const s=this._htmlSupport.getGhsAttributeNameForElement(e.element),o=i.getAttribute(s);return this.hasAllClasses(o,e.classes)}getAffectedBlocks(e,i){return e.modelElements.includes(i.name)?[i]:null}isStyleEnabledForInlineSelection(e,i){const s=this.editor.model;for(const o of e.ghsAttributes)if(s.schema.checkAttributeInSelection(i,o))return!0;return!1}isStyleActiveForInlineSelection(e,i){for(const s of e.ghsAttributes){const o=this._getValueFromFirstAllowedNode(i,s);if(this.hasAllClasses(o,e.classes))return!0}return!1}getAffectedInlineSelectable(e,i){return i}getStylePreview(e,i){const{element:s,classes:o}=e;return{tag:koe(s)?s:"div",attributes:{class:o},children:i}}hasAllClasses(e,i){return Ce(e)&&Coe(e)&&i.every(s=>e.classes.includes(s))}configureGHSDataFilter({block:e,inline:i}){const s=this.editor.plugins.get("DataFilter");s.loadAllowedConfig(e.map(yy)),s.loadAllowedConfig(i.map(yy))}_getValueFromFirstAllowedNode(e,i){const o=this.editor.model.schema;if(e.isCollapsed)return e.getAttribute(i);for(const r of e.getRanges())for(const a of r.getItems())if(o.checkAttribute(a,i))return a.getAttribute(i);return null}}function Coe(n){return!!n.classes&&Array.isArray(n.classes)}function koe(n){return!yoe.includes(n)}function yy({element:n,classes:t}){return{name:n,classes:t}}class Toe extends A{static get pluginName(){return"StyleUI"}static get requires(){return[ss]}init(){const t=this.editor,e=t.plugins.get("DataSchema"),i=t.plugins.get("StyleUtils"),s=t.config.get("style.definitions"),o=i.normalizeConfig(e,s);t.ui.componentFactory.add("style",r=>{const a=r.t,l=Yt(r),c=t.commands.get("style");return l.once("change:isOpen",()=>{const u=new voe(r,o);l.panelView.children.add(u),u.delegate("execute").to(l),u.bind("activeStyles").to(c,"value"),u.bind("enabledStyles").to(c,"enabledStyles")}),l.bind("isEnabled").to(c),l.buttonView.withText=!0,l.buttonView.bind("label").to(c,"value",u=>u.length>1?a("Multiple styles"):u.length===1?u[0]:a("Styles")),l.bind("class").to(c,"value",u=>{const d=["ck-style-dropdown"];return u.length>1&&d.push("ck-style-dropdown_multiple-active"),d.join(" ")}),l.on("execute",u=>{t.execute("style",{styleName:u.source.styleDefinition.name}),t.editing.view.focus()}),l})}}class Eoe extends ne{constructor(e,i){super(e);h(this,"_styleDefinitions");h(this,"_styleUtils");this.set("value",[]),this.set("enabledStyles",[]),this._styleDefinitions=i,this._styleUtils=this.editor.plugins.get(ss)}refresh(){const e=this.editor.model,i=e.document.selection,s=new Set,o=new Set;for(const a of this._styleDefinitions.inline)this._styleUtils.isStyleEnabledForInlineSelection(a,i)&&o.add(a.name),this._styleUtils.isStyleActiveForInlineSelection(a,i)&&s.add(a.name);const r=Ye(i.getSelectedBlocks())||i.getFirstPosition().parent;if(r){const a=r.getAncestors({includeSelf:!0,parentFirst:!0});for(const l of a){if(l.is("rootElement"))break;for(const c of this._styleDefinitions.block)this._styleUtils.isStyleEnabledForBlock(c,l)&&(o.add(c.name),this._styleUtils.isStyleActiveForBlock(c,l)&&s.add(c.name));if(e.schema.isObject(l))break}}this.enabledStyles=Array.from(o).sort(),this.isEnabled=this.enabledStyles.length>0,this.value=this.isEnabled?Array.from(s).sort():[]}execute({styleName:e,forceValue:i}){if(!this.enabledStyles.includes(e)){Te("style-command-executed-with-incorrect-style-name");return}const s=this.editor.model,o=s.document.selection,r=this.editor.plugins.get("GeneralHtmlSupport"),a=[...this._styleDefinitions.inline,...this._styleDefinitions.block],l=a.filter(({name:d})=>this.value.includes(d)),c=a.find(({name:d})=>d==e),u=i===void 0?!this.value.includes(c.name):i;s.change(()=>{let d;xoe(c)?d=this._findAffectedBlocks(Soe(o),c):d=[this._styleUtils.getAffectedInlineSelectable(c,o)];for(const f of d)u?r.addModelHtmlClass(c.element,c.classes,f):r.removeModelHtmlClass(c.element,Aoe(l,c),f)})}_findAffectedBlocks(e,i){const s=new Set;for(const o of e){const r=o.getAncestors({includeSelf:!0,parentFirst:!0});for(const a of r){if(a.is("rootElement"))break;const l=this._styleUtils.getAffectedBlocks(i,a);if(l){for(const c of l)s.add(c);break}}}return s}}function Aoe(n,t){return n.reduce((e,i)=>i.name===t.name?e:e.filter(s=>!i.classes.includes(s)),t.classes)}function xoe(n){return"isBlock"in n}function Soe(n){const t=Array.from(n.getSelectedBlocks());return t.length?t:[n.getFirstPosition().parent]}class Ioe extends A{constructor(){super(...arguments);h(this,"_listUtils");h(this,"_styleUtils");h(this,"_htmlSupport")}static get pluginName(){return"ListStyleSupport"}static get requires(){return[ss,"GeneralHtmlSupport"]}init(){const e=this.editor;e.plugins.has("ListEditing")&&(this._styleUtils=e.plugins.get(ss),this._listUtils=this.editor.plugins.get("ListUtils"),this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport"),this.listenTo(this._styleUtils,"isStyleEnabledForBlock",(i,[s,o])=>{this._isStyleEnabledForBlock(s,o)&&(i.return=!0,i.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"isStyleActiveForBlock",(i,[s,o])=>{this._isStyleActiveForBlock(s,o)&&(i.return=!0,i.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedBlocks",(i,[s,o])=>{const r=this._getAffectedBlocks(s,o);r&&(i.return=r,i.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getStylePreview",(i,[s,o])=>{const r=this._getStylePreview(s,o);r&&(i.return=r,i.stop())},{priority:"high"}))}_isStyleEnabledForBlock(e,i){const s=this.editor.model;if(!["ol","ul","li"].includes(e.element)||!this._listUtils.isListItemBlock(i))return!1;const o=this._htmlSupport.getGhsAttributeNameForElement(e.element);if(e.element=="ol"||e.element=="ul"){if(!s.schema.checkAttribute(i,o))return!1;const a=this._listUtils.isNumberedListType(i.getAttribute("listType"))?"ol":"ul";return e.element==a}else return s.schema.checkAttribute(i,o)}_isStyleActiveForBlock(e,i){const s=this._htmlSupport.getGhsAttributeNameForElement(e.element),o=i.getAttribute(s);return this._styleUtils.hasAllClasses(o,e.classes)}_getAffectedBlocks(e,i){return this._isStyleEnabledForBlock(e,i)?e.element=="li"?this._listUtils.expandListBlocksToCompleteItems(i,{withNested:!1}):this._listUtils.expandListBlocksToCompleteList(i):null}_getStylePreview(e,i){const{element:s,classes:o}=e;return s=="ol"||s=="ul"?{tag:s,attributes:{class:o},children:[{tag:"li",children:i}]}:s=="li"?{tag:"ol",children:[{tag:s,attributes:{class:o},children:i}]}:null}}class Poe extends A{constructor(){super(...arguments);h(this,"_tableUtils");h(this,"_styleUtils")}static get pluginName(){return"TableStyleSupport"}static get requires(){return[ss]}init(){const e=this.editor;e.plugins.has("TableEditing")&&(this._styleUtils=e.plugins.get(ss),this._tableUtils=this.editor.plugins.get("TableUtils"),this.listenTo(this._styleUtils,"isStyleEnabledForBlock",(i,[s,o])=>{this._isApplicable(s,o)&&(i.return=this._isStyleEnabledForBlock(s,o),i.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedBlocks",(i,[s,o])=>{this._isApplicable(s,o)&&(i.return=this._getAffectedBlocks(s,o),i.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"configureGHSDataFilter",(i,[{block:s}])=>{this.editor.plugins.get("DataFilter").loadAllowedConfig(s.filter(r=>r.element=="figcaption").map(r=>({name:"caption",classes:r.classes})))}))}_isApplicable(e,i){return["td","th"].includes(e.element)?i.name=="tableCell":["thead","tbody"].includes(e.element)?i.name=="table":!1}_isStyleEnabledForBlock(e,i){if(["td","th"].includes(e.element)){const s=this._tableUtils.getCellLocation(i),r=i.parent.parent,a=r.getAttribute("headingRows")||0,l=r.getAttribute("headingColumns")||0,c=s.row<a||s.column<l;return e.element=="th"?c:!c}if(["thead","tbody"].includes(e.element)){const s=i.getAttribute("headingRows")||0;return e.element=="thead"?s>0:s<this._tableUtils.getRows(i)}/* istanbul ignore next -- @preserve */return!1}_getAffectedBlocks(e,i){return this._isStyleEnabledForBlock(e,i)?[i]:null}}class Roe extends A{constructor(){super(...arguments);h(this,"_styleUtils");h(this,"_htmlSupport")}static get pluginName(){return"LinkStyleSupport"}static get requires(){return[ss,"GeneralHtmlSupport"]}init(){const e=this.editor;e.plugins.has("LinkEditing")&&(this._styleUtils=e.plugins.get(ss),this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport"),this.listenTo(this._styleUtils,"isStyleEnabledForInlineSelection",(i,[s,o])=>{s.element=="a"&&(i.return=this._isStyleEnabled(s,o),i.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"isStyleActiveForInlineSelection",(i,[s,o])=>{s.element=="a"&&(i.return=this._isStyleActive(s,o),i.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedInlineSelectable",(i,[s,o])=>{if(s.element!="a")return;const r=this._getAffectedSelectable(s,o);r&&(i.return=r,i.stop())},{priority:"high"}))}_isStyleEnabled(e,i){const s=this.editor.model;if(i.isCollapsed)return i.hasAttribute("linkHref");for(const o of i.getRanges())for(const r of o.getItems())if((r.is("$textProxy")||s.schema.isInline(r))&&r.hasAttribute("linkHref"))return!0;return!1}_isStyleActive(e,i){const s=this.editor.model,o=this._htmlSupport.getGhsAttributeNameForElement(e.element);if(i.isCollapsed){if(i.hasAttribute("linkHref")){const r=i.getAttribute(o);if(this._styleUtils.hasAllClasses(r,e.classes))return!0}return!1}for(const r of i.getRanges())for(const a of r.getItems())if((a.is("$textProxy")||s.schema.isInline(a))&&a.hasAttribute("linkHref")){const l=a.getAttribute(o);return this._styleUtils.hasAllClasses(l,e.classes)}return!1}_getAffectedSelectable(e,i){const s=this.editor.model;if(i.isCollapsed){const r=i.getAttribute("linkHref");return ac(i.getFirstPosition(),"linkHref",r,s)}const o=[];for(const r of i.getRanges()){const a=s.createRange(Cy(r.start,"linkHref",!0,s),Cy(r.end,"linkHref",!1,s));for(const l of a.getItems())(l.is("$textProxy")||s.schema.isInline(l))&&l.hasAttribute("linkHref")&&o.push(this.editor.model.createRangeOn(l))}return Loe(o)}}function Cy(n,t,e,i){const s=n.textNode||(e?n.nodeAfter:n.nodeBefore);if(!s||!s.hasAttribute(t))return n;const o=s.getAttribute(t);return eg(n,t,o,e,i)}function Loe(n){for(let t=1;t<n.length;t++){const e=n[t-1].getJoined(n[t]);e&&n.splice(--t,2,e)}return n}class Voe extends A{static get pluginName(){return"StyleEditing"}static get requires(){return["GeneralHtmlSupport",ss,Ioe,Poe,Roe]}init(){const t=this.editor,e=t.plugins.get("DataSchema"),i=t.plugins.get("StyleUtils"),s=t.config.get("style.definitions"),o=i.normalizeConfig(e,s);t.commands.add("style",new Eoe(t,o)),i.configureGHSDataFilter(o)}}class Boe extends A{static get pluginName(){return"Style"}static get requires(){return[Voe,Toe]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function uw(n,t){const{modelAttribute:e,styleName:i,viewElement:s,defaultValue:o,reduceBoxSides:r=!1,shouldUpcast:a=()=>!0}=t;n.for("upcast").attributeToAttribute({view:{name:s,styles:{[i]:/[\s\S]+/}},model:{key:e,value:l=>{if(!a(l))return;const c=l.getNormalizedStyle(i),u=r?Cu(c):c;if(o!==u)return u}}})}function hg(n,t,e,i){n.for("upcast").add(s=>s.on("element:"+t,(o,r,a)=>{if(!r.modelRange)return;const l=["border-top-width","border-top-color","border-top-style","border-bottom-width","border-bottom-color","border-bottom-style","border-right-width","border-right-color","border-right-style","border-left-width","border-left-color","border-left-style"].filter(m=>r.viewItem.hasStyle(m));if(!l.length)return;const c={styles:l};if(!a.consumable.test(r.viewItem,c))return;const u=[...r.modelRange.getItems({shallow:!0})].pop();a.consumable.consume(r.viewItem,c);const d={style:r.viewItem.getNormalizedStyle("border-style"),color:r.viewItem.getNormalizedStyle("border-color"),width:r.viewItem.getNormalizedStyle("border-width")},f={style:Cu(d.style),color:Cu(d.color),width:Cu(d.width)};f.style!==i.style&&a.writer.setAttribute(e.style,f.style,u),f.color!==i.color&&a.writer.setAttribute(e.color,f.color,u),f.width!==i.width&&a.writer.setAttribute(e.width,f.width,u)}))}function sl(n,t){const{modelElement:e,modelAttribute:i,styleName:s}=t;n.for("downcast").attributeToAttribute({model:{name:e,key:i},view:o=>({key:"style",value:{[s]:o}})})}function yu(n,t){const{modelAttribute:e,styleName:i}=t;n.for("downcast").add(s=>s.on(`attribute:${e}:table`,(o,r,a)=>{const{item:l,attributeNewValue:c}=r,{mapper:u,writer:d}=a;if(!a.consumable.consume(r.item,o.name))return;const f=[...u.toViewElement(l).getChildren()].find(m=>m.is("element","table"));c?d.setStyle(i,c,f):d.removeStyle(i,f)}))}function Cu(n){if(!n)return;const t=["top","right","bottom","left"];if(!t.every(o=>n[o]))return n;const i=n.top;return t.every(o=>n[o]===i)?i:n}function at(n,t,e,i,s=1){t!=null&&s!==void 0&&s!==null&&t>s?i.setAttribute(n,t,e):i.removeAttribute(n,e)}function Go(n,t,e={}){const i=n.createElement("tableCell",e);return n.insertElement("paragraph",i),n.insert(i,t),i}function fg(n,t){const e=t.parent.parent,i=parseInt(e.getAttribute("headingColumns")||"0"),{column:s}=n.getCellLocation(t);return!!i&&s<i}function ku(n,t,e){const{modelAttribute:i}=e;n.extend("tableCell",{allowAttributes:[i]}),uw(t,{viewElement:/^(td|th)$/,...e}),sl(t,{modelElement:"tableCell",...e})}function yo(n){const t=n.getSelectedElement();return t&&t.is("element","table")?t:n.getFirstPosition().findAncestor("table")}function Moe(){return n=>{n.on("element:figure",(t,e,i)=>{if(!i.consumable.test(e.viewItem,{name:!0,classes:"table"}))return;const s=Foe(e.viewItem);if(!s||!i.consumable.test(s,{name:!0}))return;i.consumable.consume(e.viewItem,{name:!0,classes:"table"});const o=i.convertItem(s,e.modelCursor),r=Ye(o.modelRange.getItems());if(!r){i.consumable.revert(e.viewItem,{name:!0,classes:"table"});return}i.convertChildren(e.viewItem,i.writer.createPositionAt(r,"end")),i.updateConversionResult(r,e)})}}function Ooe(){return n=>{n.on("element:table",(t,e,i)=>{const s=e.viewItem;if(!i.consumable.test(s,{name:!0}))return;const{rows:o,headingRows:r,headingColumns:a}=Doe(s),l={};a&&(l.headingColumns=a),r&&(l.headingRows=r);const c=i.writer.createElement("table",l);if(i.safeInsert(c,e.modelCursor)){if(i.consumable.consume(s,{name:!0}),o.forEach(u=>i.convertItem(u,i.writer.createPositionAt(c,"end"))),i.convertChildren(s,i.writer.createPositionAt(c,"end")),c.isEmpty){const u=i.writer.createElement("tableRow");i.writer.insert(u,i.writer.createPositionAt(c,"end")),Go(i.writer,i.writer.createPositionAt(u,"end"))}i.updateConversionResult(c,e)}})}}function Noe(){return n=>{n.on("element:tr",(t,e)=>{e.viewItem.isEmpty&&e.modelCursor.index==0&&t.stop()},{priority:"high"})}}function ky(n){return t=>{t.on(`element:${n}`,(e,i,{writer:s})=>{if(!i.modelRange)return;const o=i.modelRange.start.nodeAfter,r=s.createPositionAt(o,0);if(i.viewItem.isEmpty){s.insertElement("paragraph",r);return}const a=Array.from(o.getChildren());if(a.every(l=>l.is("element","$marker"))){const l=s.createElement("paragraph");s.insert(l,s.createPositionAt(o,0));for(const c of a)s.move(s.createRangeOn(c),s.createPositionAt(l,"end"))}},{priority:"low"})}}function Foe(n){for(const t of n.getChildren())if(t.is("element","table"))return t}function Doe(n){let t=0,e;const i=[],s=[];let o;for(const r of Array.from(n.getChildren())){if(r.name!=="tbody"&&r.name!=="thead"&&r.name!=="tfoot")continue;r.name==="thead"&&!o&&(o=r);const a=Array.from(r.getChildren()).filter(l=>l.is("element","tr"));for(const l of a)if(o&&r===o||r.name==="tbody"&&Array.from(l.getChildren()).length&&Array.from(l.getChildren()).every(c=>c.is("element","th")))t++,i.push(l);else{s.push(l);const c=$oe(l);(!e||c<e)&&(e=c)}}return{headingRows:t,headingColumns:e||0,rows:[...i,...s]}}function $oe(n){let t=0,e=0;const i=Array.from(n.getChildren()).filter(s=>s.name==="th"||s.name==="td");for(;e<i.length&&i[e].name==="th";){const s=i[e],o=parseInt(s.getAttribute("colspan")||"1");t=t+o,e++}return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ne{constructor(t,e={}){h(this,"_table");h(this,"_startRow");h(this,"_endRow");h(this,"_startColumn");h(this,"_endColumn");h(this,"_includeAllSlots");h(this,"_skipRows");h(this,"_row");h(this,"_rowIndex");h(this,"_column");h(this,"_cellIndex");h(this,"_spannedCells");h(this,"_nextCellAtColumn");h(this,"_jumpedToStartRow",!1);this._table=t,this._startRow=e.row!==void 0?e.row:e.startRow||0,this._endRow=e.row!==void 0?e.row:e.endRow,this._startColumn=e.column!==void 0?e.column:e.startColumn||0,this._endColumn=e.column!==void 0?e.column:e.endColumn,this._includeAllSlots=!!e.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){this._canJumpToStartRow()&&this._jumpToNonSpannedRowClosestToStartRow();const t=this._table.getChild(this._rowIndex);if(!t||this._isOverEndRow())return{done:!0,value:void 0};if(!t.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let e=null;const i=this._getSpanned();if(i)this._includeAllSlots&&!this._shouldSkipSlot()&&(e=this._formatOutValue(i.cell,i.row,i.column));else{const s=t.getChild(this._cellIndex);if(!s)return this._advanceToNextRow();const o=parseInt(s.getAttribute("colspan")||"1"),r=parseInt(s.getAttribute("rowspan")||"1");(o>1||r>1)&&this._recordSpans(s,r,o),this._shouldSkipSlot()||(e=this._formatOutValue(s)),this._nextCellAtColumn=this._column+o}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,e||this.next()}skipRow(t){this._skipRows.add(t)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return this._endRow!==void 0&&this._row>this._endRow}_isOverEndColumn(){return this._endColumn!==void 0&&this._column>this._endColumn}_formatOutValue(t,e=this._row,i=this._column){return{done:!1,value:new Hoe(this,t,e,i)}}_shouldSkipSlot(){const t=this._skipRows.has(this._row),e=this._row<this._startRow,i=this._column<this._startColumn,s=this._endColumn!==void 0&&this._column>this._endColumn;return t||e||i||s}_getSpanned(){const t=this._spannedCells.get(this._row);return t&&t.get(this._column)||null}_recordSpans(t,e,i){const s={cell:t,row:this._row,column:this._column};for(let o=this._row;o<this._row+e;o++)for(let r=this._column;r<this._column+i;r++)(o!=this._row||r!=this._column)&&this._markSpannedCell(o,r,s)}_markSpannedCell(t,e,i){this._spannedCells.has(t)||this._spannedCells.set(t,new Map),this._spannedCells.get(t).set(e,i)}_canJumpToStartRow(){return!!this._startRow&&this._startRow>0&&!this._jumpedToStartRow}_jumpToNonSpannedRowClosestToStartRow(){const t=this._getRowLength(0);for(let e=this._startRow;!this._jumpedToStartRow;e--)t===this._getRowLength(e)&&(this._row=e,this._rowIndex=e,this._jumpedToStartRow=!0)}_getRowLength(t){return[...this._table.getChild(t).getChildren()].reduce((i,s)=>i+parseInt(s.getAttribute("colspan")||"1"),0)}}class Hoe{constructor(t,e,i,s){h(this,"cell");h(this,"row");h(this,"column");h(this,"cellAnchorRow");h(this,"cellAnchorColumn");h(this,"_cellIndex");h(this,"_rowIndex");h(this,"_table");this.cell=e,this.row=t._row,this.column=t._column,this.cellAnchorRow=i,this.cellAnchorColumn=s,this._cellIndex=t._cellIndex,this._rowIndex=t._rowIndex,this._table=t._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||"1")}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||"1")}get rowIndex(){return this._rowIndex}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}function Ty(n,t){return(e,{writer:i})=>{const s=e.getAttribute("headingRows")||0,o=i.createContainerElement("table",null,[]),r=i.createContainerElement("figure",{class:"table"},o);s>0&&i.insert(i.createPositionAt(o,"end"),i.createContainerElement("thead",null,i.createSlot(a=>a.is("element","tableRow")&&a.index<s))),s<n.getRows(e)&&i.insert(i.createPositionAt(o,"end"),i.createContainerElement("tbody",null,i.createSlot(a=>a.is("element","tableRow")&&a.index>=s)));for(const{positionOffset:a,filter:l}of t.additionalSlots)i.insert(i.createPositionAt(o,a),i.createSlot(l));return i.insert(i.createPositionAt(o,"after"),i.createSlot(a=>a.is("element","tableRow")?!1:!t.additionalSlots.some(({filter:l})=>l(a)))),t.asWidget?Uoe(r,i):r}}function zoe(){return(n,{writer:t})=>n.isEmpty?t.createEmptyElement("tr"):t.createContainerElement("tr")}function Ey(n={}){return(t,{writer:e})=>{const i=t.parent,s=i.parent,o=s.getChildIndex(i),r=new Ne(s,{row:o}),a=s.getAttribute("headingRows")||0,l=s.getAttribute("headingColumns")||0;let c=null;for(const u of r)if(u.cell==t){const f=u.row<a||u.column<l?"th":"td";c=n.asWidget?qb(e.createEditableElement(f),e):e.createContainerElement(f);break}return c}}function Ay(n={}){return(t,{writer:e})=>{if(!t.parent.is("element","tableCell")||!gR(t))return null;if(n.asWidget)return e.createContainerElement("span",{class:"ck-table-bogus-paragraph"});{const i=e.createContainerElement("p");return e.setCustomProperty("dataPipeline:transparentRendering",!0,i),i}}}function gR(n){return n.parent.childCount==1&&!Woe(n)}function Uoe(n,t){return t.setCustomProperty("table",!0,n),Xs(n,t,{hasSelectionHandle:!0})}function Woe(n){return!n.getAttributeKeys().next().done}class qoe extends ne{refresh(){const t=this.editor.model,e=t.document.selection,i=t.schema;this.isEnabled=joe(e,i)}execute(t={}){const e=this.editor,i=e.model,s=e.plugins.get("TableUtils"),o=e.config.get("table.defaultHeadings.rows"),r=e.config.get("table.defaultHeadings.columns");t.headingRows===void 0&&o&&(t.headingRows=o),t.headingColumns===void 0&&r&&(t.headingColumns=r),i.change(a=>{const l=s.createTable(a,t);i.insertObject(l,null,null,{findOptimalPosition:"auto"}),a.setSelection(a.createPositionAt(l.getNodeByPath([0,0,0]),0))})}}function joe(n,t){const e=n.getFirstPosition().parent,i=e===e.root?e:e.parent;return t.checkChild(i,"table")}class xy extends ne{constructor(e,i={}){super(e);h(this,"order");this.order=i.order||"below"}refresh(){const e=this.editor.model.document.selection,s=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=s}execute(){const e=this.editor,i=e.model.document.selection,s=e.plugins.get("TableUtils"),o=this.order==="above",r=s.getSelectionAffectedTableCells(i),a=s.getRowIndexes(r),l=o?a.first:a.last,c=r[0].findAncestor("table");s.insertRows(c,{at:o?l:l+1,copyStructureFromAbove:!o})}}class Sy extends ne{constructor(e,i={}){super(e);h(this,"order");this.order=i.order||"right"}refresh(){const e=this.editor.model.document.selection,s=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=s}execute(){const e=this.editor,i=e.model.document.selection,s=e.plugins.get("TableUtils"),o=this.order==="left",r=s.getSelectionAffectedTableCells(i),a=s.getColumnIndexes(r),l=o?a.first:a.last,c=r[0].findAncestor("table");s.insertColumns(c,{columns:1,at:o?l:l+1})}}class Iy extends ne{constructor(e,i={}){super(e);h(this,"direction");this.direction=i.direction||"horizontally"}refresh(){const i=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=i.length===1}execute(){const e=this.editor.plugins.get("TableUtils"),i=e.getSelectionAffectedTableCells(this.editor.model.document.selection)[0];this.direction==="horizontally"?e.splitCellHorizontally(i,2):e.splitCellVertically(i,2)}}function pR(n,t,e){const{startRow:i,startColumn:s,endRow:o,endColumn:r}=t,a=e.createElement("table"),l=o-i+1;for(let u=0;u<l;u++)e.insertElement("tableRow",a,"end");const c=[...new Ne(n,{startRow:i,endRow:o,startColumn:s,endColumn:r,includeAllSlots:!0})];for(const{row:u,column:d,cell:f,isAnchor:m,cellAnchorRow:g,cellAnchorColumn:p}of c){const w=u-i,v=a.getChild(w);if(!m)(g<i||p<s)&&Go(e,e.createPositionAt(v,"end"));else{const _=e.cloneElement(f);e.append(_,v),yR(_,u,d,o,r,e)}}return Goe(a,n,i,s,e),a}function bR(n,t,e=0){const i=[],s=new Ne(n,{startRow:e,endRow:t-1});for(const o of s){const{row:r,cellHeight:a}=o,l=r+a-1;r<t&&t<=l&&i.push(o)}return i}function wR(n,t,e){const i=n.parent,s=i.parent,o=i.index,r=parseInt(n.getAttribute("rowspan")),a=t-o,l={},c=r-a;c>1&&(l.rowspan=c);const u=parseInt(n.getAttribute("colspan")||"1");u>1&&(l.colspan=u);const d=o,f=d+a,m=[...new Ne(s,{startRow:d,endRow:f,includeAllSlots:!0})];let g=null,p;for(const w of m){const{row:v,column:_,cell:y}=w;y===n&&p===void 0&&(p=_),p!==void 0&&p===_&&v===f&&(g=Go(e,w.getPositionBefore(),l))}return at("rowspan",a,n,e),g}function _R(n,t){const e=[],i=new Ne(n);for(const s of i){const{column:o,cellWidth:r}=s,a=o+r-1;o<t&&t<=a&&e.push(s)}return e}function vR(n,t,e,i){const s=parseInt(n.getAttribute("colspan")),o=e-t,r={},a=s-o;a>1&&(r.colspan=a);const l=parseInt(n.getAttribute("rowspan")||"1");l>1&&(r.rowspan=l);const c=Go(i,i.createPositionAfter(n),r);return at("colspan",o,n,i),c}function yR(n,t,e,i,s,o){const r=parseInt(n.getAttribute("colspan")||"1"),a=parseInt(n.getAttribute("rowspan")||"1");if(e+r-1>s){const u=s-e+1;at("colspan",u,n,o,1)}if(t+a-1>i){const u=i-t+1;at("rowspan",u,n,o,1)}}function Goe(n,t,e,i,s){const o=parseInt(t.getAttribute("headingRows")||"0");if(o>0){const a=o-e;at("headingRows",a,n,s,0)}const r=parseInt(t.getAttribute("headingColumns")||"0");if(r>0){const a=r-i;at("headingColumns",a,n,s,0)}}function mg(n,t){const e=t.getColumns(n),i=new Array(e).fill(0);for(const{column:o}of new Ne(n))i[o]++;const s=i.reduce((o,r,a)=>r?o:[...o,a],[]);if(s.length>0){const o=s[s.length-1];return t.removeColumns(n,{at:o}),!0}return!1}function gg(n,t){const e=[],i=t.getRows(n);for(let s=0;s<i;s++)n.getChild(s).isEmpty&&e.push(s);if(e.length>0){const s=e[e.length-1];return t.removeRows(n,{at:s}),!0}return!1}function dw(n,t){mg(n,t)||gg(n,t)}function CR(n,t){const e=Array.from(new Ne(n,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow}));if(e.every(({cellHeight:o})=>o===1))return t.lastRow;const s=e[0].cellHeight-1;return t.lastRow+s}function kR(n,t){const e=Array.from(new Ne(n,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn}));if(e.every(({cellWidth:o})=>o===1))return t.lastColumn;const s=e[0].cellWidth-1;return t.lastColumn+s}class su extends ne{constructor(e,i){super(e);h(this,"direction");h(this,"isHorizontal");this.direction=i.direction,this.isHorizontal=this.direction=="right"||this.direction=="left"}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,i=e.document,o=this.editor.plugins.get("TableUtils").getTableCellsContainingSelection(i.selection)[0],r=this.value,a=this.direction;e.change(l=>{const c=a=="right"||a=="down",u=c?o:r,d=c?r:o,f=d.parent;Joe(d,u,l);const m=this.isHorizontal?"colspan":"rowspan",g=parseInt(o.getAttribute(m)||"1"),p=parseInt(r.getAttribute(m)||"1");l.setAttribute(m,g+p,u),l.setSelection(l.createRangeIn(u));const w=this.editor.plugins.get("TableUtils"),v=f.findAncestor("table");dw(v,w)})}_getMergeableCell(){const i=this.editor.model.document,s=this.editor.plugins.get("TableUtils"),o=s.getTableCellsContainingSelection(i.selection)[0];if(!o)return;const r=this.isHorizontal?Koe(o,this.direction,s):Zoe(o,this.direction,s);if(!r)return;const a=this.isHorizontal?"rowspan":"colspan",l=parseInt(o.getAttribute(a)||"1");if(parseInt(r.getAttribute(a)||"1")===l)return r}}function Koe(n,t,e){const s=n.parent.parent,o=t=="right"?n.nextSibling:n.previousSibling,r=(s.getAttribute("headingColumns")||0)>0;if(!o)return;const a=t=="right"?n:o,l=t=="right"?o:n,{column:c}=e.getCellLocation(a),{column:u}=e.getCellLocation(l),d=parseInt(a.getAttribute("colspan")||"1"),f=fg(e,a),m=fg(e,l);return r&&f!=m?void 0:c+d===u?o:void 0}function Zoe(n,t,e){const i=n.parent,s=i.parent,o=s.getChildIndex(i);if(t=="down"&&o===e.getRows(s)-1||t=="up"&&o===0)return null;const r=parseInt(n.getAttribute("rowspan")||"1"),a=s.getAttribute("headingRows")||0,l=t=="down"&&o+r===a,c=t=="up"&&o===a;if(a&&(l||c))return null;const u=parseInt(n.getAttribute("rowspan")||"1"),d=t=="down"?o+u:o,f=[...new Ne(s,{endRow:d})],g=f.find(w=>w.cell===n).column,p=f.find(({row:w,cellHeight:v,column:_})=>_!==g?!1:t=="down"?w===d:d===w+v);return p&&p.cell?p.cell:null}function Joe(n,t,e){Py(n)||(Py(t)&&e.remove(e.createRangeIn(t)),e.move(e.createRangeIn(n),e.createPositionAt(t,"end"))),e.remove(n)}function Py(n){const t=n.getChild(0);return n.childCount==1&&t.is("element","paragraph")&&t.isEmpty}class Yoe extends ne{refresh(){const t=this.editor.plugins.get("TableUtils"),e=t.getSelectionAffectedTableCells(this.editor.model.document.selection),i=e[0];if(i){const s=i.findAncestor("table"),r=t.getRows(s)-1,a=t.getRowIndexes(e),l=a.first===0&&a.last===r;this.isEnabled=!l}else this.isEnabled=!1}execute(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),i=e.getSelectionAffectedTableCells(t.document.selection),s=e.getRowIndexes(i),o=i[0],r=o.findAncestor("table"),a=e.getCellLocation(o).column;t.change(l=>{const c=s.last-s.first+1;e.removeRows(r,{at:s.first,rows:c});const u=Xoe(r,s.first,a,e.getRows(r));l.setSelection(l.createPositionAt(u,0))})}}function Xoe(n,t,e,i){const s=n.getChild(Math.min(t,i-1));let o=s.getChild(0),r=0;for(const a of s.getChildren()){if(r>e)return o;o=a,r+=parseInt(a.getAttribute("colspan")||"1")}return o}class Qoe extends ne{refresh(){const t=this.editor.plugins.get("TableUtils"),e=t.getSelectionAffectedTableCells(this.editor.model.document.selection),i=e[0];if(i){const s=i.findAncestor("table"),o=t.getColumns(s),{first:r,last:a}=t.getColumnIndexes(e);this.isEnabled=a-r<o-1}else this.isEnabled=!1}execute(){const t=this.editor.plugins.get("TableUtils"),[e,i]=tre(this.editor.model.document.selection,t),s=e.parent.parent,o=[...new Ne(s)],r={first:o.find(l=>l.cell===e).column,last:o.find(l=>l.cell===i).column},a=ere(o,e,i,r);this.editor.model.change(l=>{const c=r.last-r.first+1;t.removeColumns(s,{at:r.first,columns:c}),l.setSelection(l.createPositionAt(a,0))})}}function ere(n,t,e,i){return parseInt(e.getAttribute("colspan")||"1")>1?e:t.previousSibling||e.nextSibling?e.nextSibling||t.previousSibling:i.first?n.reverse().find(({column:o})=>o<i.first).cell:n.reverse().find(({column:o})=>o>i.last).cell}function tre(n,t){const e=t.getSelectionAffectedTableCells(n),i=e[0],s=e.pop(),o=[i,s];return i.isBefore(s)?o:o.reverse()}class nre extends ne{refresh(){const t=this.editor.plugins.get("TableUtils"),e=this.editor.model,i=t.getSelectionAffectedTableCells(e.document.selection),s=i.length>0;this.isEnabled=s,this.value=s&&i.every(o=>this._isInHeading(o,o.parent.parent))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.plugins.get("TableUtils"),i=this.editor.model,s=e.getSelectionAffectedTableCells(i.document.selection),o=s[0].findAncestor("table"),{first:r,last:a}=e.getRowIndexes(s),l=this.value?r:a+1,c=o.getAttribute("headingRows")||0;i.change(u=>{if(l){const d=l>c?c:0,f=bR(o,l,d);for(const{cell:m}of f)wR(m,l,u)}at("headingRows",l,o,u,0)})}_isInHeading(t,e){const i=parseInt(e.getAttribute("headingRows")||"0");return!!i&&t.parent.index<i}}class ire extends ne{refresh(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),i=e.getSelectionAffectedTableCells(t.document.selection),s=i.length>0;this.isEnabled=s,this.value=s&&i.every(o=>fg(e,o))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.plugins.get("TableUtils"),i=this.editor.model,s=e.getSelectionAffectedTableCells(i.document.selection),o=s[0].findAncestor("table"),{first:r,last:a}=e.getColumnIndexes(s),l=this.value?r:a+1;i.change(c=>{if(l){const u=_R(o,l);for(const{cell:d,column:f}of u)vR(d,f,l,c)}at("headingColumns",l,o,c,0)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const sre=5,pg=40,ore=2;function rre(n){const t=new Set;for(const e of n.document.differ.getChanges()){let i=null;switch(e.type){case"insert":i=["table","tableRow","tableCell"].includes(e.name)?e.position:null;break;case"remove":i=["tableRow","tableCell"].includes(e.name)?e.position:null;break;case"attribute":e.range.start.nodeAfter&&(i=["table","tableRow","tableCell"].includes(e.range.start.nodeAfter.name)?e.range.start:null);break}if(!i)continue;const s=i.nodeAfter&&i.nodeAfter.is("element","table")?i.nodeAfter:i.findAncestor("table");for(const o of n.createRangeOn(s).getItems())o.is("element","table")&&fc(o)&&t.add(o)}return t}function are(n,t){return pg*100/TR(n,t)}function TR(n,t){const e=Ry(n,"tbody",t)||Ry(n,"thead",t),i=t.editing.view.domConverter.mapViewToDom(e);return bg(i)}function Ry(n,t,e){return[...[...e.editing.mapper.toViewElement(n).getChildren()].find(o=>o.is("element","table")).getChildren()].find(o=>o.is("element",t))}function bg(n){const t=j.window.getComputedStyle(n);return t.boxSizing==="border-box"?parseFloat(t.width)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderLeftWidth)-parseFloat(t.borderRightWidth):parseFloat(t.width)}function lre(n,t){const e=t.getCellLocation(n).column,i=n.getAttribute("colspan")||1;return{leftEdge:e,rightEdge:e+i-1}}function ln(n){const t=Math.pow(10,ore),e=typeof n=="number"?n:parseFloat(n);return Math.round(e*t)/t}function cre(n,t,e){return n<=t?ln(t):n>=e?ln(e):ln(n)}function ure(n,t){return Array(n).fill(t)}function Nl(n){return n.map(t=>typeof t=="number"?t:parseFloat(t)).filter(t=>!Number.isNaN(t)).reduce((t,e)=>t+e,0)}function hw(n){const t=n.map(s=>s==="auto"?s:parseFloat(s.replace("%","")));let e=dre(t);const i=Nl(e);return i!==100&&(e=e.map(s=>ln(s*100/i)).map((s,o,r)=>{if(!(o===r.length-1))return s;const l=Nl(r);return ln(s+100-l)})),e.map(s=>s+"%")}function dre(n){const t=n.filter(s=>s==="auto").length;if(t===0)return n.map(s=>ln(s));const e=Nl(n),i=Math.max((100-e)/t,sre);return n.map(s=>s==="auto"?i:s).map(s=>ln(s))}function hre(n){const t=j.window.getComputedStyle(n);return t.boxSizing==="border-box"?parseInt(t.width):parseFloat(t.width)+parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)+parseFloat(t.borderWidth)}function ER(n,t,e,i){for(let s=0;s<Math.max(e.length,n.length);s++){const o=n[s],r=e[s];r?o?i.setAttribute("columnWidth",r,o):i.appendElement("tableColumn",{columnWidth:r},t):i.remove(o)}}function fc(n){if(n.is("element","tableColumnGroup"))return n;const t=n.getChildren();return Array.from(t).find(e=>e.is("element","tableColumnGroup"))}function mc(n){const t=fc(n);return t?Array.from(t.getChildren()):[]}function fre(n){return mc(n).map(t=>t.getAttribute("columnWidth"))}function mre(n,t){return mc(n).reduce((i,s)=>{const o=s.getAttribute("columnWidth"),r=s.getAttribute("colSpan");if(!r)return i.push(o),i;for(let a=0;a<r;a++)i.push(o);return t.removeAttribute("colSpan",s),i},[])}class Lt extends A{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(t){const e=t.parent,i=e.parent,s=i.getChildIndex(e),o=new Ne(i,{row:s});for(const{cell:r,row:a,column:l}of o)if(r===t)return{row:a,column:l};/* istanbul ignore next -- @preserve */}createTable(t,e){const i=t.createElement("table"),s=e.rows||2,o=e.columns||2;return Gf(t,i,0,s,o),e.headingRows&&at("headingRows",Math.min(e.headingRows,s),i,t,0),e.headingColumns&&at("headingColumns",Math.min(e.headingColumns,o),i,t,0),i}insertRows(t,e={}){const i=this.editor.model,s=e.at||0,o=e.rows||1,r=e.copyStructureFromAbove!==void 0,a=e.copyStructureFromAbove?s-1:s,l=this.getRows(t),c=this.getColumns(t);if(s>l)throw new C("tableutils-insertrows-insert-out-of-range",this,{options:e});i.change(u=>{const d=t.getAttribute("headingRows")||0;if(d>s&&at("headingRows",d+o,t,u,0),!r&&(s===0||s===l)){Gf(u,t,s,o,c);return}const f=r?Math.max(s,a):s,m=new Ne(t,{endRow:f}),g=new Array(c).fill(1);for(const{row:p,column:w,cellHeight:v,cellWidth:_,cell:y}of m){const E=p+v-1,x=p<s&&s<=E,S=p<=a&&a<=E;x?(u.setAttribute("rowspan",v+o,y),g[w]=-_):r&&S&&(g[w]=_)}for(let p=0;p<o;p++){const w=u.createElement("tableRow");u.insert(w,t,s);for(let v=0;v<g.length;v++){const _=g[v],y=u.createPositionAt(w,"end");_>0&&Go(u,y,_>1?{colspan:_}:void 0),v+=Math.abs(_)-1}}})}insertColumns(t,e={}){const i=this.editor.model,s=e.at||0,o=e.columns||1;i.change(r=>{const a=t.getAttribute("headingColumns");s<a&&r.setAttribute("headingColumns",a+o,t);const l=this.getColumns(t);if(s===0||l===s){for(const u of t.getChildren())u.is("element","tableRow")&&wr(o,r,r.createPositionAt(u,s?"end":0));return}const c=new Ne(t,{column:s,includeAllSlots:!0});for(const u of c){const{row:d,cell:f,cellAnchorColumn:m,cellAnchorRow:g,cellWidth:p,cellHeight:w}=u;if(m<s){r.setAttribute("colspan",p+o,f);const v=g+w-1;for(let _=d;_<=v;_++)c.skipRow(_)}else wr(o,r,u.getPositionBefore())}})}removeRows(t,e){const i=this.editor.model,s=e.rows||1,o=this.getRows(t),r=e.at,a=r+s-1;if(a>o-1)throw new C("tableutils-removerows-row-index-out-of-range",this,{table:t,options:e});i.change(l=>{const c={first:r,last:a},{cellsToMove:u,cellsToTrim:d}=bre(t,c);if(u.size){const f=a+1;wre(t,f,u,l)}for(let f=a;f>=r;f--)l.remove(t.getChild(f));for(const{rowspan:f,cell:m}of d)at("rowspan",f,m,l);pre(t,c,l),mg(t,this)||gg(t,this)})}removeColumns(t,e){const i=this.editor.model,s=e.at,o=e.columns||1,r=e.at+o-1;i.change(a=>{gre(t,{first:s,last:r},a);const l=mc(t);for(let c=r;c>=s;c--){for(const{cell:u,column:d,cellWidth:f}of[...new Ne(t)])d<=c&&f>1&&d+f>c?at("colspan",f-1,u,a):d===c&&a.remove(u);if(l[c]){const u=c===0?l[1]:l[c-1],d=parseFloat(l[c].getAttribute("columnWidth")),f=parseFloat(u.getAttribute("columnWidth"));a.remove(l[c]),a.setAttribute("columnWidth",d+f+"%",u)}}gg(t,this)||mg(t,this)})}splitCellVertically(t,e=2){const i=this.editor.model,o=t.parent.parent,r=parseInt(t.getAttribute("rowspan")||"1"),a=parseInt(t.getAttribute("colspan")||"1");i.change(l=>{if(a>1){const{newCellsSpan:c,updatedSpan:u}=Ly(a,e);at("colspan",u,t,l);const d={};c>1&&(d.colspan=c),r>1&&(d.rowspan=r);const f=a>e?e-1:a-1;wr(f,l,l.createPositionAfter(t),d)}if(a<e){const c=e-a,u=[...new Ne(o)],{column:d}=u.find(({cell:p})=>p===t),f=u.filter(({cell:p,cellWidth:w,column:v})=>{const _=p!==t&&v===d,y=v<d&&v+w>d;return _||y});for(const{cell:p,cellWidth:w}of f)l.setAttribute("colspan",w+c,p);const m={};r>1&&(m.rowspan=r),wr(c,l,l.createPositionAfter(t),m);const g=o.getAttribute("headingColumns")||0;g>d&&at("headingColumns",g+c,o,l)}})}splitCellHorizontally(t,e=2){const i=this.editor.model,s=t.parent,o=s.parent,r=o.getChildIndex(s),a=parseInt(t.getAttribute("rowspan")||"1"),l=parseInt(t.getAttribute("colspan")||"1");i.change(c=>{if(a>1){const u=[...new Ne(o,{startRow:r,endRow:r+a-1,includeAllSlots:!0})],{newCellsSpan:d,updatedSpan:f}=Ly(a,e);at("rowspan",f,t,c);const{column:m}=u.find(({cell:p})=>p===t),g={};d>1&&(g.rowspan=d),l>1&&(g.colspan=l);for(const p of u){const{column:w,row:v}=p,_=v>=r+f,y=w===m,E=(v+r+f)%d===0;_&&y&&E&&wr(1,c,p.getPositionBefore(),g)}}if(a<e){const u=e-a,d=[...new Ne(o,{startRow:0,endRow:r})];for(const{cell:g,cellHeight:p,row:w}of d)if(g!==t&&w+p>r){const v=p+u;c.setAttribute("rowspan",v,g)}const f={};l>1&&(f.colspan=l),Gf(c,o,r+1,u,1,f);const m=o.getAttribute("headingRows")||0;m>r&&at("headingRows",m+u,o,c)}})}getColumns(t){return[...t.getChild(0).getChildren()].filter(i=>i.is("element","tableCell")).reduce((i,s)=>{const o=parseInt(s.getAttribute("colspan")||"1");return i+o},0)}getRows(t){return Array.from(t.getChildren()).reduce((e,i)=>i.is("element","tableRow")?e+1:e,0)}createTableWalker(t,e={}){return new Ne(t,e)}getSelectedTableCells(t){const e=[];for(const i of this.sortRanges(t.getRanges())){const s=i.getContainedElement();s&&s.is("element","tableCell")&&e.push(s)}return e}getTableCellsContainingSelection(t){const e=[];for(const i of t.getRanges()){const s=i.start.findAncestor("tableCell");s&&e.push(s)}return e}getSelectionAffectedTableCells(t){const e=this.getSelectedTableCells(t);return e.length?e:this.getTableCellsContainingSelection(t)}getRowIndexes(t){const e=t.map(i=>i.parent.index);return this._getFirstLastIndexesObject(e)}getColumnIndexes(t){const e=t[0].findAncestor("table"),s=[...new Ne(e)].filter(o=>t.includes(o.cell)).map(o=>o.column);return this._getFirstLastIndexesObject(s)}isSelectionRectangular(t){if(t.length<2||!this._areCellInTheSameTableSection(t))return!1;const e=new Set,i=new Set;let s=0;for(const r of t){const{row:a,column:l}=this.getCellLocation(r),c=parseInt(r.getAttribute("rowspan"))||1,u=parseInt(r.getAttribute("colspan"))||1;e.add(a),i.add(l),c>1&&e.add(a+c-1),u>1&&i.add(l+u-1),s+=c*u}return vre(e,i)==s}sortRanges(t){return Array.from(t).sort(_re)}_getFirstLastIndexesObject(t){const e=t.sort((o,r)=>o-r),i=e[0],s=e[e.length-1];return{first:i,last:s}}_areCellInTheSameTableSection(t){const e=t[0].findAncestor("table"),i=this.getRowIndexes(t),s=parseInt(e.getAttribute("headingRows"))||0;if(!this._areIndexesInSameSection(i,s))return!1;const o=this.getColumnIndexes(t),r=parseInt(e.getAttribute("headingColumns"))||0;return this._areIndexesInSameSection(o,r)}_areIndexesInSameSection({first:t,last:e},i){const s=t<i,o=e<i;return s===o}}function Gf(n,t,e,i,s,o={}){for(let r=0;r<i;r++){const a=n.createElement("tableRow");n.insert(a,t,e),wr(s,n,n.createPositionAt(a,"end"),o)}}function wr(n,t,e,i={}){for(let s=0;s<n;s++)Go(t,e,i)}function Ly(n,t){if(n<t)return{newCellsSpan:1,updatedSpan:1};const e=Math.floor(n/t),i=n-e*t+e;return{newCellsSpan:e,updatedSpan:i}}function gre(n,t,e){const i=n.getAttribute("headingColumns")||0;if(i&&t.first<i){const s=Math.min(i-1,t.last)-t.first+1;e.setAttribute("headingColumns",i-s,n)}}function pre(n,{first:t,last:e},i){const s=n.getAttribute("headingRows")||0;if(t<s){const o=e<s?s-(e-t+1):t;at("headingRows",o,n,i,0)}}function bre(n,{first:t,last:e}){const i=new Map,s=[];for(const{row:o,column:r,cellHeight:a,cell:l}of new Ne(n,{endRow:e})){const c=o+a-1;if(o>=t&&o<=e&&c>e){const f=e-o+1,m=a-f;i.set(r,{cell:l,rowspan:m})}if(o<t&&c>=t){let f;c>=e?f=e-t+1:f=c-t+1,s.push({cell:l,rowspan:a-f})}}return{cellsToMove:i,cellsToTrim:s}}function wre(n,t,e,i){const o=[...new Ne(n,{includeAllSlots:!0,row:t})],r=n.getChild(t);let a;for(const{column:l,cell:c,isAnchor:u}of o)if(e.has(l)){const{cell:d,rowspan:f}=e.get(l),m=a?i.createPositionAfter(a):i.createPositionAt(r,0);i.move(i.createRangeOn(d),m),at("rowspan",f,d,i),a=d}else u&&(a=c)}function _re(n,t){const e=n.start,i=t.start;return e.isBefore(i)?-1:1}function vre(n,t){const e=Array.from(n.values()),i=Array.from(t.values()),s=Math.max(...e),o=Math.min(...e),r=Math.max(...i),a=Math.min(...i);return(s-o+1)*(r-a+1)}class yre extends ne{refresh(){const t=this.editor.plugins.get(Lt),e=t.getSelectedTableCells(this.editor.model.document.selection);this.isEnabled=t.isSelectionRectangular(e)}execute(){const t=this.editor.model,e=this.editor.plugins.get(Lt);t.change(i=>{const s=e.getSelectedTableCells(t.document.selection),o=s.shift(),{mergeWidth:r,mergeHeight:a}=kre(o,s,e);at("colspan",r,o,i),at("rowspan",a,o,i);for(const c of s)Cre(c,o,i);const l=o.findAncestor("table");dw(l,e),i.setSelection(o,"in")})}}function Cre(n,t,e){Vy(n)||(Vy(t)&&e.remove(e.createRangeIn(t)),e.move(e.createRangeIn(n),e.createPositionAt(t,"end"))),e.remove(n)}function Vy(n){const t=n.getChild(0);return n.childCount==1&&t.is("element","paragraph")&&t.isEmpty}function kre(n,t,e){let i=0,s=0;for(const c of t){const{row:u,column:d}=e.getCellLocation(c);i=By(c,d,i,"colspan"),s=By(c,u,s,"rowspan")}const{row:o,column:r}=e.getCellLocation(n),a=i-r,l=s-o;return{mergeWidth:a,mergeHeight:l}}function By(n,t,e,i){const s=parseInt(n.getAttribute(i)||"1");return Math.max(e,t+s)}class Tre extends ne{constructor(t){super(t),this.affectsData=!1}refresh(){const e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),i=e.getSelectionAffectedTableCells(t.document.selection),s=e.getRowIndexes(i),o=i[0].findAncestor("table"),r=[];for(let a=s.first;a<=s.last;a++)for(const l of o.getChild(a).getChildren())r.push(t.createRangeOn(l));t.change(a=>{a.setSelection(r)})}}class Ere extends ne{constructor(t){super(t),this.affectsData=!1}refresh(){const e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const t=this.editor.plugins.get("TableUtils"),e=this.editor.model,i=t.getSelectionAffectedTableCells(e.document.selection),s=i[0],o=i.pop(),r=s.findAncestor("table"),a=t.getCellLocation(s),l=t.getCellLocation(o),c=Math.min(a.column,l.column),u=Math.max(a.column,l.column),d=[];for(const f of new Ne(r,{startColumn:c,endColumn:u}))d.push(e.createRangeOn(f.cell));e.change(f=>{f.setSelection(d)})}}function Are(n){n.document.registerPostFixer(t=>xre(t,n))}function xre(n,t){const e=t.document.differ.getChanges();let i=!1;const s=new Set;for(const o of e){let r=null;o.type=="insert"&&o.name=="table"&&(r=o.position.nodeAfter),(o.type=="insert"||o.type=="remove")&&(o.name=="tableRow"||o.name=="tableCell")&&(r=o.position.findAncestor("table")),Lre(o)&&(r=o.range.start.findAncestor("table")),r&&!s.has(r)&&(i=Sre(r,n)||i,i=Ire(r,n)||i,s.add(r))}return i}function Sre(n,t){let e=!1;const i=Pre(n);if(i.length){e=!0;for(const s of i)at("rowspan",s.rowspan,s.cell,t,1)}return e}function Ire(n,t){let e=!1;const i=Rre(n),s=[];for(const[l,c]of i.entries())!c&&n.getChild(l).is("element","tableRow")&&s.push(l);if(s.length){e=!0;for(const l of s.reverse())t.remove(n.getChild(l)),i.splice(l,1)}const o=i.filter((l,c)=>n.getChild(c).is("element","tableRow")),r=o[0];if(!o.every(l=>l===r)){const l=o.reduce((c,u)=>u>c?u:c,0);for(const[c,u]of o.entries()){const d=l-u;if(d){for(let f=0;f<d;f++)Go(t,t.createPositionAt(n.getChild(c),"end"));e=!0}}}return e}function Pre(n){const t=parseInt(n.getAttribute("headingRows")||"0"),e=Array.from(n.getChildren()).reduce((s,o)=>o.is("element","tableRow")?s+1:s,0),i=[];for(const{row:s,cell:o,cellHeight:r}of new Ne(n)){if(r<2)continue;const l=s<t?t:e;if(s+r>l){const c=l-s;i.push({cell:o,rowspan:c})}}return i}function Rre(n){const t=new Array(n.childCount).fill(0);for(const{rowIndex:e}of new Ne(n,{includeAllSlots:!0}))t[e]++;return t}function Lre(n){if(n.type!=="attribute")return!1;const t=n.attributeKey;return t==="headingRows"||t==="colspan"||t==="rowspan"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Vre(n){n.document.registerPostFixer(t=>Bre(t,n))}function Bre(n,t){const e=t.document.differ.getChanges();let i=!1;for(const s of e)s.type=="insert"&&s.name=="table"&&(i=Mre(s.position.nodeAfter,n)||i),s.type=="insert"&&s.name=="tableRow"&&(i=AR(s.position.nodeAfter,n)||i),s.type=="insert"&&s.name=="tableCell"&&(i=wg(s.position.nodeAfter,n)||i),(s.type=="remove"||s.type=="insert")&&Ore(s)&&(i=wg(s.position.parent,n)||i);return i}function Mre(n,t){let e=!1;for(const i of n.getChildren())i.is("element","tableRow")&&(e=AR(i,t)||e);return e}function AR(n,t){let e=!1;for(const i of n.getChildren())e=wg(i,t)||e;return e}function wg(n,t){if(n.childCount==0)return t.insertElement("paragraph",n),!0;const e=Array.from(n.getChildren()).filter(i=>i.is("$text"));for(const i of e)t.wrap(t.createRangeOn(i),"paragraph");return!!e.length}function Ore(n){return n.position.parent.is("element","tableCell")?n.type=="insert"&&n.name=="$text"||n.type=="remove":!1}function Nre(n,t){const e=n.document.differ;for(const i of e.getChanges()){let s,o=!1;if(i.type=="attribute"){const c=i.range.start.nodeAfter;if(!c||!c.is("element","table")||i.attributeKey!="headingRows"&&i.attributeKey!="headingColumns")continue;s=c,o=i.attributeKey=="headingRows"}else(i.name=="tableRow"||i.name=="tableCell")&&(s=i.position.findAncestor("table"),o=i.name=="tableRow");if(!s)continue;const r=s.getAttribute("headingRows")||0,a=s.getAttribute("headingColumns")||0,l=new Ne(s);for(const c of l){const d=c.row<r||c.column<a?"th":"td",f=t.mapper.toViewElement(c.cell);f&&f.is("element")&&f.name!=d&&t.reconvertItem(o?c.cell.parent:c.cell)}}}function Fre(n,t){const e=n.document.differ,i=new Set;for(const s of e.getChanges()){const o=s.type=="attribute"?s.range.start.parent:s.position.parent;o.is("element","tableCell")&&i.add(o)}for(const s of i.values()){const o=Array.from(s.getChildren()).filter(r=>Dre(r,t.mapper));for(const r of o)t.reconvertItem(r)}}function Dre(n,t){if(!n.is("element","paragraph"))return!1;const e=t.toViewElement(n);return e?gR(n)!==e.is("element","span"):!1}class gc extends A{constructor(e){super(e);h(this,"_additionalSlots");this._additionalSlots=[]}static get pluginName(){return"TableEditing"}static get requires(){return[Lt]}init(){const e=this.editor,i=e.model,s=i.schema,o=e.conversion,r=e.plugins.get(Lt);s.register("table",{inheritAllFrom:"$blockObject",allowAttributes:["headingRows","headingColumns"]}),s.register("tableRow",{allowIn:"table",isLimit:!0}),s.register("tableCell",{allowContentOf:"$container",allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),o.for("upcast").add(Moe()),o.for("upcast").add(Ooe()),o.for("editingDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:Ty(r,{asWidget:!0,additionalSlots:this._additionalSlots})}),o.for("dataDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:Ty(r,{additionalSlots:this._additionalSlots})}),o.for("upcast").elementToElement({model:"tableRow",view:"tr"}),o.for("upcast").add(Noe()),o.for("downcast").elementToElement({model:"tableRow",view:zoe()}),o.for("upcast").elementToElement({model:"tableCell",view:"td"}),o.for("upcast").elementToElement({model:"tableCell",view:"th"}),o.for("upcast").add(ky("td")),o.for("upcast").add(ky("th")),o.for("editingDowncast").elementToElement({model:"tableCell",view:Ey({asWidget:!0})}),o.for("dataDowncast").elementToElement({model:"tableCell",view:Ey()}),o.for("editingDowncast").elementToElement({model:"paragraph",view:Ay({asWidget:!0}),converterPriority:"high"}),o.for("dataDowncast").elementToElement({model:"paragraph",view:Ay(),converterPriority:"high"}),o.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),o.for("upcast").attributeToAttribute({model:{key:"colspan",value:My("colspan")},view:"colspan"}),o.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),o.for("upcast").attributeToAttribute({model:{key:"rowspan",value:My("rowspan")},view:"rowspan"}),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new qoe(e)),e.commands.add("insertTableRowAbove",new xy(e,{order:"above"})),e.commands.add("insertTableRowBelow",new xy(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new Sy(e,{order:"left"})),e.commands.add("insertTableColumnRight",new Sy(e,{order:"right"})),e.commands.add("removeTableRow",new Yoe(e)),e.commands.add("removeTableColumn",new Qoe(e)),e.commands.add("splitTableCellVertically",new Iy(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new Iy(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new yre(e)),e.commands.add("mergeTableCellRight",new su(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new su(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new su(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new su(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new ire(e)),e.commands.add("setTableRowHeader",new nre(e)),e.commands.add("selectTableRow",new Tre(e)),e.commands.add("selectTableColumn",new Ere(e)),Are(i),Vre(i),this.listenTo(i.document,"change:data",()=>{Nre(i,e.editing),Fre(i,e.editing)})}registerAdditionalSlot(e){this._additionalSlots.push(e)}}function My(n){return t=>{const e=parseInt(t.getAttribute(n));return Number.isNaN(e)||e<=0?null:e}}class Oy extends q{constructor(e){super(e);h(this,"items");h(this,"keystrokes");h(this,"focusTracker");const i=this.bindTemplate;this.items=this._createGridCollection(),this.keystrokes=new tt,this.focusTracker=new Ge,this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(s,o)=>`${o} × ${s}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":i.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck","ck-insert-table-dropdown__label"],"aria-hidden":!0},children:[{text:i.to("label")}]}],on:{mousedown:i.to(s=>{s.preventDefault()}),click:i.to(()=>{this.fire("execute")})}}),this.on("boxover",(s,o)=>{const{row:r,column:a}=o.target.dataset;this.items.get((parseInt(r,10)-1)*10+(parseInt(a,10)-1)).focus()}),this.focusTracker.on("change:focusedElement",(s,o,r)=>{if(!r)return;const{row:a,column:l}=r.dataset;this.set({rows:parseInt(a),columns:parseInt(l)})}),this.on("change:columns",()=>this._highlightGridBoxes()),this.on("change:rows",()=>this._highlightGridBoxes())}render(){super.render(),Bh({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:10,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}reset(){this.set({rows:1,columns:1})}focus(){this.items.get(0).focus()}focusLast(){this.items.get(0).focus()}_highlightGridBoxes(){const e=this.rows,i=this.columns;this.items.map((s,o)=>{const r=Math.floor(o/10),a=o%10,l=r<e&&a<i;s.set("isOn",l)})}_createGridButton(e,i,s,o){const r=new te(e);return r.set({label:o,class:"ck-insert-table-dropdown-grid-box"}),r.extendTemplate({attributes:{"data-row":i,"data-column":s}}),r}_createGridCollection(){const e=[];for(let i=0;i<100;i++){const s=Math.floor(i/10),o=i%10,r=`${s+1} × ${o+1}`;e.push(this._createGridButton(this.locale,s+1,o+1,r))}return this.createCollection(e)}}var $re='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',Hre='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',zre='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';class Ure extends A{static get pluginName(){return"TableUI"}init(){const t=this.editor,e=this.editor.t,s=t.locale.contentLanguageDirection==="ltr";t.ui.componentFactory.add("insertTable",o=>{const r=t.commands.get("insertTable"),a=Yt(o);a.bind("isEnabled").to(r),a.buttonView.set({icon:F.table,label:e("Insert table"),tooltip:!0});let l;return a.on("change:isOpen",()=>{l||(l=new Oy(o),a.panelView.children.add(l),l.delegate("execute").to(a),a.on("execute",()=>{t.execute("insertTable",{rows:l.rows,columns:l.columns}),t.editing.view.focus()}))}),a}),t.ui.componentFactory.add("menuBar:insertTable",o=>{const r=t.commands.get("insertTable"),a=new ui(o),l=new Oy(o);return l.delegate("execute").to(a),a.on("change:isOpen",(c,u,d)=>{d||l.reset()}),l.on("execute",()=>{t.execute("insertTable",{rows:l.rows,columns:l.columns}),t.editing.view.focus()}),a.buttonView.set({label:e("Table"),icon:F.table}),a.panelView.children.add(l),a.bind("isEnabled").to(r),a}),t.ui.componentFactory.add("tableColumn",o=>{const r=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:e("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:s?"insertTableColumnLeft":"insertTableColumnRight",label:e("Insert column left")}},{type:"button",model:{commandName:s?"insertTableColumnRight":"insertTableColumnLeft",label:e("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:e("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:e("Select column")}}];return this._prepareDropdown(e("Column"),$re,r,o)}),t.ui.componentFactory.add("tableRow",o=>{const r=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:e("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:e("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:e("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:e("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:e("Select row")}}];return this._prepareDropdown(e("Row"),Hre,r,o)}),t.ui.componentFactory.add("mergeTableCells",o=>{const r=[{type:"button",model:{commandName:"mergeTableCellUp",label:e("Merge cell up")}},{type:"button",model:{commandName:s?"mergeTableCellRight":"mergeTableCellLeft",label:e("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:e("Merge cell down")}},{type:"button",model:{commandName:s?"mergeTableCellLeft":"mergeTableCellRight",label:e("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:e("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:e("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(e("Merge cells"),zre,r,o)})}_prepareDropdown(t,e,i,s){const o=this.editor,r=Yt(s),a=this._fillDropdownWithListOptions(r,i);return r.buttonView.set({label:t,icon:e,tooltip:!0}),r.bind("isEnabled").toMany(a,"isEnabled",(...l)=>l.some(c=>c)),this.listenTo(r,"execute",l=>{o.execute(l.source.commandName),l.source instanceof rc||o.editing.view.focus()}),r}_prepareMergeSplitButtonDropdown(t,e,i,s){const o=this.editor,r=Yt(s,la),a="mergeTableCells",l=o.commands.get(a),c=this._fillDropdownWithListOptions(r,i);return r.buttonView.set({label:t,icon:e,tooltip:!0,isEnabled:!0}),r.bind("isEnabled").toMany([l,...c],"isEnabled",(...u)=>u.some(d=>d)),this.listenTo(r.buttonView,"execute",()=>{o.execute(a),o.editing.view.focus()}),this.listenTo(r,"execute",u=>{o.execute(u.source.commandName),o.editing.view.focus()}),r}_fillDropdownWithListOptions(t,e){const i=this.editor,s=[],o=new rn;for(const r of e)Wre(r,i,s,o);return ca(t,o),s}}function Wre(n,t,e,i){if(n.type==="button"||n.type==="switchbutton"){const s=n.model=new Wr(n.model),{commandName:o,bindIsOn:r}=n.model,a=t.commands.get(o);e.push(a),s.set({commandName:o}),s.bind("isEnabled").to(a),r&&s.bind("isOn").to(a,"value"),s.set({withText:!0})}i.add(n)}class Co extends A{static get pluginName(){return"TableSelection"}static get requires(){return[Lt,Lt]}init(){const t=this.editor,e=t.model,i=t.editing.view;this.listenTo(e,"deleteContent",(s,o)=>this._handleDeleteContent(s,o),{priority:"high"}),this.listenTo(i.document,"insertText",(s,o)=>this._handleInsertTextEvent(s,o),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const t=this.editor.plugins.get(Lt),e=this.editor.model.document.selection,i=t.getSelectedTableCells(e);return i.length==0?null:i}getSelectionAsFragment(){const t=this.editor.plugins.get(Lt),e=this.getSelectedTableCells();return e?this.editor.model.change(i=>{const s=i.createDocumentFragment(),{first:o,last:r}=t.getColumnIndexes(e),{first:a,last:l}=t.getRowIndexes(e),c=e[0].findAncestor("table");let u=l,d=r;if(t.isSelectionRectangular(e)){const g={firstColumn:o,lastColumn:r,firstRow:a,lastRow:l};u=CR(c,g),d=kR(c,g)}const m=pR(c,{startRow:a,startColumn:o,endRow:u,endColumn:d},i);return i.insert(m,s,0),s}):null}setCellSelection(t,e){const i=this._getCellsToSelect(t,e);this.editor.model.change(s=>{s.setSelection(i.cells.map(o=>s.createRangeOn(o)),{backward:i.backward})})}getFocusCell(){const i=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return i&&i.is("element","tableCell")?i:null}getAnchorCell(){const t=this.editor.model.document.selection,i=Ye(t.getRanges()).getContainedElement();return i&&i.is("element","tableCell")?i:null}_defineSelectionConverter(){const t=this.editor,e=new Set;t.conversion.for("editingDowncast").add(s=>s.on("selection",(o,r,a)=>{const l=a.writer;i(l);const c=this.getSelectedTableCells();if(!c)return;for(const d of c){const f=a.mapper.toViewElement(d);l.addClass("ck-editor__editable_selected",f),e.add(f)}const u=a.mapper.toViewElement(c[c.length-1]);l.setSelection(u,0)},{priority:"lowest"}));function i(s){for(const o of e)s.removeClass("ck-editor__editable_selected",o);e.clear()}}_enablePluginDisabling(){const t=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const e=this.getSelectedTableCells();if(!e)return;t.model.change(i=>{const s=i.createPositionAt(e[0],0),o=t.model.schema.getNearestSelectionRange(s);i.setSelection(o)})}})}_handleDeleteContent(t,e){const i=this.editor.plugins.get(Lt),s=e[0],o=e[1],r=this.editor.model,a=!o||o.direction=="backward",l=i.getSelectedTableCells(s);l.length&&(t.stop(),r.change(c=>{const u=l[a?l.length-1:0];r.change(f=>{for(const m of l)r.deleteContent(f.createSelection(m,"in"))});const d=r.schema.getNearestSelectionRange(c.createPositionAt(u,0));s.is("documentSelection")?c.setSelection(d):s.setTo(d)}))}_handleInsertTextEvent(t,e){const i=this.editor,s=this.getSelectedTableCells();if(!s)return;const o=i.editing.view,r=i.editing.mapper,a=s.map(l=>o.createRangeOn(r.toViewElement(l)));e.selection=o.createSelection(a)}_getCellsToSelect(t,e){const i=this.editor.plugins.get("TableUtils"),s=i.getCellLocation(t),o=i.getCellLocation(e),r=Math.min(s.row,o.row),a=Math.max(s.row,o.row),l=Math.min(s.column,o.column),c=Math.max(s.column,o.column),u=new Array(a-r+1).fill(null).map(()=>[]),d={startRow:r,endRow:a,startColumn:l,endColumn:c};for(const{row:g,cell:p}of new Ne(t.findAncestor("table"),d))u[g-r].push(p);const f=o.row<s.row,m=o.column<s.column;return f&&u.reverse(),m&&u.forEach(g=>g.reverse()),{cells:u.flat(),backward:f||m}}}class qre extends A{static get pluginName(){return"TableClipboard"}static get requires(){return[il,Hn,Co,Lt]}init(){const t=this.editor,e=t.editing.view.document;this.listenTo(e,"copy",(i,s)=>this._onCopyCut(i,s)),this.listenTo(e,"cut",(i,s)=>this._onCopyCut(i,s)),this.listenTo(t.model,"insertContent",(i,[s,o])=>this._onInsertContent(i,s,o),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(t,e){const i=this.editor.editing.view,s=this.editor.plugins.get(Co),o=this.editor.plugins.get(il);s.getSelectedTableCells()&&(t.name=="cut"&&!this.editor.model.canEditAt(this.editor.model.document.selection)||(e.preventDefault(),t.stop(),this.editor.model.enqueueChange({isUndoable:t.name==="cut"},()=>{const r=o._copySelectedFragmentWithMarkers(t.name,this.editor.model.document.selection,()=>s.getSelectionAsFragment());i.document.fire("clipboardOutput",{dataTransfer:e.dataTransfer,content:this.editor.data.toView(r),method:t.name})})))}_onInsertContent(t,e,i){if(i&&!i.is("documentSelection"))return;const s=this.editor.model,o=this.editor.plugins.get(Lt),r=this.editor.plugins.get(il),a=this.getTableIfOnlyTableInContent(e,s);if(!a)return;const l=o.getSelectionAffectedTableCells(s.document.selection);if(!l.length){dw(a,o);return}t.stop(),e.is("documentFragment")?r._pasteMarkersIntoTransformedElement(e.markers,c=>this._replaceSelectedCells(a,l,c)):this.editor.model.change(c=>{this._replaceSelectedCells(a,l,c)})}_replaceSelectedCells(t,e,i){const s=this.editor.plugins.get(Lt),o={width:s.getColumns(t),height:s.getRows(t)},r=jre(e,o,i,s),a=r.lastRow-r.firstRow+1,l=r.lastColumn-r.firstColumn+1,c={startRow:0,startColumn:0,endRow:Math.min(a,o.height)-1,endColumn:Math.min(l,o.width)-1};t=pR(t,c,i);const u=e[0].findAncestor("table"),d=this._replaceSelectedCellsWithPasted(t,o,u,r,i);if(this.editor.plugins.get("TableSelection").isEnabled){const f=s.sortRanges(d.map(m=>i.createRangeOn(m)));i.setSelection(f)}else i.setSelection(d[0],0);return u}_replaceSelectedCellsWithPasted(t,e,i,s,o){const{width:r,height:a}=e,l=Kre(t,r,a),c=[...new Ne(i,{startRow:s.firstRow,endRow:s.lastRow,startColumn:s.firstColumn,endColumn:s.lastColumn,includeAllSlots:!0})],u=[];let d;for(const w of c){const{row:v,column:_}=w;_===s.firstColumn&&(d=w.getPositionBefore());const y=v-s.firstRow,E=_-s.firstColumn,x=l[y%a][E%r],S=x?o.cloneElement(x):null,R=this._replaceTableSlotCell(w,S,d,o);R&&(yR(R,v,_,s.lastRow,s.lastColumn,o),u.push(R),d=o.createPositionAfter(R))}const f=parseInt(i.getAttribute("headingRows")||"0"),m=parseInt(i.getAttribute("headingColumns")||"0"),g=s.firstRow<f&&f<=s.lastRow,p=s.firstColumn<m&&m<=s.lastColumn;if(g){const w={first:s.firstColumn,last:s.lastColumn},v=_g(i,f,w,o,s.firstRow);u.push(...v)}if(p){const w={first:s.firstRow,last:s.lastRow},v=vg(i,m,w,o);u.push(...v)}return u}_replaceTableSlotCell(t,e,i,s){const{cell:o,isAnchor:r}=t;return r&&s.remove(o),e?(s.insert(e,i),e):null}getTableIfOnlyTableInContent(t,e){if(!t.is("documentFragment")&&!t.is("element"))return null;if(t.is("element","table"))return t;if(t.childCount==1&&t.getChild(0).is("element","table"))return t.getChild(0);const i=e.createRangeIn(t);for(const s of i.getItems())if(s.is("element","table")){const o=e.createRange(i.start,e.createPositionBefore(s));if(e.hasContent(o,{ignoreWhitespaces:!0}))return null;const r=e.createRange(e.createPositionAfter(s),i.end);return e.hasContent(r,{ignoreWhitespaces:!0})?null:s}return null}}function jre(n,t,e,i){const s=n[0].findAncestor("table"),o=i.getColumnIndexes(n),r=i.getRowIndexes(n),a={firstColumn:o.first,lastColumn:o.last,firstRow:r.first,lastRow:r.last},l=n.length===1;return l&&(a.lastRow+=t.height-1,a.lastColumn+=t.width-1,Gre(s,a.lastRow+1,a.lastColumn+1,i)),l||!i.isSelectionRectangular(n)?Zre(s,a,e):(a.lastRow=CR(s,a),a.lastColumn=kR(s,a)),a}function Gre(n,t,e,i){const s=i.getColumns(n),o=i.getRows(n);e>s&&i.insertColumns(n,{at:s,columns:e-s}),t>o&&i.insertRows(n,{at:o,rows:t-o})}function Kre(n,t,e){const i=new Array(e).fill(null).map(()=>new Array(t).fill(null));for(const{column:s,row:o,cell:r}of new Ne(n))i[o][s]=r;return i}function Zre(n,t,e){const{firstRow:i,lastRow:s,firstColumn:o,lastColumn:r}=t,a={first:i,last:s},l={first:o,last:r};vg(n,o,a,e),vg(n,r+1,a,e),_g(n,i,l,e),_g(n,s+1,l,e,i)}function _g(n,t,e,i,s=0){return t<1?void 0:bR(n,t,s).filter(({column:a,cellWidth:l})=>xR(a,l,e)).map(({cell:a})=>wR(a,t,i))}function vg(n,t,e,i){return t<1?void 0:_R(n,t).filter(({row:r,cellHeight:a})=>xR(r,a,e)).map(({cell:r,column:a})=>vR(r,a,t,i))}function xR(n,t,e){const i=n+t-1,{first:s,last:o}=e,r=n>=s&&n<=o,a=n<s&&i>=s;return r||a}class Jre extends A{static get pluginName(){return"TableKeyboard"}static get requires(){return[Co,Lt]}init(){const t=this.editor,i=t.editing.view.document,s=t.t;this.listenTo(i,"arrowKey",(...o)=>this._onArrowKey(...o),{context:"table"}),this.listenTo(i,"tab",(...o)=>this._handleTabOnSelectedTable(...o),{context:"figure"}),this.listenTo(i,"tab",(...o)=>this._handleTab(...o),{context:["th","td"]}),t.accessibility.addKeystrokeInfoGroup({id:"table",label:s("Keystrokes that can be used in a table cell"),keystrokes:[{label:s("Move the selection to the next cell"),keystroke:"Tab"},{label:s("Move the selection to the previous cell"),keystroke:"Shift+Tab"},{label:s("Insert a new table row (when in the last cell of a table)"),keystroke:"Tab"},{label:s("Navigate through the table"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]}]})}_handleTabOnSelectedTable(t,e){const i=this.editor,o=i.model.document.selection.getSelectedElement();!o||!o.is("element","table")||(e.preventDefault(),e.stopPropagation(),t.stop(),i.model.change(r=>{r.setSelection(r.createRangeIn(o.getChild(0).getChild(0)))}))}_handleTab(t,e){const i=this.editor,s=this.editor.plugins.get(Lt),o=this.editor.plugins.get("TableSelection"),r=i.model.document.selection,a=!e.shiftKey;let l=s.getTableCellsContainingSelection(r)[0];if(l||(l=o.getFocusCell()),!l)return;e.preventDefault(),e.stopPropagation(),t.stop();const c=l.parent,u=c.parent,d=u.getChildIndex(c),f=c.getChildIndex(l),m=f===0;if(!a&&m&&d===0){i.model.change(v=>{v.setSelection(v.createRangeOn(u))});return}const g=f===c.childCount-1,p=d===s.getRows(u)-1;if(a&&p&&g&&(i.execute("insertTableRowBelow"),d===s.getRows(u)-1)){i.model.change(v=>{v.setSelection(v.createRangeOn(u))});return}let w;if(a&&g)w=u.getChild(d+1).getChild(0);else if(!a&&m){const v=u.getChild(d-1);w=v.getChild(v.childCount-1)}else w=c.getChild(f+(a?1:-1));i.model.change(v=>{v.setSelection(v.createRangeIn(w))})}_onArrowKey(t,e){const i=this.editor,s=e.keyCode,o=Eh(s,i.locale.contentLanguageDirection);this._handleArrowKeys(o,e.shiftKey)&&(e.preventDefault(),e.stopPropagation(),t.stop())}_handleArrowKeys(t,e){const i=this.editor.plugins.get(Lt),s=this.editor.plugins.get("TableSelection"),o=this.editor.model,r=o.document.selection,a=["right","down"].includes(t),l=i.getSelectedTableCells(r);if(l.length){let u;return e?u=s.getFocusCell():u=a?l[l.length-1]:l[0],this._navigateFromCellInDirection(u,t,e),!0}const c=r.focus.findAncestor("tableCell");/* istanbul ignore if: paranoid check -- @preserve */if(!c)return!1;if(!r.isCollapsed)if(e){if(r.isBackward==a&&!r.containsEntireContent(c))return!1}else{const u=r.getSelectedElement();if(!u||!o.schema.isObject(u))return!1}return this._isSelectionAtCellEdge(r,c,a)?(this._navigateFromCellInDirection(c,t,e),!0):!1}_isSelectionAtCellEdge(t,e,i){const s=this.editor.model,o=this.editor.model.schema,r=i?t.getLastPosition():t.getFirstPosition();if(!o.getLimitElement(r).is("element","tableCell"))return s.createPositionAt(e,i?"end":0).isTouching(r);const a=s.createSelection(r);return s.modifySelection(a,{direction:i?"forward":"backward"}),r.isEqual(a.focus)}_navigateFromCellInDirection(t,e,i=!1){const s=this.editor.model,o=t.findAncestor("table"),r=[...new Ne(o,{includeAllSlots:!0})],{row:a,column:l}=r[r.length-1],c=r.find(({cell:_})=>_==t);let{row:u,column:d}=c;switch(e){case"left":d--;break;case"up":u--;break;case"right":d+=c.cellWidth;break;case"down":u+=c.cellHeight;break}const f=u<0||u>a,m=d<0&&u<=0,g=d>l&&u>=a;if(f||m||g){s.change(_=>{_.setSelection(_.createRangeOn(o))});return}d<0?(d=i?0:l,u--):d>l&&(d=i?l:0,u++);const p=r.find(_=>_.row==u&&_.column==d).cell,w=["right","down"].includes(e),v=this.editor.plugins.get("TableSelection");if(i&&v.isEnabled){const _=v.getAnchorCell()||t;v.setCellSelection(_,p)}else{const _=s.createPositionAt(p,w?0:"end");s.change(y=>{y.setSelection(_)})}}}class SR extends fs{constructor(){super(...arguments);h(this,"domEventType",["mousemove","mouseleave"])}onDomEvent(e){this.fire(e.type,e)}}class Yre extends A{static get pluginName(){return"TableMouse"}static get requires(){return[Co,Lt]}init(){this.editor.editing.view.addObserver(SR),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const t=this.editor,e=t.plugins.get(Lt);let i=!1;const s=t.plugins.get(Co);this.listenTo(t.editing.view.document,"mousedown",(o,r)=>{const a=t.model.document.selection;if(!this.isEnabled||!s.isEnabled||!r.domEvent.shiftKey)return;const l=s.getAnchorCell()||e.getTableCellsContainingSelection(a)[0];if(!l)return;const c=this._getModelTableCellFromDomEvent(r);c&&Ny(l,c)&&(i=!0,s.setCellSelection(l,c),r.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{i=!1}),this.listenTo(t.editing.view.document,"selectionChange",o=>{i&&o.stop()},{priority:"highest"})}_enableMouseDragSelection(){const t=this.editor;let e,i,s=!1,o=!1;const r=t.plugins.get(Co);this.listenTo(t.editing.view.document,"mousedown",(a,l)=>{!this.isEnabled||!r.isEnabled||l.domEvent.shiftKey||l.domEvent.ctrlKey||l.domEvent.altKey||(e=this._getModelTableCellFromDomEvent(l))}),this.listenTo(t.editing.view.document,"mousemove",(a,l)=>{if(!l.domEvent.buttons||!e)return;const c=this._getModelTableCellFromDomEvent(l);c&&Ny(e,c)&&(i=c,!s&&i!=e&&(s=!0)),s&&(o=!0,r.setCellSelection(e,i),l.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{s=!1,o=!1,e=null,i=null}),this.listenTo(t.editing.view.document,"selectionChange",a=>{o&&a.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(t){const e=t.target,i=this.editor.editing.view.createPositionAt(e,0);return this.editor.editing.mapper.toModelPosition(i).parent.findAncestor("tableCell",{includeSelf:!0})}}function Ny(n,t){return n.parent.parent==t.parent.parent}class Xre extends A{static get requires(){return[gc,Ure,Co,Yre,Jre,qre,ms]}static get pluginName(){return"Table"}}function IR(n){const t=PR(n);return t||zh(n)}function PR(n){const t=n.getSelectedElement();return t&&RR(t)?t:null}function zh(n){const t=n.getFirstPosition();if(!t)return null;let e=t.parent;for(;e;){if(e.is("element")&&RR(e))return e;e=e.parent}return null}function RR(n){return!!n.getCustomProperty("table")&&ht(n)}class Qre extends A{static get requires(){return[ad]}static get pluginName(){return"TableToolbar"}afterInit(){const t=this.editor,e=t.t,i=t.plugins.get(ad),s=t.config.get("table.contentToolbar"),o=t.config.get("table.tableToolbar");s&&i.register("tableContent",{ariaLabel:e("Table toolbar"),items:s,getRelatedElement:zh}),o&&i.register("table",{ariaLabel:e("Table toolbar"),items:o,getRelatedElement:PR})}}class eae extends q{constructor(e,i){super(e);h(this,"options");h(this,"focusTracker");h(this,"focusCycler");h(this,"_focusables");h(this,"dropdownView");h(this,"inputView");h(this,"keystrokes");h(this,"_stillTyping");this.set("value",""),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isEmpty",!0),this.options=i,this.focusTracker=new Ge,this._focusables=new Mt,this.dropdownView=this._createDropdownView(),this.inputView=this._createInputTextView(),this.keystrokes=new tt,this._stillTyping=!1,this.focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-input-color"]},children:[this.dropdownView,this.inputView]}),this.on("change:value",(s,o,r)=>this._setInputValue(r))}render(){super.render(),[this.inputView,this.dropdownView.buttonView].forEach(e=>{this.focusTracker.add(e.element),this._focusables.add(e)}),this.keystrokes.listenTo(this.element)}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}_createDropdownView(){const e=this.locale,i=e.t,s=this.bindTemplate,o=this._createColorSelector(e),r=Yt(e),a=new q;return a.setTemplate({tag:"span",attributes:{class:["ck","ck-input-color__button__preview"],style:{backgroundColor:s.to("value")}},children:[{tag:"span",attributes:{class:["ck","ck-input-color__button__preview__no-color-indicator",s.if("value","ck-hidden",l=>l!="")]}}]}),r.buttonView.extendTemplate({attributes:{class:"ck-input-color__button"}}),r.buttonView.children.add(a),r.buttonView.label=i("Color picker"),r.buttonView.tooltip=!0,r.panelPosition=e.uiLanguageDirection==="rtl"?"se":"sw",r.panelView.children.add(o),r.bind("isEnabled").to(this,"isReadOnly",l=>!l),r.on("change:isOpen",(l,c,u)=>{u&&(o.updateSelectedColors(),o.showColorGridsFragment())}),r}_createInputTextView(){const e=this.locale,i=new II(e);return i.extendTemplate({on:{blur:i.bindTemplate.to("blur")}}),i.value=this.value,i.bind("isReadOnly","hasError").to(this),this.bind("isFocused","isEmpty").to(i),i.on("input",()=>{const s=i.element.value,o=this.options.colorDefinitions.find(r=>s===r.label);this._stillTyping=!0,this.value=o&&o.color||s}),i.on("blur",()=>{this._stillTyping=!1,this._setInputValue(i.element.value)}),i.delegate("input").to(this),i}_createColorSelector(e){const i=e.t,s=this.options.defaultColorValue||"",o=i(s?"Restore default":"Remove color"),r=new vZ(e,{colors:this.options.colorDefinitions,columns:this.options.columns,removeButtonLabel:o,colorPickerLabel:i("Color picker"),colorPickerViewConfig:this.options.colorPickerConfig===!1?!1:{...this.options.colorPickerConfig,hideInput:!0}});r.appendUI(),r.on("execute",(l,c)=>{if(c.source==="colorPickerSaveButton"){this.dropdownView.isOpen=!1;return}this.value=c.value||s,this.fire("input"),c.source!=="colorPicker"&&(this.dropdownView.isOpen=!1)});let a=this.value;return r.on("colorPicker:cancel",()=>{this.value=a,this.fire("input"),this.dropdownView.isOpen=!1}),r.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{a=this.value}),r.bind("selectedColor").to(this,"value"),r}_setInputValue(e){if(!this._stillTyping){const i=Fy(e),s=this.options.colorDefinitions.find(o=>i===Fy(o.color));s?this.inputView.value=s.label:this.inputView.value=e||""}}}function Fy(n){return n.replace(/([(,])\s+/g,"$1").replace(/^\s+|\s+(?=[),\s]|$)/g,"").replace(/,|\s/g," ")}const fw=n=>n==="";function mw(n){return{none:n("None"),solid:n("Solid"),dotted:n("Dotted"),dashed:n("Dashed"),double:n("Double"),groove:n("Groove"),ridge:n("Ridge"),inset:n("Inset"),outset:n("Outset")}}function LR(n){return n('The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".')}function VR(n){return n('The value is invalid. Try "10px" or "2em" or simply "2".')}function yd(n){return n=n.trim().toLowerCase(),fw(n)||eI(n)}function ol(n){return n=n.trim(),fw(n)||OR(n)||Rb(n)||cj(n)}function BR(n){return n=n.trim(),fw(n)||OR(n)||Rb(n)}function MR(n,t){const e=new rn,i=mw(n.t);for(const s in i){const o={type:"button",model:new Wr({_borderStyleValue:s,label:i[s],role:"menuitemradio",withText:!0})};s==="none"?o.model.bind("isOn").to(n,"borderStyle",r=>t==="none"?!r:r===s):o.model.bind("isOn").to(n,"borderStyle",r=>r===s),e.add(o)}return e}function yg(n){const{view:t,icons:e,toolbar:i,labels:s,propertyName:o,nameToValue:r,defaultValue:a}=n;for(const l in s){const c=new te(t.locale);c.set({label:s[l],icon:e[l],tooltip:s[l]});const u=r?r(l):l;c.bind("isOn").to(t,o,d=>{let f=d;return d===""&&a&&(f=a),u===f}),c.on("execute",()=>{t[o]=u}),i.items.add(c)}}const Cd=[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}];function kd(n){return(t,e,i)=>{const s=new eae(t.locale,{colorDefinitions:tae(n.colorConfig),columns:n.columns,defaultColorValue:n.defaultColorValue,colorPickerConfig:n.colorPickerConfig});return s.inputView.set({id:e,ariaDescribedById:i}),s.bind("isReadOnly").to(t,"isEnabled",o=>!o),s.bind("hasError").to(t,"errorText",o=>!!o),s.on("input",()=>{t.errorText=null}),t.bind("isEmpty","isFocused").to(s),s}}function OR(n){const t=parseFloat(n);return!Number.isNaN(t)&&n===String(t)}function tae(n){return n.map(t=>({color:t.model,label:t.label,options:{hasBorder:t.hasBorder}}))}class xn extends q{constructor(e,i={}){super(e);h(this,"children");const s=this.bindTemplate;this.set("class",i.class||null),this.children=this.createCollection(),i.children&&i.children.forEach(o=>this.children.add(o)),this.set("_role",null),this.set("_ariaLabelledBy",null),i.labelView&&this.set({_role:"group",_ariaLabelledBy:i.labelView.id}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__row",s.to("class")],role:s.to("_role"),"aria-labelledby":s.to("_ariaLabelledBy")},children:this.children})}}class nae extends q{constructor(e,i){super(e);h(this,"options");h(this,"focusTracker");h(this,"keystrokes");h(this,"children");h(this,"borderStyleDropdown");h(this,"borderWidthInput");h(this,"borderColorInput");h(this,"backgroundInput");h(this,"paddingInput");h(this,"widthInput");h(this,"heightInput");h(this,"horizontalAlignmentToolbar");h(this,"verticalAlignmentToolbar");h(this,"saveButtonView");h(this,"cancelButtonView");h(this,"_focusables");h(this,"_focusCycler");this.set({borderStyle:"",borderWidth:"",borderColor:"",padding:"",backgroundColor:"",width:"",height:"",horizontalAlignment:"",verticalAlignment:""}),this.options=i;const{borderStyleDropdown:s,borderWidthInput:o,borderColorInput:r,borderRowLabel:a}=this._createBorderFields(),{backgroundRowLabel:l,backgroundInput:c}=this._createBackgroundFields(),{widthInput:u,operatorLabel:d,heightInput:f,dimensionsLabel:m}=this._createDimensionFields(),{horizontalAlignmentToolbar:g,verticalAlignmentToolbar:p,alignmentLabel:w}=this._createAlignmentFields();this.focusTracker=new Ge,this.keystrokes=new tt,this.children=this.createCollection(),this.borderStyleDropdown=s,this.borderWidthInput=o,this.borderColorInput=r,this.backgroundInput=c,this.paddingInput=this._createPaddingField(),this.widthInput=u,this.heightInput=f,this.horizontalAlignmentToolbar=g,this.verticalAlignmentToolbar=p;const{saveButtonView:v,cancelButtonView:_}=this._createActionButtons();this.saveButtonView=v,this.cancelButtonView=_,this._focusables=new Mt,this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Ob(e,{label:this.t("Cell properties")})),this.children.add(new xn(e,{labelView:a,children:[a,s,r,o],class:"ck-table-form__border-row"})),this.children.add(new xn(e,{labelView:l,children:[l,c],class:"ck-table-form__background-row"})),this.children.add(new xn(e,{children:[new xn(e,{labelView:m,children:[m,u,d,f],class:"ck-table-form__dimensions-row"}),new xn(e,{children:[this.paddingInput],class:"ck-table-cell-properties-form__padding-row"})]})),this.children.add(new xn(e,{labelView:w,children:[w,g,p],class:"ck-table-cell-properties-form__alignment-row"})),this.children.add(new xn(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-cell-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),qo({view:this}),[this.borderColorInput,this.backgroundInput].forEach(e=>{e.fieldView.focusCycler.on("forwardCycle",i=>{this._focusCycler.focusNext(),i.stop()}),e.fieldView.focusCycler.on("backwardCycle",i=>{this._focusCycler.focusPrevious(),i.stop()})}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.paddingInput,this.horizontalAlignmentToolbar,this.verticalAlignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableCellProperties,i={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},s=kd({colorConfig:this.options.borderColors,columns:5,defaultColorValue:i.color,colorPickerConfig:this.options.colorPickerConfig}),o=this.locale,r=this.t,a=r("Style"),l=new fn(o);l.text=r("Border");const c=mw(r),u=new wt(o,BI);u.set({label:a,class:"ck-table-form__border-style"}),u.fieldView.buttonView.set({ariaLabel:a,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:a}),u.fieldView.buttonView.bind("label").to(this,"borderStyle",m=>c[m||"none"]),u.fieldView.on("execute",m=>{this.borderStyle=m.source._borderStyleValue}),u.bind("isEmpty").to(this,"borderStyle",m=>!m),ca(u.fieldView,MR(this,i.style),{role:"menu",ariaLabel:a});const d=new wt(o,jn);d.set({label:r("Width"),class:"ck-table-form__border-width"}),d.fieldView.bind("value").to(this,"borderWidth"),d.bind("isEnabled").to(this,"borderStyle",ou),d.fieldView.on("input",()=>{this.borderWidth=d.fieldView.element.value});const f=new wt(o,s);return f.set({label:r("Color"),class:"ck-table-form__border-color"}),f.fieldView.bind("value").to(this,"borderColor"),f.bind("isEnabled").to(this,"borderStyle",ou),f.fieldView.on("input",()=>{this.borderColor=f.fieldView.value}),this.on("change:borderStyle",(m,g,p,w)=>{ou(p)||(this.borderColor="",this.borderWidth=""),ou(w)||(this.borderColor=i.color,this.borderWidth=i.width)}),{borderRowLabel:l,borderStyleDropdown:u,borderColorInput:f,borderWidthInput:d}}_createBackgroundFields(){const e=this.locale,i=this.t,s=new fn(e);s.text=i("Background");const o=kd({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableCellProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),r=new wt(e,o);return r.set({label:i("Color"),class:"ck-table-cell-properties-form__background"}),r.fieldView.bind("value").to(this,"backgroundColor"),r.fieldView.on("input",()=>{this.backgroundColor=r.fieldView.value}),{backgroundRowLabel:s,backgroundInput:r}}_createDimensionFields(){const e=this.locale,i=this.t,s=new fn(e);s.text=i("Dimensions");const o=new wt(e,jn);o.set({label:i("Width"),class:"ck-table-form__dimensions-row__width"}),o.fieldView.bind("value").to(this,"width"),o.fieldView.on("input",()=>{this.width=o.fieldView.element.value});const r=new q(e);r.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const a=new wt(e,jn);return a.set({label:i("Height"),class:"ck-table-form__dimensions-row__height"}),a.fieldView.bind("value").to(this,"height"),a.fieldView.on("input",()=>{this.height=a.fieldView.element.value}),{dimensionsLabel:s,widthInput:o,operatorLabel:r,heightInput:a}}_createPaddingField(){const e=this.locale,i=this.t,s=new wt(e,jn);return s.set({label:i("Padding"),class:"ck-table-cell-properties-form__padding"}),s.fieldView.bind("value").to(this,"padding"),s.fieldView.on("input",()=>{this.padding=s.fieldView.element.value}),s}_createAlignmentFields(){const e=this.locale,i=this.t,s=new fn(e),o={left:F.alignLeft,center:F.alignCenter,right:F.alignRight,justify:F.alignJustify,top:F.alignTop,middle:F.alignMiddle,bottom:F.alignBottom};s.text=i("Table cell text alignment");const r=new Ro(e),a=e.contentLanguageDirection==="rtl";r.set({isCompact:!0,ariaLabel:i("Horizontal text alignment toolbar")}),yg({view:this,icons:o,toolbar:r,labels:this._horizontalAlignmentLabels,propertyName:"horizontalAlignment",nameToValue:c=>{if(a){if(c==="left")return"right";if(c==="right")return"left"}return c},defaultValue:this.options.defaultTableCellProperties.horizontalAlignment});const l=new Ro(e);return l.set({isCompact:!0,ariaLabel:i("Vertical text alignment toolbar")}),yg({view:this,icons:o,toolbar:l,labels:this._verticalAlignmentLabels,propertyName:"verticalAlignment",defaultValue:this.options.defaultTableCellProperties.verticalAlignment}),{horizontalAlignmentToolbar:r,verticalAlignmentToolbar:l,alignmentLabel:s}}_createActionButtons(){const e=this.locale,i=this.t,s=new te(e),o=new te(e),r=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.paddingInput];return s.set({label:i("Save"),icon:F.check,class:"ck-button-save",type:"submit",withText:!0}),s.bind("isEnabled").toMany(r,"errorText",(...a)=>a.every(l=>!l)),o.set({label:i("Cancel"),icon:F.cancel,class:"ck-button-cancel",withText:!0}),o.delegate("execute").to(this,"cancel"),{saveButtonView:s,cancelButtonView:o}}get _horizontalAlignmentLabels(){const e=this.locale,i=this.t,s=i("Align cell text to the left"),o=i("Align cell text to the center"),r=i("Align cell text to the right"),a=i("Justify cell text");return e.uiLanguageDirection==="rtl"?{right:r,center:o,left:s,justify:a}:{left:s,center:o,right:r,justify:a}}get _verticalAlignmentLabels(){const e=this.t;return{top:e("Align cell text to the top"),middle:e("Align cell text to the middle"),bottom:e("Align cell text to the bottom")}}}function ou(n){return n!=="none"}const Cg=[St.defaultPositions.northArrowSouth,St.defaultPositions.northArrowSouthWest,St.defaultPositions.northArrowSouthEast,St.defaultPositions.southArrowNorth,St.defaultPositions.southArrowNorthWest,St.defaultPositions.southArrowNorthEast,St.defaultPositions.viewportStickyNorth];function NR(n,t){const e=n.plugins.get("ContextualBalloon"),i=n.editing.view.document.selection;let s;t==="cell"?zh(i)&&(s=DR(n)):IR(i)&&(s=FR(n)),s&&e.updatePosition(s)}function FR(n){const t=n.model.document.selection,e=yo(t),i=n.editing.mapper.toViewElement(e);return{target:n.editing.view.domConverter.mapViewToDom(i),positions:Cg}}function DR(n){const t=n.editing.mapper,e=n.editing.view.domConverter,i=n.model.document.selection;if(i.rangeCount>1)return{target:()=>iae(i.getRanges(),n),positions:Cg};const s=$R(i.getFirstPosition()),o=t.toViewElement(s);return{target:e.mapViewToDom(o),positions:Cg}}function $R(n){return n.nodeAfter&&n.nodeAfter.is("element","tableCell")?n.nodeAfter:n.findAncestor("tableCell")}function iae(n,t){const e=t.editing.mapper,i=t.editing.view.domConverter,s=Array.from(n).map(o=>{const r=$R(o.start),a=e.toViewElement(r);return new he(i.mapViewToDom(a))});return he.getBoundingRect(s)}var sae='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.105 18-.17 1H2.5A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1h15A1.5 1.5 0 0 1 19 2.5v9.975l-.85-.124-.15-.302V8h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5h3.105zM2 12h5V8H2v4zm10-4H8v4h4V8zM2 2v5h5V2H2zm0 16h5v-5H2v5zM13 7h5V2h-5v5zM8 2v5h4V2H8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM13 6a1 1 0 0 1 1 1v3.172a2.047 2.047 0 0 0-.293.443l-.858 1.736-1.916.28-.151.027A1.976 1.976 0 0 0 9.315 14H7a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h6zm-1 2H8v4h4V8z"/></svg>';function Ko(n){if(!n||!Ce(n))return n;const{top:t,right:e,bottom:i,left:s}=n;if(t==e&&e==i&&i==s)return t}function Zo(n,t){const e=parseFloat(n);return Number.isNaN(e)||String(e)!==String(n)?n:`${e}${t}`}function pc(n,t={}){const e={borderStyle:"none",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",...n};return t.includeAlignmentProperty&&!e.alignment&&(e.alignment="center"),t.includePaddingProperty&&!e.padding&&(e.padding=""),t.includeVerticalAlignmentProperty&&!e.verticalAlignment&&(e.verticalAlignment="middle"),t.includeHorizontalAlignmentProperty&&!e.horizontalAlignment&&(e.horizontalAlignment=t.isRightToLeftContent?"right":"left"),e}const oae=500,Dy={borderStyle:"tableCellBorderStyle",borderColor:"tableCellBorderColor",borderWidth:"tableCellBorderWidth",height:"tableCellHeight",width:"tableCellWidth",padding:"tableCellPadding",backgroundColor:"tableCellBackgroundColor",horizontalAlignment:"tableCellHorizontalAlignment",verticalAlignment:"tableCellVerticalAlignment"};class rae extends A{constructor(e){super(e);h(this,"_defaultTableCellProperties");h(this,"_balloon");h(this,"view");h(this,"_undoStepBatch");h(this,"_isReady");e.config.define("table.tableCellProperties",{borderColors:Cd,backgroundColors:Cd})}static get requires(){return[mi]}static get pluginName(){return"TableCellPropertiesUI"}init(){const e=this.editor,i=e.t;this._defaultTableCellProperties=pc(e.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:e.locale.contentLanguageDirection==="rtl"}),this._balloon=e.plugins.get(mi),this.view=null,this._isReady=!1,e.ui.componentFactory.add("tableCellProperties",s=>{const o=new te(s);o.set({label:i("Cell properties"),icon:sae,tooltip:!0}),this.listenTo(o,"execute",()=>this._showView());const r=Object.values(Dy).map(a=>e.commands.get(a));return o.bind("isEnabled").toMany(r,"isEnabled",(...a)=>a.some(l=>l)),o})}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(){const e=this.editor,i=e.config.get("table.tableCellProperties"),s=sd(i.borderColors),o=id(e.locale,s),r=sd(i.backgroundColors),a=id(e.locale,r),l=i.colorPicker!==!1,c=new nae(e.locale,{borderColors:o,backgroundColors:a,defaultTableCellProperties:this._defaultTableCellProperties,colorPickerConfig:l?i.colorPicker||{}:!1}),u=e.t;c.render(),this.listenTo(c,"submit",()=>{this._hideView()}),this.listenTo(c,"cancel",()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()}),c.keystrokes.set("Esc",(m,g)=>{this._hideView(),g()}),Wo({emitter:c,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const d=LR(u),f=VR(u);return c.on("change:borderStyle",this._getPropertyChangeCallback("tableCellBorderStyle")),c.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:c.borderColorInput,commandName:"tableCellBorderColor",errorText:d,validator:yd})),c.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:c.borderWidthInput,commandName:"tableCellBorderWidth",errorText:f,validator:BR})),c.on("change:padding",this._getValidatedPropertyChangeCallback({viewField:c.paddingInput,commandName:"tableCellPadding",errorText:f,validator:ol})),c.on("change:width",this._getValidatedPropertyChangeCallback({viewField:c.widthInput,commandName:"tableCellWidth",errorText:f,validator:ol})),c.on("change:height",this._getValidatedPropertyChangeCallback({viewField:c.heightInput,commandName:"tableCellHeight",errorText:f,validator:ol})),c.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:c.backgroundInput,commandName:"tableCellBackgroundColor",errorText:d,validator:yd})),c.on("change:horizontalAlignment",this._getPropertyChangeCallback("tableCellHorizontalAlignment")),c.on("change:verticalAlignment",this._getPropertyChangeCallback("tableCellVerticalAlignment")),c}_fillViewFormFromCommandValues(){const e=this.editor.commands,i=e.get("tableCellBorderStyle");Object.entries(Dy).map(([s,o])=>{const r=this._defaultTableCellProperties[s]||"";return[s,e.get(o).value||r]}).forEach(([s,o])=>{(s==="borderColor"||s==="borderWidth")&&i.value==="none"||this.view.set(s,o)}),this._isReady=!0}_showView(){const e=this.editor;this.view||(this.view=this._createPropertiesView()),this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:DR(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,i=e.editing.view.document;zh(i.selection)?this._isViewVisible&&NR(e,"cell"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(i,s,o)=>{this._isReady&&this.editor.execute(e,{value:o,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:i,viewField:s,validator:o,errorText:r}=e,a=Fn(()=>{s.errorText=r},oae);return(l,c,u)=>{a.cancel(),this._isReady&&(o(u)?(this.editor.execute(i,{value:u,batch:this._undoStepBatch}),s.errorText=null):a())}}}class gs extends ne{constructor(e,i,s){super(e);h(this,"attributeName");h(this,"_defaultValue");this.attributeName=i,this._defaultValue=s}refresh(){const e=this.editor,s=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e.model.document.selection);this.isEnabled=!!s.length,this.value=this._getSingleValue(s)}execute(e={}){const{value:i,batch:s}=e,o=this.editor.model,a=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(o.document.selection),l=this._getValueToSet(i);o.enqueueChange(s,c=>{l?a.forEach(u=>c.setAttribute(this.attributeName,l,u)):a.forEach(u=>c.removeAttribute(this.attributeName,u))})}_getAttribute(e){if(!e)return;const i=e.getAttribute(this.attributeName);if(i!==this._defaultValue)return i}_getValueToSet(e){if(e!==this._defaultValue)return e}_getSingleValue(e){const i=this._getAttribute(e[0]);return e.every(o=>this._getAttribute(o)===i)?i:void 0}}class aae extends gs{constructor(t,e){super(t,"tableCellWidth",e)}_getValueToSet(t){if(t=Zo(t,"px"),t!==this._defaultValue)return t}}class HR extends A{static get pluginName(){return"TableCellWidthEditing"}static get requires(){return[gc]}init(){const t=this.editor,e=pc(t.config.get("table.tableCellProperties.defaultProperties"));ku(t.model.schema,t.conversion,{modelAttribute:"tableCellWidth",styleName:"width",defaultValue:e.width}),t.commands.add("tableCellWidth",new aae(t,e.width))}}class lae extends gs{constructor(t,e){super(t,"tableCellPadding",e)}_getAttribute(t){if(!t)return;const e=Ko(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}_getValueToSet(t){const e=Zo(t,"px");if(e!==this._defaultValue)return e}}class cae extends gs{constructor(t,e){super(t,"tableCellHeight",e)}_getValueToSet(t){const e=Zo(t,"px");if(e!==this._defaultValue)return e}}class uae extends gs{constructor(t,e){super(t,"tableCellBackgroundColor",e)}}class dae extends gs{constructor(t,e){super(t,"tableCellVerticalAlignment",e)}}class hae extends gs{constructor(t,e){super(t,"tableCellHorizontalAlignment",e)}}class fae extends gs{constructor(t,e){super(t,"tableCellBorderStyle",e)}_getAttribute(t){if(!t)return;const e=Ko(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}}class mae extends gs{constructor(t,e){super(t,"tableCellBorderColor",e)}_getAttribute(t){if(!t)return;const e=Ko(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}}class gae extends gs{constructor(t,e){super(t,"tableCellBorderWidth",e)}_getAttribute(t){if(!t)return;const e=Ko(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}_getValueToSet(t){const e=Zo(t,"px");if(e!==this._defaultValue)return e}}const $y=/^(top|middle|bottom)$/,Hy=/^(left|center|right|justify)$/;class pae extends A{static get pluginName(){return"TableCellPropertiesEditing"}static get requires(){return[gc,HR]}init(){const t=this.editor,e=t.model.schema,i=t.conversion;t.config.define("table.tableCellProperties.defaultProperties",{});const s=pc(t.config.get("table.tableCellProperties.defaultProperties"),{includeVerticalAlignmentProperty:!0,includeHorizontalAlignmentProperty:!0,includePaddingProperty:!0,isRightToLeftContent:t.locale.contentLanguageDirection==="rtl"});t.data.addStyleProcessorRules(iI),bae(e,i,{color:s.borderColor,style:s.borderStyle,width:s.borderWidth}),t.commands.add("tableCellBorderStyle",new fae(t,s.borderStyle)),t.commands.add("tableCellBorderColor",new mae(t,s.borderColor)),t.commands.add("tableCellBorderWidth",new gae(t,s.borderWidth)),ku(e,i,{modelAttribute:"tableCellHeight",styleName:"height",defaultValue:s.height}),t.commands.add("tableCellHeight",new cae(t,s.height)),t.data.addStyleProcessorRules(Aj),ku(e,i,{modelAttribute:"tableCellPadding",styleName:"padding",reduceBoxSides:!0,defaultValue:s.padding}),t.commands.add("tableCellPadding",new lae(t,s.padding)),t.data.addStyleProcessorRules(nI),ku(e,i,{modelAttribute:"tableCellBackgroundColor",styleName:"background-color",defaultValue:s.backgroundColor}),t.commands.add("tableCellBackgroundColor",new uae(t,s.backgroundColor)),wae(e,i,s.horizontalAlignment),t.commands.add("tableCellHorizontalAlignment",new hae(t,s.horizontalAlignment)),_ae(e,i,s.verticalAlignment),t.commands.add("tableCellVerticalAlignment",new dae(t,s.verticalAlignment))}}function bae(n,t,e){const i={width:"tableCellBorderWidth",color:"tableCellBorderColor",style:"tableCellBorderStyle"};n.extend("tableCell",{allowAttributes:Object.values(i)}),hg(t,"td",i,e),hg(t,"th",i,e),sl(t,{modelElement:"tableCell",modelAttribute:i.style,styleName:"border-style"}),sl(t,{modelElement:"tableCell",modelAttribute:i.color,styleName:"border-color"}),sl(t,{modelElement:"tableCell",modelAttribute:i.width,styleName:"border-width"})}function wae(n,t,e){n.extend("tableCell",{allowAttributes:["tableCellHorizontalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellHorizontalAlignment"},view:i=>({key:"style",value:{"text-align":i}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"text-align":Hy}},model:{key:"tableCellHorizontalAlignment",value:i=>{const s=i.getStyle("text-align");return s===e?null:s}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{align:Hy}},model:{key:"tableCellHorizontalAlignment",value:i=>{const s=i.getAttribute("align");return s===e?null:s}}})}function _ae(n,t,e){n.extend("tableCell",{allowAttributes:["tableCellVerticalAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"tableCell",key:"tableCellVerticalAlignment"},view:i=>({key:"style",value:{"vertical-align":i}})}),t.for("upcast").attributeToAttribute({view:{name:/^(td|th)$/,styles:{"vertical-align":$y}},model:{key:"tableCellVerticalAlignment",value:i=>{const s=i.getStyle("vertical-align");return s===e?null:s}}}).attributeToAttribute({view:{name:/^(td|th)$/,attributes:{valign:$y}},model:{key:"tableCellVerticalAlignment",value:i=>{const s=i.getAttribute("valign");return s===e?null:s}}})}class vae extends A{static get pluginName(){return"TableCellProperties"}static get requires(){return[pae,rae]}}class Jo extends ne{constructor(e,i,s){super(e);h(this,"attributeName");h(this,"_defaultValue");this.attributeName=i,this._defaultValue=s}refresh(){const i=this.editor.model.document.selection,s=yo(i);this.isEnabled=!!s,this.value=this._getValue(s)}execute(e={}){const i=this.editor.model,s=i.document.selection,{value:o,batch:r}=e,a=yo(s),l=this._getValueToSet(o);i.enqueueChange(r,c=>{l?c.setAttribute(this.attributeName,l,a):c.removeAttribute(this.attributeName,a)})}_getValue(e){if(!e)return;const i=e.getAttribute(this.attributeName);if(i!==this._defaultValue)return i}_getValueToSet(e){if(e!==this._defaultValue)return e}}class yae extends Jo{constructor(t,e){super(t,"tableBackgroundColor",e)}}class Cae extends Jo{constructor(t,e){super(t,"tableBorderColor",e)}_getValue(t){if(!t)return;const e=Ko(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}}class kae extends Jo{constructor(t,e){super(t,"tableBorderStyle",e)}_getValue(t){if(!t)return;const e=Ko(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}}class Tae extends Jo{constructor(t,e){super(t,"tableBorderWidth",e)}_getValue(t){if(!t)return;const e=Ko(t.getAttribute(this.attributeName));if(e!==this._defaultValue)return e}_getValueToSet(t){const e=Zo(t,"px");if(e!==this._defaultValue)return e}}class Eae extends Jo{constructor(t,e){super(t,"tableWidth",e)}_getValueToSet(t){if(t=Zo(t,"px"),t!==this._defaultValue)return t}}class Aae extends Jo{constructor(t,e){super(t,"tableHeight",e)}_getValueToSet(t){if(t=Zo(t,"px"),t!==this._defaultValue)return t}}class xae extends Jo{constructor(t,e){super(t,"tableAlignment",e)}}const Sae=/^(left|center|right)$/,Iae=/^(left|none|right)$/;class Pae extends A{static get pluginName(){return"TablePropertiesEditing"}static get requires(){return[gc]}init(){const t=this.editor,e=t.model.schema,i=t.conversion;t.config.define("table.tableProperties.defaultProperties",{});const s=pc(t.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0});t.data.addStyleProcessorRules(iI),Rae(e,i,{color:s.borderColor,style:s.borderStyle,width:s.borderWidth}),t.commands.add("tableBorderColor",new Cae(t,s.borderColor)),t.commands.add("tableBorderStyle",new kae(t,s.borderStyle)),t.commands.add("tableBorderWidth",new Tae(t,s.borderWidth)),Lae(e,i,s.alignment),t.commands.add("tableAlignment",new xae(t,s.alignment)),zy(e,i,{modelAttribute:"tableWidth",styleName:"width",defaultValue:s.width}),t.commands.add("tableWidth",new Eae(t,s.width)),zy(e,i,{modelAttribute:"tableHeight",styleName:"height",defaultValue:s.height}),t.commands.add("tableHeight",new Aae(t,s.height)),t.data.addStyleProcessorRules(nI),Vae(e,i,{modelAttribute:"tableBackgroundColor",styleName:"background-color",defaultValue:s.backgroundColor}),t.commands.add("tableBackgroundColor",new yae(t,s.backgroundColor))}}function Rae(n,t,e){const i={width:"tableBorderWidth",color:"tableBorderColor",style:"tableBorderStyle"};n.extend("table",{allowAttributes:Object.values(i)}),hg(t,"table",i,e),yu(t,{modelAttribute:i.color,styleName:"border-color"}),yu(t,{modelAttribute:i.style,styleName:"border-style"}),yu(t,{modelAttribute:i.width,styleName:"border-width"})}function Lae(n,t,e){n.extend("table",{allowAttributes:["tableAlignment"]}),t.for("downcast").attributeToAttribute({model:{name:"table",key:"tableAlignment"},view:i=>({key:"style",value:{float:i==="center"?"none":i}}),converterPriority:"high"}),t.for("upcast").attributeToAttribute({view:{name:/^(table|figure)$/,styles:{float:Iae}},model:{key:"tableAlignment",value:i=>{let s=i.getStyle("float");return s==="none"&&(s="center"),s===e?null:s}}}).attributeToAttribute({view:{attributes:{align:Sae}},model:{name:"table",key:"tableAlignment",value:i=>{const s=i.getAttribute("align");return s===e?null:s}}})}function Vae(n,t,e){const{modelAttribute:i}=e;n.extend("table",{allowAttributes:[i]}),uw(t,{viewElement:"table",...e}),yu(t,e)}function zy(n,t,e){const{modelAttribute:i}=e;n.extend("table",{allowAttributes:[i]}),uw(t,{viewElement:/^(table|figure)$/,shouldUpcast:s=>!(s.name=="table"&&s.parent.name=="figure"),...e}),sl(t,{modelElement:"table",...e})}class Bae extends q{constructor(e,i){super(e);h(this,"options");h(this,"focusTracker");h(this,"keystrokes");h(this,"children");h(this,"borderStyleDropdown");h(this,"borderWidthInput");h(this,"borderColorInput");h(this,"backgroundInput");h(this,"widthInput");h(this,"heightInput");h(this,"alignmentToolbar");h(this,"saveButtonView");h(this,"cancelButtonView");h(this,"_focusables");h(this,"_focusCycler");this.set({borderStyle:"",borderWidth:"",borderColor:"",backgroundColor:"",width:"",height:"",alignment:""}),this.options=i;const{borderStyleDropdown:s,borderWidthInput:o,borderColorInput:r,borderRowLabel:a}=this._createBorderFields(),{backgroundRowLabel:l,backgroundInput:c}=this._createBackgroundFields(),{widthInput:u,operatorLabel:d,heightInput:f,dimensionsLabel:m}=this._createDimensionFields(),{alignmentToolbar:g,alignmentLabel:p}=this._createAlignmentFields();this.focusTracker=new Ge,this.keystrokes=new tt,this.children=this.createCollection(),this.borderStyleDropdown=s,this.borderWidthInput=o,this.borderColorInput=r,this.backgroundInput=c,this.widthInput=u,this.heightInput=f,this.alignmentToolbar=g;const{saveButtonView:w,cancelButtonView:v}=this._createActionButtons();this.saveButtonView=w,this.cancelButtonView=v,this._focusables=new Mt,this._focusCycler=new Gt({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.children.add(new Ob(e,{label:this.t("Table properties")})),this.children.add(new xn(e,{labelView:a,children:[a,s,r,o],class:"ck-table-form__border-row"})),this.children.add(new xn(e,{labelView:l,children:[l,c],class:"ck-table-form__background-row"})),this.children.add(new xn(e,{children:[new xn(e,{labelView:m,children:[m,u,d,f],class:"ck-table-form__dimensions-row"}),new xn(e,{labelView:p,children:[p,g],class:"ck-table-properties-form__alignment-row"})]})),this.children.add(new xn(e,{children:[this.saveButtonView,this.cancelButtonView],class:"ck-table-form__action-row"})),this.setTemplate({tag:"form",attributes:{class:["ck","ck-form","ck-table-form","ck-table-properties-form"],tabindex:"-1"},children:this.children})}render(){super.render(),qo({view:this}),[this.borderColorInput,this.backgroundInput].forEach(e=>{e.fieldView.focusCycler.on("forwardCycle",i=>{this._focusCycler.focusNext(),i.stop()}),e.fieldView.focusCycler.on("backwardCycle",i=>{this._focusCycler.focusPrevious(),i.stop()})}),[this.borderStyleDropdown,this.borderColorInput,this.borderWidthInput,this.backgroundInput,this.widthInput,this.heightInput,this.alignmentToolbar,this.saveButtonView,this.cancelButtonView].forEach(e=>{this._focusables.add(e),this.focusTracker.add(e.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createBorderFields(){const e=this.options.defaultTableProperties,i={style:e.borderStyle,width:e.borderWidth,color:e.borderColor},s=kd({colorConfig:this.options.borderColors,columns:5,defaultColorValue:i.color,colorPickerConfig:this.options.colorPickerConfig}),o=this.locale,r=this.t,a=r("Style"),l=new fn(o);l.text=r("Border");const c=mw(r),u=new wt(o,BI);u.set({label:a,class:"ck-table-form__border-style"}),u.fieldView.buttonView.set({ariaLabel:a,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:a}),u.fieldView.buttonView.bind("label").to(this,"borderStyle",m=>c[m||"none"]),u.fieldView.on("execute",m=>{this.borderStyle=m.source._borderStyleValue}),u.bind("isEmpty").to(this,"borderStyle",m=>!m),ca(u.fieldView,MR(this,i.style),{role:"menu",ariaLabel:a});const d=new wt(o,jn);d.set({label:r("Width"),class:"ck-table-form__border-width"}),d.fieldView.bind("value").to(this,"borderWidth"),d.bind("isEnabled").to(this,"borderStyle",ru),d.fieldView.on("input",()=>{this.borderWidth=d.fieldView.element.value});const f=new wt(o,s);return f.set({label:r("Color"),class:"ck-table-form__border-color"}),f.fieldView.bind("value").to(this,"borderColor"),f.bind("isEnabled").to(this,"borderStyle",ru),f.fieldView.on("input",()=>{this.borderColor=f.fieldView.value}),this.on("change:borderStyle",(m,g,p,w)=>{ru(p)||(this.borderColor="",this.borderWidth=""),ru(w)||(this.borderColor=i.color,this.borderWidth=i.width)}),{borderRowLabel:l,borderStyleDropdown:u,borderColorInput:f,borderWidthInput:d}}_createBackgroundFields(){const e=this.locale,i=this.t,s=new fn(e);s.text=i("Background");const o=kd({colorConfig:this.options.backgroundColors,columns:5,defaultColorValue:this.options.defaultTableProperties.backgroundColor,colorPickerConfig:this.options.colorPickerConfig}),r=new wt(e,o);return r.set({label:i("Color"),class:"ck-table-properties-form__background"}),r.fieldView.bind("value").to(this,"backgroundColor"),r.fieldView.on("input",()=>{this.backgroundColor=r.fieldView.value}),{backgroundRowLabel:s,backgroundInput:r}}_createDimensionFields(){const e=this.locale,i=this.t,s=new fn(e);s.text=i("Dimensions");const o=new wt(e,jn);o.set({label:i("Width"),class:"ck-table-form__dimensions-row__width"}),o.fieldView.bind("value").to(this,"width"),o.fieldView.on("input",()=>{this.width=o.fieldView.element.value});const r=new q(e);r.setTemplate({tag:"span",attributes:{class:["ck-table-form__dimension-operator"]},children:[{text:"×"}]});const a=new wt(e,jn);return a.set({label:i("Height"),class:"ck-table-form__dimensions-row__height"}),a.fieldView.bind("value").to(this,"height"),a.fieldView.on("input",()=>{this.height=a.fieldView.element.value}),{dimensionsLabel:s,widthInput:o,operatorLabel:r,heightInput:a}}_createAlignmentFields(){const e=this.locale,i=this.t,s=new fn(e);s.text=i("Alignment");const o=new Ro(e);return o.set({isCompact:!0,ariaLabel:i("Table alignment toolbar")}),yg({view:this,icons:{left:F.objectLeft,center:F.objectCenter,right:F.objectRight},toolbar:o,labels:this._alignmentLabels,propertyName:"alignment",defaultValue:this.options.defaultTableProperties.alignment}),{alignmentLabel:s,alignmentToolbar:o}}_createActionButtons(){const e=this.locale,i=this.t,s=new te(e),o=new te(e),r=[this.borderWidthInput,this.borderColorInput,this.backgroundInput,this.widthInput,this.heightInput];return s.set({label:i("Save"),icon:F.check,class:"ck-button-save",type:"submit",withText:!0}),s.bind("isEnabled").toMany(r,"errorText",(...a)=>a.every(l=>!l)),o.set({label:i("Cancel"),icon:F.cancel,class:"ck-button-cancel",withText:!0}),o.delegate("execute").to(this,"cancel"),{saveButtonView:s,cancelButtonView:o}}get _alignmentLabels(){const e=this.locale,i=this.t,s=i("Align table to the left"),o=i("Center table"),r=i("Align table to the right");return e.uiLanguageDirection==="rtl"?{right:r,center:o,left:s}:{left:s,center:o,right:r}}}function ru(n){return n!=="none"}var Mae='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8 2v5h4V2h1v5h5v1h-5v4h.021l-.172.351-1.916.28-.151.027c-.287.063-.54.182-.755.341L8 13v5H7v-5H2v-1h5V8H2V7h5V2h1zm4 6H8v4h4V8z" opacity=".6"/><path d="m15.5 11.5 1.323 2.68 2.957.43-2.14 2.085.505 2.946L15.5 18.25l-2.645 1.39.505-2.945-2.14-2.086 2.957-.43L15.5 11.5zM17 1a2 2 0 0 1 2 2v9.475l-.85-.124-.857-1.736a2.048 2.048 0 0 0-.292-.44L17 3H3v14h7.808l.402.392L10.935 19H3a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h14z"/></svg>';const Oae=500,Uy={borderStyle:"tableBorderStyle",borderColor:"tableBorderColor",borderWidth:"tableBorderWidth",backgroundColor:"tableBackgroundColor",width:"tableWidth",height:"tableHeight",alignment:"tableAlignment"};class Nae extends A{constructor(e){super(e);h(this,"_defaultTableProperties");h(this,"_balloon");h(this,"view",null);h(this,"_undoStepBatch");h(this,"_isReady");e.config.define("table.tableProperties",{borderColors:Cd,backgroundColors:Cd})}static get requires(){return[mi]}static get pluginName(){return"TablePropertiesUI"}init(){const e=this.editor,i=e.t;this._defaultTableProperties=pc(e.config.get("table.tableProperties.defaultProperties"),{includeAlignmentProperty:!0}),this._balloon=e.plugins.get(mi),e.ui.componentFactory.add("tableProperties",s=>{const o=new te(s);o.set({label:i("Table properties"),icon:Mae,tooltip:!0}),this.listenTo(o,"execute",()=>this._showView());const r=Object.values(Uy).map(a=>e.commands.get(a));return o.bind("isEnabled").toMany(r,"isEnabled",(...a)=>a.some(l=>l)),o})}destroy(){super.destroy(),this.view&&this.view.destroy()}_createPropertiesView(){const e=this.editor,i=e.config.get("table.tableProperties"),s=sd(i.borderColors),o=id(e.locale,s),r=sd(i.backgroundColors),a=id(e.locale,r),l=i.colorPicker!==!1,c=new Bae(e.locale,{borderColors:o,backgroundColors:a,defaultTableProperties:this._defaultTableProperties,colorPickerConfig:l?i.colorPicker||{}:!1}),u=e.t;c.render(),this.listenTo(c,"submit",()=>{this._hideView()}),this.listenTo(c,"cancel",()=>{this._undoStepBatch.operations.length&&e.execute("undo",this._undoStepBatch),this._hideView()}),c.keystrokes.set("Esc",(m,g)=>{this._hideView(),g()}),Wo({emitter:c,activator:()=>this._isViewInBalloon,contextElements:[this._balloon.view.element],callback:()=>this._hideView()});const d=LR(u),f=VR(u);return c.on("change:borderStyle",this._getPropertyChangeCallback("tableBorderStyle")),c.on("change:borderColor",this._getValidatedPropertyChangeCallback({viewField:c.borderColorInput,commandName:"tableBorderColor",errorText:d,validator:yd})),c.on("change:borderWidth",this._getValidatedPropertyChangeCallback({viewField:c.borderWidthInput,commandName:"tableBorderWidth",errorText:f,validator:BR})),c.on("change:backgroundColor",this._getValidatedPropertyChangeCallback({viewField:c.backgroundInput,commandName:"tableBackgroundColor",errorText:d,validator:yd})),c.on("change:width",this._getValidatedPropertyChangeCallback({viewField:c.widthInput,commandName:"tableWidth",errorText:f,validator:ol})),c.on("change:height",this._getValidatedPropertyChangeCallback({viewField:c.heightInput,commandName:"tableHeight",errorText:f,validator:ol})),c.on("change:alignment",this._getPropertyChangeCallback("tableAlignment")),c}_fillViewFormFromCommandValues(){const e=this.editor.commands,i=e.get("tableBorderStyle");Object.entries(Uy).map(([s,o])=>{const r=s,a=this._defaultTableProperties[r]||"";return[r,e.get(o).value||a]}).forEach(([s,o])=>{(s==="borderColor"||s==="borderWidth")&&i.value==="none"||this.view.set(s,o)}),this._isReady=!0}_showView(){const e=this.editor;this.view||(this.view=this._createPropertiesView()),this.listenTo(e.ui,"update",()=>{this._updateView()}),this._fillViewFormFromCommandValues(),this._balloon.add({view:this.view,position:FR(e)}),this._undoStepBatch=e.model.createBatch(),this.view.focus()}_hideView(){const e=this.editor;this.stopListening(e.ui,"update"),this._isReady=!1,this.view.saveButtonView.focus(),this._balloon.remove(this.view),this.editor.editing.view.focus()}_updateView(){const e=this.editor,i=e.editing.view.document;IR(i.selection)?this._isViewVisible&&NR(e,"table"):this._hideView()}get _isViewVisible(){return!!this.view&&this._balloon.visibleView===this.view}get _isViewInBalloon(){return!!this.view&&this._balloon.hasView(this.view)}_getPropertyChangeCallback(e){return(i,s,o)=>{this._isReady&&this.editor.execute(e,{value:o,batch:this._undoStepBatch})}}_getValidatedPropertyChangeCallback(e){const{commandName:i,viewField:s,validator:o,errorText:r}=e,a=Fn(()=>{s.errorText=r},Oae);return(l,c,u)=>{a.cancel(),this._isReady&&(o(u)?(this.editor.execute(i,{value:u,batch:this._undoStepBatch}),s.errorText=null):a())}}}class Fae extends A{static get pluginName(){return"TableProperties"}static get requires(){return[Pae,Nae]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Dae(n){n.document.registerPostFixer(t=>$ae(t,n))}function $ae(n,t){const e=t.document.differ.getChanges();let i=!1;for(const s of e){if(s.type!="insert")continue;const o=s.position.parent;if(o.is("element","table")||s.name=="table"){const r=s.name=="table"?s.position.nodeAfter:o,a=Array.from(r.getChildren()).filter(c=>c.is("element","caption")),l=a.shift();if(!l)continue;for(const c of a)n.move(n.createRangeIn(c),l,"end"),n.remove(c);l.nextSibling&&(n.move(n.createRangeOn(l),r,"end"),i=!0),i=!!a.length||i}}return i}function Wy(n){return!!n&&n.is("element","table")}function kg(n){for(const t of n.getChildren())if(t.is("element","caption"))return t;return null}function Hae(n){const t=yo(n);return t?kg(t):null}function zae(n){const t=n.parent;return n.name=="figcaption"&&t&&t.is("element","figure")&&t.hasClass("table")?{name:!0}:n.name=="caption"&&t&&t.is("element","table")?{name:!0}:null}class Uae extends ne{refresh(){const t=this.editor,e=yo(t.model.document.selection);this.isEnabled=!!e,this.isEnabled?this.value=!!kg(e):this.value=!1}execute({focusCaptionOnShow:t=!1}={}){this.editor.model.change(e=>{this.value?this._hideTableCaption(e):this._showTableCaption(e,t)})}_showTableCaption(t,e){const i=this.editor.model,s=yo(i.document.selection),a=this.editor.plugins.get("TableCaptionEditing")._getSavedCaption(s)||t.createElement("caption");i.insertContent(a,s,"end"),e&&t.setSelection(a,"in")}_hideTableCaption(t){const e=this.editor.model,i=yo(e.document.selection),s=this.editor.plugins.get("TableCaptionEditing"),o=kg(i);s._saveCaption(i,o),e.deleteContent(t.createSelection(o,"on"))}}class Wae extends A{constructor(e){super(e);h(this,"_savedCaptionsMap");this._savedCaptionsMap=new WeakMap}static get pluginName(){return"TableCaptionEditing"}init(){const e=this.editor,i=e.model.schema,s=e.editing.view,o=e.t;i.isRegistered("caption")?i.extend("caption",{allowIn:"table"}):i.register("caption",{allowIn:"table",allowContentOf:"$block",isLimit:!0}),e.commands.add("toggleTableCaption",new Uae(this.editor)),e.conversion.for("upcast").elementToElement({view:zae,model:"caption"}),e.conversion.for("dataDowncast").elementToElement({model:"caption",view:(r,{writer:a})=>Wy(r.parent)?a.createContainerElement("figcaption"):null}),e.conversion.for("editingDowncast").elementToElement({model:"caption",view:(r,{writer:a})=>{if(!Wy(r.parent))return null;const l=a.createEditableElement("figcaption");return a.setCustomProperty("tableCaption",!0,l),l.placeholder=o("Enter table caption"),vb({view:s,element:l,keepOnFocus:!0}),qb(l,a)}}),Dae(e.model)}_getSavedCaption(e){const i=this._savedCaptionsMap.get(e);return i?Je.fromJSON(i):null}_saveCaption(e,i){this._savedCaptionsMap.set(e,i.toJSON())}}class qae extends A{static get pluginName(){return"TableCaptionUI"}init(){const t=this.editor,e=t.editing.view,i=t.t;t.ui.componentFactory.add("toggleTableCaption",s=>{const o=t.commands.get("toggleTableCaption"),r=new te(s);return r.set({icon:F.caption,tooltip:!0,isToggleable:!0}),r.bind("isOn","isEnabled").to(o,"value","isEnabled"),r.bind("label").to(o,"value",a=>i(a?"Toggle caption off":"Toggle caption on")),this.listenTo(r,"execute",()=>{if(t.execute("toggleTableCaption",{focusCaptionOnShow:!0}),o.value){const a=Hae(t.model.document.selection),l=t.editing.mapper.toViewElement(a);if(!l)return;e.scrollToTheSelection(),e.change(c=>{c.addClass("table__caption_highlighted",l)})}t.editing.view.focus()}),r})}}class jae extends A{static get pluginName(){return"TableCaption"}static get requires(){return[Wae,qae]}}class Gae extends ne{refresh(){this.isEnabled=!0}execute(t={}){const{model:e,plugins:i}=this.editor;let{table:s=e.document.selection.getSelectedElement(),columnWidths:o,tableWidth:r}=t;o&&(o=Array.isArray(o)?o:o.split(",")),e.change(a=>{r?a.setAttribute("tableWidth",r,s):a.removeAttribute("tableWidth",s);const l=i.get("TableColumnResizeEditing").getColumnGroupElement(s);if(!o&&!l)return;if(!o)return a.remove(l);const c=hw(o);if(l)Array.from(l.getChildren()).forEach((u,d)=>a.setAttribute("columnWidth",c[d],u));else{const u=a.createElement("tableColumnGroup");c.forEach(d=>a.appendElement("tableColumn",{columnWidth:d},u)),a.append(u,s)}})}}function Kae(n){return t=>t.on("element:colgroup",(e,i,s)=>{const o=i.modelCursor.findAncestor("table"),r=fc(o);if(!r)return;const a=mc(r),l=n.getColumns(o);let c=mre(r,s.writer);c=Array.from({length:l},(u,d)=>c[d]||"auto"),(c.length!=a.length||c.includes("auto"))&&ER(a,r,hw(c),s.writer)},{priority:"low"})}function Zae(){return n=>n.on("insert:table",(t,e,i)=>{const s=i.writer,o=e.item,r=i.mapper.toViewElement(o),a=r.is("element","table")?r:Array.from(r.getChildren()).find(c=>c.is("element","table"));fc(o)?s.addClass("ck-table-resized",a):s.removeClass("ck-table-resized",a)},{priority:"low"})}class Jae extends A{constructor(e){super(e);h(this,"_isResizingActive");h(this,"_resizingData");h(this,"_domEmitter");h(this,"_tableUtilsPlugin");this._isResizingActive=!1,this.set("_isResizingAllowed",!0),this._resizingData=null,this._domEmitter=new(on()),this._tableUtilsPlugin=e.plugins.get("TableUtils"),this.on("change:_isResizingAllowed",(i,s,o)=>{const r=o?"removeClass":"addClass";e.editing.view.change(a=>{for(const l of e.editing.view.document.roots)a[r]("ck-column-resize_disabled",e.editing.view.document.getRoot(l.rootName))})})}static get requires(){return[gc,Lt]}static get pluginName(){return"TableColumnResizeEditing"}init(){this._extendSchema(),this._registerPostFixer(),this._registerConverters(),this._registerResizingListeners(),this._registerResizerInserter();const e=this.editor,i=e.plugins.get("TableColumnResize");e.plugins.get("TableEditing").registerAdditionalSlot({filter:r=>r.is("element","tableColumnGroup"),positionOffset:0});const o=new Gae(e);e.commands.add("resizeTableWidth",o),e.commands.add("resizeColumnWidths",o),this.bind("_isResizingAllowed").to(e,"isReadOnly",i,"isEnabled",o,"isEnabled",(r,a,l)=>!r&&a&&l)}destroy(){this._domEmitter.stopListening(),super.destroy()}getColumnGroupElement(e){return fc(e)}getTableColumnElements(e){return mc(e)}getTableColumnsWidths(e){return fre(e)}_extendSchema(){this.editor.model.schema.extend("table",{allowAttributes:["tableWidth"]}),this.editor.model.schema.register("tableColumnGroup",{allowIn:"table",isLimit:!0}),this.editor.model.schema.register("tableColumn",{allowIn:"tableColumnGroup",allowAttributes:["columnWidth","colSpan"],isLimit:!0})}_registerPostFixer(){const i=this.editor.model;i.document.registerPostFixer(r=>{let a=!1;for(const l of rre(i)){const c=this.getColumnGroupElement(l),u=this.getTableColumnElements(c),d=this.getTableColumnsWidths(c);let f=hw(d);f=s(f,l,this),!Ds(d,f)&&(ER(u,c,f,r),a=!0)}return a});function s(r,a,l){const c=l._tableUtilsPlugin.getColumns(a);if(c-r.length===0)return r;const d=r.map(m=>Number(m.replace("%",""))),f=o(l.editor.model.document.differ,a);for(const m of f){const g=c-d.length;if(g===0)continue;const p=g>0,w=l._tableUtilsPlugin.getCellLocation(m).column;if(p){const v=are(a,l.editor),_=ure(g,v);d.splice(w,0,..._)}else{const v=d.splice(w,Math.abs(g));d[w]+=Nl(v)}}return d.map(m=>m+"%")}function o(r,a){const l=new Set;for(const c of r.getChanges())if(c.type=="insert"&&c.position.nodeAfter&&c.position.nodeAfter.name=="tableCell"&&c.position.nodeAfter.getAncestors().includes(a))l.add(c.position.nodeAfter);else if(c.type=="remove"){const u=c.position.nodeBefore||c.position.nodeAfter;u.name=="tableCell"&&u.getAncestors().includes(a)&&l.add(u)}return l}}_registerConverters(){const i=this.editor.conversion;i.for("upcast").attributeToAttribute({view:{name:"figure",key:"style",value:{width:/[\s\S]+/}},model:{name:"table",key:"tableWidth",value:s=>s.getStyle("width")}}),i.for("downcast").attributeToAttribute({model:{name:"table",key:"tableWidth"},view:s=>({name:"figure",key:"style",value:{width:s}})}),i.elementToElement({model:"tableColumnGroup",view:"colgroup"}),i.elementToElement({model:"tableColumn",view:"col"}),i.for("downcast").add(Zae()),i.for("upcast").add(Kae(this._tableUtilsPlugin)),i.for("upcast").attributeToAttribute({view:{name:"col",styles:{width:/.*/}},model:{key:"columnWidth",value:s=>{const o=s.getStyle("width");return!o||!o.endsWith("%")&&!o.endsWith("pt")?"auto":o}}}),i.for("upcast").attributeToAttribute({view:{name:"col",key:"span"},model:"colSpan"}),i.for("downcast").attributeToAttribute({model:{name:"tableColumn",key:"columnWidth"},view:s=>({key:"style",value:{width:s}})})}_registerResizingListeners(){const e=this.editor.editing.view;e.addObserver(SR),e.document.on("mousedown",this._onMouseDownHandler.bind(this),{priority:"high"}),this._domEmitter.listenTo(j.window.document,"mousemove",$s(this._onMouseMoveHandler.bind(this),50)),this._domEmitter.listenTo(j.window.document,"mouseup",this._onMouseUpHandler.bind(this))}_onMouseDownHandler(e,i){const s=i.target;if(!s.hasClass("ck-table-column-resizer")||!this._isResizingAllowed)return;const o=this.editor,r=o.editing.mapper.toModelElement(s.findAncestor("figure"));if(!o.model.canEditAt(r))return;i.preventDefault(),e.stop();const a=u(r,this._tableUtilsPlugin,o),l=s.findAncestor("table"),c=o.editing.view;Array.from(l.getChildren()).find(m=>m.is("element","colgroup"))||c.change(m=>{d(m,a,l)}),this._isResizingActive=!0,this._resizingData=this._getResizingData(i,a),c.change(m=>f(m,l,this._resizingData));function u(m,g,p){const w=Array(g.getColumns(m)),v=new Ne(m);for(const _ of v){const y=p.editing.mapper.toViewElement(_.cell),E=p.editing.view.domConverter.mapViewToDom(y),x=hre(E);(!w[_.column]||x<w[_.column])&&(w[_.column]=ln(x))}return w}function d(m,g,p){const w=m.createContainerElement("colgroup");for(let v=0;v<g.length;v++){const _=m.createEmptyElement("col"),y=`${ln(g[v]/Nl(g)*100)}%`;m.setStyle("width",y,_),m.insert(m.createPositionAt(w,"end"),_)}m.insert(m.createPositionAt(p,0),w)}function f(m,g,p){const w=p.widths.viewFigureWidth/p.widths.viewFigureParentWidth;m.addClass("ck-table-resized",g),m.addClass("ck-table-column-resizer__active",p.elements.viewResizer),m.setStyle("width",`${ln(w*100)}%`,g.findAncestor("figure"))}}_onMouseMoveHandler(e,i){if(!this._isResizingActive)return;if(!this._isResizingAllowed){this._onMouseUpHandler();return}const{columnPosition:s,flags:{isRightEdge:o,isTableCentered:r,isLtrContent:a},elements:{viewFigure:l,viewLeftColumn:c,viewRightColumn:u},widths:{viewFigureParentWidth:d,tableWidth:f,leftColumnWidth:m,rightColumnWidth:g}}=this._resizingData,p=-m+pg,w=o?d-f:g-pg,v=(a?1:-1)*(o&&r?2:1),_=cre((i.clientX-s)*v,Math.min(p,0),Math.max(w,0));_!==0&&this.editor.editing.view.change(y=>{const E=ln((m+_)*100/f);if(y.setStyle("width",`${E}%`,c),o){const x=ln((f+_)*100/d);y.setStyle("width",`${x}%`,l)}else{const x=ln((g-_)*100/f);y.setStyle("width",`${x}%`,u)}})}_onMouseUpHandler(){if(!this._isResizingActive)return;const{viewResizer:e,modelTable:i,viewFigure:s,viewColgroup:o}=this._resizingData.elements,r=this.editor,a=r.editing.view,l=this.getColumnGroupElement(i),c=Array.from(o.getChildren()).filter(w=>w.is("view:element")),u=l?this.getTableColumnsWidths(l):null,d=c.map(w=>w.getStyle("width")),f=!Ds(u,d),m=i.getAttribute("tableWidth"),g=s.getStyle("width"),p=m!==g;(f||p)&&(this._isResizingAllowed?r.execute("resizeTableWidth",{table:i,tableWidth:`${ln(g)}%`,columnWidths:d}):a.change(w=>{if(u)for(const v of c)w.setStyle("width",u.shift(),v);else w.remove(o);p&&(m?w.setStyle("width",m,s):w.removeStyle("width",s)),!u&&!m&&w.removeClass("ck-table-resized",[...s.getChildren()].find(v=>v.name==="table"))})),a.change(w=>{w.removeClass("ck-table-column-resizer__active",e)}),this._isResizingActive=!1,this._resizingData=null}_getResizingData(e,i){const s=this.editor,o=e.domEvent.clientX,r=e.target,a=r.findAncestor("td")||r.findAncestor("th"),l=s.editing.mapper.toModelElement(a),c=l.findAncestor("table"),u=lre(l,this._tableUtilsPlugin).rightEdge,d=this._tableUtilsPlugin.getColumns(c)-1,f=u===d,m=!c.hasAttribute("tableAlignment"),g=s.locale.contentLanguageDirection!=="rtl",p=a.findAncestor("table"),w=p.findAncestor("figure"),v=[...p.getChildren()].find(P=>P.is("element","colgroup")),_=v.getChild(u),y=f?void 0:v.getChild(u+1),E=bg(s.editing.view.domConverter.mapViewToDom(w.parent)),x=bg(s.editing.view.domConverter.mapViewToDom(w)),S=TR(c,s),R=i[u],V=f?void 0:i[u+1];return{columnPosition:o,flags:{isRightEdge:f,isTableCentered:m,isLtrContent:g},elements:{viewResizer:r,modelTable:c,viewFigure:w,viewColgroup:v,viewLeftColumn:_,viewRightColumn:y},widths:{viewFigureParentWidth:E,viewFigureWidth:x,tableWidth:S,leftColumnWidth:R,rightColumnWidth:V}}}_registerResizerInserter(){this.editor.conversion.for("editingDowncast").add(e=>{e.on("insert:tableCell",(i,s,o)=>{const r=s.item,a=o.mapper.toViewElement(r),l=o.writer;l.insert(l.createPositionAt(a,"end"),l.createUIElement("div",{class:"ck-table-column-resizer"}))},{priority:"lowest"})})}}class Yae extends A{static get requires(){return[Jae,HR]}static get pluginName(){return"TableColumnResize"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Xae={vi:{dictionary:{"Words: %0":"Số chữ: %0","Characters: %0":"Số ký tự: %0","Widget toolbar":"Thanh công cụ tiện ích","Insert paragraph before block":"Chèn đoạn trước khối","Insert paragraph after block":"Chèn đoạn sau khối","Press Enter to type after or press Shift + Enter to type before the widget":"Nhấn Enter để nhập vào sau hoặc nhấn Shift + Enter để nhập vào trước tiện ích","Keystrokes that can be used when a widget is selected (for example: image, table, etc.)":"Tổ hợp phím mà bạn có thể dùng khi một tiện ích được chọn (ví dụ: hình ảnh, bảng, v.v.)","Insert a new paragraph directly after a widget":"Chèn đoạn văn mới ngay sau tiện ích","Insert a new paragraph directly before a widget":"Chèn đoạn văn mới ngay trước tiện ích","Move the caret to allow typing directly before a widget":"Di chuyển dấu sót để cho phép nhập ngay trước một tiện ích","Move the caret to allow typing directly after a widget":"Di chuyển dấu sót để cho phép nhập ngay sau một tiện ích","Move focus from an editable area back to the parent widget":"Di chuyển tiêu điểm từ vùng có thể chỉnh sửa trở lại tiện ích gốc","Upload in progress":"Đang tải lên",Undo:"Hoàn tác",Redo:"Tiếp tục","Rich Text Editor":"Trình soạn thảo văn bản","Editor editing area: %0":"Vùng chỉnh sửa của trình chỉnh sửa: %0","Edit block":"Chỉnh sửa đoạn","Click to edit block":"Nhấp để sửa khối","Drag to move":"Kéo để di chuyển",Next:"Tiếp theo",Previous:"Quay lại","Editor toolbar":"Thanh công cụ biên tập","Dropdown toolbar":"Thanh công cụ danh mục",Black:"Đen","Dim grey":"Xám mờ",Grey:"Xám","Light grey":"Xám nhạt",White:"Trắng",Red:"Đỏ",Orange:"Cam",Yellow:"Vàng","Light green":"Xanh lá nhạt",Green:"Xanh lá",Aquamarine:"Xanh ngọc biển",Turquoise:"Xanh ngọc bích","Light blue":"Xanh dương",Blue:"Xanh biển",Purple:"Tím","Editor block content toolbar":"Thanh công cụ chỉnh sửa khối nội dung","Editor contextual toolbar":"Thanh công cụ chỉnh sửa theo ngữ cảnh",HEX:"HEX","No results found":"Không tìm thấy kết quả","No searchable items":"Không có mục nào tìm kiếm được","Editor dialog":"Hộp thoại trình biên tập",Close:"Đóng","Help Contents. To close this dialog press ESC.":"Nội dung Trợ giúp. Nhấn phím ESC để đóng hộp thoại này.","Below, you can find a list of keyboard shortcuts that can be used in the editor.":"Dưới đây, bạn có thể tìm thấy danh sách các phím tắt mà bạn có thể dùng trong trình biên tập này.","(may require <kbd>Fn</kbd>)":"(có thể cần nhấn phím <kbd>Fn</kbd>)",Accessibility:"Trợ năng","Accessibility help":"Trợ giúp về khả năng truy cập","Press %0 for help.":"Nhấn %0 để được trợ giúp.","Move focus in and out of an active dialog window":"Di chuyển tiêu điểm vào và ra khỏi cửa sổ hộp thoại đang kích hoạt",MENU_BAR_MENU_FILE:"Tệp",MENU_BAR_MENU_EDIT:"Chỉnh sửa",MENU_BAR_MENU_VIEW:"Xem",MENU_BAR_MENU_INSERT:"Chèn",MENU_BAR_MENU_FORMAT:"Định dạng",MENU_BAR_MENU_TOOLS:"Công cụ",MENU_BAR_MENU_HELP:"Trợ giúp",MENU_BAR_MENU_TEXT:"Văn bản",MENU_BAR_MENU_FONT:"Phông chữ","Editor menu bar":"Thanh menu Trình soạn thảo",'Please enter a valid color (e.g. "ff0000").':'Vui lòng nhập một màu sắc hợp lệ (ví dụ: "ff0000").',"Insert table":"Tạo bảng","Header column":"Tiêu đề cột","Insert column left":"Thêm cột vào bên trái","Insert column right":"Thêm cột vào bên phải","Delete column":"Xoá cột","Select column":"Chọn cột",Column:"Cột","Header row":"Tiêu đề hàng","Insert row below":"Thêm hàng ở dưới","Insert row above":"Thêm hàng phía trên","Delete row":"Xoá hàng","Select row":"Chọn hàng",Row:"Hàng","Merge cell up":"Sát nhập ô lên trên","Merge cell right":"Sát nhập ô qua phải","Merge cell down":"Sát nhập ô xuống dưới","Merge cell left":"Sát nhập ô qua trái","Split cell vertically":"Tách ô theo chiều dọc","Split cell horizontally":"Tách ô theo chiều ngang","Merge cells":"Sát nhập ô","Table toolbar":"Thanh công cụ bảng","Table properties":"Thuộc tính của bảng","Cell properties":"Thuộc tính của ô",Border:"Viền",Style:"Kiểu",Width:"Rộng",Height:"Cao",Color:"Màu",Background:"Màu nền",Padding:"Cách lề",Dimensions:"Kích thước","Table cell text alignment":"Căn lề văn bản trong ô",Alignment:"Căn lề","Horizontal text alignment toolbar":"Thanh công cụ căn chỉnh văn bản theo chiều ngang","Vertical text alignment toolbar":"Thanh công cụ căn chỉnh văn bản theo chiều dọc","Table alignment toolbar":"Thanh công cụ căn chỉnh bảng",None:"Không có kiểu nào",Solid:"Dạng nét liền",Dotted:"Dạng chấm",Dashed:"Dạng đường đứt nét",Double:"Dạng nét đôi",Groove:"Dạng đường rãnh",Ridge:"Dạng gờ",Inset:"Dạng chìm",Outset:"Dạng nổi","Align cell text to the left":"Căn chỉnh văn bản trong ô về bên trái","Align cell text to the center":"Căn chỉnh văn bản trong ô vào chính giữa","Align cell text to the right":"Căn chỉnh văn bản trong ô về bên phải","Justify cell text":"Căn đều văn bản trong ô","Align cell text to the top":"Căn chỉnh văn bản trong ô lên trên cùng","Align cell text to the middle":"Căn chỉnh văn bản trong ô vào giữa","Align cell text to the bottom":"Căn chỉnh văn bản trong ô xuống dưới cùng","Align table to the left":"Căn chỉnh bảng về phía bên trái","Center table":"Căn chỉnh bảng vào chính giữa","Align table to the right":"Căn chỉnh bảng về phía bên phải",'The color is invalid. Try "#FF0000" or "rgb(255,0,0)" or "red".':'Màu này không hợp lệ. Hãy thử "#FF0000" hoặc "rgb(255,0,0)" hoặc "red".','The value is invalid. Try "10px" or "2em" or simply "2".':'Giá trị này không hợp lệ. Hãy thử "10px" hoặc "2em" hoặc chỉ "2".',"Color picker":"Bộ chọn màu","Enter table caption":"Nhập chú thích cho bảng","Keystrokes that can be used in a table cell":"Tổ hợp phím mà bạn có thể dùng trong một ô bảng","Move the selection to the next cell":"Di chuyển vùng chọn đến ô tiếp theo","Move the selection to the previous cell":"Di chuyển vùng chọn đến ô trước đó","Insert a new table row (when in the last cell of a table)":"Chèn một hàng mới trong bảng (khi ở ô cuối cùng của bảng)","Navigate through the table":"Điều hướng qua bảng",Table:"Bảng",Styles:"Kiểu","Multiple styles":"Nhiều kiểu","Block styles":"Kiểu của khối","Text styles":"Kiểu văn bản","Special characters":"Các ký tự đặc biệt",All:"Tất cả",Arrows:"Mũi tên",Currency:"Tiền tệ",Latin:"Latin",Mathematical:"Toán học",Text:"Văn bản","leftwards simple arrow":"mũi tên đơn giản chỉ sang trái","rightwards simple arrow":"mũi tên đơn giản chỉ sang phải","upwards simple arrow":"mũi tên đơn giản chỉ lên trên","downwards simple arrow":"mũi tên đơn giản chỉ xuống dưới","leftwards double arrow":"mũi tên kép hướng sang trái","rightwards double arrow":"mũi tên kép hướng sang phải","upwards double arrow":"mũi tên kép hướng lên","downwards double arrow":"mũi tên kép hướng xuống","leftwards dashed arrow":"mũi tên đứt nét hướng sang trái","rightwards dashed arrow":"mũi tên đứt nét hướng sang phải","upwards dashed arrow":"mũi tên đứt nét hướng lên","downwards dashed arrow":"mũi tên đứt nét hướng xuống","leftwards arrow to bar":"mũi tên hướng sang trái về phía thanh","rightwards arrow to bar":"mũi tên hướng sang phải về phía thanh","upwards arrow to bar":"mũi tên hướng lên trên về phía thanh","downwards arrow to bar":"mũi tên hướng xuống dưới về phía thanh","up down arrow with base":"mũi tên lên xuống có đế","back with leftwards arrow above":"back với mũi tên hướng sang trái ở trên","end with leftwards arrow above":"end với mũi tên hướng sang trái ở trên","on with exclamation mark with left right arrow above":"on với dấu chấm than và mũi tên trái phải ở trên","soon with rightwards arrow above":"soon với mũi tên hướng sang phải ở trên","top with upwards arrow above":"top với mũi tên hướng lên ở trên","Dollar sign":"Ký hiệu Đô la","Euro sign":"Ký hiệu Euro","Yen sign":"Ký hiệu Yên Nhật","Pound sign":"Ký hiệu Bảng Anh","Cent sign":"Ký hiệu Cent","Euro-currency sign":"Ký hiệu tiền tệ Euro","Colon sign":"Ký hiệu Colon","Cruzeiro sign":"Ký hiệu Cruzeiro","French franc sign":"Ký hiệu franc Pháp","Lira sign":"Ký hiệu Lira","Currency sign":"Ký hiệu tiền tệ","Bitcoin sign":"Ký hiệu Bitcoin","Mill sign":"Ký hiệu Mill","Naira sign":"Ký hiệu Naira","Peseta sign":"Ký hiệu Peseta","Rupee sign":"Ký hiệu Rupee","Won sign":"Ký hiệu Won","New sheqel sign":"Ký hiệu Shekel mới","Dong sign":"Ký hiệu Đồng","Kip sign":"Ký hiệu Kip","Tugrik sign":"Ký hiệu Tögrög","Drachma sign":"Ký hiệu Drachma","German penny sign":"Ký hiệu penny Đức","Peso sign":"Ký hiệu Peso","Guarani sign":"Ký hiệu Guarani","Austral sign":"Ký hiệu Austral","Hryvnia sign":"Ký hiệu Hryvnia","Cedi sign":"Ký hiệu Cedi","Livre tournois sign":"Ký hiệu Livre tournois","Spesmilo sign":"Ký hiệu Spesmilo","Tenge sign":"Ký hiệu Tenge","Indian rupee sign":"Ký hiệu rupee Ấn Độ","Turkish lira sign":"Ký hiệu lira Thổ Nhĩ Kỳ","Nordic mark sign":"Ký hiệu Mác Bắc Âu","Manat sign":"Ký hiệu Manat","Ruble sign":"Ký hiệu Rúp","Latin capital letter a with macron":"Chữ cái Latinh a viết hoa với dấu trường âm","Latin small letter a with macron":"Chữ cái Latinh a viết thường với dấu trường âm","Latin capital letter a with breve":"Chữ cái Latinh a viết hoa với dấu trăng","Latin small letter a with breve":"Chữ cái Latinh a viết thường với dấu trăng","Latin capital letter a with ogonek":"Chữ cái Latinh a viết hoa với dấu ogonek","Latin small letter a with ogonek":"Chữ cái Latinh a viết thường với dấu ogonek","Latin capital letter c with acute":"Chữ cái Latinh c viết hoa với dấu sắc","Latin small letter c with acute":"Chữ cái Latinh c viết thường với dấu sắc","Latin capital letter c with circumflex":"Chữ cái Latinh c viết hoa với dấu mũ","Latin small letter c with circumflex":"Chữ cái Latinh c viết thường với dấu mũ","Latin capital letter c with dot above":"Chữ cái Latinh c viết hoa với dấu chấm ở trên","Latin small letter c with dot above":"Chữ cái Latinh c viết thường với dấu chấm ở trên","Latin capital letter c with caron":"Chữ cái Latinh c viết hoa với dấu mũ ngược","Latin small letter c with caron":"Chữ cái Latinh c viết thường với dấu mũ ngược","Latin capital letter d with caron":"Chữ cái Latinh d viết hoa với dấu mũ ngược","Latin small letter d with caron":"Chữ cái Latinh d viết thường với dấu mũ ngược","Latin capital letter d with stroke":"Chữ cái Latinh d viết hoa với dấu gạch ngang","Latin small letter d with stroke":"Chữ cái Latinh d viết thường với dấu gạch ngang","Latin capital letter e with macron":"Chữ cái Latinh e viết hoa với dấu trường âm","Latin small letter e with macron":"Chữ cái Latinh e viết thường với dấu trường âm","Latin capital letter e with breve":"Chữ cái Latinh e viết hoa với dấu trăng","Latin small letter e with breve":"Chữ cái Latinh e viết thường với dấu trăng","Latin capital letter e with dot above":"Chữ cái Latinh e viết hoa với dấu chấm ở trên","Latin small letter e with dot above":"Chữ cái Latinh e viết thường với dấu chấm ở trên","Latin capital letter e with ogonek":"Chữ cái Latinh e viết hoa với dấu ogonek","Latin small letter e with ogonek":"Chữ cái Latinh e viết thường với dấu ogonek","Latin capital letter e with caron":"Chữ cái Latinh e viết hoa với dấu mũ ngược","Latin small letter e with caron":"Chữ cái Latinh e viết thường với dấu mũ ngược","Latin capital letter g with circumflex":"Chữ cái Latinh g viết hoa với dấu mũ","Latin small letter g with circumflex":"Chữ cái Latinh g viết thường với dấu mũ","Latin capital letter g with breve":"Chữ cái Latinh g viết hoa với dấu trăng","Latin small letter g with breve":"Chữ cái Latinh g viết thường với dấu trăng","Latin capital letter g with dot above":"Chữ cái Latinh g viết hoa với dấu chấm ở trên","Latin small letter g with dot above":"Chữ cái Latinh g viết thường với dấu chấm ở trên","Latin capital letter g with cedilla":"Chữ cái Latinh g viết hoa với dấu móc dưới","Latin small letter g with cedilla":"Chữ cái Latinh g viết thường với dấu móc dưới","Latin capital letter h with circumflex":"Chữ cái Latinh h viết hoa với dấu mũ","Latin small letter h with circumflex":"Chữ cái Latinh h viết thường với dấu mũ","Latin capital letter h with stroke":"Chữ cái Latinh h viết hoa với dấu gạch ngang","Latin small letter h with stroke":"Chữ cái Latinh h viết thường với dấu gạch ngang","Latin capital letter i with tilde":"Chữ cái Latinh i viết hoa với dấu ngã","Latin small letter i with tilde":"Chữ cái Latinh i viết thường với dấu ngã","Latin capital letter i with macron":"Chữ cái Latinh i viết hoa với dấu trường âm","Latin small letter i with macron":"Chữ cái Latinh i viết thường với dấu trường âm","Latin capital letter i with breve":"Chữ cái Latinh i viết hoa với dấu trăng","Latin small letter i with breve":"Chữ cái Latinh i viết thường với dấu trăng","Latin capital letter i with ogonek":"Chữ cái Latinh i viết hoa với dấu ogonek","Latin small letter i with ogonek":"Chữ cái Latinh i viết thường với dấu ogonek","Latin capital letter i with dot above":"Chữ cái Latinh i viết hoa với dấu chấm ở trên","Latin small letter dotless i":"Chữ cái Latinh i viết thường không dấu chấm","Latin capital ligature ij":"Chữ ghép Latinh ij viết hoa","Latin small ligature ij":"Chữ ghép Latinh ij viết thường","Latin capital letter j with circumflex":"Chữ cái Latinh j viết hoa với dấu mũ","Latin small letter j with circumflex":"Chữ cái Latinh j viết thường với dấu mũ","Latin capital letter k with cedilla":"Chữ cái Latinh k viết hoa với dấu móc dưới","Latin small letter k with cedilla":"Chữ cái Latinh k viết hoa với dấu móc dưới","Latin small letter kra":"Chữ cái Latinh k viết thường","Latin capital letter l with acute":"Chữ cái Latinh l viết hoa với dấu sắc","Latin small letter l with acute":"Chữ cái Latinh l viết thường với dấu sắc","Latin capital letter l with cedilla":"Chữ cái Latinh l viết hoa với dấu móc dưới","Latin small letter l with cedilla":"Chữ cái Latinh l viết thường với dấu móc dưới","Latin capital letter l with caron":"Chữ cái Latinh l viết hoa với dấu mũ ngược","Latin small letter l with caron":"Chữ cái Latinh l viết thường với dấu mũ ngược","Latin capital letter l with middle dot":"Chữ cái Latinh l viết hoa với dấu chấm ở giữa","Latin small letter l with middle dot":"Chữ cái Latinh l viết thường với dấu chấm ở giữa","Latin capital letter l with stroke":"Chữ cái Latinh l viết hoa với dấu gạch ngang","Latin small letter l with stroke":"Chữ cái Latinh l viết thường với dấu gạch ngang","Latin capital letter n with acute":"Chữ cái Latinh n viết hoa với dấu sắc","Latin small letter n with acute":"Chữ cái Latinh n viết thường với dấu sắc","Latin capital letter n with cedilla":"Chữ cái Latinh n viết hoa với dấu móc dưới","Latin small letter n with cedilla":"Chữ cái Latinh n viết thường với dấu móc dưới","Latin capital letter n with caron":"Chữ cái Latinh n viết hoa với dấu mũ ngược","Latin small letter n with caron":"Chữ cái Latinh n viết thường với dấu mũ ngược","Latin small letter n preceded by apostrophe":"Chữ cái Latinh n viết thường có dấu viết lược đứng trước","Latin capital letter eng":"Chữ cái Latinh Ŋ viết hoa","Latin small letter eng":"Chữ cái Latinh ŋ viết thường","Latin capital letter o with macron":"Chữ cái Latinh o viết hoa với dấu trường âm","Latin small letter o with macron":"Chữ cái Latinh o viết thường với dấu trường âm","Latin capital letter o with breve":"Chữ cái Latinh o viết hoa với dấu trăng","Latin small letter o with breve":"Chữ cái Latinh o viết thường với dấu trăng","Latin capital letter o with double acute":"Chữ cái Latinh o viết hoa với dấu sắc kép","Latin small letter o with double acute":"Chữ cái Latinh o viết thường với dấu sắc kép","Latin capital ligature oe":"Chữ ghép Latinh oe viết hoa","Latin small ligature oe":"Chữ ghép Latinh oe viết thường","Latin capital letter r with acute":"Chữ cái Latinh r viết hoa với dấu sắc","Latin small letter r with acute":"Chữ cái Latinh r viết thường với dấu sắc","Latin capital letter r with cedilla":"Chữ cái Latinh r viết hoa với dấu móc dưới","Latin small letter r with cedilla":"Chữ cái Latinh r viết thường với dấu móc dưới","Latin capital letter r with caron":"Chữ cái Latinh r viết hoa với dấu mũ ngược","Latin small letter r with caron":"Chữ cái Latinh r viết thường với dấu mũ ngược","Latin capital letter s with acute":"Chữ cái Latinh s viết hoa với dấu sắc","Latin small letter s with acute":"Chữ cái Latinh s viết thường với dấu sắc","Latin capital letter s with circumflex":"Chữ cái Latinh s viết hoa với dấu mũ","Latin small letter s with circumflex":"Chữ cái Latinh s viết thường với dấu mũ","Latin capital letter s with cedilla":"Chữ cái Latinh s viết hoa với dấu móc dưới","Latin small letter s with cedilla":"Chữ cái Latinh s viết thường với dấu móc dưới","Latin capital letter s with caron":"Chữ cái Latinh s viết hoa với dấu mũ ngược","Latin small letter s with caron":"Chữ cái Latinh s viết thường với dấu mũ ngược","Latin capital letter t with cedilla":"Chữ cái Latinh t viết hoa với dấu móc dưới","Latin small letter t with cedilla":"Chữ cái Latinh t viết thường với dấu móc dưới","Latin capital letter t with caron":"Chữ cái Latinh t viết hoa với dấu mũ ngược","Latin small letter t with caron":"Chữ cái Latinh t viết thường với dấu mũ ngược","Latin capital letter t with stroke":"Chữ cái Latinh t viết hoa với dấu gạch ngang","Latin small letter t with stroke":"Chữ cái Latinh t viết thường với dấu gạch ngang","Latin capital letter u with tilde":"Chữ cái Latinh u viết hoa với dấu ngã","Latin small letter u with tilde":"Chữ cái Latinh u viết hoa với dấu ngã","Latin capital letter u with macron":"Chữ cái Latinh u viết hoa với dấu trường âm","Latin small letter u with macron":"Chữ cái Latinh u viết thường với dấu trường âm","Latin capital letter u with breve":"Chữ cái Latinh u viết hoa với dấu trăng","Latin small letter u with breve":"Chữ cái Latinh u viết thường với dấu trăng","Latin capital letter u with ring above":"Chữ cái Latinh u viết hoa với vòng tròn ở trên","Latin small letter u with ring above":"Chữ cái Latinh u viết thường với vòng tròn ở trên","Latin capital letter u with double acute":"Chữ cái Latinh u viết hoa với dấu sắc kép","Latin small letter u with double acute":"Chữ cái Latinh u viết thường với dấu sắc kép","Latin capital letter u with ogonek":"Chữ cái Latinh u viết hoa với dấu ogonek","Latin small letter u with ogonek":"Chữ cái Latinh u viết thường với dấu ogonek","Latin capital letter w with circumflex":"Chữ cái Latinh w viết hoa với dấu mũ","Latin small letter w with circumflex":"Chữ cái Latinh w viết thường với dấu mũ","Latin capital letter y with circumflex":"Chữ cái Latinh y viết hoa với dấu mũ","Latin small letter y with circumflex":"Chữ cái Latinh y viết thường với dấu mũ","Latin capital letter y with diaeresis":"Chữ cái Latinh y viết hoa với dấu tách đôi","Latin capital letter z with acute":"Chữ cái Latinh z viết hoa với dấu sắc","Latin small letter z with acute":"Chữ cái Latinh z viết thường với dấu sắc","Latin capital letter z with dot above":"Chữ cái Latinh z viết hoa với dấu chấm ở trên","Latin small letter z with dot above":"Chữ cái Latinh z viết thường với dấu chấm ở trên","Latin capital letter z with caron":"Chữ cái Latinh z viết hoa với dấu mũ ngược","Latin small letter z with caron":"Chữ cái Latinh z viết thường với dấu mũ ngược","Latin small letter long s":"Chữ cái Latinh s dài viết thường","Less-than sign":"Ký hiệu nhỏ hơn","Greater-than sign":"Ký hiệu lớn hơn","Less-than or equal to":"Nhỏ hơn hoặc bằng","Greater-than or equal to":"Lớn hơn hoặc bằng","En dash":"Gạch ngang ngắn","Em dash":"Gạch ngang dài",Macron:"Dấu trường âm",Overline:"Gạch trên","Degree sign":"Ký hiệu độ","Minus sign":"Ký hiệu trừ","Plus-minus sign":"Ký hiệu cộng-trừ","Division sign":"Ký hiệu chia","Fraction slash":"Dấu gạch chéo phân số","Multiplication sign":"Ký hiệu nhân","Latin small letter f with hook":"Chữ cái Latinh f viết thường với móc",Integral:"Tích phân","N-ary summation":"Phép tổng n số nguyên",Infinity:"Vô cực","Square root":"Căn bậc hai","Tilde operator":"Toán tử dấu ngã","Approximately equal to":"Xấp xỉ bằng","Almost equal to":"Gần bằng","Not equal to":"Không bằng","Identical to":"Tương đương","Element of":"Thuộc","Not an element of":"Không thuộc","Contains as member":"Chứa","N-ary product":"Tích n số nguyên","Logical and":"Và logic","Logical or":"Hoặc logic","Not sign":"Không",Intersection:"Giao",Union:"Hợp","Partial differential":"Vi phân riêng phần","For all":"Với mọi","There exists":"Tồn tại","Empty set":"Tập hợp rỗng",Nabla:"Nabla","Asterisk operator":"Toán tử dấu hoa thị","Proportional to":"Tương ứng với",Angle:"Góc","Vulgar fraction one quarter":"Phân số thường một phần tư","Vulgar fraction one half":"Phân số thường một phần hai","Vulgar fraction three quarters":"Phân số thường ba phần tư","Single left-pointing angle quotation mark":"Dấu nháy đơn dạng góc chỉ sang bên trái","Single right-pointing angle quotation mark":"Dấu nháy đơn dạng góc chỉ sang bên phải","Left-pointing double angle quotation mark":"Dấu nháy kép dạng góc chỉ sang bên trái","Right-pointing double angle quotation mark":"Dấu nháy kép dạng góc chỉ sang bên phải","Left single quotation mark":"Dấu nháy đơn bên trái","Right single quotation mark":"Dấu nháy đơn bên phải","Left double quotation mark":"Dấu nháy kép bên trái","Right double quotation mark":"Dấu nháy kép bên phải","Single low-9 quotation mark":"Dấu nháy đơn kiểu low-9","Double low-9 quotation mark":"Dấu nháy kép kiểu low-9","Inverted exclamation mark":"Dấu chấm than ngược","Inverted question mark":"Dấu hỏi ngược","Two dot leader":"Hàng hai dấu chấm","Horizontal ellipsis":"Dấu chấm lửng ngang","Double dagger":"Dấu chữ thập kép","Per mille sign":"Ký hiệu phần nghìn","Per ten thousand sign":"Ký hiệu phần vạn","Double exclamation mark":"Dấu chấm than kép","Question exclamation mark":"Dấu chấm hỏi và chấm than","Exclamation question mark":"Dấu chấm than và chấm hỏi","Double question mark":"Dấu chấm hỏi kép","Copyright sign":"Ký hiệu bản quyền","Registered sign":"Ký hiệu đăng ký thương hiệu","Trade mark sign":"Ký hiệu thương hiệu","Section sign":"Ký hiệu phân đoạn","Paragraph sign":"Ký hiệu đoạn văn","Reversed paragraph sign":"Ký hiệu đoạn văn đảo ngược","Character categories":"Danh mục ký tự",Source:"Nguồn","Show source":"Hiển thị nguồn","Show blocks":"Hiện các khối","Select all":"Chọn tất cả","Disable editing":"Tắt tính năng chỉnh sửa","Enable editing":"Bật tính năng chỉnh sửa","Previous editable region":"Vùng có thể chỉnh sửa trước đó","Next editable region":"Vùng có thể chỉnh sửa tiếp theo","Navigate editable regions":"Di chuyển giữa các vùng có thể chỉnh sửa","Remove Format":"Xóa định dang","Page break":"Ngắt trang","media widget":"tiện ích đa phương tiện","Media URL":"Đường dẫn đa phương tiện","Paste the media URL in the input.":"Dán đường dẫn đa phương tiện vào trường","Tip: Paste the URL into the content to embed faster.":"Mẹo: Dán đường dẫn vào nội dung để nhúng ngay","The URL must not be empty.":"Đường dẫn không được để trống","This media URL is not supported.":"Đường dẫn đa phương tiện không hỗ trợ","Insert media":"Chèn đa phương tiện",Media:"Phương tiện","Media toolbar":"Thanh công cụ đa phương tiện","Open media in new tab":"Mở nội dung nghe nhìn trong tab mới","Numbered List":"Danh sách đánh số","Bulleted List":"Danh sách đánh ký hiệu","To-do List":"Danh sách cần làm","Bulleted list styles toolbar":"Thanh công cụ kiểu danh sách có dấu đầu dòng","Numbered list styles toolbar":"Thanh công cụ kiểu danh sách được đánh số","Toggle the disc list style":"Bật/tắt kiểu danh sách dạng đĩa","Toggle the circle list style":"Bật/tắt kiểu danh sách dạng vòng tròn","Toggle the square list style":"Bật/tắt kiểu danh sách dạng vuông","Toggle the decimal list style":"Bật/tắt kiểu danh sách dạng thập phân","Toggle the decimal with leading zero list style":"Bật/tắt kiểu danh sách dạng thập phân bắt đầu bằng số 0","Toggle the lower–roman list style":"Bật/tắt kiểu danh sách chữ số La Mã viết thường","Toggle the upper–roman list style":"Bật/tắt kiểu danh sách chữ số La Mã viết hoa","Toggle the lower–latin list style":"Bật/tắt kiểu danh sách chữ cái Latinh viết thường","Toggle the upper–latin list style":"Bật/tắt kiểu danh sách chữ cái Latinh viết hoa",Disc:"Đĩa",Circle:"Tròn",Square:"Vuông",Decimal:"Thập phân","Decimal with leading zero":"Thập phân bắt đầu bằng số 0","Lower–roman":"Chữ số La Mã viết thường","Upper-roman":"Chữ số La Mã viết hoa","Lower-latin":"Chữ cái Latinh viết thường","Upper-latin":"Chữ cái Latinh viết hoa","List properties":"Thuộc tính danh sách","Start at":"Bắt đầu tại","Invalid start index value.":"Giá trị chỉ mục bắt đầu không hợp lệ.","Start index must be greater than 0.":"Chỉ mục bắt đầu phải lớn hơn 0.","Reversed order":"Thứ tự đảo ngược","Keystrokes that can be used in a list":"Tổ hợp phím mà bạn có thể dùng trong danh sách","Increase list item indent":"Tăng thụt lề mục danh sách","Decrease list item indent":"Giảm thụt lề mục danh sách","Entering a to-do list":"Đang nhập danh sách việc cần làm","Leaving a to-do list":"Đang rời khỏi danh sách việc cần làm",Unlink:"Bỏ liên kết",Link:"Chèn liên kết","Link URL":"Đường dẫn liên kết","Link URL must not be empty.":"Không được để trống URL đường liên kết.","Link image":"Liên kết của ảnh","Edit link":"Sửa liên kết","Open link in new tab":"Mở liên kết","This link has no URL":"Liên kết không có đường dẫn","Open in a new tab":"Mở trên tab mới",Downloadable:"Có thể tải về","Create link":"Tạo liên kết","Move out of a link":"Di chuyển ra khỏi một liên kết",Language:"Ngôn ngữ","Choose language":"Chọn ngôn ngữ","Remove language":"Xóa ngôn ngữ","Increase indent":"Tăng lề","Decrease indent":"Giảm lề","image widget":"tiện ích ảnh","Wrap text":"Bọc văn bản","Break text":"Ngắt văn bản","In line":"Nội dòng","Side image":"Ảnh một bên","Full size image":"Ảnh đầy đủ","Left aligned image":"Ảnh canh trái","Centered image":"Ảnh canh giữa","Right aligned image":"Ảnh canh phải","Change image text alternative":"Đổi chữ alt của ảnh","Text alternative":"Chữ alt","Enter image caption":"Nhập mô tả ảnh","Insert image":"Chèn ảnh","Replace image":"Thay thế hình ảnh","Upload from computer":"Tải lên từ máy tính","Replace from computer":"Thay thế từ máy tính","Upload image from computer":"Tải hình ảnh lên từ máy tính","Image from computer":"Hình ảnh từ máy tính","From computer":"Từ máy tính","Replace image from computer":"Thay thế hình ảnh từ máy tính","Upload failed":"Tải thất bại","Image toolbar":"Thanh công cụ hình ảnh","Resize image":"Chỉnh kích cỡ ảnh","Resize image to %0":"Chỉnh kích cỡ ảnh về %0","Resize image to the original size":"Chỉnh về ảnh kích cỡ nguyên gốc","Resize image (in %0)":"Đặt lại kích thước hình ảnh (bằng %0)",Original:"Nguyên bản","Custom image size":"Tùy chỉnh kích thước hình ảnh",Custom:"Tùy chỉnh","Image resize list":"Danh sách ảnh đã chỉnh kích thước","Insert image via URL":"Chèn ảnh từ URL","Insert via URL":"Chèn bằng URL","Image via URL":"Hình ảnh bằng URL","Via URL":"Bằng URL","Update image URL":"Cập nhật ảnh từ URL","Caption for the image":"Chú thích cho hình ảnh","Caption for image: %0":"Chú thích cho hình ảnh: %0","The value must not be empty.":"Không được để trống giá trị này.","The value should be a plain number.":"Giá trị này phải là một số thường.","Uploading image":"Đang tải hình ảnh lên","Image upload complete":"Hoàn tất quá trình tải hình ảnh lên","Error during image upload":"Xảy ra lỗi trong quá trình tải hình ảnh lên",Image:"Hình ảnh","HTML object":"Đối tượng HTML","Insert HTML":"Chèn HTML","HTML snippet":"Mẫu HTML","Paste raw HTML here...":"Dán mã HTML nguyên bản tại đây...","Edit source":"Sửa nguồn","Save changes":"Lưu thay đổi","No preview available":"Không có sẵn bản xem trước","Empty snippet content":"Nội dung đoạn mã trống","Horizontal line":"Đường ngang","Yellow marker":"Bút vàng","Green marker":"Bút xanh lá","Pink marker":"Bút hồng","Blue marker":"Bút xanh dương","Red pen":"Mực đỏ","Green pen":"Mực xanh","Remove highlight":"Xóa làm nổi",Highlight:"Làm nổi","Text highlight toolbar":"Thanh công cụ làm nổi chữ",Paragraph:"Đoạn văn",Heading:"Tiêu đề","Choose heading":"Chọn tiêu đề","Heading 1":"Tiêu đề 1","Heading 2":"Tiêu đề 2","Heading 3":"Tiêu đề 3","Heading 4":"Tiêu đề 4","Heading 5":"Tiêu đề 5","Heading 6":"Tiêu đề 6","Type your title":"Nhập tựa đề","Type or paste your content here.":"Nhập hoặc dán nội dung tại đây","Font Size":"Cỡ chữ",Tiny:"Bé",Small:"Nhỏ",Big:"Lớn",Huge:"Khổng lồ","Font Family":"Họ chữ",Default:"Mặc định","Font Color":"Màu chữ","Font Background Color":"Màu nền chữ","Document colors":"Màu văn bản","Find and replace":"Tìm và thay thế","Find in text…":"Tìm trong văn bản...",Find:"Tìm","Previous result":"Kết quả trước","Next result":"Kết quả tiếp theo",Replace:"Thay thế","Replace all":"Thay thế tất cả","Match case":"Khớp chữ hoa/chữ thường","Whole words only":"Chỉ toàn bộ từ","Replace with…":"Thay thế bằng...","Text to find must not be empty.":"Không được để trống trường văn bản cần tìm.","Tip: Find some text first in order to replace it.":"Mẹo: Tìm một đoạn văn bản trước để thay thế.","Advanced options":"Tùy chọn nâng cao","Find in the document":"Tìm trong tài liệu","Insert a soft break (a <code>&lt;br&gt;</code> element)":"Chèn dấu ngắt mềm (phần tử <code>&lt;br&gt;</code>)","Insert a hard break (a new paragraph)":"Chèn dấu ngắt cứng (đoạn văn mới)",Cancel:"Hủy",Clear:"Xóa","Remove color":"Xóa màu","Restore default":"Khôi phục giá trị mặc định",Save:"Lưu","Show more items":"Xem thêm","%0 of %1":"%0 đến %1","Cannot upload file:":"Không thể tải file:","Rich Text Editor. Editing area: %0":"Trình chỉnh sửa Văn bản dạng RTF. Vùng chỉnh sửa:  %0","Insert with file manager":"Chèn bằng trình quản lý tập tin","Replace with file manager":"Thay thế bằng trình quản lý tập tin","Insert image with file manager":"Chèn hình ảnh bằng trình quản lý tập tin","Replace image with file manager":"Thay thế hình ảnh bằng trình quản lý tập tin",File:"Tệp","With file manager":"Với trình quản lý tệp","Toggle caption off":"Ẩn chú thích","Toggle caption on":"Hiện chú thích","Content editing keystrokes":"Tổ hợp phím chỉnh sửa nội dung","These keyboard shortcuts allow for quick access to content editing features.":"Những phím tắt này giúp bạn truy cập nhanh vào các tính năng chỉnh sửa nội dung.","User interface and content navigation keystrokes":"Giao diện người dùng và tổ hợp phím điều hướng nội dung","Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface.":"Sử dụng các tổ hợp phím sau đây để điều hướng hiệu quả hơn trong giao diện người dùng CKEditor 5.","Close contextual balloons, dropdowns, and dialogs":"Đóng bong bóng theo ngữ cảnh, menu thả xuống và hộp thoại","Open the accessibility help dialog":"Mở hộp thoại trợ giúp về khả năng tiếp cận","Move focus between form fields (inputs, buttons, etc.)":"Di chuyển tiêu điểm giữa các trường biểu mẫu (nội dung nhập, nút, v.v.)","Move focus to the menu bar, navigate between menu bars":"Di chuyển tiêu điểm đến thanh menu, điều hướng giữa các thanh menu","Move focus to the toolbar, navigate between toolbars":"Di chuyển tiêu điểm đến thanh công cụ, điều hướng giữa các thanh công cụ","Navigate through the toolbar or menu bar":"Điều hướng trên thanh công cụ hoặc thanh menu","Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content.":"Thực thi nút hiện đang ưu tiên. Việc thực thi các nút tương tác với nội dung soạn thảo sẽ làm di chuyển tiêu điểm trở lại phần nội dung.",Accept:"Chấp nhận","Insert code block":"Chèn khối mã","Plain text":"Văn bản thuần","Leaving %0 code snippet":"Đang rời khỏi đoạn mã snippet %0","Entering %0 code snippet":"Đang nhập đoạn mã snippet %0","Entering code snippet":"Đang nhập đoạn mã snippet","Leaving code snippet":"Đang rời khỏi đoạn mã snippet","Code block":"Khối mã","Copy selected content":"Sao chép nội dung đã chọn","Paste content":"Dán nội dung","Paste content as plain text":"Dán nội dung dưới dạng văn bản thuần túy","Insert image or file":"Chèn ảnh hoặc file","Could not obtain resized image URL.":"Không thể lấy được đường dẫn ảnh đã đổi kích thước","Selecting resized image failed":"Chọn ảnh đã đổi kích thước thất bại","Could not insert image at the current position.":"Không thể chèn ảnh ở vị trí hiện tại","Inserting image failed":"Chèn ảnh thất bại","Open file manager":"Mở trình quản lý tệp","Cannot determine a category for the uploaded file.":"Không thể xác định danh mục cho tệp được tải lên.","Cannot access default workspace.":"Không thể truy cập vào không gian làm việc mặc định.","Edit image":"Chỉnh sửa hình ảnh","Processing the edited image.":"Xử lý hình ảnh đã chỉnh sửa.","Server failed to process the image.":"Máy chủ không thể xử lý hình ảnh.","Failed to determine category of edited image.":"Không thể xác định danh mục hình ảnh đã chỉnh sửa.","Block quote":"Trích dẫn",Bold:"Đậm",Italic:"Nghiêng",Underline:"Gạch dưới",Code:"Code",Strikethrough:"Gạch ngang",Subscript:"Chữ nhỏ dưới",Superscript:"Chữ nhỏ trên","Italic text":"In nghiêng chữ","Move out of an inline code style":"Thoát khỏi kiểu mã nội dòng","Bold text":"In đậm chữ","Underline text":"Gạch chân chữ","Strikethrough text":"Gạch ngang chữ","Saving changes":"Đang lưu","Revert autoformatting action":"Hoàn nguyên thao tác tự động định dạng","Align left":"Canh trái","Align right":"Canh phải","Align center":"Canh giữa",Justify:"Canh đều","Text alignment":"Căn chỉnh văn bản","Text alignment toolbar":"Thanh công cụ canh chữ"},getPluralForm(n){return 0}}};var Qae=typeof self=="object"?self.FormData:window.FormData;const ele=Lh(Qae);class qy{constructor(t,e,i,s){this.loader=t,this.url=`https://api.cloudinary.com/v1_1/${e}/image/upload`,this.folder=i,this.preset=s}upload(){return this.loader.file.then(t=>new Promise((e,i)=>{this._initRequest(),this._initListeners(e,i,t),this._sendRequest(t)}))}abort(){this.xhr&&this.xhr.abort()}_initRequest(){const t=this.xhr=new XMLHttpRequest;t.open("POST",this.url,!0),t.responseType="json"}_initListeners(t,e,i){const s=this.xhr,o=this.loader,r=`Couldn't upload file: ${i.name}.`;s.addEventListener("error",()=>e(r)),s.addEventListener("abort",()=>e()),s.addEventListener("load",()=>{const a=s.response;if(!a||a.error)return e(a&&a.error?a.error.message:r);t({default:a.url})}),s.upload&&s.upload.addEventListener("progress",a=>{a.lengthComputable&&(o.uploadTotal=a.total,o.uploaded=a.loaded)})}_sendRequest(t){const e=new ele;e.append("upload_preset",this.preset),e.append("folder",this.folder),e.append("file",t),this.xhr.send(e)}}const gw=(n,t)=>{const e=n.__vccOpts||n;for(const[i,s]of t)e[i]=s;return e};var au={};const tle={name:"app",data(){return{isLayoutReady:!1,config:null,editor:SX,data:"<h2>Hãy bắt đầu bài viết của bạn nào!</h2>"}},mounted(){this.config={toolbar:{items:["undo","redo","|","sourceEditing","showBlocks","|","heading","style","|","bold","italic","|","link","insertImage","insertTable","blockQuote","codeBlock","|","alignment","|","bulletedList","numberedList","todoList","outdent","indent"],shouldNotGroupWhenFull:!1},plugins:[kI,vJ,NJ,QQ,FP,FJ,GZ,oY,HJ,cX,jJ,EX,HX,jQ,zQ,KX,tQ,WQ,aQ,cee,gee,dee,Mee,TP,jee,ite,Qb,ste,kP,lte,ute,JJ,Dte,jte,pne,Bne,qie,ase,gse,ud,Gie,soe,lP,coe,goe,Boe,Xre,jae,vae,Yae,Fae,Qre,PJ,Wne,Nh,qy],extraPlugins:[function(n){n.plugins.get("FileRepository").createUploadAdapter=t=>new qy(t,au.CLOUDINARY_NAME,au.CLOUDINARY_FOLDER,au.CLOUDINARY_UPLOAD_PRESET)}],balloonToolbar:["bold","italic","|","link","insertImage","|","bulletedList","numberedList"],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},htmlSupport:{allow:[{name:/^.*$/,styles:!0,attributes:!0,classes:!0}]},image:{toolbar:["toggleImageCaption","imageTextAlternative","|","imageStyle:inline","imageStyle:wrapText","imageStyle:breakText","|","resizeImage"]},language:"vi",link:{addTargetToExternalLinks:!0,defaultProtocol:"https://",decorators:{toggleDownloadable:{mode:"manual",label:"Downloadable",attributes:{download:"file"}}}},list:{properties:{styles:!0,startIndex:!0,reversed:!0}},menuBar:{isVisible:!0},placeholder:"Type or paste your content here!",style:{definitions:[{name:"Article category",element:"h3",classes:["category"]},{name:"Title",element:"h2",classes:["document-title"]},{name:"Subtitle",element:"h3",classes:["document-subtitle"]},{name:"Info box",element:"p",classes:["info-box"]},{name:"Side quote",element:"blockquote",classes:["side-quote"]},{name:"Marker",element:"span",classes:["marker"]},{name:"Spoiler",element:"span",classes:["spoiler"]},{name:"Code (dark)",element:"pre",classes:["fancy-code","fancy-code-dark"]},{name:"Code (bright)",element:"pre",classes:["fancy-code","fancy-code-bright"]}]},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells","tableProperties","tableCellProperties"]},translations:[Xae],simpleUpload:{uploadUrl:`https://api.cloudinary.com/v1_1/${au.CLOUDINARY_NAME}/image/upload?upload_preset=upload_f`,withCredentials:!1,headers:{"X-Requested-With":"XMLHttpRequest"},formData:{upload_preset:"upload_f"},onError:n=>{console.error("Upload failed:",n)},payload:{upload_preset:"upload_f"}}},this.isLayoutReady=!0},emits:["data"],watch:{data(n){this.$emit("data",n)}}},nle={class:"main-container article-editor"},ile={class:"editor-container editor-container_classic-editor editor-container_include-style",ref:"editorContainerElement"},sle={class:"editor-container__editor"},ole={ref:"editorElement"};function rle(n,t,e,i,s,o){const r=Iu("ckeditor");return Vs(),Wd("div",nle,[Is("div",ile,[Is("div",sle,[Is("div",ole,[s.isLayoutReady?(Vs(),qd(r,{key:0,modelValue:s.data,"onUpdate:modelValue":t[0]||(t[0]=a=>s.data=a),editor:s.editor,config:s.config,ref:"editorInstance"},null,8,["modelValue","editor","config"])):wk("",!0)],512)])],512)])}const ale=gw(tle,[["render",rle]]),lle={props:{data:String}},cle=["innerHTML"];function ule(n,t,e,i,s,o){return Vs(),Wd("div",{class:"ck-content",innerHTML:e.data},null,8,cle)}const dle=gw(lle,[["render",ule]]),hle={components:{ArticleEditor:ale,ArticleDisplay:dle},data(){return{data:null}},methods:{getData(n){this.data=n}}},fle={class:"container"},mle={class:"container"};function gle(n,t,e,i,s,o){const r=Iu("ArticleEditor"),a=Iu("ArticleDisplay");return Vs(),Wd(It,null,[Is("div",fle,[qe(r,{onData:o.getData},null,8,["onData"])]),jd(" "+Sg(s.data)+" ",1),Is("div",mle,[qe(a,{data:s.data},null,8,["data"])])],64)}const ple=gw(hle,[["render",gle],["__scopeId","data-v-834fd59e"]]);var zR={exports:{}};const ble=cI(kV),wle=cI(fH);/*!
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */(function(n,t){(function(e,i){n.exports=i(ble,wle)})(self,(e,i)=>(()=>{var s={76:l=>{l.exports=i},380:l=>{l.exports=e}},o={};function r(l){var c=o[l];if(c!==void 0)return c.exports;var u=o[l]={exports:{}};return s[l](u,u.exports,r),u.exports}r.d=(l,c)=>{for(var u in c)r.o(c,u)&&!r.o(l,u)&&Object.defineProperty(l,u,{enumerable:!0,get:c[u]})},r.o=(l,c)=>Object.prototype.hasOwnProperty.call(l,c);var a={};return(()=>{r.d(a,{default:()=>d});var l=r(380),c=r(76);const u=(0,l.defineComponent)({name:"Ckeditor",model:{prop:"modelValue",event:"update:modelValue"},props:{editor:{type:Function,required:!0},config:{type:Object,default:()=>({})},modelValue:{type:String,default:""},tagName:{type:String,default:"div"},disabled:{type:Boolean,default:!1},disableTwoWayDataBinding:{type:Boolean,default:!1}},emits:["ready","destroy","blur","focus","input","update:modelValue"],data:()=>({instance:null,lastEditorData:null}),watch:{modelValue(f){this.instance&&f!==this.lastEditorData&&this.instance.data.set(f)},disabled(f){f?this.instance.enableReadOnlyMode("Integration Sample"):this.instance.disableReadOnlyMode("Integration Sample")}},created(){const{CKEDITOR_VERSION:f}=window;if(!f)return console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.');const[m]=f.split(".").map(Number);m>=42||f.startsWith("0.0.0")||console.warn("The <CKEditor> component requires using CKEditor 5 in version 42+ or nightly build.")},mounted(){const f=Object.assign({},this.config);this.modelValue&&(f.initialData=this.modelValue),this.editor.create(this.$el,f).then(m=>{this.instance=(0,l.markRaw)(m),this.setUpEditorEvents(),this.modelValue!==f.initialData&&m.data.set(this.modelValue),this.disabled&&m.enableReadOnlyMode("Integration Sample"),this.$emit("ready",m)}).catch(m=>{console.error(m)})},beforeUnmount(){this.instance&&(this.instance.destroy(),this.instance=null),this.$emit("destroy",this.instance)},methods:{setUpEditorEvents(){const f=this.instance,m=(0,c.debounce)(g=>{if(this.disableTwoWayDataBinding)return;const p=this.lastEditorData=f.data.get();this.$emit("update:modelValue",p,g,f),this.$emit("input",p,g,f)},300,{leading:!0});f.model.document.on("change:data",m),f.editing.view.document.on("focus",g=>{this.$emit("focus",g,f)}),f.editing.view.document.on("blur",g=>{this.$emit("blur",g,f)})}},render(){return(0,l.h)(this.tagName)}});if(!l.version||!l.version.startsWith("3."))throw new Error("The CKEditor plugin works only with Vue 3+. For more information, please refer to https://ckeditor.com/docs/ckeditor5/latest/builds/guides/integration/frameworks/vuejs-v3.html");const d={install(f){f.component("Ckeditor",u)},component:u}})(),a=a.default})())})(zR);var _le=zR.exports;const vle=Lh(_le);Kk(ple).use(vle).mount("#app")});export default yle();
